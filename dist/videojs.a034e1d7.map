{"version":3,"sources":["plugin/video.js","source/videojs/index.js"],"names":["global","factory","exports","module","define","amd","videojs","version","commonjsGlobal","window","self","createCommonjsModule","fn","win","window_1","empty","empty$1","Object","freeze","default","minDoc","topLevel","doccy","document","document_1","log","level","history","logByType","type","args","lvl","levels","lvlRegExp","RegExp","unshift","toUpperCase","push","concat","console","info","test","Array","isArray","_len","arguments","length","_key","all","off","debug","warn","error","DEFAULT","hasOwnProperty","Error","clear","disable","enable","_len2","_key2","_len3","_key3","_len4","_key4","log$1","clean","s","replace","tsml","sa","i","_typeof","Symbol","iterator","obj","constructor","prototype","classCallCheck","instance","Constructor","TypeError","inherits","subClass","superClass","create","value","enumerable","writable","configurable","setPrototypeOf","__proto__","possibleConstructorReturn","call","ReferenceError","taggedTemplateLiteralLoose","strings","raw","toString","keys","object","isObject","each","forEach","key","reduce","initial","undefined","accum","assign","target","sources","apply","source","isPlain","computedStyle","el","prop","getComputedStyle","cs","_templateObject","isNonBlankString","str","throwIfWhitespace","classRegExp","className","isReal","isEl","nodeType","isInFrame","parent","x","createQuerier","method","selector","context","querySelector","ctx","createEl","tagName","properties","attributes","content","createElement","getOwnPropertyNames","propName","val","indexOf","setAttribute","textContent","attrName","appendContent","text","innerText","prependTo","child","firstChild","insertBefore","appendChild","hasClass","element","classToCheck","classList","contains","addClass","classToAdd","add","trim","removeClass","classToRemove","remove","split","filter","c","join","toggleClass","classToToggle","predicate","has","setAttributes","attrValue","removeAttribute","getAttributes","tag","knownBooleans","attrs","name","attrVal","getAttribute","attribute","blockTextSelection","body","focus","onselectstart","unblockTextSelection","getBoundingClientRect","parentNode","rect","result","k","height","parseFloat","width","findPosition","box","left","top","docEl","documentElement","clientLeft","scrollLeft","pageXOffset","clientTop","scrollTop","pageYOffset","Math","round","getPointerPosition","event","position","boxW","offsetWidth","boxH","offsetHeight","boxY","boxX","pageY","pageX","changedTouches","y","max","min","isTextNode","emptyEl","removeChild","normalizeContent","map","createTextNode","node","insertContent","isSingleLeftClick","button","buttons","$","$$","Dom","_guid","newGUID","elData","elIdAttr","Date","getTime","getData","id","hasData","removeData","e","_cleanUpEvents","elem","data","handlers","removeEventListener","dispatcher","detachEvent","disabled","_handleMultipleEvents","types","callback","fixEvent","returnTrue","returnFalse","isPropagationStopped","old","preventDefault","srcElement","relatedTarget","fromElement","toElement","returnValue","defaultPrevented","stopPropagation","cancelBubble","stopImmediatePropagation","isImmediatePropagationStopped","clientX","doc","clientY","which","charCode","keyCode","_supportsPassive","opts","defineProperty","get","addEventListener","passiveEvents","on","guid","hash","handlersCopy","slice","m","n","options","passive","attachEvent","removeType","t","splice","trigger","elemData","ownerDocument","bubbles","targetData","one","func","Events","_windowLoaded","autoSetup","vids","getElementsByTagName","audios","divs","mediaEls","mediaEl","player","autoSetupTimeout","wait","vjs","setTimeout","readyState","createStyleElement","style","setTextContent","styleSheet","cssText","bind","uid","bound","throttle","last","now","throttled","debounce","immediate","timeout","_later","later","clearTimeout","EventTarget","allowedEvents_","ael","dispatchEvent","isEvented","eventBusEl_","every","isValidEventType","validateTarget","nodeName","validateEventType","validateListener","listener","normalizeListenArgs","isTargetingSelf","shift","listen","EventedMixin","on$$1","_this","_normalizeListenArgs","removeListenerOnDispose","removeRemoverOnTargetDispose","one$$1","_this2","_normalizeListenArgs2","wrapper","largs","off$$1","targetOrType","typeOrListener","trigger$$1","evented","eventBusKey","StatefulMixin","state","setState","stateUpdates","changes","from","to","stateful","defaultState","handleStateChanged","toTitleCase","string","charAt","titleCaseEquals","str1","str2","mergeOptions","Component","ready","play","player_","options_","id_","name_","el_","children_","childIndex_","childNameIndex_","initChildren","reportTouchActivity","enableTouchActivity","dispose","createEl$$1","localize","tokens","defaultValue","code","language","languages","primaryCode","primaryLang","localizedString","match","index","ret","contentEl","contentEl_","children","getChildById","getChild","addChild","component","componentName","componentClassName","componentClass","ComponentClass","getComponent","childNodes","refNode","childFound","compEl","parentOptions","handleAdd","playerOptions","newChild","workingChildren","Tech","some","wchild","isTech","buildCSSClass","sync","isReady_","readyQueue_","triggerReady","readyQueue","$$$1","$$$$1","hasClass$$1","addClass$$1","removeClass$$1","toggleClass$$1","show","hide","lockShowing","unlockShowing","getAttribute$$1","setAttribute$$1","removeAttribute$$1","num","skipListeners","dimension","dimensions","widthOrHeight","pxIndex","parseInt","currentDimension","computedWidthOrHeight","getPropertyValue","rule","currentDimensions","currentWidth","currentHeight","blur","emitTapEvents","touchStart","firstTouch","tapMovementThreshold","touchTimeThreshold","couldBeTap","touches","xdiff","ydiff","touchDistance","sqrt","noTap","touchTime","reportUserActivity","report","touchHolding","clearInterval","setInterval","touchEnd","timeoutId","disposeFn","interval","_this3","intervalId","requestAnimationFrame","_this4","supportsRaf_","cancelAnimationFrame","registerComponent","ComponentToRegister","isComp","isPrototypeOf","reason","components_","Player","players","playerNames","pname","Boolean","USER_AGENT","navigator","userAgent","webkitVersionMap","exec","appleWebkitVersion","pop","IS_IPAD","IS_IPHONE","IS_IPOD","IS_IOS","IOS_VERSION","IS_ANDROID","ANDROID_VERSION","major","minor","IS_NATIVE_ANDROID","IS_FIREFOX","IS_EDGE","IS_CHROME","CHROME_VERSION","IE_VERSION","IS_SAFARI","IS_ANY_SAFARI","TOUCH_ENABLED","DocumentTouch","browser","rangeCheck","fnName","maxIndex","getRange","valueIndex","ranges","rangeIndex","createTimeRangesObj","start","end","createTimeRanges","bufferedPercent","buffered","duration","bufferedDuration","FullscreenApi","apiMap","specApi","browserApi","_i","MediaError","message","defaultMessages","status","errorTypes","errNum","tuple","SafeParseTuple","reviver","json","JSON","parse","err","isPromise","then","silencePromise","trackToJson_","track","acc","cues","cue","startTime","endTime","textTracksToJson","tech","trackEls","trackObjs","tracks","trackEl","src","textTracks","jsonToTextTracks","addedTrack","addRemoteTextTrack","addCue","textTrackConverter","MODAL_CLASS_NAME","ESC","ModalDialog","_Component","opened_","hasBeenOpened_","hasBeenFilled_","closeable","uncloseable","role","descEl_","description","tabIndex","label","previouslyActiveEl_","handleKeyPress","close","desc","open","fillAlways","fill","wasPlaying_","paused","pauseOnOpen","pause","hadControls_","controls","conditionalFocus_","opened","conditionalBlur_","temporary","closeable_","temp","controlText","fillWith","parentEl","nextSiblingEl","nextSibling","closeButton","content_","activeEl","activeElement","playerEl","handleKeyDown","focusableEls","focusableEls_","focusIndex","shiftKey","allChildren","querySelectorAll","HTMLAnchorElement","HTMLAreaElement","hasAttribute","HTMLInputElement","HTMLSelectElement","HTMLTextAreaElement","HTMLButtonElement","HTMLIFrameElement","HTMLObjectElement","HTMLEmbedElement","TrackList","_EventTarget","tracks_","get$$1","addTrack","removeTrack","rtrack","l","getTrackById","change","addtrack","removetrack","disableOthers","list","enabled","AudioTrackList","_TrackList","changing_","disableOthers$1","selected","VideoTrackList","set","set$$1","TextTrackList","nonLanguageTextTrackKind","kind","HtmlTrackElementList","trackElements","trackElements_","addTrackElement_","trackElement","getTrackElementByTrack_","trackElement_","removeTrackElement_","TextTrackCueList","setCues_","length_","oldLength","cues_","defineProp","getCueById","VideoTrackKind","alternative","captions","main","sign","subtitles","commentary","AudioTrackKind","TextTrackKind","descriptions","chapters","metadata","TextTrackMode","hidden","showing","Track","trackProps","_loop","parseUrl","url","props","a","href","addToBody","host","protocol","div","innerHTML","details","location","getAbsoluteURL","getFileExtension","path","splitPathRe","pathParts","toLowerCase","isCrossOrigin","winLoc","urlInfo","srcProtocol","crossOrigin","Url","isFunction_1","isFunction","toString$1","alert","confirm","prompt","isFunction$1","__moduleExports","trim_1","right","trim_2","trim_3","isFunction$2","forEach_1","toString$2","forEachArray","forEachString","forEachObject","array","len","forEach$1","trim$1","forEach$2","arg","parseHeaders","headers","row","parseHeaders$1","immutable","extend","hasOwnProperty$1","immutable$1","parseHeaders$2","xtend","xhr","createXHR","XMLHttpRequest","noop","XDomainRequest","forEachArray$1","uri","initParams","_createXHR","isEmpty","params","called","cbOnce","response","readystatechange","loadFunc","getBody","responseText","getXml","isJson","errorFunc","evt","timeoutTimer","statusCode","failureResponse","aborted","useXDR","rawRequest","getAllResponseHeaders","cors","stringify","onreadystatechange","onload","onerror","onprogress","onabort","ontimeout","username","password","withCredentials","abort","setRequestHeader","responseType","beforeSend","send","responseXML","firefoxBugTakenEffect","parseCues","srcContent","parser","WebVTT","Parser","vttjs","StringDecoder","errors","oncue","onparsingerror","onflush","groupCollapsed","groupEnd","flush","loadTrack","responseBody","loaded_","tech_","loadHandler","TextTrack","_Track","settings","srclang","mode","default_","activeCues_","activeCues","changed","timeupdateHandler","defineProperties","newMode","ct","currentTime","active","originalCue","VTTCue","originalCue_","removeCue","_removeCue","cuechange","AudioTrack","newEnabled","VideoTrack","newSelected","NONE","LOADING","LOADED","ERROR","HTMLTrackElement","load","NORMAL","audio","ListClass","TrackClass","capitalName","video","getterName","privateName","REMOTE","remoteText","remoteTextEl","ALL","names","_objCreate","F","o","ParsingError","errorData","Errors","BadSignature","BadTimeStamp","parseTimeStamp","input","computeSeconds","h","f","Settings","values","v","dflt","defaultKey","alt","integer","percent","parseOptions","keyValueDelim","groupDelim","groups","kv","parseCue","regionList","oInput","consumeTimeStamp","ts","consumeCueSettings","region","vals","vals0","vertical","line","lineAlign","snapToLines","size","align","middle","positionAlign","skipWhitespace","substr","ESCAPE","TAG_NAME","b","u","ruby","rt","lang","TAG_ANNOTATION","NEEDS_PARENT","parseContent","nextToken","consume","unescape1","unescape","shouldAdd","current","localName","annotation","rootDiv","tagStack","createProcessingInstruction","strongRTLRanges","isStrongRTLChar","currentRange","determineBidi","cueDiv","nodeStack","pushNodes","nextTextNode","charCodeAt","computeLinePos","textTrackList","mediaElement","trackList","count","StyleBox","applyStyles","styles","formatStyle","unit","CueStyleBox","styleOptions","color","backgroundColor","bottom","display","writingMode","unicodeBidi","direction","textAlign","font","whiteSpace","textPos","move","BoxPosition","lh","offsetTop","rects","getClientRects","lineHeight","axis","toMove","overlaps","b2","overlapsAny","boxes","within","container","overlapsOppositeAxis","intersectPercentage","intersectArea","toCSSCompatValues","reference","getSimpleBoxPosition","moveBoxToLinePosition","styleBox","containerBox","boxPositions","findBestPosition","bestPosition","specifiedPosition","percentage","p","boxPosition","linePos","step","maxPosition","initialAxis","abs","ceil","reverse","calculatedPercentage","WebVTT$1","decode","decodeURIComponent","encodeURIComponent","convertCueToDOMTree","cuetext","FONT_SIZE_PERCENT","FONT_STYLE","CUE_BACKGROUND_PADDING","processCues","overlay","paddedOverlay","margin","shouldCompute","hasBeenReset","displayState","fontSize","decoder","buffer","TextDecoder","reportOrThrowError","stream","collectNextLine","pos","parseRegion","xy","anchor","VTTRegion","lines","regionAnchorX","regionAnchorY","viewportAnchorX","viewportAnchorY","scroll","onregion","parseTimestampMap","ontimestampmap","parseHeader","alreadyCollectedLine","hasSubstring","vtt","vtt$1","autoKeyword","directionSetting","alignSetting","findDirectionSetting","dir","findAlignSetting","_id","_pauseOnExit","_startTime","_endTime","_text","_region","_vertical","_snapToLines","_line","_lineAlign","_position","_positionAlign","_size","_align","setting","SyntaxError","getCueAsHTML","vttcue","vttcue$1","scrollSetting","findScrollSetting","isValidPercentValue","_width","_lines","_regionAnchorX","_regionAnchorY","_viewportAnchorX","_viewportAnchorY","_scroll","vttregion","vttregion$1","require$$0","require$$1","require$$2","browserIndex","cueShim","regionShim","nativeVTTCue","nativeVTTRegion","shim","restore","browserIndex_1","browserIndex_2","browserIndex_3","createTrackHelper","hasStarted_","featuresProgressEvents","manualProgressOn","featuresTimeupdateEvents","manualTimeUpdatesOn","nativeCaptions","nativeTextTracks","featuresNativeTextTracks","emulateTextTracks","autoRemoteTextTracks_","initTrackListeners","nativeControlsForTouch","triggerSourceset","onDurationChange","manualProgress","trackProgress","manualProgressOff","stopTrackingProgress","progressInterval","numBufferedPercent","bufferedPercent_","duration_","bufferedPercent$$1","manualTimeUpdates","trackCurrentTime","stopTrackingCurrentTime","manualTimeUpdatesOff","currentTimeInterval","manuallyTriggered","clearTracks","removeRemoteTextTrack","cleanupAutoTextTracks","reset","error_","played","setCurrentTime","trackListChanges","addWebVttScript_","_this5","script","_this6","remoteTracks","remoteTextTracks","handleAddTrack","handleRemoveTrack","updateDisplay","textTracksChanges","addTextTrack","createRemoteTextTrack","_this7","manualCleanup","htmlTrackElement","remoteTextTrackEls","getVideoPlaybackQuality","setPoster","playsinline","setPlaysinline","overrideNativeAudioTracks","overrideNativeVideoTracks","canPlayType","canPlaySource","srcObj","registerTech","techs_","defaultTechOrder_","getTech","featuresVolumeControl","featuresFullscreenResize","featuresPlaybackRate","featuresSourceset","withSourceHandlers","_Tech","registerSourceHandler","handler","sourceHandlers","can","selectSourceHandler","canHandleSource","sh","deferrable","originalFn","sourceHandler_","setSource","nativeSourceHandler","disposeSourceHandler","currentSource_","handleSource","middlewares","middlewareInstances","TERMINATOR","use","middleware","next","setSourceHelper","setTech","mw","get$1","reduceRight","middlewareIterator","set$1","mediate","callMethod","middlewareValue","terminated","executeRight","allowedGetters","seekable","allowedSetters","allowedMediators","mws","clearCacheForPlayer","getOrCreateFactory","mwFactory","_mws$i","mwf","mwi","lastRun","mwrest","_src","MimetypesKind","opus","ogv","mp4","mov","m4v","mkv","mp3","aac","oga","m3u8","getMimetype","ext","mimetype","findMimetype","cache_","matchingSources","filterSource","newsrc","srcobj","fixSource","MediaLoader","j","techOrder","techName","isSupported","loadTech_","ClickableComponent","tabIndex_","createControlTextEl","controlTextEl_","controlText_","localizedText","nonIconControl","enabled_","handleClick","handleFocus","handleBlur","PosterImage","_ClickableComponent","update","poster","setSrc","backgroundImage","darkGray","lightGray","fontMap","monospace","sansSerif","serif","monospaceSansSerif","monospaceSerif","proportionalSansSerif","proportionalSerif","casual","smallcaps","constructColor","opacity","tryUpdateStyle","TextTrackDisplay","toggleDisplay","preselectTrack","modes","userPref","selectedLanguage","firstDesc","firstCaptions","preferredTrack","clearDisplay","descriptionsTrack","captionsSubtitlesTrack","updateForTrack","textTrackSettings","overrides","getValues","textOpacity","backgroundOpacity","windowColor","windowOpacity","edgeStyle","textShadow","fontPercent","fontFamily","fontVariant","LoadingSpinner","isAudio","playerType","Button","BigPlayButton","_Button","mouseused_","handleMouseDown","playPromise","cb","playToggle","playFocus","CloseButton","PlayToggle","handlePlay","handlePause","handleEnded","handleSeeked","defaultImplementation","seconds","guide","floor","gm","gh","isNaN","Infinity","implementation","setFormatTime","customImplementation","resetFormatTime","formatTime","TimeDisplay","throttledUpdateContent","updateContent","plainName","labelText_","updateTextNode_","textNode_","formattedTime_","formatTime_","time","updateFormattedTime_","formattedTime","CurrentTimeDisplay","_TimeDisplay","scrubbing","getCache","DurationDisplay","TimeDivider","RemainingTimeDisplay","remainingTimeDisplay","remainingTime","LiveDisplay","updateShowing","Slider","bar","barName","playerEvent","handleMouseMove","handleMouseUp","progress","getPercent","toFixed","calculateDistance","stepBack","stepForward","bool","vertical_","LoadProgressBar","partEls_","bufferedEnd","percentify","part","TimeTooltip","seekBarRect","seekBarPoint","tooltipRect","playerRect","seekBarPointPx","spaceLeftOfPoint","spaceRightOfPoint","pullTooltipBy","PlayProgressBar","rafId_","timeTooltip","MouseTimeDisplay","STEP_SECONDS","UPDATE_REFRESH_INTERVAL","SeekBar","_Slider","setEventHandlers_","updateInterval","update_","getCurrentTime_","videoWasPlaying","newTime","mouseTimeDisplay","handleAction","ProgressControl","throttledHandleMouseSeek","handleMouseSeek","seekBar","seekBarEl","FullscreenToggle","handleFullscreenChange","isFullscreen","requestFullscreen","exitFullscreen","checkVolumeSupport","VolumeLevel","VolumeBar","updateLastVolume_","updateARIAAttributes","checkMuted","volume","muted","ariaValue","volumeAsPercentage_","volumeBeforeDrag","lastVolume_","VolumeControl","volumeBar","throttledHandleMouseMove","orientationClass","MuteToggle","vol","lastVolume","volumeToSet","updateIcon_","updateControlText_","soundOff","VolumePanel","inline","volumeControl","sliderActive_","sliderInactive_","Menu","menuButton_","menuButton","focusedChild_","addItem","unpressButton","contentElType","append","stepChild","item","haveTitle","MenuButton","buttonClass","handleSubmenuKeyPress","menu","createMenu","buttonPressed_","items","hideThreshold_","title","createItems","buildWrapperCSSClass","menuButtonClass","pressButton","TrackButton","_MenuButton","updateHandler","MenuItem","selectable","isSelected_","_selected","TextTrackMenuItem","_MenuItem","changeHandler","handleTracksChange","selectedLanguageChangeHandler","handleSelectedLanguageChange","onchange","Event","createEvent","initEvent","kinds","shouldBeSelected","OffTextTrackMenuItem","_TextTrackMenuItem","allHidden","TextTrackButton","_TrackButton","TrackMenuItem","label_","kinds_","kind_","ChaptersTrackMenuItem","ChaptersButton","_TextTrackButton","track_","setTrack","findChaptersTrack","updateHandler_","remoteTextTrackEl","_remoteTextTrackEl","getMenuCaption","mi","DescriptionsButton","SubtitlesButton","CaptionSettingsMenuItem","CaptionsButton","SubsCapsMenuItem","SubsCapsButton","language_","AudioTrackMenuItem","audioTracks","AudioTrackButton","PlaybackRateMenuItem","rate","playbackRate","PlaybackRateMenuButton","updateVisibility","updateLabel","labelEl_","rates","playbackRates","currentRate","newRate","playbackRateSupported","Spacer","CustomControlSpacer","_Spacer","ControlBar","ErrorDisplay","_ModalDialog","LOCAL_STORAGE_KEY","COLOR_BLACK","COLOR_BLUE","COLOR_CYAN","COLOR_GREEN","COLOR_MAGENTA","COLOR_RED","COLOR_WHITE","COLOR_YELLOW","OPACITY_OPAQUE","OPACITY_SEMI","OPACITY_TRANS","selectConfigs","Number","parseOptionValue","getSelectedOptionValue","selectedIndex","setSelectedOption","TextTrackSettings","endDialog","setDefaults","persistTextTrackSettings","saveSettings","config","restoreSettings","createElSelect_","legendId","selectLabelledbyIds","optionId","createElFgColor_","createElBgColor_","createElWinColor_","createElColors_","createElFont_","createElControls_","defaultsDescription","setValues","localStorage","getItem","setItem","removeItem","ttDisplay","controlBar","subsCapsBtn","subsCapsButton","ccBtn","captionsButton","ResizeManager","RESIZE_OBSERVER_AVAILABLE","ResizeObserver","loadListener_","resizeObserver_","debouncedHandler_","resizeHandler","observe","contentWindow","unobserve","disconnect","resizeObserver","sourcesetLoad","srcUrls","innerHTMLDescriptorPolyfill","cloneNode","dummy","docFrag","createDocumentFragment","Element","getDescriptor","priority","descriptor","getOwnPropertyDescriptor","getInnerHTMLDescriptor","HTMLMediaElement","firstSourceWatch","resetSourceWatch_","innerDescriptor","appendWrapper","appendFn","retval","srcDescriptorPolyfill","getSrcDescriptor","setupSourceset","resetSourceset_","srcDescriptor","oldSetAttribute","oldLoad","currentSrc","_templateObject$1","Html5","crossoriginTracks","initNetworkState_","handleLateInit_","enableSourceset","setupSourcesetHandling_","hasChildNodes","nodes","nodesLength","removeNodes","proxyNativeTracks_","restoreMetadataTracksInIOSNativePlayer_","setControls","proxyWebkitFullscreen_","disposeMediaElement","metadataTracksPreFullscreenState","takeMetadataTrackSnapshot","storedMode","restoreTrackMode","storedTrack","overrideNative_","override","lowerCaseType","eventName","elTracks","proxyNativeTracksForType_","techTracks","listeners","currentTarget","removeOldTracks","removeTracks","found","playerElIngest","movingMediaElementInDOM","clone","tagAttributes","techId","class","playerId","preload","settingsAttrs","attr","networkState","loadstartFired","setLoadstartFired","triggerLoadstart","eventsToTrigger","checkProgress","NaN","endFn","beginFn","webkitPresentationMode","supportsFullScreen","webkitEnterFullScreen","enterFullScreen","HAVE_METADATA","exitFullScreen","webkitExitFullScreen","resetMediaElement","videoPlaybackQuality","webkitDroppedFrameCount","webkitDecodedFrameCount","droppedVideoFrames","totalVideoFrames","performance","creationTime","timing","navigationStart","TEST_VID","canControlVolume","canControlPlaybackRate","canOverrideAttributes","supportsNativeTextTracks","supportsNativeVideoTracks","videoTracks","supportsNativeAudioTracks","featuresNativeVideoTracks","featuresNativeAudioTracks","mpegurlRE","patchCanPlayType","unpatchCanPlayType","r","_templateObject$2","TECH_EVENTS_RETRIGGER","TECH_EVENTS_QUEUE","canplay","canplaythrough","playing","seeked","getTagSettings","closest","isPosterFromTech_","queuedCallbacks_","userActive_","languagesToLower","name$$1","languages_","poster_","controls_","scrubbing_","lastPlaybackRate","defaultPlaybackRate","playerOptionsCopy","plugins","middleware_","flexNotSupported_","majorVersion","userActive","listenForUserActivity_","handleFullscreenChange_","handleStageClick_","changingSrc_","playWaitingForReady_","playOnLoadstart_","styleEl_","playerElIngest_","divEmbed","VIDEOJS_NO_DYNAMIC_STYLE","defaultsStyleEl","head","fluid","aspectRatio","links","linkEl","_dimension","privDimension","updateStyleEl_","parsedVal","fluid_","ratio","aspectRatio_","width_","_height","height_","techEl","idClass","videoWidth","videoHeight","ratioParts","ratioMultiplier","unloadTech_","titleTechName","camelTechName","techName_","techOptions","autoplay","loop","techCanOverridePoster","TechClass","handleTechReady_","textTracksJson_","eventObj","seeking","handleTechLoadStart_","handleTechSourceset_","handleTechWaiting_","handleTechEnded_","handleTechSeeking_","handleTechPlay_","handleTechFirstPlay_","handleTechPause_","handleTechDurationChange_","handleTechFullscreenChange_","handleTechError_","handleTechPosterChange_","handleTechTextData_","handleTechRateChange_","usingNativeControls","techGet_","addTechControlsListeners_","safety","removeTechControlsListeners_","handleTechClick_","handleTechTouchStart_","handleTechTouchMove_","handleTechTouchEnd_","handleTechTap_","techCall_","hasStarted","updateSourceCaches_","sourceElSources","sourceEls","matchingSourceEls","sourceObj","updateCache","request","queued","handleTechCanPlay_","handleTechCanPlayThrough_","handleTechPlaying_","handleTechSeeked_","starttime","userWasActive","isScrubbing","percentAsDecimal","_muted","defaultMuted","_defaultMuted","isFS","isFullscreen_","fsApi","fullscreenchange","documentFullscreenChange","fullscreenElement","enterFullWindow","exitFullWindow","isFullWindow","docOrigOverflow","overflow","fullWindowOnEscKey","selectSource","techs","_ref","findFirstPassingTechSourcePair","outerArray","innerArray","tester","outerChoice","innerChoice","foundSourceAndTech","flip","finder","_ref2","sourceOrder","_this8","notSupportedMessage","middlewareSource","src_","_this9","sourceTech","currentSources","currentSource","currentType","newPoster","usingNativeControls_","errorDisplay","userActivity_","mouseInProgress","lastMoveX","lastMoveY","handleActivity","screenX","screenY","inactivityTimeout","isAudio_","_ref3","_ref3$track","String","toJSON","createModal","_this10","modal","baseOptions","tagOptions","dataSetup","_safeParseTuple","childName","html5","flash","userLanguage","BASE_PLUGIN_NAME","PLUGIN_CACHE_KEY","pluginStorage","pluginExists","getPlugin","markPluginAsActive","triggerSetupEvent","before","createBasicPlugin","plugin","basicPluginWrapper","createPluginFactory","PluginSubClass","Function","getEventHash","Plugin","VERSION","isBasic","registerPlugin","deregisterPlugin","getPlugins","getPluginVersion","usingPlugin","hasPlugin","_inherits","super_","extendFn","subClassMethods","methods","normalizeId","videojs$1","getPlayer","hooks","hookFunction","PlayerComponent","hooks_","hook","hookOnce","original","removeHook","style$1","getPlayers","nId","_tag","_player","getAllPlayers","comp","writeable","addLanguage","_mergeOptions","createTimeRange","dom","urlToolkit","root","URL_REGEX","FIRST_SEGMENT_REGEX","SLASH_DOT_REGEX","SLASH_DOT_DOT_REGEX","URLToolkit","buildAbsoluteURL","baseURL","relativeURL","alwaysNormalize","basePartsForNormalise","parseURL","normalizePath","buildURLFromParts","relativeParts","scheme","baseParts","netLoc","builtParts","query","fragment","baseURLPath","newPath","substring","lastIndexOf","parts","classCallCheck$1","classCallCheck$$1","_extends$1","inherits$1","inherits$$1","possibleConstructorReturn$1","possibleConstructorReturn$$1","Stream","callbacks","pipe","destination","LineStream","_Stream","nextNewline","attributeSeparator","keyvalue","parseAttributes","ParseStream","customParsers","tagType","number","playlistType","offset","allowed","URI","BYTERANGE","_attributes$BYTERANGE","byterange","RESOLUTION","resolution","BANDWIDTH","dateTimeString","dateTimeObject","IV","Uint32Array","PRECISE","addParser","expression","customType","dataParser","segment","lineStream","parseStream","uris","currentUri","currentMap","defaultMediaGroups","currentTimeline","manifest","allowCache","discontinuityStarts","segments","entry","mediaGroup","rendition","endlist","endList","inf","mediaSequence","discontinuitySequence","METHOD","iv","isFinite","playlist","streamInf","playlists","mediaGroups","media","TYPE","NAME","mediaGroupType","autoselect","AUTOSELECT","LANGUAGE","instreamId","CHARACTERISTICS","characteristics","FORCED","forced","discontinuity","programDateTime","targetduration","targetDuration","totalduration","totalDuration","timeOffset","precise","cueOut","cueOutCont","cueIn","timeline","comment","custom","chunk","formatAudioPlaylist","_attributes","bandwidth","CODECS","codecs","periodIndex","resolvedUri","contentProtection","formatVttPlaylist","_attributes2","baseUrl","sourceDuration","organizeAudioPlaylists","organizeVttPlaylists","formatVideoPlaylist","_attributes3","AUDIO","SUBTITLES","toM3u8","dashPlaylists","_mediaGroups","_dashPlaylists$0$attr","_dashPlaylists$0$attr2","minimumUpdatePeriod","videoOnly","_ref4","mimeType","contentType","audioOnly","_ref5","vttOnly","_ref6","videoPlaylists","audioPlaylists","vttPlaylists","master","VIDEO","subs","isObject$1","merge","objects","resolveUrl","relativeUrl","urlTypeToSegment","_ref7","_ref7$baseUrl","_ref7$source","_ref7$range","range","init","startRange","endRange","getLiveRValue","NOW","clientOffset","availabilityStartTime","_attributes$timescale","timescale","_attributes$start","_attributes$minimumUp","periodStartWC","periodEndWC","periodDuration","parseByTimeline","segmentTimeline","_attributes$type","_attributes$minimumUp2","_attributes$media","_attributes$timescale2","_attributes$startNumb","startNumber","sIndex","S","d","repeat","segmentTime","nextS","flatten","lists","segmentRange","static","_static","_attributes$timescale3","dynamic","_attributes$timescale4","_attributes$start2","_attributes$minimumUp3","_attributes$timeShift","timeShiftBufferDepth","segmentCount","availableStart","availableEnd","toSegments","_attributes$timescale5","_attributes$startNumb2","parseByDuration","_attributes$type2","_attributes$timescale6","_segmentRange$type","identifierPattern","identifierReplacement","identifier","format","constructTemplateUrl","parseTemplateInfo","segmentsFromTemplate","templateValues","RepresentationID","Bandwidth","_attributes$initializ","initialization","sourceURL","mapSegment","Time","INVALID_NUMBER_OF_PERIOD","DASH_EMPTY_MANIFEST","DASH_INVALID_XML","NO_BASE_URL","MISSING_SEGMENT_INFORMATION","SEGMENT_TIME_UNSPECIFIED","UNSUPPORTED_UTC_TIMING_SCHEME","SegmentURLToSegmentObject","segmentUrl","_attributes$initializ2","initSegment","mediaRange","segmentsFromList","_attributes$segmentUr","segmentUrls","segmentUrlMap","segmentUrlObject","segmentTimeInfo","segmentsFromBase","_attributes$initializ3","_attributes$timescale7","_attributes$indexRang","indexRange","generateSegments","_ref8","segmentInfo","segmentAttributes","segmentsFn","template","base","_segmentAttributes","_segmentAttributes$ti","toPlaylists","representations","findChildren","_ref9","getContent","parseDuration","SECONDS_IN_YEAR","SECONDS_IN_MONTH","SECONDS_IN_DAY","SECONDS_IN_HOUR","SECONDS_IN_MIN","durationRegex","_match$slice","year","month","day","hour","minute","second","parseDate","dateRegex","parsers","mediaPresentationDuration","parsedValue","parseAttributes$1","parseFn","decodeB64ToUint8Array","b64Text","decodedString","atob","Uint8Array","keySystemsMap","buildBaseUrls","referenceUrls","baseUrlElements","baseUrlElement","getSegmentInformation","adaptationSet","segmentTemplate","segmentList","segmentBase","segmentTimelineParentNode","segmentInitializationParentNode","segmentInitialization","inheritBaseUrls","adaptationSetAttributes","adaptationSetBaseUrls","adaptationSetSegmentInfo","representation","repBaseUrlElements","repBaseUrls","representationSegmentInfo","generateKeySystemInformation","contentProtectionNodes","keySystem","schemeIdUri","psshNode","pssh","psshBuffer","toRepresentations","periodAttributes","periodBaseUrls","periodSegmentInfo","roleAttributes","toAdaptationSets","mpdAttributes","mpdBaseUrls","period","periodAtt","adaptationSets","inheritAttributes","mpd","_options$manifestUri","manifestUri","_options$NOW","_options$clientOffset","periods","stringToMpdXml","manifestString","DOMParser","xml","parseFromString","parseUTCTimingScheme","UTCTimingNode","parseUTCTiming","toUnsigned","bin","bin_1","bin$1","require$$0$1","toUnsigned$1","_findBox","parseType","findBox","results","subresults","byteLength","subarray","fromCharCode","traks","trak","tkhd","mdhd","trafs","baseTimes","traf","tfhd","scale","baseTime","tfdt","pow","probe","streamTypes","H264_STREAM_TYPE","ADTS_STREAM_TYPE","METADATA_STREAM_TYPE","streamTypes_1","streamTypes_2","streamTypes_3","streamTypes$1","Stream$1","flushSource","stream$1","Stream$2","MAX_TS","RO_THRESH","handleRollover","TimestampRolloverStream","lastDTS","referenceDTS","type_","dts","pts","timestampRolloverStream","timestampRolloverStream_1","timestampRolloverStream_2","timestampRolloverStream$1","StreamTypes","parsePid","packet","pid","parsePayloadUnitStartIndicator","parseAdaptionField","parseType$1","pmtPid","parsePat","pusi","parsePmt","programMapTable","payloadOffset","sectionLength","tableEnd","programInfoLength","parsePesType","parsePesTime","pes","ptsDtsFlags","parseNalUnitType","videoPacketContainsKeyFrame","frameBuffer","frameI","frameSyncPoint","foundKeyFrame","nalType","probe$1","probe_1$1","probe_2$1","probe_3$1","probe_4","probe_5","probe_6","probe_7","probe$2","ADTS_SAMPLING_FREQUENCIES","parseSyncSafeInteger","percentEncode","bytes","parseIso88591","parseId3TagSize","header","byteIndex","returnSize","flags","footerPresent","parseAdtsSize","lowThree","highTwo","parseType$2","parseSampleRate","parseAacTimestamp","frameStart","frameSize","frame","frameHeader","owner","probe$3","probe_1$2","probe_2$2","probe_3$2","probe_4$1","probe_5$1","probe$4","require$$0$2","require$$1$1","require$$2$1","handleRollover$1","probe$5","PES_TIMESCALE","MP2T_PACKET_LENGTH","SYNC_BYTE","isLikelyAacData","parsePsi_","pmt","startIndex","endIndex","table","parseAudioPes_","pesType","parsed","endLoop","parseVideoPes_","currentFrame","firstKeyFrame","adjustTimestamp_","baseTimestamp","audioBaseTimestamp","dtsTime","ptsTime","videoBaseTimestamp","inspectAac_","audioCount","sampleRate","timestamp","audioTimescale","inspectTs_","inspect","isAacData","tsInspector","unpad","padded","classCallCheck$2","createClass$1","protoProps","staticProps","inherits$2","possibleConstructorReturn$2","precompute","tables","encTable","decTable","sbox","sboxInv","xInv","th","x2","x4","x8","tEnc","tDec","aesTables","AES","_tables","tmp","encKey","decKey","keyLen","rcon","decrypt","encrypted0","encrypted1","encrypted2","encrypted3","out","a2","c2","nInnerRounds","kIndex","table0","table1","table2","table3","Stream$3","_length","AsyncStream","jobs","delay","timeout_","processJob_","job","ntoh","word","encrypted","initVector","encrypted32","Int32Array","byteOffset","decipher","decrypted","decrypted32","init0","init1","init2","init3","wordIx","Decrypter","done","STEP","asyncStream_","decryptChunk_","resolveUrl$1","mergeOptions$1","EventTarget$1","log$2","forEachMediaGroup","mediaType","groupKey","labelKey","mediaProperties","updateSegments","resolveSegmentUris","baseUri","updateMaster","mergedPlaylist","setupMediaPlaylists","resolveMediaGroupUris","refreshDelay","lastSegment","PlaylistLoader","srcUrl","hls","hls_","req","playlistRequestError","haveMetadata","startingState","media_","mediaUpdateTimeout","stopRequest","oldRequest","mediaChange","started","isFinalRendition","backwardDuration","endSequence","forwardDuration","intervalDuration","expired","backward","forward","sumDurations","durations","_i2","safeLiveIndex","distanceFromEnd","safeDistance","playlistEnd","useSafeLiveEnd","seekableStart","seekableEnd","isWholeNumber","roundSignificantDigit","increment","numDecimalDigits","ceilLeastSignificantDigit","floorLeastSignificantDigit","getMediaInfoForTime","numSegments","mediaIndex","isBlacklisted","excludeUntil","isIncompatible","isEnabled","blacklisted","isDisabled","isAes","isFmp4","estimateSegmentRequestTime","segmentDuration","bytesReceived","isLowestEnabledRendition","currentBandwidth","MAX_VALUE","Playlist","videojsXHR","mergeOptions$1$1","xhrFactory","XhrFunction","beforeRequest","Hls","newOptions","reqResponse","responseTime","roundTripTime","requestTime","responseHeaders","timedout","originalAbort","textRange","formatHexString","formatAsciiString","createTransferableMessage","transferable","ArrayBuffer","isView","initSegmentId","hexDump","hex","ascii","tagDump","textRanges","utils","TIME_FUDGE_FACTOR","SAFE_TIME_DELTA","filterRanges","timeRanges","findRange","findNextRange","findGaps","printableRange","strArr","timeUntilRebuffer","timeRangesToArray","timeRangesList","createTextTracksIfNecessary","sourceBuffer","mediaSource","inbandTextTracks_","trackId","captionStreams","metadataTrack_","inBandMetadataTrackDispatchType","dispatchType","removeCuesFromTrack","deprecateOldCue","privateData","durationOfVideo","dur","addTextTrackData","sourceHandler","captionArray","metadataArray","Cue","WebKitDataCue","caption","timestampOffset","videoDuration","mediaSource_","cueTime","frames","cuesArray","cuesGroupedByStartTime","timeSlot","sortedStartTimes","sort","idx","cueGroup","nextTime","win$1","TARGET","SCRIPT_TYPE","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","URL","webkitURL","msURL","Worker","shimWorker","filename","ShimWorker","forceFallback","objURL","createSourceObject","wrapTerminate","selfShim","postMessage","onmessage","isThisThread","testWorker","testArray","revokeObjectURL","terminate","createObjectURL","Blob","blob","getBlob","worker","term","TransmuxWorker","document$$1","transmuxerWorker","window_1$$1","UINT32_MAX","dinf","esds","ftyp","mdat","mfhd","minf","moof","moov","mvex","mvhd","mdia","hdlr","sdtp","stbl","stsd","trex","trun","MAJOR_BRAND","MINOR_VERSION","AVC1_BRAND","VIDEO_HDLR","AUDIO_HDLR","HDLR_TYPES","VMHD","SMHD","DREF","STCO","STSC","STSZ","STTS","avc1","avcC","btrt","dref","mp4a","smhd","stco","stsc","stsz","stts","styp","vmhd","payload","view","DataView","setUint32","audioobjecttype","samplingfrequencyindex","channelcount","samplerate","sequenceNumber","trackFragments","samples","dependsOn","isDependedOn","hasRedundancy","videoSample","audioSample","sps","pps","sequenceParameterSets","pictureParameterSets","profileIdc","profileCompatibility","levelIdc","samplesize","trackFragmentHeader","trackFragmentDecodeTime","trackFragmentRun","sampleDependencyTable","dataOffset","upperWordBaseMediaDecodeTime","lowerWordBaseMediaDecodeTime","baseMediaDecodeTime","audioTrun","videoTrun","trunHeader","durationPresent","sizePresent","flagsPresent","compositionTimeOffset","sample","isLeading","paddingValue","isNonSyncSample","degradationPriority","mp4Generator","fileType","movie","USER_DATA_REGISTERED_ITU_T_T35","RBSP_TRAILING_BITS","parseSei","payloadType","payloadSize","parseUserData","sei","parseCaptionPackets","userData","ccData","CaptionStream","captionPackets_","ccStreams_","Cea608Stream","cc","nalUnitType","escapedRBSP","latestDts_","ignoreNextEqualDts_","numSameDts_","presortIndex","dispatchCea608Packet","activeCea608Channel_","ccStream","setsChannel1Active","setsChannel2Active","CHARACTER_TRANSLATION","getCharFromCode","BOTTOM_ROW","ROWS","createDisplayBuffer","field","dataChannel","field_","dataChannel_","setConstants","swap","char0","char1","lastControlCode_","PADDING_","RESUME_CAPTION_LOADING_","mode_","END_OF_CAPTION_","clearFormatting","flushDisplayed","displayed_","nonDisplayed_","startPts_","ROLL_UP_2_ROWS_","topRow_","ROLL_UP_3_ROWS_","ROLL_UP_4_ROWS_","CARRIAGE_RETURN_","shiftRowsUp_","BACKSPACE_","ERASE_DISPLAYED_MEMORY_","ERASE_NON_DISPLAYED_MEMORY_","RESUME_DIRECT_CAPTIONING_","isSpecialCharacter","column_","isExtCharacter","row_","isMidRowCode","addFormatting","isOffsetControlCode","isPAC","formatting_","isColorPAC","isNormalChar","startPts","endPts","BASE_","EXT_","CONTROL_","OFFSET_","char","popOn","baseRow","rollUp","paintOn","captionStream","parseUtf8","tagParsers","TXXX","WXXX","PRIV","_MetadataStream","MetadataStream","tagSize","bufferSize","dataAlignmentIndicator","timeStamp","metadataStream","TimestampRolloverStream$1","_TransportPacketStream","_TransportParseStream","_ElementaryStream","TransportPacketStream","bytesInBuffer","everything","TransportParseStream","parsePsi","packetsWaitingForPmt","psi","payloadUnitStartIndicator","pat","section_number","last_section_number","streamType","processPes_","STREAM_TYPES","h264","adts","ElementaryStream","timedMetadata","parsePes","packetLength","flushStream","stream$$1","forceFlush","packetData","packetFlushable","timelineStartInfo","codec","m2ts","PAT_PID","m2ts_1","_AdtsStream","AdtsStream","frameNum","frameLength","protectionSkipBytes","frameEnd","oldBuffer","sampleCount","adtsFrameDuration","ExpGolomb","workingData","workingBytesAvailable","workingWord","workingBitsAvailable","bitsAvailable","loadWord","workingBytes","availableBytes","getUint32","skipBits","skipBytes","readBits","bits","valu","skipLeadingZeros","leadingZeroCount","skipUnsignedExpGolomb","skipExpGolomb","readUnsignedExpGolomb","clz","readExpGolomb","readBoolean","readUnsignedByte","expGolomb","_H264Stream","_NalByteStream","PROFILES_WITH_OPTIONAL_SPS_DATA","NalByteStream","syncPoint","swapBuffer","H264Stream","nalByteStream","currentPts","currentDts","discardEmulationPreventionBytes","readSequenceParameterSet","skipScalingList","expGolombDecoder","lastScale","nextScale","deltaScale","emulationPreventionBytesPositions","newLength","newData","sourceIndex","frameCropLeftOffset","frameCropRightOffset","frameCropTopOffset","frameCropBottomOffset","sarScale","chromaFormatIdc","picOrderCntType","numRefFramesInPicOrderCntCycle","picWidthInMbsMinus1","picHeightInMapUnitsMinus1","frameMbsOnlyFlag","scalingListCount","sarRatio","aspectRatioIdc","_AacStream","AacStream","setTimestamp","bytesLeft","tempLength","highPrefix","lowPrefix","zeroFill","makeTable","metaTable","arr","coneOfSilence","silence","ONE_SECOND_IN_TS","secondsToVideoTs","secondsToAudioTs","videoTsToSeconds","audioTsToSeconds","audioTsToVideoTs","videoTsToAudioTs","clock","AUDIO_PROPERTIES","VIDEO_PROPERTIES","ONE_SECOND_IN_TS$1","_VideoSegmentStream","_AudioSegmentStream","_Transmuxer","_CoalesceStream","createDefaultSample","collectDtsInfo","clearDtsInfo","calculateTrackBaseMediaDecodeTime","arrayEquals","sumFrameByteLengths","currentObj","sum","AudioSegmentStream","adtsFrames","earliestAllowedDts","audioAppendStartTs","videoBaseMediaDecodeTime","setEarliestDts","earliestDts","setVideoBaseMediaDecodeTime","setAudioAppendStart","trimAdtsFramesByEarliestDts_","keepOriginalTimestamps","prefixWithSilence_","generateSampleTable_","concatenateFrameData_","baseMediaDecodeTimeTs","frameDuration","audioGapDuration","audioFillFrameCount","audioFillDuration","silentFrame","minSegmentDts","minSegmentPts","VideoSegmentStream","nalUnits","gopsToAlignWith","minPTS","gopCache_","nalUnit","gopForFusion","gops","resetStream_","groupNalsIntoFrames_","groupFramesIntoGops_","keyFrame","getGopForFusion_","nalCount","extendFirstKeyFrame_","alignedGops","alignGopsAtEnd","alignGopsAtEnd_","alignGopsAtStart_","gop","concatenateNalData_","halfSecond","allowableOverlap","nearestDistance","dtsDistance","nearestGopObj","currentGop","currentGopObj","currentNal","baseDataOffset","nalsByteLength","numberOfNals","totalByteLength","alignIndex","gopIndex","alignEndIndex","matchFound","trimIndex","total","alignGopsWith","newGopsToAlignWith","maxSegmentPts","maxSegmentDts","CoalesceStream","numberOfTracks","remux","remuxTracks","pendingTracks","videoTrack","pendingBoxes","pendingCaptions","pendingMetadata","pendingBytes","emittedTracks","output","audioTrack","id3","timelineStartPts","Transmuxer","hasFlushed","transmuxPipeline_","setupAacPipeline","pipeline","aacStream","audioTimestampRolloverStream","timedMetadataTimestampRolloverStream","adtsStream","coalesceStream","headOfPipeline","audioSegmentStream","setupTsPipeline","packetStream","elementaryStream","videoTimestampRolloverStream","h264Stream","videoSegmentStream","setBaseMediaDecodeTime","isAac","resetCaptions","transmuxer","generator","createClass$$1","wireTransmuxerEvents","initArray","typedArray","action","gopInfo","MessageHandlers","setTimestampOffset","appendStart","TransmuxerWorker","messageHandlers","isAudioCodec","isVideoCodec","parseContentType","parameters","parameter","pair","translateLegacyCodecs","orig","profile","avcLevel","profileHex","avcLevelHex","makeWrappedSourceBuffer","addSourceBuffer","updating","realBuffer_","gopsSafeToAlignWith","mapping","currentTimePts","updateGopBuffer","removeGopBuffer","updatedBuffer","VirtualSourceBuffer","_videojs$EventTarget","timestampOffset_","pendingBuffers_","bufferUpdating_","codecs_","audioCodec_","videoCodec_","audioDisabled_","appendAudioInitSegment_","gopBuffer_","timeMapping_","safeAppend_","transmuxer_","data_","done_","appendGopInfo_","videoBuffer_","audioBuffer_","appendWindowStart","arity","extents","videoBuffered","audioBuffered","processPendingSegments_","createRealSourceBuffers_","codecProperty","nativeMediaSource_","shouldTrigger","appendBuffer","sortedSegments","segmentObj","triggerUpdateend","concatAndAppendSegments_","destinationBuffer","tempBuffer","originalError","HtmlMediaSource","_videojs$EventTarget2","property","MediaSource","activeSourceBuffers_","sourceBuffers","updateActiveSourceBuffers_","disableCombined","disableAudioOnly","onPlayerMediachange_","onHlsReset_","onHlsSegmentTimeMapping_","url_","sourcebuffer","addSeekableRange_","parsedType","urlCount","mediaSources","msObjectURL","swfId","supportsNativeMediaSources","isTypeSupported","URL$1","objectUrlPrefix","EventTarget$1$1","mergeOptions$2","updateMaster$1","oldMaster","newMaster","playlistUpdate","group","_playlistUpdate","DashPlaylistLoader","_EventTarget$","srcUrlOrPlaylist","masterPlaylistLoader","refreshXml_","refreshMedia_","masterPlaylistLoader_","parseMasterXml","masterXml_","clientOffset_","phonyUri","_phonyUri","_this11","date","masterLoaded_","syncClientServerClock_","onClientServerClockSync_","_this12","utcTiming","serverTime","_this13","_this14","_this15","updatedMaster","logger","noop$1","SourceUpdater","sourceBufferEmitter","callbacks_","pendingCallback_","processedAppend_","mimeType_","logger_","createSourceBuffer_","_this16","sourceBuffer_","start_","_this17","started_","onUpdateendCallback_","pendingCallback","runCallback_","_this18","queueCallback_","_this19","_this20","_this21","Config","GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BANDWIDTH_VARIANCE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","REQUEST_ERRORS","FAILURE","TIMEOUT","ABORTED","byterangeStr","byterangeStart","byterangeEnd","segmentXhrHeaders","Range","abortAll","activeXhrs","getRequestStats","getProgressStats","progressEvent","stats","loaded","handleErrors","handleKeyResponse","finishProcessingFn","errorObj","handleInitSegmentResponse","handleSegmentResponse","encryptedBytes","decryptSegment","decrypter","doneFn","decryptionHandler","requestId","getMostImportantError","prev","waitForCompletion","endOfAllRequests","worstError","handleProgress","progressFn","firstBytesReceivedAt","mediaSegmentRequest","xhrOptions","decryptionWorker","keyRequestOptions","keyRequestCallback","keyXhr","initSegmentOptions","initSegmentRequestCallback","initSegmentXhr","segmentRequestOptions","segmentRequestCallback","segmentXhr","defaultCodecs","videoCodec","videoObjectTypeIndicator","audioProfile","parseCodecs","codecCount","mapLegacyAvcCodecs","codecString","makeMimeTypeString","getContainerType","getCodecs","mediaAttributes","audioProfileFromDefault","audioGroupId","audioGroup","audioType","mimeTypesForPlaylist","containerType","codecInfo","isMuxed","isMaat","groupId","codecStrings","justAudio","justVideo","bothVideoAudio","safeGetComputedStyle","stableSort","sortFn","newArray","cmp","comparePlaylistBandwidth","leftBandwidth","rightBandwidth","comparePlaylistResolution","leftWidth","rightWidth","simpleSelector","playerBandwidth","playerWidth","playerHeight","sortedPlaylistReps","rep","enabledPlaylistReps","bandwidthPlaylistReps","highestRemainingBandwidthRep","bandwidthBestRep","haveResolution","resolutionBestRepList","resolutionBestRep","resolutionPlusOneList","resolutionPlusOneSmallest","resolutionPlusOneRep","chosenRep","lastBandwidthSelector","systemBandwidth","minRebufferMaxBandwidthSelector","duration$$1","syncController","compatiblePlaylists","enabledPlaylists","bandwidthPlaylists","rebufferingEstimates","getSyncPoint","numRequests","requestTimeEstimate","rebufferingImpact","noRebufferingPlaylists","estimate","lowestBitrateCompatibleVariantSelector","playlistsWithVideo","CHECK_BUFFER_DELAY","detectEndOfStream","segmentIndex","appendedLastSegment","finite","illegalMediaSwitch","loaderType","startingMedia","newSegmentMedia","containsAudio","containsVideo","safeBackBufferTrimTime","seekable$$1","removeToTime","segmentInfoString","_segmentInfo$segment","_segmentInfo$playlist","seq","_segmentInfo$playlist2","SegmentLoader","_videojs$EventTarget3","_this22","throughput","roundTrip","resetStats_","hasPlayed_","hasPlayed","currentTime_","seekable_","seeking_","loaderType_","startingMedia_","segmentMetadataTrack_","segmentMetadataTrack","goalBufferLength_","goalBufferLength","sourceType_","sourceType","state_","checkBufferTimeout_","currentTimeline_","pendingSegment_","sourceUpdater_","xhrOptions_","activeInitSegmentId_","initSegments_","decrypter_","syncController_","syncPoint_","ended_","fetchAtBuffer_","newState","mediaBytesTransferred","mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaSecondsLoaded","abort_","monitorBuffer_","abortRequests","_error","endOfStream","buffered_","storedMap","couldBeginLoading_","playlist_","setDateTimeMapping","init_","sourceBufferEmitter_","resetEverything","newPlaylist","oldPlaylist","syncInfo","oldId","resyncLoader","mediaSequenceDiff","saveExpiredSegmentInfo","_mimeType","resetLoader","monitorBufferTick_","fillBuffer_","checkBuffer_","isEndOfStream","startOfSegment","loadSegment_","lastBufferedEnd","bufferedTime","getSyncSegmentCandidate_","generateSegmentInfo_","mediaSourceInfo","_mediaSourceInfo","_this23","segmentIndexArray","isSyncRequest","random","abortRequestEarly_","measuredBandwidth","requestTimeRemaining","timeUntilRebuffer$$1","switchCandidate","timeSavedBySwitching","minimumTimeSaving","handleProgress_","simpleSegment","trimBackBuffer_","createSimplifiedSegmentObj_","segmentRequestFinished_","processSegmentResponse_","handleSegment_","_this24","timingInfo","probeSegmentInfo","illegalMediaSwitchError","blacklistDuration","timelineMapping","mappingForTimeline","initId","handleUpdateEnd_","isWalkingForward","recordThroughput_","addSegmentMetadataCue_","segmentProcessingTime","segmentProcessingThroughput","VTT_LINE_TERMINATORS","uintToString","uintArray","VTTSegmentLoader","_SegmentLoader","_this25","subtitlesTrack_","combinedByteLength","combinedSegment","_track","_this26","skipEmptySegments_","timestampOffsetForTimeline","checkTimestampOffset","_this27","requested","parseVTTCues_","updateTimeMapping_","timelines","decodeBytesToString","timestampmap","MPEGTS","LOCAL","mapData","segmentData","mappingObj","diff","firstStart","lastStart","findAdCue","mediaTime","adStartTime","adEndTime","updateAdCues","adOffset","adTotal","_segment$cueOutCont$s","tsprobe","syncPointStrategies","run","datetimeToDisplayTime","lastDistance","segmentStart","distance","discontinuitySync","discontinuities","SyncController","_videojs$EventTarget4","_this28","inspectCache_","syncPoints","runStrategies_","selectSyncPoint_","getExpiredTime","strategy","bestSyncPoint","bestDistance","bestStrategy","newDistance","lastRemovedSegment","playlistTimestamp","probeMp4Segment_","probeTsSegment_","calculateSegmentTimeMapping_","saveDiscontinuitySyncInfo_","timescales","timeInfo","segmentStartTime","segmentEndTime","accuracy","mediaIndexDiff","Decrypter$1","decrypterWorker","decrypt$$1","AsyncStream$$1","Decrypter$$1","DecrypterWorker","audioTrackKind_","stopLoaders","segmentLoader","activePlaylistLoader","startLoaders","playlistLoader","onGroupChanged","_settings$segmentLoad","segmentLoaders","mainSegmentLoader","mediaTypes","activeTrack","activeGroup","previousActiveLoader","onTrackChanged","_settings$segmentLoad2","onError","blacklistCurrentPlaylist","defaultTrack","setupListeners","requestOptions","byGroupId","byResolvedUri","initialize","_settings$master","_settings$mediaTypes$","groupPlaylists","variantLabel","matchingPlaylists","_settings$mediaTypes$2","CLOSEDCAPTIONS","_settings$mediaTypes$3","variants","setupMediaGroups","onAudioTrackChanged","createMediaTypes","ABORT_EARLY_BLACKLIST_SECONDS","loaderStats","sumLoaderStat","stat","audioSegmentLoader_","mainSegmentLoader_","MasterPlaylistController","_videojs$EventTarget5","_this29","externHls","useCueTags","enableLowInitialPlaylist","useCueTags_","cueTagsTrack_","requestOptions_","mediaTypes_","handleSourceOpen_","segmentLoaderSettings","setupMasterPlaylistLoaderListeners_","subtitleSegmentLoader_","setupSegmentLoaderListeners_","_this30","requestTimeout","triggerPresenceUsage_","setupSourceBuffers_","setupFirstPlay","updatedPlaylist","excludeUnsupportedVariants_","selectedMedia","selectInitialPlaylist","selectPlaylist","initialMedia_","updateAdCues_","updateDuration","addSeekableRange","onDurationchange","playlistOutdated","stuckAtPlaylistEnd_","defaultDemuxed","audioGroupKeys","_this31","nextPlaylist","currentPlaylist","forwardBuffer","bufferLowWaterLine","onSyncInfoUpdate_","onEndOfStream","mediaSecondsLoaded_","fastQualityChange_","ended","_this32","absolutePlaylistEnd","pauseLoading","mainSeekable","audioSeekable","_this33","oldDuration","newDuration","setDuration","_this34","mimeTypes","configureLoaderMimeTypes_","excludeIncompatibleVariants_","variant","variantCodecs","enableFunction","loader","playlistUri","changePlaylistFn","incompatible","currentlyEnabled","Representation","hlsHandler","fastChangeFunction","masterPlaylistController_","renditionSelectionMixin","timerCancelEvents","PlaybackWatcher","_this35","consecutiveUpdates","lastRecordedTime","timer_","checkCurrentTimeTimeout_","canPlayHandler","monitorCurrentTime_","waitingHandler","techWaiting_","cancelTimerHandler","cancelTimer_","fixesBadSeeksHandler","fixesBadSeeks_","checkCurrentTime_","waiting_","seekTo","afterSeekableWindow_","beforeSeekableWindow_","livePoint","nextRange","videoUnderflow_","difference","skipTheGap_","gap","gapFromVideoUnderflow_","scheduledCurrentTime","gaps","defaultOptions","errorInterval","getSource","IWillNotUseThisInPlugins","initPlugin","lastCalled","localOptions","loadedMetadataHandler","errorHandler","cleanupEvents","reinitPlugin","reloadSourceOnError","version$3","Hls$1","STANDARD_PLAYLIST_SELECTOR","INITIAL_PLAYLIST_SELECTOR","INITIAL_BANDWIDTH","simpleTypeFromSourceType","dashRE","handleHlsMediaChange","qualityLevels","selectedIndex_","handleHlsLoadedMetadata","addQualityLevel","emeKeySystems","keySystemOptions","videoPlaylist","audioPlaylist","keySystemContentTypes","audioContentType","videoContentType","setupEmeOptions","eme","sourceOptions","source_","keySystems","supportsNativeHls","canPlay","canItPlay","supportsNativeDash","supportsTypeNatively","Component$1","HlsHandler","_this36","vhs","dash","ignoreNextSeekingEvent_","setOptions_","overrideNative","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","_this37","option","_this38","playbackWatcher_","invBandwidth","invThroughput","systemBitrate","mediaRequests_","mediaRequestsAborted_","mediaRequestsTimedout_","mediaRequestsErrored_","mediaTransferDuration_","mediaBytesTransferred_","currentTech","playerDimensions","setupQualityLevels_","_this39","qualityLevels_","HlsSourceHandler","_videojs$mergeOptions","supportedType","canUseMsePlayback","myPlayer"],"mappings":"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","file":"videojs.a034e1d7.map","sourceRoot":"..","sourcesContent":["/**\n * @license\n * Video.js 7.0.2 <http://videojs.com/>\n * Copyright Brightcove, Inc. <https://www.brightcove.com/>\n * Available under Apache License Version 2.0\n * <https://github.com/videojs/video.js/blob/master/LICENSE>\n *\n * Includes vtt.js <https://github.com/mozilla/vtt.js>\n * Available under Apache License Version 2.0\n * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.videojs = factory());\n}(this, (function () {\n\n  var version = \"7.0.2\";\n\n  var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n  function createCommonjsModule(fn, module) {\n  \treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n  }\n\n  var win;\n\n  if (typeof window !== \"undefined\") {\n      win = window;\n  } else if (typeof commonjsGlobal !== \"undefined\") {\n      win = commonjsGlobal;\n  } else if (typeof self !== \"undefined\") {\n      win = self;\n  } else {\n      win = {};\n  }\n\n  var window_1 = win;\n\n  var empty = {};\n\n  var empty$1 = /*#__PURE__*/Object.freeze({\n    default: empty\n  });\n\n  var minDoc = ( empty$1 && empty ) || empty$1;\n\n  var topLevel = typeof commonjsGlobal !== 'undefined' ? commonjsGlobal : typeof window !== 'undefined' ? window : {};\n\n  var doccy;\n\n  if (typeof document !== 'undefined') {\n      doccy = document;\n  } else {\n      doccy = topLevel['__GLOBAL_DOCUMENT_CACHE@4'];\n\n      if (!doccy) {\n          doccy = topLevel['__GLOBAL_DOCUMENT_CACHE@4'] = minDoc;\n      }\n  }\n\n  var document_1 = doccy;\n\n  /**\n   * @file log.js\n   * @module log\n   */\n\n  var log = void 0;\n\n  // This is the private tracking variable for logging level.\n  var level = 'info';\n\n  // This is the private tracking variable for the logging history.\n  var history = [];\n\n  /**\n   * Log messages to the console and history based on the type of message\n   *\n   * @private\n   * @param  {string} type\n   *         The name of the console method to use.\n   *\n   * @param  {Array} args\n   *         The arguments to be passed to the matching console method.\n   */\n  var logByType = function logByType(type, args) {\n    var lvl = log.levels[level];\n    var lvlRegExp = new RegExp('^(' + lvl + ')$');\n\n    if (type !== 'log') {\n\n      // Add the type to the front of the message when it's not \"log\".\n      args.unshift(type.toUpperCase() + ':');\n    }\n\n    // Add a clone of the args at this point to history.\n    if (history) {\n      history.push([].concat(args));\n    }\n\n    // Add console prefix after adding to history.\n    args.unshift('VIDEOJS:');\n\n    // If there's no console then don't try to output messages, but they will\n    // still be stored in history.\n    if (!window_1.console) {\n      return;\n    }\n\n    // Was setting these once outside of this function, but containing them\n    // in the function makes it easier to test cases where console doesn't exist\n    // when the module is executed.\n    var fn = window_1.console[type];\n\n    if (!fn && type === 'debug') {\n      // Certain browsers don't have support for console.debug. For those, we\n      // should default to the closest comparable log.\n      fn = window_1.console.info || window_1.console.log;\n    }\n\n    // Bail out if there's no console or if this type is not allowed by the\n    // current logging level.\n    if (!fn || !lvl || !lvlRegExp.test(type)) {\n      return;\n    }\n\n    fn[Array.isArray(args) ? 'apply' : 'call'](window_1.console, args);\n  };\n\n  /**\n   * Logs plain debug messages. Similar to `console.log`.\n   *\n   * @class\n   * @param    {Mixed[]} args\n   *           One or more messages or objects that should be logged.\n   */\n  log = function log() {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    logByType('log', args);\n  };\n\n  /**\n   * Enumeration of available logging levels, where the keys are the level names\n   * and the values are `|`-separated strings containing logging methods allowed\n   * in that logging level. These strings are used to create a regular expression\n   * matching the function name being called.\n   *\n   * Levels provided by video.js are:\n   *\n   * - `off`: Matches no calls. Any value that can be cast to `false` will have\n   *   this effect. The most restrictive.\n   * - `all`: Matches only Video.js-provided functions (`debug`, `log`,\n   *   `log.warn`, and `log.error`).\n   * - `debug`: Matches `log.debug`, `log`, `log.warn`, and `log.error` calls.\n   * - `info` (default): Matches `log`, `log.warn`, and `log.error` calls.\n   * - `warn`: Matches `log.warn` and `log.error` calls.\n   * - `error`: Matches only `log.error` calls.\n   *\n   * @type {Object}\n   */\n  log.levels = {\n    all: 'debug|log|warn|error',\n    off: '',\n    debug: 'debug|log|warn|error',\n    info: 'log|warn|error',\n    warn: 'warn|error',\n    error: 'error',\n    DEFAULT: level\n  };\n\n  /**\n   * Get or set the current logging level. If a string matching a key from\n   * {@link log.levels} is provided, acts as a setter. Regardless of argument,\n   * returns the current logging level.\n   *\n   * @param  {string} [lvl]\n   *         Pass to set a new logging level.\n   *\n   * @return {string}\n   *         The current logging level.\n   */\n  log.level = function (lvl) {\n    if (typeof lvl === 'string') {\n      if (!log.levels.hasOwnProperty(lvl)) {\n        throw new Error('\"' + lvl + '\" in not a valid log level');\n      }\n      level = lvl;\n    }\n    return level;\n  };\n\n  /**\n   * Returns an array containing everything that has been logged to the history.\n   *\n   * This array is a shallow clone of the internal history record. However, its\n   * contents are _not_ cloned; so, mutating objects inside this array will\n   * mutate them in history.\n   *\n   * @return {Array}\n   */\n  log.history = function () {\n    return history ? [].concat(history) : [];\n  };\n\n  /**\n   * Clears the internal history tracking, but does not prevent further history\n   * tracking.\n   */\n  log.history.clear = function () {\n    if (history) {\n      history.length = 0;\n    }\n  };\n\n  /**\n   * Disable history tracking if it is currently enabled.\n   */\n  log.history.disable = function () {\n    if (history !== null) {\n      history.length = 0;\n      history = null;\n    }\n  };\n\n  /**\n   * Enable history tracking if it is currently disabled.\n   */\n  log.history.enable = function () {\n    if (history === null) {\n      history = [];\n    }\n  };\n\n  /**\n   * Logs error messages. Similar to `console.error`.\n   *\n   * @param {Mixed[]} args\n   *        One or more messages or objects that should be logged as an error\n   */\n  log.error = function () {\n    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    return logByType('error', args);\n  };\n\n  /**\n   * Logs warning messages. Similar to `console.warn`.\n   *\n   * @param {Mixed[]} args\n   *        One or more messages or objects that should be logged as a warning.\n   */\n  log.warn = function () {\n    for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    return logByType('warn', args);\n  };\n\n  /**\n   * Logs debug messages. Similar to `console.debug`, but may also act as a comparable\n   * log if `console.debug` is not available\n   *\n   * @param {Mixed[]} args\n   *        One or more messages or objects that should be logged as debug.\n   */\n  log.debug = function () {\n    for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n\n    return logByType('debug', args);\n  };\n\n  var log$1 = log;\n\n  function clean(s) {\n    return s.replace(/\\n\\r?\\s*/g, '');\n  }\n\n  var tsml = function tsml(sa) {\n    var s = '',\n        i = 0;\n\n    for (; i < arguments.length; i++) {\n      s += clean(sa[i]) + (arguments[i + 1] || '');\n    }return s;\n  };\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  };\n\n  var classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  var inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  var possibleConstructorReturn = function (self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  var taggedTemplateLiteralLoose = function (strings, raw) {\n    strings.raw = raw;\n    return strings;\n  };\n\n  /**\n   * @file obj.js\n   * @module obj\n   */\n\n  /**\n   * @callback obj:EachCallback\n   *\n   * @param {Mixed} value\n   *        The current key for the object that is being iterated over.\n   *\n   * @param {string} key\n   *        The current key-value for object that is being iterated over\n   */\n\n  /**\n   * @callback obj:ReduceCallback\n   *\n   * @param {Mixed} accum\n   *        The value that is accumulating over the reduce loop.\n   *\n   * @param {Mixed} value\n   *        The current key for the object that is being iterated over.\n   *\n   * @param {string} key\n   *        The current key-value for object that is being iterated over\n   *\n   * @return {Mixed}\n   *         The new accumulated value.\n   */\n  var toString = Object.prototype.toString;\n\n  /**\n   * Get the keys of an Object\n   *\n   * @param {Object}\n   *        The Object to get the keys from\n   *\n   * @return {string[]}\n   *         An array of the keys from the object. Returns an empty array if the\n   *         object passed in was invalid or had no keys.\n   *\n   * @private\n   */\n  var keys = function keys(object) {\n    return isObject(object) ? Object.keys(object) : [];\n  };\n\n  /**\n   * Array-like iteration for objects.\n   *\n   * @param {Object} object\n   *        The object to iterate over\n   *\n   * @param {obj:EachCallback} fn\n   *        The callback function which is called for each key in the object.\n   */\n  function each(object, fn) {\n    keys(object).forEach(function (key) {\n      return fn(object[key], key);\n    });\n  }\n\n  /**\n   * Array-like reduce for objects.\n   *\n   * @param {Object} object\n   *        The Object that you want to reduce.\n   *\n   * @param {Function} fn\n   *         A callback function which is called for each key in the object. It\n   *         receives the accumulated value and the per-iteration value and key\n   *         as arguments.\n   *\n   * @param {Mixed} [initial = 0]\n   *        Starting value\n   *\n   * @return {Mixed}\n   *         The final accumulated value.\n   */\n  function reduce(object, fn) {\n    var initial = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n    return keys(object).reduce(function (accum, key) {\n      return fn(accum, object[key], key);\n    }, initial);\n  }\n\n  /**\n   * Object.assign-style object shallow merge/extend.\n   *\n   * @param  {Object} target\n   * @param  {Object} ...sources\n   * @return {Object}\n   */\n  function assign(target) {\n    for (var _len = arguments.length, sources = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      sources[_key - 1] = arguments[_key];\n    }\n\n    if (Object.assign) {\n      return Object.assign.apply(Object, [target].concat(sources));\n    }\n\n    sources.forEach(function (source) {\n      if (!source) {\n        return;\n      }\n\n      each(source, function (value, key) {\n        target[key] = value;\n      });\n    });\n\n    return target;\n  }\n\n  /**\n   * Returns whether a value is an object of any kind - including DOM nodes,\n   * arrays, regular expressions, etc. Not functions, though.\n   *\n   * This avoids the gotcha where using `typeof` on a `null` value\n   * results in `'object'`.\n   *\n   * @param  {Object} value\n   * @return {Boolean}\n   */\n  function isObject(value) {\n    return !!value && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object';\n  }\n\n  /**\n   * Returns whether an object appears to be a \"plain\" object - that is, a\n   * direct instance of `Object`.\n   *\n   * @param  {Object} value\n   * @return {Boolean}\n   */\n  function isPlain(value) {\n    return isObject(value) && toString.call(value) === '[object Object]' && value.constructor === Object;\n  }\n\n  /**\n   * @file computed-style.js\n   * @module computed-style\n   */\n\n  /**\n   * A safe getComputedStyle.\n   *\n   * This is needed because in Firefox, if the player is loaded in an iframe with\n   * `display:none`, then `getComputedStyle` returns `null`, so, we do a null-check to\n   * make sure  that the player doesn't break in these cases.\n   *\n   * @param {Element} el\n   *        The element you want the computed style of\n   *\n   * @param {string} prop\n   *        The property name you want\n   *\n   * @see https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n   *\n   * @static\n   * @const\n   */\n  function computedStyle(el, prop) {\n    if (!el || !prop) {\n      return '';\n    }\n\n    if (typeof window_1.getComputedStyle === 'function') {\n      var cs = window_1.getComputedStyle(el);\n\n      return cs ? cs[prop] : '';\n    }\n\n    return '';\n  }\n\n  var _templateObject = taggedTemplateLiteralLoose(['Setting attributes in the second argument of createEl()\\n                has been deprecated. Use the third argument instead.\\n                createEl(type, properties, attributes). Attempting to set ', ' to ', '.'], ['Setting attributes in the second argument of createEl()\\n                has been deprecated. Use the third argument instead.\\n                createEl(type, properties, attributes). Attempting to set ', ' to ', '.']);\n\n  /**\n   * Detect if a value is a string with any non-whitespace characters.\n   *\n   * @param {string} str\n   *        The string to check\n   *\n   * @return {boolean}\n   *         - True if the string is non-blank\n   *         - False otherwise\n   *\n   */\n  function isNonBlankString(str) {\n    return typeof str === 'string' && /\\S/.test(str);\n  }\n\n  /**\n   * Throws an error if the passed string has whitespace. This is used by\n   * class methods to be relatively consistent with the classList API.\n   *\n   * @param {string} str\n   *         The string to check for whitespace.\n   *\n   * @throws {Error}\n   *         Throws an error if there is whitespace in the string.\n   *\n   */\n  function throwIfWhitespace(str) {\n    if (/\\s/.test(str)) {\n      throw new Error('class has illegal whitespace characters');\n    }\n  }\n\n  /**\n   * Produce a regular expression for matching a className within an elements className.\n   *\n   * @param {string} className\n   *         The className to generate the RegExp for.\n   *\n   * @return {RegExp}\n   *         The RegExp that will check for a specific `className` in an elements\n   *         className.\n   */\n  function classRegExp(className) {\n    return new RegExp('(^|\\\\s)' + className + '($|\\\\s)');\n  }\n\n  /**\n   * Whether the current DOM interface appears to be real.\n   *\n   * @return {Boolean}\n   */\n  function isReal() {\n    // Both document and window will never be undefined thanks to `global`.\n    return document_1 === window_1.document;\n  }\n\n  /**\n   * Determines, via duck typing, whether or not a value is a DOM element.\n   *\n   * @param {Mixed} value\n   *        The thing to check\n   *\n   * @return {boolean}\n   *         - True if it is a DOM element\n   *         - False otherwise\n   */\n  function isEl(value) {\n    return isObject(value) && value.nodeType === 1;\n  }\n\n  /**\n   * Determines if the current DOM is embedded in an iframe.\n   *\n   * @return {boolean}\n   *\n   */\n  function isInFrame() {\n\n    // We need a try/catch here because Safari will throw errors when attempting\n    // to get either `parent` or `self`\n    try {\n      return window_1.parent !== window_1.self;\n    } catch (x) {\n      return true;\n    }\n  }\n\n  /**\n   * Creates functions to query the DOM using a given method.\n   *\n   * @param {string} method\n   *         The method to create the query with.\n   *\n   * @return {Function}\n   *         The query method\n   */\n  function createQuerier(method) {\n    return function (selector, context) {\n      if (!isNonBlankString(selector)) {\n        return document_1[method](null);\n      }\n      if (isNonBlankString(context)) {\n        context = document_1.querySelector(context);\n      }\n\n      var ctx = isEl(context) ? context : document_1;\n\n      return ctx[method] && ctx[method](selector);\n    };\n  }\n\n  /**\n   * Creates an element and applies properties.\n   *\n   * @param {string} [tagName='div']\n   *         Name of tag to be created.\n   *\n   * @param {Object} [properties={}]\n   *         Element properties to be applied.\n   *\n   * @param {Object} [attributes={}]\n   *         Element attributes to be applied.\n   *\n   * @param {String|Element|TextNode|Array|Function} [content]\n   *         Contents for the element (see: {@link dom:normalizeContent})\n   *\n   * @return {Element}\n   *         The element that was created.\n   */\n  function createEl() {\n    var tagName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'div';\n    var properties = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var content = arguments[3];\n\n    var el = document_1.createElement(tagName);\n\n    Object.getOwnPropertyNames(properties).forEach(function (propName) {\n      var val = properties[propName];\n\n      // See #2176\n      // We originally were accepting both properties and attributes in the\n      // same object, but that doesn't work so well.\n      if (propName.indexOf('aria-') !== -1 || propName === 'role' || propName === 'type') {\n        log$1.warn(tsml(_templateObject, propName, val));\n        el.setAttribute(propName, val);\n\n        // Handle textContent since it's not supported everywhere and we have a\n        // method for it.\n      } else if (propName === 'textContent') {\n        textContent(el, val);\n      } else {\n        el[propName] = val;\n      }\n    });\n\n    Object.getOwnPropertyNames(attributes).forEach(function (attrName) {\n      el.setAttribute(attrName, attributes[attrName]);\n    });\n\n    if (content) {\n      appendContent(el, content);\n    }\n\n    return el;\n  }\n\n  /**\n   * Injects text into an element, replacing any existing contents entirely.\n   *\n   * @param {Element} el\n   *        The element to add text content into\n   *\n   * @param {string} text\n   *        The text content to add.\n   *\n   * @return {Element}\n   *         The element with added text content.\n   */\n  function textContent(el, text) {\n    if (typeof el.textContent === 'undefined') {\n      el.innerText = text;\n    } else {\n      el.textContent = text;\n    }\n    return el;\n  }\n\n  /**\n   * Insert an element as the first child node of another\n   *\n   * @param {Element} child\n   *        Element to insert\n   *\n   * @param {Element} parent\n   *        Element to insert child into\n   */\n  function prependTo(child, parent) {\n    if (parent.firstChild) {\n      parent.insertBefore(child, parent.firstChild);\n    } else {\n      parent.appendChild(child);\n    }\n  }\n\n  /**\n   * Check if an element has a CSS class\n   *\n   * @param {Element} element\n   *        Element to check\n   *\n   * @param {string} classToCheck\n   *        Class name to check for\n   *\n   * @return {boolean}\n   *         - True if the element had the class\n   *         - False otherwise.\n   *\n   * @throws {Error}\n   *         Throws an error if `classToCheck` has white space.\n   */\n  function hasClass(element, classToCheck) {\n    throwIfWhitespace(classToCheck);\n    if (element.classList) {\n      return element.classList.contains(classToCheck);\n    }\n    return classRegExp(classToCheck).test(element.className);\n  }\n\n  /**\n   * Add a CSS class name to an element\n   *\n   * @param {Element} element\n   *        Element to add class name to.\n   *\n   * @param {string} classToAdd\n   *        Class name to add.\n   *\n   * @return {Element}\n   *         The dom element with the added class name.\n   */\n  function addClass(element, classToAdd) {\n    if (element.classList) {\n      element.classList.add(classToAdd);\n\n      // Don't need to `throwIfWhitespace` here because `hasElClass` will do it\n      // in the case of classList not being supported.\n    } else if (!hasClass(element, classToAdd)) {\n      element.className = (element.className + ' ' + classToAdd).trim();\n    }\n\n    return element;\n  }\n\n  /**\n   * Remove a CSS class name from an element\n   *\n   * @param {Element} element\n   *        Element to remove a class name from.\n   *\n   * @param {string} classToRemove\n   *        Class name to remove\n   *\n   * @return {Element}\n   *         The dom element with class name removed.\n   */\n  function removeClass(element, classToRemove) {\n    if (element.classList) {\n      element.classList.remove(classToRemove);\n    } else {\n      throwIfWhitespace(classToRemove);\n      element.className = element.className.split(/\\s+/).filter(function (c) {\n        return c !== classToRemove;\n      }).join(' ');\n    }\n\n    return element;\n  }\n\n  /**\n   * The callback definition for toggleElClass.\n   *\n   * @callback Dom~PredicateCallback\n   * @param {Element} element\n   *        The DOM element of the Component.\n   *\n   * @param {string} classToToggle\n   *        The `className` that wants to be toggled\n   *\n   * @return {boolean|undefined}\n   *         - If true the `classToToggle` will get added to `element`.\n   *         - If false the `classToToggle` will get removed from `element`.\n   *         - If undefined this callback will be ignored\n   */\n\n  /**\n   * Adds or removes a CSS class name on an element depending on an optional\n   * condition or the presence/absence of the class name.\n   *\n   * @param {Element} element\n   *        The element to toggle a class name on.\n   *\n   * @param {string} classToToggle\n   *        The class that should be toggled\n   *\n   * @param {boolean|PredicateCallback} [predicate]\n   *        See the return value for {@link Dom~PredicateCallback}\n   *\n   * @return {Element}\n   *         The element with a class that has been toggled.\n   */\n  function toggleClass(element, classToToggle, predicate) {\n\n    // This CANNOT use `classList` internally because IE11 does not support the\n    // second parameter to the `classList.toggle()` method! Which is fine because\n    // `classList` will be used by the add/remove functions.\n    var has = hasClass(element, classToToggle);\n\n    if (typeof predicate === 'function') {\n      predicate = predicate(element, classToToggle);\n    }\n\n    if (typeof predicate !== 'boolean') {\n      predicate = !has;\n    }\n\n    // If the necessary class operation matches the current state of the\n    // element, no action is required.\n    if (predicate === has) {\n      return;\n    }\n\n    if (predicate) {\n      addClass(element, classToToggle);\n    } else {\n      removeClass(element, classToToggle);\n    }\n\n    return element;\n  }\n\n  /**\n   * Apply attributes to an HTML element.\n   *\n   * @param {Element} el\n   *        Element to add attributes to.\n   *\n   * @param {Object} [attributes]\n   *        Attributes to be applied.\n   */\n  function setAttributes(el, attributes) {\n    Object.getOwnPropertyNames(attributes).forEach(function (attrName) {\n      var attrValue = attributes[attrName];\n\n      if (attrValue === null || typeof attrValue === 'undefined' || attrValue === false) {\n        el.removeAttribute(attrName);\n      } else {\n        el.setAttribute(attrName, attrValue === true ? '' : attrValue);\n      }\n    });\n  }\n\n  /**\n   * Get an element's attribute values, as defined on the HTML tag\n   * Attributes are not the same as properties. They're defined on the tag\n   * or with setAttribute (which shouldn't be used with HTML)\n   * This will return true or false for boolean attributes.\n   *\n   * @param {Element} tag\n   *        Element from which to get tag attributes.\n   *\n   * @return {Object}\n   *         All attributes of the element.\n   */\n  function getAttributes(tag) {\n    var obj = {};\n\n    // known boolean attributes\n    // we can check for matching boolean properties, but not all browsers\n    // and not all tags know about these attributes, so, we still want to check them manually\n    var knownBooleans = ',' + 'autoplay,controls,playsinline,loop,muted,default,defaultMuted' + ',';\n\n    if (tag && tag.attributes && tag.attributes.length > 0) {\n      var attrs = tag.attributes;\n\n      for (var i = attrs.length - 1; i >= 0; i--) {\n        var attrName = attrs[i].name;\n        var attrVal = attrs[i].value;\n\n        // check for known booleans\n        // the matching element property will return a value for typeof\n        if (typeof tag[attrName] === 'boolean' || knownBooleans.indexOf(',' + attrName + ',') !== -1) {\n          // the value of an included boolean attribute is typically an empty\n          // string ('') which would equal false if we just check for a false value.\n          // we also don't want support bad code like autoplay='false'\n          attrVal = attrVal !== null ? true : false;\n        }\n\n        obj[attrName] = attrVal;\n      }\n    }\n\n    return obj;\n  }\n\n  /**\n   * Get the value of an element's attribute\n   *\n   * @param {Element} el\n   *        A DOM element\n   *\n   * @param {string} attribute\n   *        Attribute to get the value of\n   *\n   * @return {string}\n   *         value of the attribute\n   */\n  function getAttribute(el, attribute) {\n    return el.getAttribute(attribute);\n  }\n\n  /**\n   * Set the value of an element's attribute\n   *\n   * @param {Element} el\n   *        A DOM element\n   *\n   * @param {string} attribute\n   *        Attribute to set\n   *\n   * @param {string} value\n   *        Value to set the attribute to\n   */\n  function setAttribute(el, attribute, value) {\n    el.setAttribute(attribute, value);\n  }\n\n  /**\n   * Remove an element's attribute\n   *\n   * @param {Element} el\n   *        A DOM element\n   *\n   * @param {string} attribute\n   *        Attribute to remove\n   */\n  function removeAttribute(el, attribute) {\n    el.removeAttribute(attribute);\n  }\n\n  /**\n   * Attempt to block the ability to select text while dragging controls\n   */\n  function blockTextSelection() {\n    document_1.body.focus();\n    document_1.onselectstart = function () {\n      return false;\n    };\n  }\n\n  /**\n   * Turn off text selection blocking\n   */\n  function unblockTextSelection() {\n    document_1.onselectstart = function () {\n      return true;\n    };\n  }\n\n  /**\n   * Identical to the native `getBoundingClientRect` function, but ensures that\n   * the method is supported at all (it is in all browsers we claim to support)\n   * and that the element is in the DOM before continuing.\n   *\n   * This wrapper function also shims properties which are not provided by some\n   * older browsers (namely, IE8).\n   *\n   * Additionally, some browsers do not support adding properties to a\n   * `ClientRect`/`DOMRect` object; so, we shallow-copy it with the standard\n   * properties (except `x` and `y` which are not widely supported). This helps\n   * avoid implementations where keys are non-enumerable.\n   *\n   * @param  {Element} el\n   *         Element whose `ClientRect` we want to calculate.\n   *\n   * @return {Object|undefined}\n   *         Always returns a plain\n   */\n  function getBoundingClientRect(el) {\n    if (el && el.getBoundingClientRect && el.parentNode) {\n      var rect = el.getBoundingClientRect();\n      var result = {};\n\n      ['bottom', 'height', 'left', 'right', 'top', 'width'].forEach(function (k) {\n        if (rect[k] !== undefined) {\n          result[k] = rect[k];\n        }\n      });\n\n      if (!result.height) {\n        result.height = parseFloat(computedStyle(el, 'height'));\n      }\n\n      if (!result.width) {\n        result.width = parseFloat(computedStyle(el, 'width'));\n      }\n\n      return result;\n    }\n  }\n\n  /**\n   * The postion of a DOM element on the page.\n   *\n   * @typedef {Object} module:dom~Position\n   *\n   * @property {number} left\n   *           Pixels to the left\n   *\n   * @property {number} top\n   *           Pixels on top\n   */\n\n  /**\n   * Offset Left.\n   * getBoundingClientRect technique from\n   * John Resig\n   *\n   * @see http://ejohn.org/blog/getboundingclientrect-is-awesome/\n   *\n   * @param {Element} el\n   *        Element from which to get offset\n   *\n   * @return {module:dom~Position}\n   *         The position of the element that was passed in.\n   */\n  function findPosition(el) {\n    var box = void 0;\n\n    if (el.getBoundingClientRect && el.parentNode) {\n      box = el.getBoundingClientRect();\n    }\n\n    if (!box) {\n      return {\n        left: 0,\n        top: 0\n      };\n    }\n\n    var docEl = document_1.documentElement;\n    var body = document_1.body;\n\n    var clientLeft = docEl.clientLeft || body.clientLeft || 0;\n    var scrollLeft = window_1.pageXOffset || body.scrollLeft;\n    var left = box.left + scrollLeft - clientLeft;\n\n    var clientTop = docEl.clientTop || body.clientTop || 0;\n    var scrollTop = window_1.pageYOffset || body.scrollTop;\n    var top = box.top + scrollTop - clientTop;\n\n    // Android sometimes returns slightly off decimal values, so need to round\n    return {\n      left: Math.round(left),\n      top: Math.round(top)\n    };\n  }\n\n  /**\n   * x and y coordinates for a dom element or mouse pointer\n   *\n   * @typedef {Object} Dom~Coordinates\n   *\n   * @property {number} x\n   *           x coordinate in pixels\n   *\n   * @property {number} y\n   *           y coordinate in pixels\n   */\n\n  /**\n   * Get pointer position in element\n   * Returns an object with x and y coordinates.\n   * The base on the coordinates are the bottom left of the element.\n   *\n   * @param {Element} el\n   *        Element on which to get the pointer position on\n   *\n   * @param {EventTarget~Event} event\n   *        Event object\n   *\n   * @return {Dom~Coordinates}\n   *         A Coordinates object corresponding to the mouse position.\n   *\n   */\n  function getPointerPosition(el, event) {\n    var position = {};\n    var box = findPosition(el);\n    var boxW = el.offsetWidth;\n    var boxH = el.offsetHeight;\n\n    var boxY = box.top;\n    var boxX = box.left;\n    var pageY = event.pageY;\n    var pageX = event.pageX;\n\n    if (event.changedTouches) {\n      pageX = event.changedTouches[0].pageX;\n      pageY = event.changedTouches[0].pageY;\n    }\n\n    position.y = Math.max(0, Math.min(1, (boxY - pageY + boxH) / boxH));\n    position.x = Math.max(0, Math.min(1, (pageX - boxX) / boxW));\n\n    return position;\n  }\n\n  /**\n   * Determines, via duck typing, whether or not a value is a text node.\n   *\n   * @param {Mixed} value\n   *        Check if this value is a text node.\n   *\n   * @return {boolean}\n   *         - True if it is a text node\n   *         - False otherwise\n   */\n  function isTextNode(value) {\n    return isObject(value) && value.nodeType === 3;\n  }\n\n  /**\n   * Empties the contents of an element.\n   *\n   * @param {Element} el\n   *        The element to empty children from\n   *\n   * @return {Element}\n   *         The element with no children\n   */\n  function emptyEl(el) {\n    while (el.firstChild) {\n      el.removeChild(el.firstChild);\n    }\n    return el;\n  }\n\n  /**\n   * Normalizes content for eventual insertion into the DOM.\n   *\n   * This allows a wide range of content definition methods, but protects\n   * from falling into the trap of simply writing to `innerHTML`, which is\n   * an XSS concern.\n   *\n   * The content for an element can be passed in multiple types and\n   * combinations, whose behavior is as follows:\n   *\n   * @param {String|Element|TextNode|Array|Function} content\n   *        - String: Normalized into a text node.\n   *        - Element/TextNode: Passed through.\n   *        - Array: A one-dimensional array of strings, elements, nodes, or functions\n   *          (which return single strings, elements, or nodes).\n   *        - Function: If the sole argument, is expected to produce a string, element,\n   *          node, or array as defined above.\n   *\n   * @return {Array}\n   *         All of the content that was passed in normalized.\n   */\n  function normalizeContent(content) {\n\n    // First, invoke content if it is a function. If it produces an array,\n    // that needs to happen before normalization.\n    if (typeof content === 'function') {\n      content = content();\n    }\n\n    // Next up, normalize to an array, so one or many items can be normalized,\n    // filtered, and returned.\n    return (Array.isArray(content) ? content : [content]).map(function (value) {\n\n      // First, invoke value if it is a function to produce a new value,\n      // which will be subsequently normalized to a Node of some kind.\n      if (typeof value === 'function') {\n        value = value();\n      }\n\n      if (isEl(value) || isTextNode(value)) {\n        return value;\n      }\n\n      if (typeof value === 'string' && /\\S/.test(value)) {\n        return document_1.createTextNode(value);\n      }\n    }).filter(function (value) {\n      return value;\n    });\n  }\n\n  /**\n   * Normalizes and appends content to an element.\n   *\n   * @param {Element} el\n   *        Element to append normalized content to.\n   *\n   *\n   * @param {String|Element|TextNode|Array|Function} content\n   *        See the `content` argument of {@link dom:normalizeContent}\n   *\n   * @return {Element}\n   *         The element with appended normalized content.\n   */\n  function appendContent(el, content) {\n    normalizeContent(content).forEach(function (node) {\n      return el.appendChild(node);\n    });\n    return el;\n  }\n\n  /**\n   * Normalizes and inserts content into an element; this is identical to\n   * `appendContent()`, except it empties the element first.\n   *\n   * @param {Element} el\n   *        Element to insert normalized content into.\n   *\n   * @param {String|Element|TextNode|Array|Function} content\n   *        See the `content` argument of {@link dom:normalizeContent}\n   *\n   * @return {Element}\n   *         The element with inserted normalized content.\n   *\n   */\n  function insertContent(el, content) {\n    return appendContent(emptyEl(el), content);\n  }\n\n  /**\n   * Check if event was a single left click\n   *\n   * @param {EventTarget~Event} event\n   *        Event object\n   *\n   * @return {boolean}\n   *         - True if a left click\n   *         - False if not a left click\n   */\n  function isSingleLeftClick(event) {\n    // Note: if you create something draggable, be sure to\n    // call it on both `mousedown` and `mousemove` event,\n    // otherwise `mousedown` should be enough for a button\n\n    if (event.button === undefined && event.buttons === undefined) {\n      // Why do we need `buttons` ?\n      // Because, middle mouse sometimes have this:\n      // e.button === 0 and e.buttons === 4\n      // Furthermore, we want to prevent combination click, something like\n      // HOLD middlemouse then left click, that would be\n      // e.button === 0, e.buttons === 5\n      // just `button` is not gonna work\n\n      // Alright, then what this block does ?\n      // this is for chrome `simulate mobile devices`\n      // I want to support this as well\n\n      return true;\n    }\n\n    if (event.button === 0 && event.buttons === undefined) {\n      // Touch screen, sometimes on some specific device, `buttons`\n      // doesn't have anything (safari on ios, blackberry...)\n\n      return true;\n    }\n\n    if (event.button !== 0 || event.buttons !== 1) {\n      // This is the reason we have those if else block above\n      // if any special case we can catch and let it slide\n      // we do it above, when get to here, this definitely\n      // is-not-left-click\n\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Finds a single DOM element matching `selector` within the optional\n   * `context` of another DOM element (defaulting to `document`).\n   *\n   * @param {string} selector\n   *        A valid CSS selector, which will be passed to `querySelector`.\n   *\n   * @param {Element|String} [context=document]\n   *        A DOM element within which to query. Can also be a selector\n   *        string in which case the first matching element will be used\n   *        as context. If missing (or no element matches selector), falls\n   *        back to `document`.\n   *\n   * @return {Element|null}\n   *         The element that was found or null.\n   */\n  var $ = createQuerier('querySelector');\n\n  /**\n   * Finds a all DOM elements matching `selector` within the optional\n   * `context` of another DOM element (defaulting to `document`).\n   *\n   * @param {string} selector\n   *           A valid CSS selector, which will be passed to `querySelectorAll`.\n   *\n   * @param {Element|String} [context=document]\n   *           A DOM element within which to query. Can also be a selector\n   *           string in which case the first matching element will be used\n   *           as context. If missing (or no element matches selector), falls\n   *           back to `document`.\n   *\n   * @return {NodeList}\n   *         A element list of elements that were found. Will be empty if none were found.\n   *\n   */\n  var $$ = createQuerier('querySelectorAll');\n\n  var Dom = /*#__PURE__*/Object.freeze({\n    isReal: isReal,\n    isEl: isEl,\n    isInFrame: isInFrame,\n    createEl: createEl,\n    textContent: textContent,\n    prependTo: prependTo,\n    hasClass: hasClass,\n    addClass: addClass,\n    removeClass: removeClass,\n    toggleClass: toggleClass,\n    setAttributes: setAttributes,\n    getAttributes: getAttributes,\n    getAttribute: getAttribute,\n    setAttribute: setAttribute,\n    removeAttribute: removeAttribute,\n    blockTextSelection: blockTextSelection,\n    unblockTextSelection: unblockTextSelection,\n    getBoundingClientRect: getBoundingClientRect,\n    findPosition: findPosition,\n    getPointerPosition: getPointerPosition,\n    isTextNode: isTextNode,\n    emptyEl: emptyEl,\n    normalizeContent: normalizeContent,\n    appendContent: appendContent,\n    insertContent: insertContent,\n    isSingleLeftClick: isSingleLeftClick,\n    $: $,\n    $$: $$\n  });\n\n  /**\n   * @file guid.js\n   * @module guid\n   */\n\n  /**\n   * Unique ID for an element or function\n   * @type {Number}\n   */\n  var _guid = 1;\n\n  /**\n   * Get a unique auto-incrementing ID by number that has not been returned before.\n   *\n   * @return {number}\n   *         A new unique ID.\n   */\n  function newGUID() {\n    return _guid++;\n  }\n\n  /**\n   * @file dom-data.js\n   * @module dom-data\n   */\n\n  /**\n   * Element Data Store.\n   *\n   * Allows for binding data to an element without putting it directly on the\n   * element. Ex. Event listeners are stored here.\n   * (also from jsninja.com, slightly modified and updated for closure compiler)\n   *\n   * @type {Object}\n   * @private\n   */\n  var elData = {};\n\n  /*\n   * Unique attribute name to store an element's guid in\n   *\n   * @type {String}\n   * @constant\n   * @private\n   */\n  var elIdAttr = 'vdata' + new Date().getTime();\n\n  /**\n   * Returns the cache object where data for an element is stored\n   *\n   * @param {Element} el\n   *        Element to store data for.\n   *\n   * @return {Object}\n   *         The cache object for that el that was passed in.\n   */\n  function getData(el) {\n    var id = el[elIdAttr];\n\n    if (!id) {\n      id = el[elIdAttr] = newGUID();\n    }\n\n    if (!elData[id]) {\n      elData[id] = {};\n    }\n\n    return elData[id];\n  }\n\n  /**\n   * Returns whether or not an element has cached data\n   *\n   * @param {Element} el\n   *        Check if this element has cached data.\n   *\n   * @return {boolean}\n   *         - True if the DOM element has cached data.\n   *         - False otherwise.\n   */\n  function hasData(el) {\n    var id = el[elIdAttr];\n\n    if (!id) {\n      return false;\n    }\n\n    return !!Object.getOwnPropertyNames(elData[id]).length;\n  }\n\n  /**\n   * Delete data for the element from the cache and the guid attr from getElementById\n   *\n   * @param {Element} el\n   *        Remove cached data for this element.\n   */\n  function removeData(el) {\n    var id = el[elIdAttr];\n\n    if (!id) {\n      return;\n    }\n\n    // Remove all stored data\n    delete elData[id];\n\n    // Remove the elIdAttr property from the DOM node\n    try {\n      delete el[elIdAttr];\n    } catch (e) {\n      if (el.removeAttribute) {\n        el.removeAttribute(elIdAttr);\n      } else {\n        // IE doesn't appear to support removeAttribute on the document element\n        el[elIdAttr] = null;\n      }\n    }\n  }\n\n  /**\n   * @file events.js. An Event System (John Resig - Secrets of a JS Ninja http://jsninja.com/)\n   * (Original book version wasn't completely usable, so fixed some things and made Closure Compiler compatible)\n   * This should work very similarly to jQuery's events, however it's based off the book version which isn't as\n   * robust as jquery's, so there's probably some differences.\n   *\n   * @module events\n   */\n\n  /**\n   * Clean up the listener cache and dispatchers\n   *\n   * @param {Element|Object} elem\n   *        Element to clean up\n   *\n   * @param {string} type\n   *        Type of event to clean up\n   */\n  function _cleanUpEvents(elem, type) {\n    var data = getData(elem);\n\n    // Remove the events of a particular type if there are none left\n    if (data.handlers[type].length === 0) {\n      delete data.handlers[type];\n      // data.handlers[type] = null;\n      // Setting to null was causing an error with data.handlers\n\n      // Remove the meta-handler from the element\n      if (elem.removeEventListener) {\n        elem.removeEventListener(type, data.dispatcher, false);\n      } else if (elem.detachEvent) {\n        elem.detachEvent('on' + type, data.dispatcher);\n      }\n    }\n\n    // Remove the events object if there are no types left\n    if (Object.getOwnPropertyNames(data.handlers).length <= 0) {\n      delete data.handlers;\n      delete data.dispatcher;\n      delete data.disabled;\n    }\n\n    // Finally remove the element data if there is no data left\n    if (Object.getOwnPropertyNames(data).length === 0) {\n      removeData(elem);\n    }\n  }\n\n  /**\n   * Loops through an array of event types and calls the requested method for each type.\n   *\n   * @param {Function} fn\n   *        The event method we want to use.\n   *\n   * @param {Element|Object} elem\n   *        Element or object to bind listeners to\n   *\n   * @param {string} type\n   *        Type of event to bind to.\n   *\n   * @param {EventTarget~EventListener} callback\n   *        Event listener.\n   */\n  function _handleMultipleEvents(fn, elem, types, callback) {\n    types.forEach(function (type) {\n      // Call the event method for each one of the types\n      fn(elem, type, callback);\n    });\n  }\n\n  /**\n   * Fix a native event to have standard property values\n   *\n   * @param {Object} event\n   *        Event object to fix.\n   *\n   * @return {Object}\n   *         Fixed event object.\n   */\n  function fixEvent(event) {\n\n    function returnTrue() {\n      return true;\n    }\n\n    function returnFalse() {\n      return false;\n    }\n\n    // Test if fixing up is needed\n    // Used to check if !event.stopPropagation instead of isPropagationStopped\n    // But native events return true for stopPropagation, but don't have\n    // other expected methods like isPropagationStopped. Seems to be a problem\n    // with the Javascript Ninja code. So we're just overriding all events now.\n    if (!event || !event.isPropagationStopped) {\n      var old = event || window_1.event;\n\n      event = {};\n      // Clone the old object so that we can modify the values event = {};\n      // IE8 Doesn't like when you mess with native event properties\n      // Firefox returns false for event.hasOwnProperty('type') and other props\n      //  which makes copying more difficult.\n      // TODO: Probably best to create a whitelist of event props\n      for (var key in old) {\n        // Safari 6.0.3 warns you if you try to copy deprecated layerX/Y\n        // Chrome warns you if you try to copy deprecated keyboardEvent.keyLocation\n        // and webkitMovementX/Y\n        if (key !== 'layerX' && key !== 'layerY' && key !== 'keyLocation' && key !== 'webkitMovementX' && key !== 'webkitMovementY') {\n          // Chrome 32+ warns if you try to copy deprecated returnValue, but\n          // we still want to if preventDefault isn't supported (IE8).\n          if (!(key === 'returnValue' && old.preventDefault)) {\n            event[key] = old[key];\n          }\n        }\n      }\n\n      // The event occurred on this element\n      if (!event.target) {\n        event.target = event.srcElement || document_1;\n      }\n\n      // Handle which other element the event is related to\n      if (!event.relatedTarget) {\n        event.relatedTarget = event.fromElement === event.target ? event.toElement : event.fromElement;\n      }\n\n      // Stop the default browser action\n      event.preventDefault = function () {\n        if (old.preventDefault) {\n          old.preventDefault();\n        }\n        event.returnValue = false;\n        old.returnValue = false;\n        event.defaultPrevented = true;\n      };\n\n      event.defaultPrevented = false;\n\n      // Stop the event from bubbling\n      event.stopPropagation = function () {\n        if (old.stopPropagation) {\n          old.stopPropagation();\n        }\n        event.cancelBubble = true;\n        old.cancelBubble = true;\n        event.isPropagationStopped = returnTrue;\n      };\n\n      event.isPropagationStopped = returnFalse;\n\n      // Stop the event from bubbling and executing other handlers\n      event.stopImmediatePropagation = function () {\n        if (old.stopImmediatePropagation) {\n          old.stopImmediatePropagation();\n        }\n        event.isImmediatePropagationStopped = returnTrue;\n        event.stopPropagation();\n      };\n\n      event.isImmediatePropagationStopped = returnFalse;\n\n      // Handle mouse position\n      if (event.clientX !== null && event.clientX !== undefined) {\n        var doc = document_1.documentElement;\n        var body = document_1.body;\n\n        event.pageX = event.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n        event.pageY = event.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n      }\n\n      // Handle key presses\n      event.which = event.charCode || event.keyCode;\n\n      // Fix button for mouse clicks:\n      // 0 == left; 1 == middle; 2 == right\n      if (event.button !== null && event.button !== undefined) {\n\n        // The following is disabled because it does not pass videojs-standard\n        // and... yikes.\n        /* eslint-disable */\n        event.button = event.button & 1 ? 0 : event.button & 4 ? 1 : event.button & 2 ? 2 : 0;\n        /* eslint-enable */\n      }\n    }\n\n    // Returns fixed-up instance\n    return event;\n  }\n\n  /**\n   * Whether passive event listeners are supported\n   */\n  var _supportsPassive = false;\n\n  (function () {\n    try {\n      var opts = Object.defineProperty({}, 'passive', {\n        get: function get() {\n          _supportsPassive = true;\n        }\n      });\n\n      window_1.addEventListener('test', null, opts);\n      window_1.removeEventListener('test', null, opts);\n    } catch (e) {\n      // disregard\n    }\n  })();\n\n  /**\n   * Touch events Chrome expects to be passive\n   */\n  var passiveEvents = ['touchstart', 'touchmove'];\n\n  /**\n   * Add an event listener to element\n   * It stores the handler function in a separate cache object\n   * and adds a generic handler to the element's event,\n   * along with a unique id (guid) to the element.\n   *\n   * @param {Element|Object} elem\n   *        Element or object to bind listeners to\n   *\n   * @param {string|string[]} type\n   *        Type of event to bind to.\n   *\n   * @param {EventTarget~EventListener} fn\n   *        Event listener.\n   */\n  function on(elem, type, fn) {\n    if (Array.isArray(type)) {\n      return _handleMultipleEvents(on, elem, type, fn);\n    }\n\n    var data = getData(elem);\n\n    // We need a place to store all our handler data\n    if (!data.handlers) {\n      data.handlers = {};\n    }\n\n    if (!data.handlers[type]) {\n      data.handlers[type] = [];\n    }\n\n    if (!fn.guid) {\n      fn.guid = newGUID();\n    }\n\n    data.handlers[type].push(fn);\n\n    if (!data.dispatcher) {\n      data.disabled = false;\n\n      data.dispatcher = function (event, hash) {\n\n        if (data.disabled) {\n          return;\n        }\n\n        event = fixEvent(event);\n\n        var handlers = data.handlers[event.type];\n\n        if (handlers) {\n          // Copy handlers so if handlers are added/removed during the process it doesn't throw everything off.\n          var handlersCopy = handlers.slice(0);\n\n          for (var m = 0, n = handlersCopy.length; m < n; m++) {\n            if (event.isImmediatePropagationStopped()) {\n              break;\n            } else {\n              try {\n                handlersCopy[m].call(elem, event, hash);\n              } catch (e) {\n                log$1.error(e);\n              }\n            }\n          }\n        }\n      };\n    }\n\n    if (data.handlers[type].length === 1) {\n      if (elem.addEventListener) {\n        var options = false;\n\n        if (_supportsPassive && passiveEvents.indexOf(type) > -1) {\n          options = { passive: true };\n        }\n        elem.addEventListener(type, data.dispatcher, options);\n      } else if (elem.attachEvent) {\n        elem.attachEvent('on' + type, data.dispatcher);\n      }\n    }\n  }\n\n  /**\n   * Removes event listeners from an element\n   *\n   * @param {Element|Object} elem\n   *        Object to remove listeners from.\n   *\n   * @param {string|string[]} [type]\n   *        Type of listener to remove. Don't include to remove all events from element.\n   *\n   * @param {EventTarget~EventListener} [fn]\n   *        Specific listener to remove. Don't include to remove listeners for an event\n   *        type.\n   */\n  function off(elem, type, fn) {\n    // Don't want to add a cache object through getElData if not needed\n    if (!hasData(elem)) {\n      return;\n    }\n\n    var data = getData(elem);\n\n    // If no events exist, nothing to unbind\n    if (!data.handlers) {\n      return;\n    }\n\n    if (Array.isArray(type)) {\n      return _handleMultipleEvents(off, elem, type, fn);\n    }\n\n    // Utility function\n    var removeType = function removeType(el, t) {\n      data.handlers[t] = [];\n      _cleanUpEvents(el, t);\n    };\n\n    // Are we removing all bound events?\n    if (type === undefined) {\n      for (var t in data.handlers) {\n        if (Object.prototype.hasOwnProperty.call(data.handlers || {}, t)) {\n          removeType(elem, t);\n        }\n      }\n      return;\n    }\n\n    var handlers = data.handlers[type];\n\n    // If no handlers exist, nothing to unbind\n    if (!handlers) {\n      return;\n    }\n\n    // If no listener was provided, remove all listeners for type\n    if (!fn) {\n      removeType(elem, type);\n      return;\n    }\n\n    // We're only removing a single handler\n    if (fn.guid) {\n      for (var n = 0; n < handlers.length; n++) {\n        if (handlers[n].guid === fn.guid) {\n          handlers.splice(n--, 1);\n        }\n      }\n    }\n\n    _cleanUpEvents(elem, type);\n  }\n\n  /**\n   * Trigger an event for an element\n   *\n   * @param {Element|Object} elem\n   *        Element to trigger an event on\n   *\n   * @param {EventTarget~Event|string} event\n   *        A string (the type) or an event object with a type attribute\n   *\n   * @param {Object} [hash]\n   *        data hash to pass along with the event\n   *\n   * @return {boolean|undefined}\n   *         - Returns the opposite of `defaultPrevented` if default was prevented\n   *         - Otherwise returns undefined\n   */\n  function trigger(elem, event, hash) {\n    // Fetches element data and a reference to the parent (for bubbling).\n    // Don't want to add a data object to cache for every parent,\n    // so checking hasElData first.\n    var elemData = hasData(elem) ? getData(elem) : {};\n    var parent = elem.parentNode || elem.ownerDocument;\n    // type = event.type || event,\n    // handler;\n\n    // If an event name was passed as a string, creates an event out of it\n    if (typeof event === 'string') {\n      event = { type: event, target: elem };\n    } else if (!event.target) {\n      event.target = elem;\n    }\n\n    // Normalizes the event properties.\n    event = fixEvent(event);\n\n    // If the passed element has a dispatcher, executes the established handlers.\n    if (elemData.dispatcher) {\n      elemData.dispatcher.call(elem, event, hash);\n    }\n\n    // Unless explicitly stopped or the event does not bubble (e.g. media events)\n    // recursively calls this function to bubble the event up the DOM.\n    if (parent && !event.isPropagationStopped() && event.bubbles === true) {\n      trigger.call(null, parent, event, hash);\n\n      // If at the top of the DOM, triggers the default action unless disabled.\n    } else if (!parent && !event.defaultPrevented) {\n      var targetData = getData(event.target);\n\n      // Checks if the target has a default action for this event.\n      if (event.target[event.type]) {\n        // Temporarily disables event dispatching on the target as we have already executed the handler.\n        targetData.disabled = true;\n        // Executes the default action.\n        if (typeof event.target[event.type] === 'function') {\n          event.target[event.type]();\n        }\n        // Re-enables event dispatching.\n        targetData.disabled = false;\n      }\n    }\n\n    // Inform the triggerer if the default was prevented by returning false\n    return !event.defaultPrevented;\n  }\n\n  /**\n   * Trigger a listener only once for an event\n   *\n   * @param {Element|Object} elem\n   *        Element or object to bind to.\n   *\n   * @param {string|string[]} type\n   *        Name/type of event\n   *\n   * @param {Event~EventListener} fn\n   *        Event Listener function\n   */\n  function one(elem, type, fn) {\n    if (Array.isArray(type)) {\n      return _handleMultipleEvents(one, elem, type, fn);\n    }\n    var func = function func() {\n      off(elem, type, func);\n      fn.apply(this, arguments);\n    };\n\n    // copy the guid to the new function so it can removed using the original function's ID\n    func.guid = fn.guid = fn.guid || newGUID();\n    on(elem, type, func);\n  }\n\n  var Events = /*#__PURE__*/Object.freeze({\n    fixEvent: fixEvent,\n    on: on,\n    off: off,\n    trigger: trigger,\n    one: one\n  });\n\n  /**\n   * @file setup.js - Functions for setting up a player without\n   * user interaction based on the data-setup `attribute` of the video tag.\n   *\n   * @module setup\n   */\n\n  var _windowLoaded = false;\n  var videojs = void 0;\n\n  /**\n   * Set up any tags that have a data-setup `attribute` when the player is started.\n   */\n  var autoSetup = function autoSetup() {\n\n    // Protect against breakage in non-browser environments and check global autoSetup option.\n    if (!isReal() || videojs.options.autoSetup === false) {\n      return;\n    }\n\n    var vids = Array.prototype.slice.call(document_1.getElementsByTagName('video'));\n    var audios = Array.prototype.slice.call(document_1.getElementsByTagName('audio'));\n    var divs = Array.prototype.slice.call(document_1.getElementsByTagName('video-js'));\n    var mediaEls = vids.concat(audios, divs);\n\n    // Check if any media elements exist\n    if (mediaEls && mediaEls.length > 0) {\n\n      for (var i = 0, e = mediaEls.length; i < e; i++) {\n        var mediaEl = mediaEls[i];\n\n        // Check if element exists, has getAttribute func.\n        if (mediaEl && mediaEl.getAttribute) {\n\n          // Make sure this player hasn't already been set up.\n          if (mediaEl.player === undefined) {\n            var options = mediaEl.getAttribute('data-setup');\n\n            // Check if data-setup attr exists.\n            // We only auto-setup if they've added the data-setup attr.\n            if (options !== null) {\n              // Create new video.js instance.\n              videojs(mediaEl);\n            }\n          }\n\n          // If getAttribute isn't defined, we need to wait for the DOM.\n        } else {\n          autoSetupTimeout(1);\n          break;\n        }\n      }\n\n      // No videos were found, so keep looping unless page is finished loading.\n    } else if (!_windowLoaded) {\n      autoSetupTimeout(1);\n    }\n  };\n\n  /**\n   * Wait until the page is loaded before running autoSetup. This will be called in\n   * autoSetup if `hasLoaded` returns false.\n   *\n   * @param {number} wait\n   *        How long to wait in ms\n   *\n   * @param {module:videojs} [vjs]\n   *        The videojs library function\n   */\n  function autoSetupTimeout(wait, vjs) {\n    if (vjs) {\n      videojs = vjs;\n    }\n\n    window_1.setTimeout(autoSetup, wait);\n  }\n\n  if (isReal() && document_1.readyState === 'complete') {\n    _windowLoaded = true;\n  } else {\n    /**\n     * Listen for the load event on window, and set _windowLoaded to true.\n     *\n     * @listens load\n     */\n    one(window_1, 'load', function () {\n      _windowLoaded = true;\n    });\n  }\n\n  /**\n   * @file stylesheet.js\n   * @module stylesheet\n   */\n\n  /**\n   * Create a DOM syle element given a className for it.\n   *\n   * @param {string} className\n   *        The className to add to the created style element.\n   *\n   * @return {Element}\n   *         The element that was created.\n   */\n  var createStyleElement = function createStyleElement(className) {\n    var style = document_1.createElement('style');\n\n    style.className = className;\n\n    return style;\n  };\n\n  /**\n   * Add text to a DOM element.\n   *\n   * @param {Element} el\n   *        The Element to add text content to.\n   *\n   * @param {string} content\n   *        The text to add to the element.\n   */\n  var setTextContent = function setTextContent(el, content) {\n    if (el.styleSheet) {\n      el.styleSheet.cssText = content;\n    } else {\n      el.textContent = content;\n    }\n  };\n\n  /**\n   * @file fn.js\n   * @module fn\n   */\n\n  /**\n   * Bind (a.k.a proxy or Context). A simple method for changing the context of a function\n   * It also stores a unique id on the function so it can be easily removed from events.\n   *\n   * @param {Mixed} context\n   *        The object to bind as scope.\n   *\n   * @param {Function} fn\n   *        The function to be bound to a scope.\n   *\n   * @param {number} [uid]\n   *        An optional unique ID for the function to be set\n   *\n   * @return {Function}\n   *         The new function that will be bound into the context given\n   */\n  var bind = function bind(context, fn, uid) {\n    // Make sure the function has a unique ID\n    if (!fn.guid) {\n      fn.guid = newGUID();\n    }\n\n    // Create the new function that changes the context\n    var bound = function bound() {\n      return fn.apply(context, arguments);\n    };\n\n    // Allow for the ability to individualize this function\n    // Needed in the case where multiple objects might share the same prototype\n    // IF both items add an event listener with the same function, then you try to remove just one\n    // it will remove both because they both have the same guid.\n    // when using this, you need to use the bind method when you remove the listener as well.\n    // currently used in text tracks\n    bound.guid = uid ? uid + '_' + fn.guid : fn.guid;\n\n    return bound;\n  };\n\n  /**\n   * Wraps the given function, `fn`, with a new function that only invokes `fn`\n   * at most once per every `wait` milliseconds.\n   *\n   * @param  {Function} fn\n   *         The function to be throttled.\n   *\n   * @param  {Number}   wait\n   *         The number of milliseconds by which to throttle.\n   *\n   * @return {Function}\n   */\n  var throttle = function throttle(fn, wait) {\n    var last = Date.now();\n\n    var throttled = function throttled() {\n      var now = Date.now();\n\n      if (now - last >= wait) {\n        fn.apply(undefined, arguments);\n        last = now;\n      }\n    };\n\n    return throttled;\n  };\n\n  /**\n   * Creates a debounced function that delays invoking `func` until after `wait`\n   * milliseconds have elapsed since the last time the debounced function was\n   * invoked.\n   *\n   * Inspired by lodash and underscore implementations.\n   *\n   * @param  {Function} func\n   *         The function to wrap with debounce behavior.\n   *\n   * @param  {number} wait\n   *         The number of milliseconds to wait after the last invocation.\n   *\n   * @param  {boolean} [immediate]\n   *         Whether or not to invoke the function immediately upon creation.\n   *\n   * @param  {Object} [context=window]\n   *         The \"context\" in which the debounced function should debounce. For\n   *         example, if this function should be tied to a Video.js player,\n   *         the player can be passed here. Alternatively, defaults to the\n   *         global `window` object.\n   *\n   * @return {Function}\n   *         A debounced function.\n   */\n  var debounce = function debounce(func, wait, immediate) {\n    var context = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : window_1;\n\n    var timeout = void 0;\n\n    /* eslint-disable consistent-this */\n    return function () {\n      var self = this;\n      var args = arguments;\n\n      var _later = function later() {\n        timeout = null;\n        _later = null;\n        if (!immediate) {\n          func.apply(self, args);\n        }\n      };\n\n      if (!timeout && immediate) {\n        func.apply(self, args);\n      }\n\n      context.clearTimeout(timeout);\n      timeout = context.setTimeout(_later, wait);\n    };\n    /* eslint-enable consistent-this */\n  };\n\n  /**\n   * @file src/js/event-target.js\n   */\n\n  /**\n   * `EventTarget` is a class that can have the same API as the DOM `EventTarget`. It\n   * adds shorthand functions that wrap around lengthy functions. For example:\n   * the `on` function is a wrapper around `addEventListener`.\n   *\n   * @see [EventTarget Spec]{@link https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-EventTarget}\n   * @class EventTarget\n   */\n  var EventTarget = function EventTarget() {};\n\n  /**\n   * A Custom DOM event.\n   *\n   * @typedef {Object} EventTarget~Event\n   * @see [Properties]{@link https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent}\n   */\n\n  /**\n   * All event listeners should follow the following format.\n   *\n   * @callback EventTarget~EventListener\n   * @this {EventTarget}\n   *\n   * @param {EventTarget~Event} event\n   *        the event that triggered this function\n   *\n   * @param {Object} [hash]\n   *        hash of data sent during the event\n   */\n\n  /**\n   * An object containing event names as keys and booleans as values.\n   *\n   * > NOTE: If an event name is set to a true value here {@link EventTarget#trigger}\n   *         will have extra functionality. See that function for more information.\n   *\n   * @property EventTarget.prototype.allowedEvents_\n   * @private\n   */\n  EventTarget.prototype.allowedEvents_ = {};\n\n  /**\n   * Adds an `event listener` to an instance of an `EventTarget`. An `event listener` is a\n   * function that will get called when an event with a certain name gets triggered.\n   *\n   * @param {string|string[]} type\n   *        An event name or an array of event names.\n   *\n   * @param {EventTarget~EventListener} fn\n   *        The function to call with `EventTarget`s\n   */\n  EventTarget.prototype.on = function (type, fn) {\n    // Remove the addEventListener alias before calling Events.on\n    // so we don't get into an infinite type loop\n    var ael = this.addEventListener;\n\n    this.addEventListener = function () {};\n    on(this, type, fn);\n    this.addEventListener = ael;\n  };\n\n  /**\n   * An alias of {@link EventTarget#on}. Allows `EventTarget` to mimic\n   * the standard DOM API.\n   *\n   * @function\n   * @see {@link EventTarget#on}\n   */\n  EventTarget.prototype.addEventListener = EventTarget.prototype.on;\n\n  /**\n   * Removes an `event listener` for a specific event from an instance of `EventTarget`.\n   * This makes it so that the `event listener` will no longer get called when the\n   * named event happens.\n   *\n   * @param {string|string[]} type\n   *        An event name or an array of event names.\n   *\n   * @param {EventTarget~EventListener} fn\n   *        The function to remove.\n   */\n  EventTarget.prototype.off = function (type, fn) {\n    off(this, type, fn);\n  };\n\n  /**\n   * An alias of {@link EventTarget#off}. Allows `EventTarget` to mimic\n   * the standard DOM API.\n   *\n   * @function\n   * @see {@link EventTarget#off}\n   */\n  EventTarget.prototype.removeEventListener = EventTarget.prototype.off;\n\n  /**\n   * This function will add an `event listener` that gets triggered only once. After the\n   * first trigger it will get removed. This is like adding an `event listener`\n   * with {@link EventTarget#on} that calls {@link EventTarget#off} on itself.\n   *\n   * @param {string|string[]} type\n   *        An event name or an array of event names.\n   *\n   * @param {EventTarget~EventListener} fn\n   *        The function to be called once for each event name.\n   */\n  EventTarget.prototype.one = function (type, fn) {\n    // Remove the addEventListener alialing Events.on\n    // so we don't get into an infinite type loop\n    var ael = this.addEventListener;\n\n    this.addEventListener = function () {};\n    one(this, type, fn);\n    this.addEventListener = ael;\n  };\n\n  /**\n   * This function causes an event to happen. This will then cause any `event listeners`\n   * that are waiting for that event, to get called. If there are no `event listeners`\n   * for an event then nothing will happen.\n   *\n   * If the name of the `Event` that is being triggered is in `EventTarget.allowedEvents_`.\n   * Trigger will also call the `on` + `uppercaseEventName` function.\n   *\n   * Example:\n   * 'click' is in `EventTarget.allowedEvents_`, so, trigger will attempt to call\n   * `onClick` if it exists.\n   *\n   * @param {string|EventTarget~Event|Object} event\n   *        The name of the event, an `Event`, or an object with a key of type set to\n   *        an event name.\n   */\n  EventTarget.prototype.trigger = function (event) {\n    var type = event.type || event;\n\n    if (typeof event === 'string') {\n      event = { type: type };\n    }\n    event = fixEvent(event);\n\n    if (this.allowedEvents_[type] && this['on' + type]) {\n      this['on' + type](event);\n    }\n\n    trigger(this, event);\n  };\n\n  /**\n   * An alias of {@link EventTarget#trigger}. Allows `EventTarget` to mimic\n   * the standard DOM API.\n   *\n   * @function\n   * @see {@link EventTarget#trigger}\n   */\n  EventTarget.prototype.dispatchEvent = EventTarget.prototype.trigger;\n\n  /**\n   * @file mixins/evented.js\n   * @module evented\n   */\n\n  /**\n   * Returns whether or not an object has had the evented mixin applied.\n   *\n   * @param  {Object} object\n   *         An object to test.\n   *\n   * @return {boolean}\n   *         Whether or not the object appears to be evented.\n   */\n  var isEvented = function isEvented(object) {\n    return object instanceof EventTarget || !!object.eventBusEl_ && ['on', 'one', 'off', 'trigger'].every(function (k) {\n      return typeof object[k] === 'function';\n    });\n  };\n\n  /**\n   * Whether a value is a valid event type - non-empty string or array.\n   *\n   * @private\n   * @param  {string|Array} type\n   *         The type value to test.\n   *\n   * @return {boolean}\n   *         Whether or not the type is a valid event type.\n   */\n  var isValidEventType = function isValidEventType(type) {\n    return (\n      // The regex here verifies that the `type` contains at least one non-\n      // whitespace character.\n      typeof type === 'string' && /\\S/.test(type) || Array.isArray(type) && !!type.length\n    );\n  };\n\n  /**\n   * Validates a value to determine if it is a valid event target. Throws if not.\n   *\n   * @private\n   * @throws {Error}\n   *         If the target does not appear to be a valid event target.\n   *\n   * @param  {Object} target\n   *         The object to test.\n   */\n  var validateTarget = function validateTarget(target) {\n    if (!target.nodeName && !isEvented(target)) {\n      throw new Error('Invalid target; must be a DOM node or evented object.');\n    }\n  };\n\n  /**\n   * Validates a value to determine if it is a valid event target. Throws if not.\n   *\n   * @private\n   * @throws {Error}\n   *         If the type does not appear to be a valid event type.\n   *\n   * @param  {string|Array} type\n   *         The type to test.\n   */\n  var validateEventType = function validateEventType(type) {\n    if (!isValidEventType(type)) {\n      throw new Error('Invalid event type; must be a non-empty string or array.');\n    }\n  };\n\n  /**\n   * Validates a value to determine if it is a valid listener. Throws if not.\n   *\n   * @private\n   * @throws {Error}\n   *         If the listener is not a function.\n   *\n   * @param  {Function} listener\n   *         The listener to test.\n   */\n  var validateListener = function validateListener(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Invalid listener; must be a function.');\n    }\n  };\n\n  /**\n   * Takes an array of arguments given to `on()` or `one()`, validates them, and\n   * normalizes them into an object.\n   *\n   * @private\n   * @param  {Object} self\n   *         The evented object on which `on()` or `one()` was called. This\n   *         object will be bound as the `this` value for the listener.\n   *\n   * @param  {Array} args\n   *         An array of arguments passed to `on()` or `one()`.\n   *\n   * @return {Object}\n   *         An object containing useful values for `on()` or `one()` calls.\n   */\n  var normalizeListenArgs = function normalizeListenArgs(self, args) {\n\n    // If the number of arguments is less than 3, the target is always the\n    // evented object itself.\n    var isTargetingSelf = args.length < 3 || args[0] === self || args[0] === self.eventBusEl_;\n    var target = void 0;\n    var type = void 0;\n    var listener = void 0;\n\n    if (isTargetingSelf) {\n      target = self.eventBusEl_;\n\n      // Deal with cases where we got 3 arguments, but we are still listening to\n      // the evented object itself.\n      if (args.length >= 3) {\n        args.shift();\n      }\n\n      type = args[0];\n      listener = args[1];\n    } else {\n      target = args[0];\n      type = args[1];\n      listener = args[2];\n    }\n\n    validateTarget(target);\n    validateEventType(type);\n    validateListener(listener);\n\n    listener = bind(self, listener);\n\n    return { isTargetingSelf: isTargetingSelf, target: target, type: type, listener: listener };\n  };\n\n  /**\n   * Adds the listener to the event type(s) on the target, normalizing for\n   * the type of target.\n   *\n   * @private\n   * @param  {Element|Object} target\n   *         A DOM node or evented object.\n   *\n   * @param  {string} method\n   *         The event binding method to use (\"on\" or \"one\").\n   *\n   * @param  {string|Array} type\n   *         One or more event type(s).\n   *\n   * @param  {Function} listener\n   *         A listener function.\n   */\n  var listen = function listen(target, method, type, listener) {\n    validateTarget(target);\n\n    if (target.nodeName) {\n      Events[method](target, type, listener);\n    } else {\n      target[method](type, listener);\n    }\n  };\n\n  /**\n   * Contains methods that provide event capabilities to an object which is passed\n   * to {@link module:evented|evented}.\n   *\n   * @mixin EventedMixin\n   */\n  var EventedMixin = {\n\n    /**\n     * Add a listener to an event (or events) on this object or another evented\n     * object.\n     *\n     * @param  {string|Array|Element|Object} targetOrType\n     *         If this is a string or array, it represents the event type(s)\n     *         that will trigger the listener.\n     *\n     *         Another evented object can be passed here instead, which will\n     *         cause the listener to listen for events on _that_ object.\n     *\n     *         In either case, the listener's `this` value will be bound to\n     *         this object.\n     *\n     * @param  {string|Array|Function} typeOrListener\n     *         If the first argument was a string or array, this should be the\n     *         listener function. Otherwise, this is a string or array of event\n     *         type(s).\n     *\n     * @param  {Function} [listener]\n     *         If the first argument was another evented object, this will be\n     *         the listener function.\n     */\n    on: function on$$1() {\n      var _this = this;\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var _normalizeListenArgs = normalizeListenArgs(this, args),\n          isTargetingSelf = _normalizeListenArgs.isTargetingSelf,\n          target = _normalizeListenArgs.target,\n          type = _normalizeListenArgs.type,\n          listener = _normalizeListenArgs.listener;\n\n      listen(target, 'on', type, listener);\n\n      // If this object is listening to another evented object.\n      if (!isTargetingSelf) {\n\n        // If this object is disposed, remove the listener.\n        var removeListenerOnDispose = function removeListenerOnDispose() {\n          return _this.off(target, type, listener);\n        };\n\n        // Use the same function ID as the listener so we can remove it later it\n        // using the ID of the original listener.\n        removeListenerOnDispose.guid = listener.guid;\n\n        // Add a listener to the target's dispose event as well. This ensures\n        // that if the target is disposed BEFORE this object, we remove the\n        // removal listener that was just added. Otherwise, we create a memory leak.\n        var removeRemoverOnTargetDispose = function removeRemoverOnTargetDispose() {\n          return _this.off('dispose', removeListenerOnDispose);\n        };\n\n        // Use the same function ID as the listener so we can remove it later\n        // it using the ID of the original listener.\n        removeRemoverOnTargetDispose.guid = listener.guid;\n\n        listen(this, 'on', 'dispose', removeListenerOnDispose);\n        listen(target, 'on', 'dispose', removeRemoverOnTargetDispose);\n      }\n    },\n\n\n    /**\n     * Add a listener to an event (or events) on this object or another evented\n     * object. The listener will only be called once and then removed.\n     *\n     * @param  {string|Array|Element|Object} targetOrType\n     *         If this is a string or array, it represents the event type(s)\n     *         that will trigger the listener.\n     *\n     *         Another evented object can be passed here instead, which will\n     *         cause the listener to listen for events on _that_ object.\n     *\n     *         In either case, the listener's `this` value will be bound to\n     *         this object.\n     *\n     * @param  {string|Array|Function} typeOrListener\n     *         If the first argument was a string or array, this should be the\n     *         listener function. Otherwise, this is a string or array of event\n     *         type(s).\n     *\n     * @param  {Function} [listener]\n     *         If the first argument was another evented object, this will be\n     *         the listener function.\n     */\n    one: function one$$1() {\n      var _this2 = this;\n\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      var _normalizeListenArgs2 = normalizeListenArgs(this, args),\n          isTargetingSelf = _normalizeListenArgs2.isTargetingSelf,\n          target = _normalizeListenArgs2.target,\n          type = _normalizeListenArgs2.type,\n          listener = _normalizeListenArgs2.listener;\n\n      // Targeting this evented object.\n\n\n      if (isTargetingSelf) {\n        listen(target, 'one', type, listener);\n\n        // Targeting another evented object.\n      } else {\n        var wrapper = function wrapper() {\n          for (var _len3 = arguments.length, largs = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n            largs[_key3] = arguments[_key3];\n          }\n\n          _this2.off(target, type, wrapper);\n          listener.apply(null, largs);\n        };\n\n        // Use the same function ID as the listener so we can remove it later\n        // it using the ID of the original listener.\n        wrapper.guid = listener.guid;\n        listen(target, 'one', type, wrapper);\n      }\n    },\n\n\n    /**\n     * Removes listener(s) from event(s) on an evented object.\n     *\n     * @param  {string|Array|Element|Object} [targetOrType]\n     *         If this is a string or array, it represents the event type(s).\n     *\n     *         Another evented object can be passed here instead, in which case\n     *         ALL 3 arguments are _required_.\n     *\n     * @param  {string|Array|Function} [typeOrListener]\n     *         If the first argument was a string or array, this may be the\n     *         listener function. Otherwise, this is a string or array of event\n     *         type(s).\n     *\n     * @param  {Function} [listener]\n     *         If the first argument was another evented object, this will be\n     *         the listener function; otherwise, _all_ listeners bound to the\n     *         event type(s) will be removed.\n     */\n    off: function off$$1(targetOrType, typeOrListener, listener) {\n\n      // Targeting this evented object.\n      if (!targetOrType || isValidEventType(targetOrType)) {\n        off(this.eventBusEl_, targetOrType, typeOrListener);\n\n        // Targeting another evented object.\n      } else {\n        var target = targetOrType;\n        var type = typeOrListener;\n\n        // Fail fast and in a meaningful way!\n        validateTarget(target);\n        validateEventType(type);\n        validateListener(listener);\n\n        // Ensure there's at least a guid, even if the function hasn't been used\n        listener = bind(this, listener);\n\n        // Remove the dispose listener on this evented object, which was given\n        // the same guid as the event listener in on().\n        this.off('dispose', listener);\n\n        if (target.nodeName) {\n          off(target, type, listener);\n          off(target, 'dispose', listener);\n        } else if (isEvented(target)) {\n          target.off(type, listener);\n          target.off('dispose', listener);\n        }\n      }\n    },\n\n\n    /**\n     * Fire an event on this evented object, causing its listeners to be called.\n     *\n     * @param   {string|Object} event\n     *          An event type or an object with a type property.\n     *\n     * @param   {Object} [hash]\n     *          An additional object to pass along to listeners.\n     *\n     * @returns {boolean}\n     *          Whether or not the default behavior was prevented.\n     */\n    trigger: function trigger$$1(event, hash) {\n      return trigger(this.eventBusEl_, event, hash);\n    }\n  };\n\n  /**\n   * Applies {@link module:evented~EventedMixin|EventedMixin} to a target object.\n   *\n   * @param  {Object} target\n   *         The object to which to add event methods.\n   *\n   * @param  {Object} [options={}]\n   *         Options for customizing the mixin behavior.\n   *\n   * @param  {String} [options.eventBusKey]\n   *         By default, adds a `eventBusEl_` DOM element to the target object,\n   *         which is used as an event bus. If the target object already has a\n   *         DOM element that should be used, pass its key here.\n   *\n   * @return {Object}\n   *         The target object.\n   */\n  function evented(target) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var eventBusKey = options.eventBusKey;\n\n    // Set or create the eventBusEl_.\n\n    if (eventBusKey) {\n      if (!target[eventBusKey].nodeName) {\n        throw new Error('The eventBusKey \"' + eventBusKey + '\" does not refer to an element.');\n      }\n      target.eventBusEl_ = target[eventBusKey];\n    } else {\n      target.eventBusEl_ = createEl('span', { className: 'vjs-event-bus' });\n    }\n\n    assign(target, EventedMixin);\n\n    // When any evented object is disposed, it removes all its listeners.\n    target.on('dispose', function () {\n      target.off();\n      window_1.setTimeout(function () {\n        target.eventBusEl_ = null;\n      }, 0);\n    });\n\n    return target;\n  }\n\n  /**\n   * @file mixins/stateful.js\n   * @module stateful\n   */\n\n  /**\n   * Contains methods that provide statefulness to an object which is passed\n   * to {@link module:stateful}.\n   *\n   * @mixin StatefulMixin\n   */\n  var StatefulMixin = {\n\n    /**\n     * A hash containing arbitrary keys and values representing the state of\n     * the object.\n     *\n     * @type {Object}\n     */\n    state: {},\n\n    /**\n     * Set the state of an object by mutating its\n     * {@link module:stateful~StatefulMixin.state|state} object in place.\n     *\n     * @fires   module:stateful~StatefulMixin#statechanged\n     * @param   {Object|Function} stateUpdates\n     *          A new set of properties to shallow-merge into the plugin state.\n     *          Can be a plain object or a function returning a plain object.\n     *\n     * @returns {Object|undefined}\n     *          An object containing changes that occurred. If no changes\n     *          occurred, returns `undefined`.\n     */\n    setState: function setState(stateUpdates) {\n      var _this = this;\n\n      // Support providing the `stateUpdates` state as a function.\n      if (typeof stateUpdates === 'function') {\n        stateUpdates = stateUpdates();\n      }\n\n      var changes = void 0;\n\n      each(stateUpdates, function (value, key) {\n\n        // Record the change if the value is different from what's in the\n        // current state.\n        if (_this.state[key] !== value) {\n          changes = changes || {};\n          changes[key] = {\n            from: _this.state[key],\n            to: value\n          };\n        }\n\n        _this.state[key] = value;\n      });\n\n      // Only trigger \"statechange\" if there were changes AND we have a trigger\n      // function. This allows us to not require that the target object be an\n      // evented object.\n      if (changes && isEvented(this)) {\n\n        /**\n         * An event triggered on an object that is both\n         * {@link module:stateful|stateful} and {@link module:evented|evented}\n         * indicating that its state has changed.\n         *\n         * @event    module:stateful~StatefulMixin#statechanged\n         * @type     {Object}\n         * @property {Object} changes\n         *           A hash containing the properties that were changed and\n         *           the values they were changed `from` and `to`.\n         */\n        this.trigger({\n          changes: changes,\n          type: 'statechanged'\n        });\n      }\n\n      return changes;\n    }\n  };\n\n  /**\n   * Applies {@link module:stateful~StatefulMixin|StatefulMixin} to a target\n   * object.\n   *\n   * If the target object is {@link module:evented|evented} and has a\n   * `handleStateChanged` method, that method will be automatically bound to the\n   * `statechanged` event on itself.\n   *\n   * @param   {Object} target\n   *          The object to be made stateful.\n   *\n   * @param   {Object} [defaultState]\n   *          A default set of properties to populate the newly-stateful object's\n   *          `state` property.\n   *\n   * @returns {Object}\n   *          Returns the `target`.\n   */\n  function stateful(target, defaultState) {\n    assign(target, StatefulMixin);\n\n    // This happens after the mixing-in because we need to replace the `state`\n    // added in that step.\n    target.state = assign({}, target.state, defaultState);\n\n    // Auto-bind the `handleStateChanged` method of the target object if it exists.\n    if (typeof target.handleStateChanged === 'function' && isEvented(target)) {\n      target.on('statechanged', target.handleStateChanged);\n    }\n\n    return target;\n  }\n\n  /**\n   * @file to-title-case.js\n   * @module to-title-case\n   */\n\n  /**\n   * Uppercase the first letter of a string.\n   *\n   * @param {string} string\n   *        String to be uppercased\n   *\n   * @return {string}\n   *         The string with an uppercased first letter\n   */\n  function toTitleCase(string) {\n    if (typeof string !== 'string') {\n      return string;\n    }\n\n    return string.charAt(0).toUpperCase() + string.slice(1);\n  }\n\n  /**\n   * Compares the TitleCase versions of the two strings for equality.\n   *\n   * @param {string} str1\n   *        The first string to compare\n   *\n   * @param {string} str2\n   *        The second string to compare\n   *\n   * @return {boolean}\n   *         Whether the TitleCase versions of the strings are equal\n   */\n  function titleCaseEquals(str1, str2) {\n    return toTitleCase(str1) === toTitleCase(str2);\n  }\n\n  /**\n   * @file merge-options.js\n   * @module merge-options\n   */\n\n  /**\n   * Deep-merge one or more options objects, recursively merging **only** plain\n   * object properties.\n   *\n   * @param   {Object[]} sources\n   *          One or more objects to merge into a new object.\n   *\n   * @returns {Object}\n   *          A new object that is the merged result of all sources.\n   */\n  function mergeOptions() {\n    var result = {};\n\n    for (var _len = arguments.length, sources = Array(_len), _key = 0; _key < _len; _key++) {\n      sources[_key] = arguments[_key];\n    }\n\n    sources.forEach(function (source) {\n      if (!source) {\n        return;\n      }\n\n      each(source, function (value, key) {\n        if (!isPlain(value)) {\n          result[key] = value;\n          return;\n        }\n\n        if (!isPlain(result[key])) {\n          result[key] = {};\n        }\n\n        result[key] = mergeOptions(result[key], value);\n      });\n    });\n\n    return result;\n  }\n\n  /**\n   * Player Component - Base class for all UI objects\n   *\n   * @file component.js\n   */\n\n  /**\n   * Base class for all UI Components.\n   * Components are UI objects which represent both a javascript object and an element\n   * in the DOM. They can be children of other components, and can have\n   * children themselves.\n   *\n   * Components can also use methods from {@link EventTarget}\n   */\n\n  var Component = function () {\n\n    /**\n     * A callback that is called when a component is ready. Does not have any\n     * paramters and any callback value will be ignored.\n     *\n     * @callback Component~ReadyCallback\n     * @this Component\n     */\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Object[]} [options.children]\n     *        An array of children objects to intialize this component with. Children objects have\n     *        a name property that will be used if more than one component of the same type needs to be\n     *        added.\n     *\n     * @param {Component~ReadyCallback} [ready]\n     *        Function that gets called when the `Component` is ready.\n     */\n    function Component(player, options, ready) {\n      classCallCheck(this, Component);\n\n\n      // The component might be the player itself and we can't pass `this` to super\n      if (!player && this.play) {\n        this.player_ = player = this; // eslint-disable-line\n      } else {\n        this.player_ = player;\n      }\n\n      // Make a copy of prototype.options_ to protect against overriding defaults\n      this.options_ = mergeOptions({}, this.options_);\n\n      // Updated options with supplied options\n      options = this.options_ = mergeOptions(this.options_, options);\n\n      // Get ID from options or options element if one is supplied\n      this.id_ = options.id || options.el && options.el.id;\n\n      // If there was no ID from the options, generate one\n      if (!this.id_) {\n        // Don't require the player ID function in the case of mock players\n        var id = player && player.id && player.id() || 'no_player';\n\n        this.id_ = id + '_component_' + newGUID();\n      }\n\n      this.name_ = options.name || null;\n\n      // Create element if one wasn't provided in options\n      if (options.el) {\n        this.el_ = options.el;\n      } else if (options.createEl !== false) {\n        this.el_ = this.createEl();\n      }\n\n      // if evented is anything except false, we want to mixin in evented\n      if (options.evented !== false) {\n        // Make this an evented object and use `el_`, if available, as its event bus\n        evented(this, { eventBusKey: this.el_ ? 'el_' : null });\n      }\n      stateful(this, this.constructor.defaultState);\n\n      this.children_ = [];\n      this.childIndex_ = {};\n      this.childNameIndex_ = {};\n\n      // Add any child components in options\n      if (options.initChildren !== false) {\n        this.initChildren();\n      }\n\n      this.ready(ready);\n      // Don't want to trigger ready here or it will before init is actually\n      // finished for all children that run this constructor\n\n      if (options.reportTouchActivity !== false) {\n        this.enableTouchActivity();\n      }\n    }\n\n    /**\n     * Dispose of the `Component` and all child components.\n     *\n     * @fires Component#dispose\n     */\n\n\n    Component.prototype.dispose = function dispose() {\n\n      /**\n       * Triggered when a `Component` is disposed.\n       *\n       * @event Component#dispose\n       * @type {EventTarget~Event}\n       *\n       * @property {boolean} [bubbles=false]\n       *           set to false so that the close event does not\n       *           bubble up\n       */\n      this.trigger({ type: 'dispose', bubbles: false });\n\n      // Dispose all children.\n      if (this.children_) {\n        for (var i = this.children_.length - 1; i >= 0; i--) {\n          if (this.children_[i].dispose) {\n            this.children_[i].dispose();\n          }\n        }\n      }\n\n      // Delete child references\n      this.children_ = null;\n      this.childIndex_ = null;\n      this.childNameIndex_ = null;\n\n      if (this.el_) {\n        // Remove element from DOM\n        if (this.el_.parentNode) {\n          this.el_.parentNode.removeChild(this.el_);\n        }\n\n        removeData(this.el_);\n        this.el_ = null;\n      }\n\n      // remove reference to the player after disposing of the element\n      this.player_ = null;\n    };\n\n    /**\n     * Return the {@link Player} that the `Component` has attached to.\n     *\n     * @return {Player}\n     *         The player that this `Component` has attached to.\n     */\n\n\n    Component.prototype.player = function player() {\n      return this.player_;\n    };\n\n    /**\n     * Deep merge of options objects with new options.\n     * > Note: When both `obj` and `options` contain properties whose values are objects.\n     *         The two properties get merged using {@link module:mergeOptions}\n     *\n     * @param {Object} obj\n     *        The object that contains new options.\n     *\n     * @return {Object}\n     *         A new object of `this.options_` and `obj` merged together.\n     *\n     * @deprecated since version 5\n     */\n\n\n    Component.prototype.options = function options(obj) {\n      log$1.warn('this.options() has been deprecated and will be moved to the constructor in 6.0');\n\n      if (!obj) {\n        return this.options_;\n      }\n\n      this.options_ = mergeOptions(this.options_, obj);\n      return this.options_;\n    };\n\n    /**\n     * Get the `Component`s DOM element\n     *\n     * @return {Element}\n     *         The DOM element for this `Component`.\n     */\n\n\n    Component.prototype.el = function el() {\n      return this.el_;\n    };\n\n    /**\n     * Create the `Component`s DOM element.\n     *\n     * @param {string} [tagName]\n     *        Element's DOM node type. e.g. 'div'\n     *\n     * @param {Object} [properties]\n     *        An object of properties that should be set.\n     *\n     * @param {Object} [attributes]\n     *        An object of attributes that should be set.\n     *\n     * @return {Element}\n     *         The element that gets created.\n     */\n\n\n    Component.prototype.createEl = function createEl$$1(tagName, properties, attributes) {\n      return createEl(tagName, properties, attributes);\n    };\n\n    /**\n     * Localize a string given the string in english.\n     *\n     * If tokens are provided, it'll try and run a simple token replacement on the provided string.\n     * The tokens it looks for look like `{1}` with the index being 1-indexed into the tokens array.\n     *\n     * If a `defaultValue` is provided, it'll use that over `string`,\n     * if a value isn't found in provided language files.\n     * This is useful if you want to have a descriptive key for token replacement\n     * but have a succinct localized string and not require `en.json` to be included.\n     *\n     * Currently, it is used for the progress bar timing.\n     * ```js\n     * {\n     *   \"progress bar timing: currentTime={1} duration={2}\": \"{1} of {2}\"\n     * }\n     * ```\n     * It is then used like so:\n     * ```js\n     * this.localize('progress bar timing: currentTime={1} duration{2}',\n     *               [this.player_.currentTime(), this.player_.duration()],\n     *               '{1} of {2}');\n     * ```\n     *\n     * Which outputs something like: `01:23 of 24:56`.\n     *\n     *\n     * @param {string} string\n     *        The string to localize and the key to lookup in the language files.\n     * @param {string[]} [tokens]\n     *        If the current item has token replacements, provide the tokens here.\n     * @param {string} [defaultValue]\n     *        Defaults to `string`. Can be a default value to use for token replacement\n     *        if the lookup key is needed to be separate.\n     *\n     * @return {string}\n     *         The localized string or if no localization exists the english string.\n     */\n\n\n    Component.prototype.localize = function localize(string, tokens) {\n      var defaultValue = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : string;\n\n      var code = this.player_.language && this.player_.language();\n      var languages = this.player_.languages && this.player_.languages();\n      var language = languages && languages[code];\n      var primaryCode = code && code.split('-')[0];\n      var primaryLang = languages && languages[primaryCode];\n\n      var localizedString = defaultValue;\n\n      if (language && language[string]) {\n        localizedString = language[string];\n      } else if (primaryLang && primaryLang[string]) {\n        localizedString = primaryLang[string];\n      }\n\n      if (tokens) {\n        localizedString = localizedString.replace(/\\{(\\d+)\\}/g, function (match, index) {\n          var value = tokens[index - 1];\n          var ret = value;\n\n          if (typeof value === 'undefined') {\n            ret = match;\n          }\n\n          return ret;\n        });\n      }\n\n      return localizedString;\n    };\n\n    /**\n     * Return the `Component`s DOM element. This is where children get inserted.\n     * This will usually be the the same as the element returned in {@link Component#el}.\n     *\n     * @return {Element}\n     *         The content element for this `Component`.\n     */\n\n\n    Component.prototype.contentEl = function contentEl() {\n      return this.contentEl_ || this.el_;\n    };\n\n    /**\n     * Get this `Component`s ID\n     *\n     * @return {string}\n     *         The id of this `Component`\n     */\n\n\n    Component.prototype.id = function id() {\n      return this.id_;\n    };\n\n    /**\n     * Get the `Component`s name. The name gets used to reference the `Component`\n     * and is set during registration.\n     *\n     * @return {string}\n     *         The name of this `Component`.\n     */\n\n\n    Component.prototype.name = function name() {\n      return this.name_;\n    };\n\n    /**\n     * Get an array of all child components\n     *\n     * @return {Array}\n     *         The children\n     */\n\n\n    Component.prototype.children = function children() {\n      return this.children_;\n    };\n\n    /**\n     * Returns the child `Component` with the given `id`.\n     *\n     * @param {string} id\n     *        The id of the child `Component` to get.\n     *\n     * @return {Component|undefined}\n     *         The child `Component` with the given `id` or undefined.\n     */\n\n\n    Component.prototype.getChildById = function getChildById(id) {\n      return this.childIndex_[id];\n    };\n\n    /**\n     * Returns the child `Component` with the given `name`.\n     *\n     * @param {string} name\n     *        The name of the child `Component` to get.\n     *\n     * @return {Component|undefined}\n     *         The child `Component` with the given `name` or undefined.\n     */\n\n\n    Component.prototype.getChild = function getChild(name) {\n      if (!name) {\n        return;\n      }\n\n      name = toTitleCase(name);\n\n      return this.childNameIndex_[name];\n    };\n\n    /**\n     * Add a child `Component` inside the current `Component`.\n     *\n     *\n     * @param {string|Component} child\n     *        The name or instance of a child to add.\n     *\n     * @param {Object} [options={}]\n     *        The key/value store of options that will get passed to children of\n     *        the child.\n     *\n     * @param {number} [index=this.children_.length]\n     *        The index to attempt to add a child into.\n     *\n     * @return {Component}\n     *         The `Component` that gets added as a child. When using a string the\n     *         `Component` will get created by this process.\n     */\n\n\n    Component.prototype.addChild = function addChild(child) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var index = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.children_.length;\n\n      var component = void 0;\n      var componentName = void 0;\n\n      // If child is a string, create component with options\n      if (typeof child === 'string') {\n        componentName = toTitleCase(child);\n\n        var componentClassName = options.componentClass || componentName;\n\n        // Set name through options\n        options.name = componentName;\n\n        // Create a new object & element for this controls set\n        // If there's no .player_, this is a player\n        var ComponentClass = Component.getComponent(componentClassName);\n\n        if (!ComponentClass) {\n          throw new Error('Component ' + componentClassName + ' does not exist');\n        }\n\n        // data stored directly on the videojs object may be\n        // misidentified as a component to retain\n        // backwards-compatibility with 4.x. check to make sure the\n        // component class can be instantiated.\n        if (typeof ComponentClass !== 'function') {\n          return null;\n        }\n\n        component = new ComponentClass(this.player_ || this, options);\n\n        // child is a component instance\n      } else {\n        component = child;\n      }\n\n      this.children_.splice(index, 0, component);\n\n      if (typeof component.id === 'function') {\n        this.childIndex_[component.id()] = component;\n      }\n\n      // If a name wasn't used to create the component, check if we can use the\n      // name function of the component\n      componentName = componentName || component.name && toTitleCase(component.name());\n\n      if (componentName) {\n        this.childNameIndex_[componentName] = component;\n      }\n\n      // Add the UI object's element to the container div (box)\n      // Having an element is not required\n      if (typeof component.el === 'function' && component.el()) {\n        var childNodes = this.contentEl().children;\n        var refNode = childNodes[index] || null;\n\n        this.contentEl().insertBefore(component.el(), refNode);\n      }\n\n      // Return so it can stored on parent object if desired.\n      return component;\n    };\n\n    /**\n     * Remove a child `Component` from this `Component`s list of children. Also removes\n     * the child `Component`s element from this `Component`s element.\n     *\n     * @param {Component} component\n     *        The child `Component` to remove.\n     */\n\n\n    Component.prototype.removeChild = function removeChild(component) {\n      if (typeof component === 'string') {\n        component = this.getChild(component);\n      }\n\n      if (!component || !this.children_) {\n        return;\n      }\n\n      var childFound = false;\n\n      for (var i = this.children_.length - 1; i >= 0; i--) {\n        if (this.children_[i] === component) {\n          childFound = true;\n          this.children_.splice(i, 1);\n          break;\n        }\n      }\n\n      if (!childFound) {\n        return;\n      }\n\n      this.childIndex_[component.id()] = null;\n      this.childNameIndex_[component.name()] = null;\n\n      var compEl = component.el();\n\n      if (compEl && compEl.parentNode === this.contentEl()) {\n        this.contentEl().removeChild(component.el());\n      }\n    };\n\n    /**\n     * Add and initialize default child `Component`s based upon options.\n     */\n\n\n    Component.prototype.initChildren = function initChildren() {\n      var _this = this;\n\n      var children = this.options_.children;\n\n      if (children) {\n        // `this` is `parent`\n        var parentOptions = this.options_;\n\n        var handleAdd = function handleAdd(child) {\n          var name = child.name;\n          var opts = child.opts;\n\n          // Allow options for children to be set at the parent options\n          // e.g. videojs(id, { controlBar: false });\n          // instead of videojs(id, { children: { controlBar: false });\n          if (parentOptions[name] !== undefined) {\n            opts = parentOptions[name];\n          }\n\n          // Allow for disabling default components\n          // e.g. options['children']['posterImage'] = false\n          if (opts === false) {\n            return;\n          }\n\n          // Allow options to be passed as a simple boolean if no configuration\n          // is necessary.\n          if (opts === true) {\n            opts = {};\n          }\n\n          // We also want to pass the original player options\n          // to each component as well so they don't need to\n          // reach back into the player for options later.\n          opts.playerOptions = _this.options_.playerOptions;\n\n          // Create and add the child component.\n          // Add a direct reference to the child by name on the parent instance.\n          // If two of the same component are used, different names should be supplied\n          // for each\n          var newChild = _this.addChild(name, opts);\n\n          if (newChild) {\n            _this[name] = newChild;\n          }\n        };\n\n        // Allow for an array of children details to passed in the options\n        var workingChildren = void 0;\n        var Tech = Component.getComponent('Tech');\n\n        if (Array.isArray(children)) {\n          workingChildren = children;\n        } else {\n          workingChildren = Object.keys(children);\n        }\n\n        workingChildren\n        // children that are in this.options_ but also in workingChildren  would\n        // give us extra children we do not want. So, we want to filter them out.\n        .concat(Object.keys(this.options_).filter(function (child) {\n          return !workingChildren.some(function (wchild) {\n            if (typeof wchild === 'string') {\n              return child === wchild;\n            }\n            return child === wchild.name;\n          });\n        })).map(function (child) {\n          var name = void 0;\n          var opts = void 0;\n\n          if (typeof child === 'string') {\n            name = child;\n            opts = children[name] || _this.options_[name] || {};\n          } else {\n            name = child.name;\n            opts = child;\n          }\n\n          return { name: name, opts: opts };\n        }).filter(function (child) {\n          // we have to make sure that child.name isn't in the techOrder since\n          // techs are registerd as Components but can't aren't compatible\n          // See https://github.com/videojs/video.js/issues/2772\n          var c = Component.getComponent(child.opts.componentClass || toTitleCase(child.name));\n\n          return c && !Tech.isTech(c);\n        }).forEach(handleAdd);\n      }\n    };\n\n    /**\n     * Builds the default DOM class name. Should be overriden by sub-components.\n     *\n     * @return {string}\n     *         The DOM class name for this object.\n     *\n     * @abstract\n     */\n\n\n    Component.prototype.buildCSSClass = function buildCSSClass() {\n      // Child classes can include a function that does:\n      // return 'CLASS NAME' + this._super();\n      return '';\n    };\n\n    /**\n     * Bind a listener to the component's ready state.\n     * Different from event listeners in that if the ready event has already happened\n     * it will trigger the function immediately.\n     *\n     * @return {Component}\n     *         Returns itself; method can be chained.\n     */\n\n\n    Component.prototype.ready = function ready(fn) {\n      var sync = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!fn) {\n        return;\n      }\n\n      if (!this.isReady_) {\n        this.readyQueue_ = this.readyQueue_ || [];\n        this.readyQueue_.push(fn);\n        return;\n      }\n\n      if (sync) {\n        fn.call(this);\n      } else {\n        // Call the function asynchronously by default for consistency\n        this.setTimeout(fn, 1);\n      }\n    };\n\n    /**\n     * Trigger all the ready listeners for this `Component`.\n     *\n     * @fires Component#ready\n     */\n\n\n    Component.prototype.triggerReady = function triggerReady() {\n      this.isReady_ = true;\n\n      // Ensure ready is triggered asynchronously\n      this.setTimeout(function () {\n        var readyQueue = this.readyQueue_;\n\n        // Reset Ready Queue\n        this.readyQueue_ = [];\n\n        if (readyQueue && readyQueue.length > 0) {\n          readyQueue.forEach(function (fn) {\n            fn.call(this);\n          }, this);\n        }\n\n        // Allow for using event listeners also\n        /**\n         * Triggered when a `Component` is ready.\n         *\n         * @event Component#ready\n         * @type {EventTarget~Event}\n         */\n        this.trigger('ready');\n      }, 1);\n    };\n\n    /**\n     * Find a single DOM element matching a `selector`. This can be within the `Component`s\n     * `contentEl()` or another custom context.\n     *\n     * @param {string} selector\n     *        A valid CSS selector, which will be passed to `querySelector`.\n     *\n     * @param {Element|string} [context=this.contentEl()]\n     *        A DOM element within which to query. Can also be a selector string in\n     *        which case the first matching element will get used as context. If\n     *        missing `this.contentEl()` gets used. If  `this.contentEl()` returns\n     *        nothing it falls back to `document`.\n     *\n     * @return {Element|null}\n     *         the dom element that was found, or null\n     *\n     * @see [Information on CSS Selectors](https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Getting_Started/Selectors)\n     */\n\n\n    Component.prototype.$ = function $$$1(selector, context) {\n      return $(selector, context || this.contentEl());\n    };\n\n    /**\n     * Finds all DOM element matching a `selector`. This can be within the `Component`s\n     * `contentEl()` or another custom context.\n     *\n     * @param {string} selector\n     *        A valid CSS selector, which will be passed to `querySelectorAll`.\n     *\n     * @param {Element|string} [context=this.contentEl()]\n     *        A DOM element within which to query. Can also be a selector string in\n     *        which case the first matching element will get used as context. If\n     *        missing `this.contentEl()` gets used. If  `this.contentEl()` returns\n     *        nothing it falls back to `document`.\n     *\n     * @return {NodeList}\n     *         a list of dom elements that were found\n     *\n     * @see [Information on CSS Selectors](https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Getting_Started/Selectors)\n     */\n\n\n    Component.prototype.$$ = function $$$$1(selector, context) {\n      return $$(selector, context || this.contentEl());\n    };\n\n    /**\n     * Check if a component's element has a CSS class name.\n     *\n     * @param {string} classToCheck\n     *        CSS class name to check.\n     *\n     * @return {boolean}\n     *         - True if the `Component` has the class.\n     *         - False if the `Component` does not have the class`\n     */\n\n\n    Component.prototype.hasClass = function hasClass$$1(classToCheck) {\n      return hasClass(this.el_, classToCheck);\n    };\n\n    /**\n     * Add a CSS class name to the `Component`s element.\n     *\n     * @param {string} classToAdd\n     *        CSS class name to add\n     */\n\n\n    Component.prototype.addClass = function addClass$$1(classToAdd) {\n      addClass(this.el_, classToAdd);\n    };\n\n    /**\n     * Remove a CSS class name from the `Component`s element.\n     *\n     * @param {string} classToRemove\n     *        CSS class name to remove\n     */\n\n\n    Component.prototype.removeClass = function removeClass$$1(classToRemove) {\n      removeClass(this.el_, classToRemove);\n    };\n\n    /**\n     * Add or remove a CSS class name from the component's element.\n     * - `classToToggle` gets added when {@link Component#hasClass} would return false.\n     * - `classToToggle` gets removed when {@link Component#hasClass} would return true.\n     *\n     * @param  {string} classToToggle\n     *         The class to add or remove based on (@link Component#hasClass}\n     *\n     * @param  {boolean|Dom~predicate} [predicate]\n     *         An {@link Dom~predicate} function or a boolean\n     */\n\n\n    Component.prototype.toggleClass = function toggleClass$$1(classToToggle, predicate) {\n      toggleClass(this.el_, classToToggle, predicate);\n    };\n\n    /**\n     * Show the `Component`s element if it is hidden by removing the\n     * 'vjs-hidden' class name from it.\n     */\n\n\n    Component.prototype.show = function show() {\n      this.removeClass('vjs-hidden');\n    };\n\n    /**\n     * Hide the `Component`s element if it is currently showing by adding the\n     * 'vjs-hidden` class name to it.\n     */\n\n\n    Component.prototype.hide = function hide() {\n      this.addClass('vjs-hidden');\n    };\n\n    /**\n     * Lock a `Component`s element in its visible state by adding the 'vjs-lock-showing'\n     * class name to it. Used during fadeIn/fadeOut.\n     *\n     * @private\n     */\n\n\n    Component.prototype.lockShowing = function lockShowing() {\n      this.addClass('vjs-lock-showing');\n    };\n\n    /**\n     * Unlock a `Component`s element from its visible state by removing the 'vjs-lock-showing'\n     * class name from it. Used during fadeIn/fadeOut.\n     *\n     * @private\n     */\n\n\n    Component.prototype.unlockShowing = function unlockShowing() {\n      this.removeClass('vjs-lock-showing');\n    };\n\n    /**\n     * Get the value of an attribute on the `Component`s element.\n     *\n     * @param {string} attribute\n     *        Name of the attribute to get the value from.\n     *\n     * @return {string|null}\n     *         - The value of the attribute that was asked for.\n     *         - Can be an empty string on some browsers if the attribute does not exist\n     *           or has no value\n     *         - Most browsers will return null if the attibute does not exist or has\n     *           no value.\n     *\n     * @see [DOM API]{@link https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttribute}\n     */\n\n\n    Component.prototype.getAttribute = function getAttribute$$1(attribute) {\n      return getAttribute(this.el_, attribute);\n    };\n\n    /**\n     * Set the value of an attribute on the `Component`'s element\n     *\n     * @param {string} attribute\n     *        Name of the attribute to set.\n     *\n     * @param {string} value\n     *        Value to set the attribute to.\n     *\n     * @see [DOM API]{@link https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute}\n     */\n\n\n    Component.prototype.setAttribute = function setAttribute$$1(attribute, value) {\n      setAttribute(this.el_, attribute, value);\n    };\n\n    /**\n     * Remove an attribute from the `Component`s element.\n     *\n     * @param {string} attribute\n     *        Name of the attribute to remove.\n     *\n     * @see [DOM API]{@link https://developer.mozilla.org/en-US/docs/Web/API/Element/removeAttribute}\n     */\n\n\n    Component.prototype.removeAttribute = function removeAttribute$$1(attribute) {\n      removeAttribute(this.el_, attribute);\n    };\n\n    /**\n     * Get or set the width of the component based upon the CSS styles.\n     * See {@link Component#dimension} for more detailed information.\n     *\n     * @param {number|string} [num]\n     *        The width that you want to set postfixed with '%', 'px' or nothing.\n     *\n     * @param {boolean} [skipListeners]\n     *        Skip the componentresize event trigger\n     *\n     * @return {number|string}\n     *         The width when getting, zero if there is no width. Can be a string\n     *           postpixed with '%' or 'px'.\n     */\n\n\n    Component.prototype.width = function width(num, skipListeners) {\n      return this.dimension('width', num, skipListeners);\n    };\n\n    /**\n     * Get or set the height of the component based upon the CSS styles.\n     * See {@link Component#dimension} for more detailed information.\n     *\n     * @param {number|string} [num]\n     *        The height that you want to set postfixed with '%', 'px' or nothing.\n     *\n     * @param {boolean} [skipListeners]\n     *        Skip the componentresize event trigger\n     *\n     * @return {number|string}\n     *         The width when getting, zero if there is no width. Can be a string\n     *         postpixed with '%' or 'px'.\n     */\n\n\n    Component.prototype.height = function height(num, skipListeners) {\n      return this.dimension('height', num, skipListeners);\n    };\n\n    /**\n     * Set both the width and height of the `Component` element at the same time.\n     *\n     * @param  {number|string} width\n     *         Width to set the `Component`s element to.\n     *\n     * @param  {number|string} height\n     *         Height to set the `Component`s element to.\n     */\n\n\n    Component.prototype.dimensions = function dimensions(width, height) {\n      // Skip componentresize listeners on width for optimization\n      this.width(width, true);\n      this.height(height);\n    };\n\n    /**\n     * Get or set width or height of the `Component` element. This is the shared code\n     * for the {@link Component#width} and {@link Component#height}.\n     *\n     * Things to know:\n     * - If the width or height in an number this will return the number postfixed with 'px'.\n     * - If the width/height is a percent this will return the percent postfixed with '%'\n     * - Hidden elements have a width of 0 with `window.getComputedStyle`. This function\n     *   defaults to the `Component`s `style.width` and falls back to `window.getComputedStyle`.\n     *   See [this]{@link http://www.foliotek.com/devblog/getting-the-width-of-a-hidden-element-with-jquery-using-width/}\n     *   for more information\n     * - If you want the computed style of the component, use {@link Component#currentWidth}\n     *   and {@link {Component#currentHeight}\n     *\n     * @fires Component#componentresize\n     *\n     * @param {string} widthOrHeight\n     8        'width' or 'height'\n     *\n     * @param  {number|string} [num]\n     8         New dimension\n     *\n     * @param  {boolean} [skipListeners]\n     *         Skip componentresize event trigger\n     *\n     * @return {number}\n     *         The dimension when getting or 0 if unset\n     */\n\n\n    Component.prototype.dimension = function dimension(widthOrHeight, num, skipListeners) {\n      if (num !== undefined) {\n        // Set to zero if null or literally NaN (NaN !== NaN)\n        if (num === null || num !== num) {\n          num = 0;\n        }\n\n        // Check if using css width/height (% or px) and adjust\n        if (('' + num).indexOf('%') !== -1 || ('' + num).indexOf('px') !== -1) {\n          this.el_.style[widthOrHeight] = num;\n        } else if (num === 'auto') {\n          this.el_.style[widthOrHeight] = '';\n        } else {\n          this.el_.style[widthOrHeight] = num + 'px';\n        }\n\n        // skipListeners allows us to avoid triggering the resize event when setting both width and height\n        if (!skipListeners) {\n          /**\n           * Triggered when a component is resized.\n           *\n           * @event Component#componentresize\n           * @type {EventTarget~Event}\n           */\n          this.trigger('componentresize');\n        }\n\n        return;\n      }\n\n      // Not setting a value, so getting it\n      // Make sure element exists\n      if (!this.el_) {\n        return 0;\n      }\n\n      // Get dimension value from style\n      var val = this.el_.style[widthOrHeight];\n      var pxIndex = val.indexOf('px');\n\n      if (pxIndex !== -1) {\n        // Return the pixel value with no 'px'\n        return parseInt(val.slice(0, pxIndex), 10);\n      }\n\n      // No px so using % or no style was set, so falling back to offsetWidth/height\n      // If component has display:none, offset will return 0\n      // TODO: handle display:none and no dimension style using px\n      return parseInt(this.el_['offset' + toTitleCase(widthOrHeight)], 10);\n    };\n\n    /**\n     * Get the width or the height of the `Component` elements computed style. Uses\n     * `window.getComputedStyle`.\n     *\n     * @param {string} widthOrHeight\n     *        A string containing 'width' or 'height'. Whichever one you want to get.\n     *\n     * @return {number}\n     *         The dimension that gets asked for or 0 if nothing was set\n     *         for that dimension.\n     */\n\n\n    Component.prototype.currentDimension = function currentDimension(widthOrHeight) {\n      var computedWidthOrHeight = 0;\n\n      if (widthOrHeight !== 'width' && widthOrHeight !== 'height') {\n        throw new Error('currentDimension only accepts width or height value');\n      }\n\n      if (typeof window_1.getComputedStyle === 'function') {\n        var computedStyle = window_1.getComputedStyle(this.el_);\n\n        computedWidthOrHeight = computedStyle.getPropertyValue(widthOrHeight) || computedStyle[widthOrHeight];\n      }\n\n      // remove 'px' from variable and parse as integer\n      computedWidthOrHeight = parseFloat(computedWidthOrHeight);\n\n      // if the computed value is still 0, it's possible that the browser is lying\n      // and we want to check the offset values.\n      // This code also runs wherever getComputedStyle doesn't exist.\n      if (computedWidthOrHeight === 0) {\n        var rule = 'offset' + toTitleCase(widthOrHeight);\n\n        computedWidthOrHeight = this.el_[rule];\n      }\n\n      return computedWidthOrHeight;\n    };\n\n    /**\n     * An object that contains width and height values of the `Component`s\n     * computed style. Uses `window.getComputedStyle`.\n     *\n     * @typedef {Object} Component~DimensionObject\n     *\n     * @property {number} width\n     *           The width of the `Component`s computed style.\n     *\n     * @property {number} height\n     *           The height of the `Component`s computed style.\n     */\n\n    /**\n     * Get an object that contains width and height values of the `Component`s\n     * computed style.\n     *\n     * @return {Component~DimensionObject}\n     *         The dimensions of the components element\n     */\n\n\n    Component.prototype.currentDimensions = function currentDimensions() {\n      return {\n        width: this.currentDimension('width'),\n        height: this.currentDimension('height')\n      };\n    };\n\n    /**\n     * Get the width of the `Component`s computed style. Uses `window.getComputedStyle`.\n     *\n     * @return {number} width\n     *           The width of the `Component`s computed style.\n     */\n\n\n    Component.prototype.currentWidth = function currentWidth() {\n      return this.currentDimension('width');\n    };\n\n    /**\n     * Get the height of the `Component`s computed style. Uses `window.getComputedStyle`.\n     *\n     * @return {number} height\n     *           The height of the `Component`s computed style.\n     */\n\n\n    Component.prototype.currentHeight = function currentHeight() {\n      return this.currentDimension('height');\n    };\n\n    /**\n     * Set the focus to this component\n     */\n\n\n    Component.prototype.focus = function focus() {\n      this.el_.focus();\n    };\n\n    /**\n     * Remove the focus from this component\n     */\n\n\n    Component.prototype.blur = function blur() {\n      this.el_.blur();\n    };\n\n    /**\n     * Emit a 'tap' events when touch event support gets detected. This gets used to\n     * support toggling the controls through a tap on the video. They get enabled\n     * because every sub-component would have extra overhead otherwise.\n     *\n     * @private\n     * @fires Component#tap\n     * @listens Component#touchstart\n     * @listens Component#touchmove\n     * @listens Component#touchleave\n     * @listens Component#touchcancel\n     * @listens Component#touchend\n      */\n\n\n    Component.prototype.emitTapEvents = function emitTapEvents() {\n      // Track the start time so we can determine how long the touch lasted\n      var touchStart = 0;\n      var firstTouch = null;\n\n      // Maximum movement allowed during a touch event to still be considered a tap\n      // Other popular libs use anywhere from 2 (hammer.js) to 15,\n      // so 10 seems like a nice, round number.\n      var tapMovementThreshold = 10;\n\n      // The maximum length a touch can be while still being considered a tap\n      var touchTimeThreshold = 200;\n\n      var couldBeTap = void 0;\n\n      this.on('touchstart', function (event) {\n        // If more than one finger, don't consider treating this as a click\n        if (event.touches.length === 1) {\n          // Copy pageX/pageY from the object\n          firstTouch = {\n            pageX: event.touches[0].pageX,\n            pageY: event.touches[0].pageY\n          };\n          // Record start time so we can detect a tap vs. \"touch and hold\"\n          touchStart = new Date().getTime();\n          // Reset couldBeTap tracking\n          couldBeTap = true;\n        }\n      });\n\n      this.on('touchmove', function (event) {\n        // If more than one finger, don't consider treating this as a click\n        if (event.touches.length > 1) {\n          couldBeTap = false;\n        } else if (firstTouch) {\n          // Some devices will throw touchmoves for all but the slightest of taps.\n          // So, if we moved only a small distance, this could still be a tap\n          var xdiff = event.touches[0].pageX - firstTouch.pageX;\n          var ydiff = event.touches[0].pageY - firstTouch.pageY;\n          var touchDistance = Math.sqrt(xdiff * xdiff + ydiff * ydiff);\n\n          if (touchDistance > tapMovementThreshold) {\n            couldBeTap = false;\n          }\n        }\n      });\n\n      var noTap = function noTap() {\n        couldBeTap = false;\n      };\n\n      // TODO: Listen to the original target. http://youtu.be/DujfpXOKUp8?t=13m8s\n      this.on('touchleave', noTap);\n      this.on('touchcancel', noTap);\n\n      // When the touch ends, measure how long it took and trigger the appropriate\n      // event\n      this.on('touchend', function (event) {\n        firstTouch = null;\n        // Proceed only if the touchmove/leave/cancel event didn't happen\n        if (couldBeTap === true) {\n          // Measure how long the touch lasted\n          var touchTime = new Date().getTime() - touchStart;\n\n          // Make sure the touch was less than the threshold to be considered a tap\n          if (touchTime < touchTimeThreshold) {\n            // Don't let browser turn this into a click\n            event.preventDefault();\n            /**\n             * Triggered when a `Component` is tapped.\n             *\n             * @event Component#tap\n             * @type {EventTarget~Event}\n             */\n            this.trigger('tap');\n            // It may be good to copy the touchend event object and change the\n            // type to tap, if the other event properties aren't exact after\n            // Events.fixEvent runs (e.g. event.target)\n          }\n        }\n      });\n    };\n\n    /**\n     * This function reports user activity whenever touch events happen. This can get\n     * turned off by any sub-components that wants touch events to act another way.\n     *\n     * Report user touch activity when touch events occur. User activity gets used to\n     * determine when controls should show/hide. It is simple when it comes to mouse\n     * events, because any mouse event should show the controls. So we capture mouse\n     * events that bubble up to the player and report activity when that happens.\n     * With touch events it isn't as easy as `touchstart` and `touchend` toggle player\n     * controls. So touch events can't help us at the player level either.\n     *\n     * User activity gets checked asynchronously. So what could happen is a tap event\n     * on the video turns the controls off. Then the `touchend` event bubbles up to\n     * the player. Which, if it reported user activity, would turn the controls right\n     * back on. We also don't want to completely block touch events from bubbling up.\n     * Furthermore a `touchmove` event and anything other than a tap, should not turn\n     * controls back on.\n     *\n     * @listens Component#touchstart\n     * @listens Component#touchmove\n     * @listens Component#touchend\n     * @listens Component#touchcancel\n     */\n\n\n    Component.prototype.enableTouchActivity = function enableTouchActivity() {\n      // Don't continue if the root player doesn't support reporting user activity\n      if (!this.player() || !this.player().reportUserActivity) {\n        return;\n      }\n\n      // listener for reporting that the user is active\n      var report = bind(this.player(), this.player().reportUserActivity);\n\n      var touchHolding = void 0;\n\n      this.on('touchstart', function () {\n        report();\n        // For as long as the they are touching the device or have their mouse down,\n        // we consider them active even if they're not moving their finger or mouse.\n        // So we want to continue to update that they are active\n        this.clearInterval(touchHolding);\n        // report at the same interval as activityCheck\n        touchHolding = this.setInterval(report, 250);\n      });\n\n      var touchEnd = function touchEnd(event) {\n        report();\n        // stop the interval that maintains activity if the touch is holding\n        this.clearInterval(touchHolding);\n      };\n\n      this.on('touchmove', report);\n      this.on('touchend', touchEnd);\n      this.on('touchcancel', touchEnd);\n    };\n\n    /**\n     * A callback that has no parameters and is bound into `Component`s context.\n     *\n     * @callback Component~GenericCallback\n     * @this Component\n     */\n\n    /**\n     * Creates a function that runs after an `x` millisecond timeout. This function is a\n     * wrapper around `window.setTimeout`. There are a few reasons to use this one\n     * instead though:\n     * 1. It gets cleared via  {@link Component#clearTimeout} when\n     *    {@link Component#dispose} gets called.\n     * 2. The function callback will gets turned into a {@link Component~GenericCallback}\n     *\n     * > Note: You can use `window.clearTimeout` on the id returned by this function. This\n     *         will cause its dispose listener not to get cleaned up! Please use\n     *         {@link Component#clearTimeout} or {@link Component#dispose}.\n     *\n     * @param {Component~GenericCallback} fn\n     *        The function that will be run after `timeout`.\n     *\n     * @param {number} timeout\n     *        Timeout in milliseconds to delay before executing the specified function.\n     *\n     * @return {number}\n     *         Returns a timeout ID that gets used to identify the timeout. It can also\n     *         get used in {@link Component#clearTimeout} to clear the timeout that\n     *         was set.\n     *\n     * @listens Component#dispose\n     * @see [Similar to]{@link https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout}\n     */\n\n\n    Component.prototype.setTimeout = function setTimeout(fn, timeout) {\n      var _this2 = this;\n\n      fn = bind(this, fn);\n\n      var timeoutId = window_1.setTimeout(fn, timeout);\n      var disposeFn = function disposeFn() {\n        return _this2.clearTimeout(timeoutId);\n      };\n\n      disposeFn.guid = 'vjs-timeout-' + timeoutId;\n\n      this.on('dispose', disposeFn);\n\n      return timeoutId;\n    };\n\n    /**\n     * Clears a timeout that gets created via `window.setTimeout` or\n     * {@link Component#setTimeout}. If you set a timeout via {@link Component#setTimeout}\n     * use this function instead of `window.clearTimout`. If you don't your dispose\n     * listener will not get cleaned up until {@link Component#dispose}!\n     *\n     * @param {number} timeoutId\n     *        The id of the timeout to clear. The return value of\n     *        {@link Component#setTimeout} or `window.setTimeout`.\n     *\n     * @return {number}\n     *         Returns the timeout id that was cleared.\n     *\n     * @see [Similar to]{@link https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/clearTimeout}\n     */\n\n\n    Component.prototype.clearTimeout = function clearTimeout(timeoutId) {\n      window_1.clearTimeout(timeoutId);\n\n      var disposeFn = function disposeFn() {};\n\n      disposeFn.guid = 'vjs-timeout-' + timeoutId;\n\n      this.off('dispose', disposeFn);\n\n      return timeoutId;\n    };\n\n    /**\n     * Creates a function that gets run every `x` milliseconds. This function is a wrapper\n     * around `window.setInterval`. There are a few reasons to use this one instead though.\n     * 1. It gets cleared via  {@link Component#clearInterval} when\n     *    {@link Component#dispose} gets called.\n     * 2. The function callback will be a {@link Component~GenericCallback}\n     *\n     * @param {Component~GenericCallback} fn\n     *        The function to run every `x` seconds.\n     *\n     * @param {number} interval\n     *        Execute the specified function every `x` milliseconds.\n     *\n     * @return {number}\n     *         Returns an id that can be used to identify the interval. It can also be be used in\n     *         {@link Component#clearInterval} to clear the interval.\n     *\n     * @listens Component#dispose\n     * @see [Similar to]{@link https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setInterval}\n     */\n\n\n    Component.prototype.setInterval = function setInterval(fn, interval) {\n      var _this3 = this;\n\n      fn = bind(this, fn);\n\n      var intervalId = window_1.setInterval(fn, interval);\n\n      var disposeFn = function disposeFn() {\n        return _this3.clearInterval(intervalId);\n      };\n\n      disposeFn.guid = 'vjs-interval-' + intervalId;\n\n      this.on('dispose', disposeFn);\n\n      return intervalId;\n    };\n\n    /**\n     * Clears an interval that gets created via `window.setInterval` or\n     * {@link Component#setInterval}. If you set an inteval via {@link Component#setInterval}\n     * use this function instead of `window.clearInterval`. If you don't your dispose\n     * listener will not get cleaned up until {@link Component#dispose}!\n     *\n     * @param {number} intervalId\n     *        The id of the interval to clear. The return value of\n     *        {@link Component#setInterval} or `window.setInterval`.\n     *\n     * @return {number}\n     *         Returns the interval id that was cleared.\n     *\n     * @see [Similar to]{@link https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/clearInterval}\n     */\n\n\n    Component.prototype.clearInterval = function clearInterval(intervalId) {\n      window_1.clearInterval(intervalId);\n\n      var disposeFn = function disposeFn() {};\n\n      disposeFn.guid = 'vjs-interval-' + intervalId;\n\n      this.off('dispose', disposeFn);\n\n      return intervalId;\n    };\n\n    /**\n     * Queues up a callback to be passed to requestAnimationFrame (rAF), but\n     * with a few extra bonuses:\n     *\n     * - Supports browsers that do not support rAF by falling back to\n     *   {@link Component#setTimeout}.\n     *\n     * - The callback is turned into a {@link Component~GenericCallback} (i.e.\n     *   bound to the component).\n     *\n     * - Automatic cancellation of the rAF callback is handled if the component\n     *   is disposed before it is called.\n     *\n     * @param  {Component~GenericCallback} fn\n     *         A function that will be bound to this component and executed just\n     *         before the browser's next repaint.\n     *\n     * @return {number}\n     *         Returns an rAF ID that gets used to identify the timeout. It can\n     *         also be used in {@link Component#cancelAnimationFrame} to cancel\n     *         the animation frame callback.\n     *\n     * @listens Component#dispose\n     * @see [Similar to]{@link https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame}\n     */\n\n\n    Component.prototype.requestAnimationFrame = function requestAnimationFrame(fn) {\n      var _this4 = this;\n\n      if (this.supportsRaf_) {\n        fn = bind(this, fn);\n\n        var id = window_1.requestAnimationFrame(fn);\n        var disposeFn = function disposeFn() {\n          return _this4.cancelAnimationFrame(id);\n        };\n\n        disposeFn.guid = 'vjs-raf-' + id;\n        this.on('dispose', disposeFn);\n\n        return id;\n      }\n\n      // Fall back to using a timer.\n      return this.setTimeout(fn, 1000 / 60);\n    };\n\n    /**\n     * Cancels a queued callback passed to {@link Component#requestAnimationFrame}\n     * (rAF).\n     *\n     * If you queue an rAF callback via {@link Component#requestAnimationFrame},\n     * use this function instead of `window.cancelAnimationFrame`. If you don't,\n     * your dispose listener will not get cleaned up until {@link Component#dispose}!\n     *\n     * @param {number} id\n     *        The rAF ID to clear. The return value of {@link Component#requestAnimationFrame}.\n     *\n     * @return {number}\n     *         Returns the rAF ID that was cleared.\n     *\n     * @see [Similar to]{@link https://developer.mozilla.org/en-US/docs/Web/API/window/cancelAnimationFrame}\n     */\n\n\n    Component.prototype.cancelAnimationFrame = function cancelAnimationFrame(id) {\n      if (this.supportsRaf_) {\n        window_1.cancelAnimationFrame(id);\n\n        var disposeFn = function disposeFn() {};\n\n        disposeFn.guid = 'vjs-raf-' + id;\n\n        this.off('dispose', disposeFn);\n\n        return id;\n      }\n\n      // Fall back to using a timer.\n      return this.clearTimeout(id);\n    };\n\n    /**\n     * Register a `Component` with `videojs` given the name and the component.\n     *\n     * > NOTE: {@link Tech}s should not be registered as a `Component`. {@link Tech}s\n     *         should be registered using {@link Tech.registerTech} or\n     *         {@link videojs:videojs.registerTech}.\n     *\n     * > NOTE: This function can also be seen on videojs as\n     *         {@link videojs:videojs.registerComponent}.\n     *\n     * @param {string} name\n     *        The name of the `Component` to register.\n     *\n     * @param {Component} ComponentToRegister\n     *        The `Component` class to register.\n     *\n     * @return {Component}\n     *         The `Component` that was registered.\n     */\n\n\n    Component.registerComponent = function registerComponent(name, ComponentToRegister) {\n      if (typeof name !== 'string' || !name) {\n        throw new Error('Illegal component name, \"' + name + '\"; must be a non-empty string.');\n      }\n\n      var Tech = Component.getComponent('Tech');\n\n      // We need to make sure this check is only done if Tech has been registered.\n      var isTech = Tech && Tech.isTech(ComponentToRegister);\n      var isComp = Component === ComponentToRegister || Component.prototype.isPrototypeOf(ComponentToRegister.prototype);\n\n      if (isTech || !isComp) {\n        var reason = void 0;\n\n        if (isTech) {\n          reason = 'techs must be registered using Tech.registerTech()';\n        } else {\n          reason = 'must be a Component subclass';\n        }\n\n        throw new Error('Illegal component, \"' + name + '\"; ' + reason + '.');\n      }\n\n      name = toTitleCase(name);\n\n      if (!Component.components_) {\n        Component.components_ = {};\n      }\n\n      var Player = Component.getComponent('Player');\n\n      if (name === 'Player' && Player && Player.players) {\n        var players = Player.players;\n        var playerNames = Object.keys(players);\n\n        // If we have players that were disposed, then their name will still be\n        // in Players.players. So, we must loop through and verify that the value\n        // for each item is not null. This allows registration of the Player component\n        // after all players have been disposed or before any were created.\n        if (players && playerNames.length > 0 && playerNames.map(function (pname) {\n          return players[pname];\n        }).every(Boolean)) {\n          throw new Error('Can not register Player component after player has been created.');\n        }\n      }\n\n      Component.components_[name] = ComponentToRegister;\n\n      return ComponentToRegister;\n    };\n\n    /**\n     * Get a `Component` based on the name it was registered with.\n     *\n     * @param {string} name\n     *        The Name of the component to get.\n     *\n     * @return {Component}\n     *         The `Component` that got registered under the given name.\n     *\n     * @deprecated In `videojs` 6 this will not return `Component`s that were not\n     *             registered using {@link Component.registerComponent}. Currently we\n     *             check the global `videojs` object for a `Component` name and\n     *             return that if it exists.\n     */\n\n\n    Component.getComponent = function getComponent(name) {\n      if (!name) {\n        return;\n      }\n\n      name = toTitleCase(name);\n\n      if (Component.components_ && Component.components_[name]) {\n        return Component.components_[name];\n      }\n    };\n\n    return Component;\n  }();\n\n  /**\n   * Whether or not this component supports `requestAnimationFrame`.\n   *\n   * This is exposed primarily for testing purposes.\n   *\n   * @private\n   * @type {Boolean}\n   */\n\n\n  Component.prototype.supportsRaf_ = typeof window_1.requestAnimationFrame === 'function' && typeof window_1.cancelAnimationFrame === 'function';\n\n  Component.registerComponent('Component', Component);\n\n  /**\n   * @file browser.js\n   * @module browser\n   */\n\n  var USER_AGENT = window_1.navigator && window_1.navigator.userAgent || '';\n  var webkitVersionMap = /AppleWebKit\\/([\\d.]+)/i.exec(USER_AGENT);\n  var appleWebkitVersion = webkitVersionMap ? parseFloat(webkitVersionMap.pop()) : null;\n\n  /*\n   * Device is an iPhone\n   *\n   * @type {Boolean}\n   * @constant\n   * @private\n   */\n  var IS_IPAD = /iPad/i.test(USER_AGENT);\n\n  // The Facebook app's UIWebView identifies as both an iPhone and iPad, so\n  // to identify iPhones, we need to exclude iPads.\n  // http://artsy.github.io/blog/2012/10/18/the-perils-of-ios-user-agent-sniffing/\n  var IS_IPHONE = /iPhone/i.test(USER_AGENT) && !IS_IPAD;\n  var IS_IPOD = /iPod/i.test(USER_AGENT);\n  var IS_IOS = IS_IPHONE || IS_IPAD || IS_IPOD;\n\n  var IOS_VERSION = function () {\n    var match = USER_AGENT.match(/OS (\\d+)_/i);\n\n    if (match && match[1]) {\n      return match[1];\n    }\n    return null;\n  }();\n\n  var IS_ANDROID = /Android/i.test(USER_AGENT);\n  var ANDROID_VERSION = function () {\n    // This matches Android Major.Minor.Patch versions\n    // ANDROID_VERSION is Major.Minor as a Number, if Minor isn't available, then only Major is returned\n    var match = USER_AGENT.match(/Android (\\d+)(?:\\.(\\d+))?(?:\\.(\\d+))*/i);\n\n    if (!match) {\n      return null;\n    }\n\n    var major = match[1] && parseFloat(match[1]);\n    var minor = match[2] && parseFloat(match[2]);\n\n    if (major && minor) {\n      return parseFloat(match[1] + '.' + match[2]);\n    } else if (major) {\n      return major;\n    }\n    return null;\n  }();\n\n  var IS_NATIVE_ANDROID = IS_ANDROID && ANDROID_VERSION < 5 && appleWebkitVersion < 537;\n\n  var IS_FIREFOX = /Firefox/i.test(USER_AGENT);\n  var IS_EDGE = /Edge/i.test(USER_AGENT);\n  var IS_CHROME = !IS_EDGE && /Chrome/i.test(USER_AGENT);\n  var CHROME_VERSION = function () {\n    var match = USER_AGENT.match(/Chrome\\/(\\d+)/);\n\n    if (match && match[1]) {\n      return parseFloat(match[1]);\n    }\n    return null;\n  }();\n  var IE_VERSION = function () {\n    var result = /MSIE\\s(\\d+)\\.\\d/.exec(USER_AGENT);\n    var version = result && parseFloat(result[1]);\n\n    if (!version && /Trident\\/7.0/i.test(USER_AGENT) && /rv:11.0/.test(USER_AGENT)) {\n      // IE 11 has a different user agent string than other IE versions\n      version = 11.0;\n    }\n\n    return version;\n  }();\n\n  var IS_SAFARI = /Safari/i.test(USER_AGENT) && !IS_CHROME && !IS_ANDROID && !IS_EDGE;\n  var IS_ANY_SAFARI = IS_SAFARI || IS_IOS;\n\n  var TOUCH_ENABLED = isReal() && ('ontouchstart' in window_1 || window_1.DocumentTouch && window_1.document instanceof window_1.DocumentTouch);\n\n  var browser = /*#__PURE__*/Object.freeze({\n    IS_IPAD: IS_IPAD,\n    IS_IPHONE: IS_IPHONE,\n    IS_IPOD: IS_IPOD,\n    IS_IOS: IS_IOS,\n    IOS_VERSION: IOS_VERSION,\n    IS_ANDROID: IS_ANDROID,\n    ANDROID_VERSION: ANDROID_VERSION,\n    IS_NATIVE_ANDROID: IS_NATIVE_ANDROID,\n    IS_FIREFOX: IS_FIREFOX,\n    IS_EDGE: IS_EDGE,\n    IS_CHROME: IS_CHROME,\n    CHROME_VERSION: CHROME_VERSION,\n    IE_VERSION: IE_VERSION,\n    IS_SAFARI: IS_SAFARI,\n    IS_ANY_SAFARI: IS_ANY_SAFARI,\n    TOUCH_ENABLED: TOUCH_ENABLED\n  });\n\n  /**\n   * @file time-ranges.js\n   * @module time-ranges\n   */\n\n  /**\n   * Returns the time for the specified index at the start or end\n   * of a TimeRange object.\n   *\n   * @function time-ranges:indexFunction\n   *\n   * @param {number} [index=0]\n   *        The range number to return the time for.\n   *\n   * @return {number}\n   *         The time that offset at the specified index.\n   *\n   * @depricated index must be set to a value, in the future this will throw an error.\n   */\n\n  /**\n   * An object that contains ranges of time for various reasons.\n   *\n   * @typedef {Object} TimeRange\n   *\n   * @property {number} length\n   *           The number of time ranges represented by this Object\n   *\n   * @property {time-ranges:indexFunction} start\n   *           Returns the time offset at which a specified time range begins.\n   *\n   * @property {time-ranges:indexFunction} end\n   *           Returns the time offset at which a specified time range ends.\n   *\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/TimeRanges\n   */\n\n  /**\n   * Check if any of the time ranges are over the maximum index.\n   *\n   * @param {string} fnName\n   *        The function name to use for logging\n   *\n   * @param {number} index\n   *        The index to check\n   *\n   * @param {number} maxIndex\n   *        The maximum possible index\n   *\n   * @throws {Error} if the timeRanges provided are over the maxIndex\n   */\n  function rangeCheck(fnName, index, maxIndex) {\n    if (typeof index !== 'number' || index < 0 || index > maxIndex) {\n      throw new Error('Failed to execute \\'' + fnName + '\\' on \\'TimeRanges\\': The index provided (' + index + ') is non-numeric or out of bounds (0-' + maxIndex + ').');\n    }\n  }\n\n  /**\n   * Get the time for the specified index at the start or end\n   * of a TimeRange object.\n   *\n   * @param {string} fnName\n   *        The function name to use for logging\n   *\n   * @param {string} valueIndex\n   *        The property that should be used to get the time. should be 'start' or 'end'\n   *\n   * @param {Array} ranges\n   *        An array of time ranges\n   *\n   * @param {Array} [rangeIndex=0]\n   *        The index to start the search at\n   *\n   * @return {number}\n   *         The time that offset at the specified index.\n   *\n   *\n   * @depricated rangeIndex must be set to a value, in the future this will throw an error.\n   * @throws {Error} if rangeIndex is more than the length of ranges\n   */\n  function getRange(fnName, valueIndex, ranges, rangeIndex) {\n    rangeCheck(fnName, rangeIndex, ranges.length - 1);\n    return ranges[rangeIndex][valueIndex];\n  }\n\n  /**\n   * Create a time range object given ranges of time.\n   *\n   * @param {Array} [ranges]\n   *        An array of time ranges.\n   */\n  function createTimeRangesObj(ranges) {\n    if (ranges === undefined || ranges.length === 0) {\n      return {\n        length: 0,\n        start: function start() {\n          throw new Error('This TimeRanges object is empty');\n        },\n        end: function end() {\n          throw new Error('This TimeRanges object is empty');\n        }\n      };\n    }\n    return {\n      length: ranges.length,\n      start: getRange.bind(null, 'start', 0, ranges),\n      end: getRange.bind(null, 'end', 1, ranges)\n    };\n  }\n\n  /**\n   * Should create a fake `TimeRange` object which mimics an HTML5 time range instance.\n   *\n   * @param {number|Array} start\n   *        The start of a single range or an array of ranges\n   *\n   * @param {number} end\n   *        The end of a single range.\n   *\n   * @private\n   */\n  function createTimeRanges(start, end) {\n    if (Array.isArray(start)) {\n      return createTimeRangesObj(start);\n    } else if (start === undefined || end === undefined) {\n      return createTimeRangesObj();\n    }\n    return createTimeRangesObj([[start, end]]);\n  }\n\n  /**\n   * @file buffer.js\n   * @module buffer\n   */\n\n  /**\n   * Compute the percentage of the media that has been buffered.\n   *\n   * @param {TimeRange} buffered\n   *        The current `TimeRange` object representing buffered time ranges\n   *\n   * @param {number} duration\n   *        Total duration of the media\n   *\n   * @return {number}\n   *         Percent buffered of the total duration in decimal form.\n   */\n  function bufferedPercent(buffered, duration) {\n    var bufferedDuration = 0;\n    var start = void 0;\n    var end = void 0;\n\n    if (!duration) {\n      return 0;\n    }\n\n    if (!buffered || !buffered.length) {\n      buffered = createTimeRanges(0, 0);\n    }\n\n    for (var i = 0; i < buffered.length; i++) {\n      start = buffered.start(i);\n      end = buffered.end(i);\n\n      // buffered end can be bigger than duration by a very small fraction\n      if (end > duration) {\n        end = duration;\n      }\n\n      bufferedDuration += end - start;\n    }\n\n    return bufferedDuration / duration;\n  }\n\n  /**\n   * @file fullscreen-api.js\n   * @module fullscreen-api\n   * @private\n   */\n\n  /**\n   * Store the browser-specific methods for the fullscreen API.\n   *\n   * @type {Object}\n   * @see [Specification]{@link https://fullscreen.spec.whatwg.org}\n   * @see [Map Approach From Screenfull.js]{@link https://github.com/sindresorhus/screenfull.js}\n   */\n  var FullscreenApi = {};\n\n  // browser API methods\n  var apiMap = [['requestFullscreen', 'exitFullscreen', 'fullscreenElement', 'fullscreenEnabled', 'fullscreenchange', 'fullscreenerror'],\n  // WebKit\n  ['webkitRequestFullscreen', 'webkitExitFullscreen', 'webkitFullscreenElement', 'webkitFullscreenEnabled', 'webkitfullscreenchange', 'webkitfullscreenerror'],\n  // Old WebKit (Safari 5.1)\n  ['webkitRequestFullScreen', 'webkitCancelFullScreen', 'webkitCurrentFullScreenElement', 'webkitCancelFullScreen', 'webkitfullscreenchange', 'webkitfullscreenerror'],\n  // Mozilla\n  ['mozRequestFullScreen', 'mozCancelFullScreen', 'mozFullScreenElement', 'mozFullScreenEnabled', 'mozfullscreenchange', 'mozfullscreenerror'],\n  // Microsoft\n  ['msRequestFullscreen', 'msExitFullscreen', 'msFullscreenElement', 'msFullscreenEnabled', 'MSFullscreenChange', 'MSFullscreenError']];\n\n  var specApi = apiMap[0];\n  var browserApi = void 0;\n\n  // determine the supported set of functions\n  for (var i = 0; i < apiMap.length; i++) {\n    // check for exitFullscreen function\n    if (apiMap[i][1] in document_1) {\n      browserApi = apiMap[i];\n      break;\n    }\n  }\n\n  // map the browser API names to the spec API names\n  if (browserApi) {\n    for (var _i = 0; _i < browserApi.length; _i++) {\n      FullscreenApi[specApi[_i]] = browserApi[_i];\n    }\n  }\n\n  /**\n   * @file media-error.js\n   */\n\n  /**\n   * A Custom `MediaError` class which mimics the standard HTML5 `MediaError` class.\n   *\n   * @param {number|string|Object|MediaError} value\n   *        This can be of multiple types:\n   *        - number: should be a standard error code\n   *        - string: an error message (the code will be 0)\n   *        - Object: arbitrary properties\n   *        - `MediaError` (native): used to populate a video.js `MediaError` object\n   *        - `MediaError` (video.js): will return itself if it's already a\n   *          video.js `MediaError` object.\n   *\n   * @see [MediaError Spec]{@link https://dev.w3.org/html5/spec-author-view/video.html#mediaerror}\n   * @see [Encrypted MediaError Spec]{@link https://www.w3.org/TR/2013/WD-encrypted-media-20130510/#error-codes}\n   *\n   * @class MediaError\n   */\n  function MediaError(value) {\n\n    // Allow redundant calls to this constructor to avoid having `instanceof`\n    // checks peppered around the code.\n    if (value instanceof MediaError) {\n      return value;\n    }\n\n    if (typeof value === 'number') {\n      this.code = value;\n    } else if (typeof value === 'string') {\n      // default code is zero, so this is a custom error\n      this.message = value;\n    } else if (isObject(value)) {\n\n      // We assign the `code` property manually because native `MediaError` objects\n      // do not expose it as an own/enumerable property of the object.\n      if (typeof value.code === 'number') {\n        this.code = value.code;\n      }\n\n      assign(this, value);\n    }\n\n    if (!this.message) {\n      this.message = MediaError.defaultMessages[this.code] || '';\n    }\n  }\n\n  /**\n   * The error code that refers two one of the defined `MediaError` types\n   *\n   * @type {Number}\n   */\n  MediaError.prototype.code = 0;\n\n  /**\n   * An optional message that to show with the error. Message is not part of the HTML5\n   * video spec but allows for more informative custom errors.\n   *\n   * @type {String}\n   */\n  MediaError.prototype.message = '';\n\n  /**\n   * An optional status code that can be set by plugins to allow even more detail about\n   * the error. For example a plugin might provide a specific HTTP status code and an\n   * error message for that code. Then when the plugin gets that error this class will\n   * know how to display an error message for it. This allows a custom message to show\n   * up on the `Player` error overlay.\n   *\n   * @type {Array}\n   */\n  MediaError.prototype.status = null;\n\n  /**\n   * Errors indexed by the W3C standard. The order **CANNOT CHANGE**! See the\n   * specification listed under {@link MediaError} for more information.\n   *\n   * @enum {array}\n   * @readonly\n   * @property {string} 0 - MEDIA_ERR_CUSTOM\n   * @property {string} 1 - MEDIA_ERR_CUSTOM\n   * @property {string} 2 - MEDIA_ERR_ABORTED\n   * @property {string} 3 - MEDIA_ERR_NETWORK\n   * @property {string} 4 - MEDIA_ERR_SRC_NOT_SUPPORTED\n   * @property {string} 5 - MEDIA_ERR_ENCRYPTED\n   */\n  MediaError.errorTypes = ['MEDIA_ERR_CUSTOM', 'MEDIA_ERR_ABORTED', 'MEDIA_ERR_NETWORK', 'MEDIA_ERR_DECODE', 'MEDIA_ERR_SRC_NOT_SUPPORTED', 'MEDIA_ERR_ENCRYPTED'];\n\n  /**\n   * The default `MediaError` messages based on the {@link MediaError.errorTypes}.\n   *\n   * @type {Array}\n   * @constant\n   */\n  MediaError.defaultMessages = {\n    1: 'You aborted the media playback',\n    2: 'A network error caused the media download to fail part-way.',\n    3: 'The media playback was aborted due to a corruption problem or because the media used features your browser did not support.',\n    4: 'The media could not be loaded, either because the server or network failed or because the format is not supported.',\n    5: 'The media is encrypted and we do not have the keys to decrypt it.'\n  };\n\n  // Add types as properties on MediaError\n  // e.g. MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED = 4;\n  for (var errNum = 0; errNum < MediaError.errorTypes.length; errNum++) {\n    MediaError[MediaError.errorTypes[errNum]] = errNum;\n    // values should be accessible on both the class and instance\n    MediaError.prototype[MediaError.errorTypes[errNum]] = errNum;\n  }\n\n  var tuple = SafeParseTuple;\n\n  function SafeParseTuple(obj, reviver) {\n      var json;\n      var error = null;\n\n      try {\n          json = JSON.parse(obj, reviver);\n      } catch (err) {\n          error = err;\n      }\n\n      return [error, json];\n  }\n\n  /**\n   * Returns whether an object is `Promise`-like (i.e. has a `then` method).\n   *\n   * @param  {Object}  value\n   *         An object that may or may not be `Promise`-like.\n   *\n   * @return {Boolean}\n   *         Whether or not the object is `Promise`-like.\n   */\n  function isPromise(value) {\n    return value !== undefined && value !== null && typeof value.then === 'function';\n  }\n\n  /**\n   * Silence a Promise-like object.\n   *\n   * This is useful for avoiding non-harmful, but potentially confusing \"uncaught\n   * play promise\" rejection error messages.\n   *\n   * @param  {Object} value\n   *         An object that may or may not be `Promise`-like.\n   */\n  function silencePromise(value) {\n    if (isPromise(value)) {\n      value.then(null, function (e) {});\n    }\n  }\n\n  /**\n   * @file text-track-list-converter.js Utilities for capturing text track state and\n   * re-creating tracks based on a capture.\n   *\n   * @module text-track-list-converter\n   */\n\n  /**\n   * Examine a single {@link TextTrack} and return a JSON-compatible javascript object that\n   * represents the {@link TextTrack}'s state.\n   *\n   * @param {TextTrack} track\n   *        The text track to query.\n   *\n   * @return {Object}\n   *         A serializable javascript representation of the TextTrack.\n   * @private\n   */\n  var trackToJson_ = function trackToJson_(track) {\n    var ret = ['kind', 'label', 'language', 'id', 'inBandMetadataTrackDispatchType', 'mode', 'src'].reduce(function (acc, prop, i) {\n\n      if (track[prop]) {\n        acc[prop] = track[prop];\n      }\n\n      return acc;\n    }, {\n      cues: track.cues && Array.prototype.map.call(track.cues, function (cue) {\n        return {\n          startTime: cue.startTime,\n          endTime: cue.endTime,\n          text: cue.text,\n          id: cue.id\n        };\n      })\n    });\n\n    return ret;\n  };\n\n  /**\n   * Examine a {@link Tech} and return a JSON-compatible javascript array that represents the\n   * state of all {@link TextTrack}s currently configured. The return array is compatible with\n   * {@link text-track-list-converter:jsonToTextTracks}.\n   *\n   * @param {Tech} tech\n   *        The tech object to query\n   *\n   * @return {Array}\n   *         A serializable javascript representation of the {@link Tech}s\n   *         {@link TextTrackList}.\n   */\n  var textTracksToJson = function textTracksToJson(tech) {\n\n    var trackEls = tech.$$('track');\n\n    var trackObjs = Array.prototype.map.call(trackEls, function (t) {\n      return t.track;\n    });\n    var tracks = Array.prototype.map.call(trackEls, function (trackEl) {\n      var json = trackToJson_(trackEl.track);\n\n      if (trackEl.src) {\n        json.src = trackEl.src;\n      }\n      return json;\n    });\n\n    return tracks.concat(Array.prototype.filter.call(tech.textTracks(), function (track) {\n      return trackObjs.indexOf(track) === -1;\n    }).map(trackToJson_));\n  };\n\n  /**\n   * Create a set of remote {@link TextTrack}s on a {@link Tech} based on an array of javascript\n   * object {@link TextTrack} representations.\n   *\n   * @param {Array} json\n   *        An array of `TextTrack` representation objects, like those that would be\n   *        produced by `textTracksToJson`.\n   *\n   * @param {Tech} tech\n   *        The `Tech` to create the `TextTrack`s on.\n   */\n  var jsonToTextTracks = function jsonToTextTracks(json, tech) {\n    json.forEach(function (track) {\n      var addedTrack = tech.addRemoteTextTrack(track).track;\n\n      if (!track.src && track.cues) {\n        track.cues.forEach(function (cue) {\n          return addedTrack.addCue(cue);\n        });\n      }\n    });\n\n    return tech.textTracks();\n  };\n\n  var textTrackConverter = { textTracksToJson: textTracksToJson, jsonToTextTracks: jsonToTextTracks, trackToJson_: trackToJson_ };\n\n  /**\n   * @file modal-dialog.js\n   */\n\n  var MODAL_CLASS_NAME = 'vjs-modal-dialog';\n  var ESC = 27;\n\n  /**\n   * The `ModalDialog` displays over the video and its controls, which blocks\n   * interaction with the player until it is closed.\n   *\n   * Modal dialogs include a \"Close\" button and will close when that button\n   * is activated - or when ESC is pressed anywhere.\n   *\n   * @extends Component\n   */\n\n  var ModalDialog = function (_Component) {\n    inherits(ModalDialog, _Component);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Mixed} [options.content=undefined]\n     *        Provide customized content for this modal.\n     *\n     * @param {string} [options.description]\n     *        A text description for the modal, primarily for accessibility.\n     *\n     * @param {boolean} [options.fillAlways=false]\n     *        Normally, modals are automatically filled only the first time\n     *        they open. This tells the modal to refresh its content\n     *        every time it opens.\n     *\n     * @param {string} [options.label]\n     *        A text label for the modal, primarily for accessibility.\n     *\n     * @param {boolean} [options.temporary=true]\n     *        If `true`, the modal can only be opened once; it will be\n     *        disposed as soon as it's closed.\n     *\n     * @param {boolean} [options.uncloseable=false]\n     *        If `true`, the user will not be able to close the modal\n     *        through the UI in the normal ways. Programmatic closing is\n     *        still possible.\n     */\n    function ModalDialog(player, options) {\n      classCallCheck(this, ModalDialog);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      _this.opened_ = _this.hasBeenOpened_ = _this.hasBeenFilled_ = false;\n\n      _this.closeable(!_this.options_.uncloseable);\n      _this.content(_this.options_.content);\n\n      // Make sure the contentEl is defined AFTER any children are initialized\n      // because we only want the contents of the modal in the contentEl\n      // (not the UI elements like the close button).\n      _this.contentEl_ = createEl('div', {\n        className: MODAL_CLASS_NAME + '-content'\n      }, {\n        role: 'document'\n      });\n\n      _this.descEl_ = createEl('p', {\n        className: MODAL_CLASS_NAME + '-description vjs-control-text',\n        id: _this.el().getAttribute('aria-describedby')\n      });\n\n      textContent(_this.descEl_, _this.description());\n      _this.el_.appendChild(_this.descEl_);\n      _this.el_.appendChild(_this.contentEl_);\n      return _this;\n    }\n\n    /**\n     * Create the `ModalDialog`'s DOM element\n     *\n     * @return {Element}\n     *         The DOM element that gets created.\n     */\n\n\n    ModalDialog.prototype.createEl = function createEl$$1() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: this.buildCSSClass(),\n        tabIndex: -1\n      }, {\n        'aria-describedby': this.id() + '_description',\n        'aria-hidden': 'true',\n        'aria-label': this.label(),\n        'role': 'dialog'\n      });\n    };\n\n    ModalDialog.prototype.dispose = function dispose() {\n      this.contentEl_ = null;\n      this.descEl_ = null;\n      this.previouslyActiveEl_ = null;\n\n      _Component.prototype.dispose.call(this);\n    };\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    ModalDialog.prototype.buildCSSClass = function buildCSSClass() {\n      return MODAL_CLASS_NAME + ' vjs-hidden ' + _Component.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * Handles `keydown` events on the document, looking for ESC, which closes\n     * the modal.\n     *\n     * @param {EventTarget~Event} e\n     *        The keypress that triggered this event.\n     *\n     * @listens keydown\n     */\n\n\n    ModalDialog.prototype.handleKeyPress = function handleKeyPress(e) {\n      if (e.which === ESC && this.closeable()) {\n        this.close();\n      }\n    };\n\n    /**\n     * Returns the label string for this modal. Primarily used for accessibility.\n     *\n     * @return {string}\n     *         the localized or raw label of this modal.\n     */\n\n\n    ModalDialog.prototype.label = function label() {\n      return this.localize(this.options_.label || 'Modal Window');\n    };\n\n    /**\n     * Returns the description string for this modal. Primarily used for\n     * accessibility.\n     *\n     * @return {string}\n     *         The localized or raw description of this modal.\n     */\n\n\n    ModalDialog.prototype.description = function description() {\n      var desc = this.options_.description || this.localize('This is a modal window.');\n\n      // Append a universal closeability message if the modal is closeable.\n      if (this.closeable()) {\n        desc += ' ' + this.localize('This modal can be closed by pressing the Escape key or activating the close button.');\n      }\n\n      return desc;\n    };\n\n    /**\n     * Opens the modal.\n     *\n     * @fires ModalDialog#beforemodalopen\n     * @fires ModalDialog#modalopen\n     */\n\n\n    ModalDialog.prototype.open = function open() {\n      if (!this.opened_) {\n        var player = this.player();\n\n        /**\n          * Fired just before a `ModalDialog` is opened.\n          *\n          * @event ModalDialog#beforemodalopen\n          * @type {EventTarget~Event}\n          */\n        this.trigger('beforemodalopen');\n        this.opened_ = true;\n\n        // Fill content if the modal has never opened before and\n        // never been filled.\n        if (this.options_.fillAlways || !this.hasBeenOpened_ && !this.hasBeenFilled_) {\n          this.fill();\n        }\n\n        // If the player was playing, pause it and take note of its previously\n        // playing state.\n        this.wasPlaying_ = !player.paused();\n\n        if (this.options_.pauseOnOpen && this.wasPlaying_) {\n          player.pause();\n        }\n\n        if (this.closeable()) {\n          this.on(this.el_.ownerDocument, 'keydown', bind(this, this.handleKeyPress));\n        }\n\n        // Hide controls and note if they were enabled.\n        this.hadControls_ = player.controls();\n        player.controls(false);\n\n        this.show();\n        this.conditionalFocus_();\n        this.el().setAttribute('aria-hidden', 'false');\n\n        /**\n          * Fired just after a `ModalDialog` is opened.\n          *\n          * @event ModalDialog#modalopen\n          * @type {EventTarget~Event}\n          */\n        this.trigger('modalopen');\n        this.hasBeenOpened_ = true;\n      }\n    };\n\n    /**\n     * If the `ModalDialog` is currently open or closed.\n     *\n     * @param  {boolean} [value]\n     *         If given, it will open (`true`) or close (`false`) the modal.\n     *\n     * @return {boolean}\n     *         the current open state of the modaldialog\n     */\n\n\n    ModalDialog.prototype.opened = function opened(value) {\n      if (typeof value === 'boolean') {\n        this[value ? 'open' : 'close']();\n      }\n      return this.opened_;\n    };\n\n    /**\n     * Closes the modal, does nothing if the `ModalDialog` is\n     * not open.\n     *\n     * @fires ModalDialog#beforemodalclose\n     * @fires ModalDialog#modalclose\n     */\n\n\n    ModalDialog.prototype.close = function close() {\n      if (!this.opened_) {\n        return;\n      }\n      var player = this.player();\n\n      /**\n        * Fired just before a `ModalDialog` is closed.\n        *\n        * @event ModalDialog#beforemodalclose\n        * @type {EventTarget~Event}\n        */\n      this.trigger('beforemodalclose');\n      this.opened_ = false;\n\n      if (this.wasPlaying_ && this.options_.pauseOnOpen) {\n        player.play();\n      }\n\n      if (this.closeable()) {\n        this.off(this.el_.ownerDocument, 'keydown', bind(this, this.handleKeyPress));\n      }\n\n      if (this.hadControls_) {\n        player.controls(true);\n      }\n\n      this.hide();\n      this.el().setAttribute('aria-hidden', 'true');\n\n      /**\n        * Fired just after a `ModalDialog` is closed.\n        *\n        * @event ModalDialog#modalclose\n        * @type {EventTarget~Event}\n        */\n      this.trigger('modalclose');\n      this.conditionalBlur_();\n\n      if (this.options_.temporary) {\n        this.dispose();\n      }\n    };\n\n    /**\n     * Check to see if the `ModalDialog` is closeable via the UI.\n     *\n     * @param  {boolean} [value]\n     *         If given as a boolean, it will set the `closeable` option.\n     *\n     * @return {boolean}\n     *         Returns the final value of the closable option.\n     */\n\n\n    ModalDialog.prototype.closeable = function closeable(value) {\n      if (typeof value === 'boolean') {\n        var closeable = this.closeable_ = !!value;\n        var close = this.getChild('closeButton');\n\n        // If this is being made closeable and has no close button, add one.\n        if (closeable && !close) {\n\n          // The close button should be a child of the modal - not its\n          // content element, so temporarily change the content element.\n          var temp = this.contentEl_;\n\n          this.contentEl_ = this.el_;\n          close = this.addChild('closeButton', { controlText: 'Close Modal Dialog' });\n          this.contentEl_ = temp;\n          this.on(close, 'close', this.close);\n        }\n\n        // If this is being made uncloseable and has a close button, remove it.\n        if (!closeable && close) {\n          this.off(close, 'close', this.close);\n          this.removeChild(close);\n          close.dispose();\n        }\n      }\n      return this.closeable_;\n    };\n\n    /**\n     * Fill the modal's content element with the modal's \"content\" option.\n     * The content element will be emptied before this change takes place.\n     */\n\n\n    ModalDialog.prototype.fill = function fill() {\n      this.fillWith(this.content());\n    };\n\n    /**\n     * Fill the modal's content element with arbitrary content.\n     * The content element will be emptied before this change takes place.\n     *\n     * @fires ModalDialog#beforemodalfill\n     * @fires ModalDialog#modalfill\n     *\n     * @param {Mixed} [content]\n     *        The same rules apply to this as apply to the `content` option.\n     */\n\n\n    ModalDialog.prototype.fillWith = function fillWith(content) {\n      var contentEl = this.contentEl();\n      var parentEl = contentEl.parentNode;\n      var nextSiblingEl = contentEl.nextSibling;\n\n      /**\n       * Fired just before a `ModalDialog` is filled with content.\n       *\n       * @event ModalDialog#beforemodalfill\n       * @type {EventTarget~Event}\n       */\n      this.trigger('beforemodalfill');\n      this.hasBeenFilled_ = true;\n\n      // Detach the content element from the DOM before performing\n      // manipulation to avoid modifying the live DOM multiple times.\n      parentEl.removeChild(contentEl);\n      this.empty();\n      insertContent(contentEl, content);\n      /**\n       * Fired just after a `ModalDialog` is filled with content.\n       *\n       * @event ModalDialog#modalfill\n       * @type {EventTarget~Event}\n       */\n      this.trigger('modalfill');\n\n      // Re-inject the re-filled content element.\n      if (nextSiblingEl) {\n        parentEl.insertBefore(contentEl, nextSiblingEl);\n      } else {\n        parentEl.appendChild(contentEl);\n      }\n\n      // make sure that the close button is last in the dialog DOM\n      var closeButton = this.getChild('closeButton');\n\n      if (closeButton) {\n        parentEl.appendChild(closeButton.el_);\n      }\n    };\n\n    /**\n     * Empties the content element. This happens anytime the modal is filled.\n     *\n     * @fires ModalDialog#beforemodalempty\n     * @fires ModalDialog#modalempty\n     */\n\n\n    ModalDialog.prototype.empty = function empty() {\n      /**\n       * Fired just before a `ModalDialog` is emptied.\n       *\n       * @event ModalDialog#beforemodalempty\n       * @type {EventTarget~Event}\n       */\n      this.trigger('beforemodalempty');\n      emptyEl(this.contentEl());\n\n      /**\n       * Fired just after a `ModalDialog` is emptied.\n       *\n       * @event ModalDialog#modalempty\n       * @type {EventTarget~Event}\n       */\n      this.trigger('modalempty');\n    };\n\n    /**\n     * Gets or sets the modal content, which gets normalized before being\n     * rendered into the DOM.\n     *\n     * This does not update the DOM or fill the modal, but it is called during\n     * that process.\n     *\n     * @param  {Mixed} [value]\n     *         If defined, sets the internal content value to be used on the\n     *         next call(s) to `fill`. This value is normalized before being\n     *         inserted. To \"clear\" the internal content value, pass `null`.\n     *\n     * @return {Mixed}\n     *         The current content of the modal dialog\n     */\n\n\n    ModalDialog.prototype.content = function content(value) {\n      if (typeof value !== 'undefined') {\n        this.content_ = value;\n      }\n      return this.content_;\n    };\n\n    /**\n     * conditionally focus the modal dialog if focus was previously on the player.\n     *\n     * @private\n     */\n\n\n    ModalDialog.prototype.conditionalFocus_ = function conditionalFocus_() {\n      var activeEl = document_1.activeElement;\n      var playerEl = this.player_.el_;\n\n      this.previouslyActiveEl_ = null;\n\n      if (playerEl.contains(activeEl) || playerEl === activeEl) {\n        this.previouslyActiveEl_ = activeEl;\n\n        this.focus();\n\n        this.on(document_1, 'keydown', this.handleKeyDown);\n      }\n    };\n\n    /**\n     * conditionally blur the element and refocus the last focused element\n     *\n     * @private\n     */\n\n\n    ModalDialog.prototype.conditionalBlur_ = function conditionalBlur_() {\n      if (this.previouslyActiveEl_) {\n        this.previouslyActiveEl_.focus();\n        this.previouslyActiveEl_ = null;\n      }\n\n      this.off(document_1, 'keydown', this.handleKeyDown);\n    };\n\n    /**\n     * Keydown handler. Attached when modal is focused.\n     *\n     * @listens keydown\n     */\n\n\n    ModalDialog.prototype.handleKeyDown = function handleKeyDown(event) {\n      // exit early if it isn't a tab key\n      if (event.which !== 9) {\n        return;\n      }\n\n      var focusableEls = this.focusableEls_();\n      var activeEl = this.el_.querySelector(':focus');\n      var focusIndex = void 0;\n\n      for (var i = 0; i < focusableEls.length; i++) {\n        if (activeEl === focusableEls[i]) {\n          focusIndex = i;\n          break;\n        }\n      }\n\n      if (document_1.activeElement === this.el_) {\n        focusIndex = 0;\n      }\n\n      if (event.shiftKey && focusIndex === 0) {\n        focusableEls[focusableEls.length - 1].focus();\n        event.preventDefault();\n      } else if (!event.shiftKey && focusIndex === focusableEls.length - 1) {\n        focusableEls[0].focus();\n        event.preventDefault();\n      }\n    };\n\n    /**\n     * get all focusable elements\n     *\n     * @private\n     */\n\n\n    ModalDialog.prototype.focusableEls_ = function focusableEls_() {\n      var allChildren = this.el_.querySelectorAll('*');\n\n      return Array.prototype.filter.call(allChildren, function (child) {\n        return (child instanceof window_1.HTMLAnchorElement || child instanceof window_1.HTMLAreaElement) && child.hasAttribute('href') || (child instanceof window_1.HTMLInputElement || child instanceof window_1.HTMLSelectElement || child instanceof window_1.HTMLTextAreaElement || child instanceof window_1.HTMLButtonElement) && !child.hasAttribute('disabled') || child instanceof window_1.HTMLIFrameElement || child instanceof window_1.HTMLObjectElement || child instanceof window_1.HTMLEmbedElement || child.hasAttribute('tabindex') && child.getAttribute('tabindex') !== -1 || child.hasAttribute('contenteditable');\n      });\n    };\n\n    return ModalDialog;\n  }(Component);\n\n  /**\n   * Default options for `ModalDialog` default options.\n   *\n   * @type {Object}\n   * @private\n   */\n\n\n  ModalDialog.prototype.options_ = {\n    pauseOnOpen: true,\n    temporary: true\n  };\n\n  Component.registerComponent('ModalDialog', ModalDialog);\n\n  /**\n   * @file track-list.js\n   */\n\n  /**\n   * Common functionaliy between {@link TextTrackList}, {@link AudioTrackList}, and\n   * {@link VideoTrackList}\n   *\n   * @extends EventTarget\n   */\n\n  var TrackList = function (_EventTarget) {\n    inherits(TrackList, _EventTarget);\n\n    /**\n     * Create an instance of this class\n     *\n     * @param {Track[]} tracks\n     *        A list of tracks to initialize the list with.\n     *\n     * @abstract\n     */\n    function TrackList() {\n      var tracks = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      classCallCheck(this, TrackList);\n\n      var _this = possibleConstructorReturn(this, _EventTarget.call(this));\n\n      _this.tracks_ = [];\n\n      /**\n       * @memberof TrackList\n       * @member {number} length\n       *         The current number of `Track`s in the this Trackist.\n       * @instance\n       */\n      Object.defineProperty(_this, 'length', {\n        get: function get$$1() {\n          return this.tracks_.length;\n        }\n      });\n\n      for (var i = 0; i < tracks.length; i++) {\n        _this.addTrack(tracks[i]);\n      }\n      return _this;\n    }\n\n    /**\n     * Add a {@link Track} to the `TrackList`\n     *\n     * @param {Track} track\n     *        The audio, video, or text track to add to the list.\n     *\n     * @fires TrackList#addtrack\n     */\n\n\n    TrackList.prototype.addTrack = function addTrack(track) {\n      var index = this.tracks_.length;\n\n      if (!('' + index in this)) {\n        Object.defineProperty(this, index, {\n          get: function get$$1() {\n            return this.tracks_[index];\n          }\n        });\n      }\n\n      // Do not add duplicate tracks\n      if (this.tracks_.indexOf(track) === -1) {\n        this.tracks_.push(track);\n        /**\n         * Triggered when a track is added to a track list.\n         *\n         * @event TrackList#addtrack\n         * @type {EventTarget~Event}\n         * @property {Track} track\n         *           A reference to track that was added.\n         */\n        this.trigger({\n          track: track,\n          type: 'addtrack'\n        });\n      }\n    };\n\n    /**\n     * Remove a {@link Track} from the `TrackList`\n     *\n     * @param {Track} rtrack\n     *        The audio, video, or text track to remove from the list.\n     *\n     * @fires TrackList#removetrack\n     */\n\n\n    TrackList.prototype.removeTrack = function removeTrack(rtrack) {\n      var track = void 0;\n\n      for (var i = 0, l = this.length; i < l; i++) {\n        if (this[i] === rtrack) {\n          track = this[i];\n          if (track.off) {\n            track.off();\n          }\n\n          this.tracks_.splice(i, 1);\n\n          break;\n        }\n      }\n\n      if (!track) {\n        return;\n      }\n\n      /**\n       * Triggered when a track is removed from track list.\n       *\n       * @event TrackList#removetrack\n       * @type {EventTarget~Event}\n       * @property {Track} track\n       *           A reference to track that was removed.\n       */\n      this.trigger({\n        track: track,\n        type: 'removetrack'\n      });\n    };\n\n    /**\n     * Get a Track from the TrackList by a tracks id\n     *\n     * @param {String} id - the id of the track to get\n     * @method getTrackById\n     * @return {Track}\n     * @private\n     */\n\n\n    TrackList.prototype.getTrackById = function getTrackById(id) {\n      var result = null;\n\n      for (var i = 0, l = this.length; i < l; i++) {\n        var track = this[i];\n\n        if (track.id === id) {\n          result = track;\n          break;\n        }\n      }\n\n      return result;\n    };\n\n    return TrackList;\n  }(EventTarget);\n\n  /**\n   * Triggered when a different track is selected/enabled.\n   *\n   * @event TrackList#change\n   * @type {EventTarget~Event}\n   */\n\n  /**\n   * Events that can be called with on + eventName. See {@link EventHandler}.\n   *\n   * @property {Object} TrackList#allowedEvents_\n   * @private\n   */\n\n\n  TrackList.prototype.allowedEvents_ = {\n    change: 'change',\n    addtrack: 'addtrack',\n    removetrack: 'removetrack'\n  };\n\n  // emulate attribute EventHandler support to allow for feature detection\n  for (var event in TrackList.prototype.allowedEvents_) {\n    TrackList.prototype['on' + event] = null;\n  }\n\n  /**\n   * @file audio-track-list.js\n   */\n\n  /**\n   * Anywhere we call this function we diverge from the spec\n   * as we only support one enabled audiotrack at a time\n   *\n   * @param {AudioTrackList} list\n   *        list to work on\n   *\n   * @param {AudioTrack} track\n   *        The track to skip\n   *\n   * @private\n   */\n  var disableOthers = function disableOthers(list, track) {\n    for (var i = 0; i < list.length; i++) {\n      if (!Object.keys(list[i]).length || track.id === list[i].id) {\n        continue;\n      }\n      // another audio track is enabled, disable it\n      list[i].enabled = false;\n    }\n  };\n\n  /**\n   * The current list of {@link AudioTrack} for a media file.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#audiotracklist}\n   * @extends TrackList\n   */\n\n  var AudioTrackList = function (_TrackList) {\n    inherits(AudioTrackList, _TrackList);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {AudioTrack[]} [tracks=[]]\n     *        A list of `AudioTrack` to instantiate the list with.\n     */\n    function AudioTrackList() {\n      var tracks = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      classCallCheck(this, AudioTrackList);\n\n      // make sure only 1 track is enabled\n      // sorted from last index to first index\n      for (var i = tracks.length - 1; i >= 0; i--) {\n        if (tracks[i].enabled) {\n          disableOthers(tracks, tracks[i]);\n          break;\n        }\n      }\n\n      var _this = possibleConstructorReturn(this, _TrackList.call(this, tracks));\n\n      _this.changing_ = false;\n      return _this;\n    }\n\n    /**\n     * Add an {@link AudioTrack} to the `AudioTrackList`.\n     *\n     * @param {AudioTrack} track\n     *        The AudioTrack to add to the list\n     *\n     * @fires TrackList#addtrack\n     */\n\n\n    AudioTrackList.prototype.addTrack = function addTrack(track) {\n      var _this2 = this;\n\n      if (track.enabled) {\n        disableOthers(this, track);\n      }\n\n      _TrackList.prototype.addTrack.call(this, track);\n      // native tracks don't have this\n      if (!track.addEventListener) {\n        return;\n      }\n\n      /**\n       * @listens AudioTrack#enabledchange\n       * @fires TrackList#change\n       */\n      track.addEventListener('enabledchange', function () {\n        // when we are disabling other tracks (since we don't support\n        // more than one track at a time) we will set changing_\n        // to true so that we don't trigger additional change events\n        if (_this2.changing_) {\n          return;\n        }\n        _this2.changing_ = true;\n        disableOthers(_this2, track);\n        _this2.changing_ = false;\n        _this2.trigger('change');\n      });\n    };\n\n    return AudioTrackList;\n  }(TrackList);\n\n  /**\n   * @file video-track-list.js\n   */\n\n  /**\n   * Un-select all other {@link VideoTrack}s that are selected.\n   *\n   * @param {VideoTrackList} list\n   *        list to work on\n   *\n   * @param {VideoTrack} track\n   *        The track to skip\n   *\n   * @private\n   */\n  var disableOthers$1 = function disableOthers(list, track) {\n    for (var i = 0; i < list.length; i++) {\n      if (!Object.keys(list[i]).length || track.id === list[i].id) {\n        continue;\n      }\n      // another video track is enabled, disable it\n      list[i].selected = false;\n    }\n  };\n\n  /**\n   * The current list of {@link VideoTrack} for a video.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#videotracklist}\n   * @extends TrackList\n   */\n\n  var VideoTrackList = function (_TrackList) {\n    inherits(VideoTrackList, _TrackList);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {VideoTrack[]} [tracks=[]]\n     *        A list of `VideoTrack` to instantiate the list with.\n     */\n    function VideoTrackList() {\n      var tracks = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      classCallCheck(this, VideoTrackList);\n\n      // make sure only 1 track is enabled\n      // sorted from last index to first index\n      for (var i = tracks.length - 1; i >= 0; i--) {\n        if (tracks[i].selected) {\n          disableOthers$1(tracks, tracks[i]);\n          break;\n        }\n      }\n\n      var _this = possibleConstructorReturn(this, _TrackList.call(this, tracks));\n\n      _this.changing_ = false;\n\n      /**\n       * @member {number} VideoTrackList#selectedIndex\n       *         The current index of the selected {@link VideoTrack`}.\n       */\n      Object.defineProperty(_this, 'selectedIndex', {\n        get: function get$$1() {\n          for (var _i = 0; _i < this.length; _i++) {\n            if (this[_i].selected) {\n              return _i;\n            }\n          }\n          return -1;\n        },\n        set: function set$$1() {}\n      });\n      return _this;\n    }\n\n    /**\n     * Add a {@link VideoTrack} to the `VideoTrackList`.\n     *\n     * @param {VideoTrack} track\n     *        The VideoTrack to add to the list\n     *\n     * @fires TrackList#addtrack\n     */\n\n\n    VideoTrackList.prototype.addTrack = function addTrack(track) {\n      var _this2 = this;\n\n      if (track.selected) {\n        disableOthers$1(this, track);\n      }\n\n      _TrackList.prototype.addTrack.call(this, track);\n      // native tracks don't have this\n      if (!track.addEventListener) {\n        return;\n      }\n\n      /**\n       * @listens VideoTrack#selectedchange\n       * @fires TrackList#change\n       */\n      track.addEventListener('selectedchange', function () {\n        if (_this2.changing_) {\n          return;\n        }\n        _this2.changing_ = true;\n        disableOthers$1(_this2, track);\n        _this2.changing_ = false;\n        _this2.trigger('change');\n      });\n    };\n\n    return VideoTrackList;\n  }(TrackList);\n\n  /**\n   * @file text-track-list.js\n   */\n\n  /**\n   * The current list of {@link TextTrack} for a media file.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#texttracklist}\n   * @extends TrackList\n   */\n\n  var TextTrackList = function (_TrackList) {\n    inherits(TextTrackList, _TrackList);\n\n    function TextTrackList() {\n      classCallCheck(this, TextTrackList);\n      return possibleConstructorReturn(this, _TrackList.apply(this, arguments));\n    }\n\n    /**\n     * Add a {@link TextTrack} to the `TextTrackList`\n     *\n     * @param {TextTrack} track\n     *        The text track to add to the list.\n     *\n     * @fires TrackList#addtrack\n     */\n    TextTrackList.prototype.addTrack = function addTrack(track) {\n      _TrackList.prototype.addTrack.call(this, track);\n\n      /**\n       * @listens TextTrack#modechange\n       * @fires TrackList#change\n       */\n      track.addEventListener('modechange', bind(this, function () {\n        this.trigger('change');\n      }));\n\n      var nonLanguageTextTrackKind = ['metadata', 'chapters'];\n\n      if (nonLanguageTextTrackKind.indexOf(track.kind) === -1) {\n        track.addEventListener('modechange', bind(this, function () {\n          this.trigger('selectedlanguagechange');\n        }));\n      }\n    };\n\n    return TextTrackList;\n  }(TrackList);\n\n  /**\n   * @file html-track-element-list.js\n   */\n\n  /**\n   * The current list of {@link HtmlTrackElement}s.\n   */\n  var HtmlTrackElementList = function () {\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {HtmlTrackElement[]} [tracks=[]]\n     *        A list of `HtmlTrackElement` to instantiate the list with.\n     */\n    function HtmlTrackElementList() {\n      var trackElements = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      classCallCheck(this, HtmlTrackElementList);\n\n      this.trackElements_ = [];\n\n      /**\n       * @memberof HtmlTrackElementList\n       * @member {number} length\n       *         The current number of `Track`s in the this Trackist.\n       * @instance\n       */\n      Object.defineProperty(this, 'length', {\n        get: function get$$1() {\n          return this.trackElements_.length;\n        }\n      });\n\n      for (var i = 0, length = trackElements.length; i < length; i++) {\n        this.addTrackElement_(trackElements[i]);\n      }\n    }\n\n    /**\n     * Add an {@link HtmlTrackElement} to the `HtmlTrackElementList`\n     *\n     * @param {HtmlTrackElement} trackElement\n     *        The track element to add to the list.\n     *\n     * @private\n     */\n\n\n    HtmlTrackElementList.prototype.addTrackElement_ = function addTrackElement_(trackElement) {\n      var index = this.trackElements_.length;\n\n      if (!('' + index in this)) {\n        Object.defineProperty(this, index, {\n          get: function get$$1() {\n            return this.trackElements_[index];\n          }\n        });\n      }\n\n      // Do not add duplicate elements\n      if (this.trackElements_.indexOf(trackElement) === -1) {\n        this.trackElements_.push(trackElement);\n      }\n    };\n\n    /**\n     * Get an {@link HtmlTrackElement} from the `HtmlTrackElementList` given an\n     * {@link TextTrack}.\n     *\n     * @param {TextTrack} track\n     *        The track associated with a track element.\n     *\n     * @return {HtmlTrackElement|undefined}\n     *         The track element that was found or undefined.\n     *\n     * @private\n     */\n\n\n    HtmlTrackElementList.prototype.getTrackElementByTrack_ = function getTrackElementByTrack_(track) {\n      var trackElement_ = void 0;\n\n      for (var i = 0, length = this.trackElements_.length; i < length; i++) {\n        if (track === this.trackElements_[i].track) {\n          trackElement_ = this.trackElements_[i];\n\n          break;\n        }\n      }\n\n      return trackElement_;\n    };\n\n    /**\n     * Remove a {@link HtmlTrackElement} from the `HtmlTrackElementList`\n     *\n     * @param {HtmlTrackElement} trackElement\n     *        The track element to remove from the list.\n     *\n     * @private\n     */\n\n\n    HtmlTrackElementList.prototype.removeTrackElement_ = function removeTrackElement_(trackElement) {\n      for (var i = 0, length = this.trackElements_.length; i < length; i++) {\n        if (trackElement === this.trackElements_[i]) {\n          this.trackElements_.splice(i, 1);\n\n          break;\n        }\n      }\n    };\n\n    return HtmlTrackElementList;\n  }();\n\n  /**\n   * @file text-track-cue-list.js\n   */\n\n  /**\n   * @typedef {Object} TextTrackCueList~TextTrackCue\n   *\n   * @property {string} id\n   *           The unique id for this text track cue\n   *\n   * @property {number} startTime\n   *           The start time for this text track cue\n   *\n   * @property {number} endTime\n   *           The end time for this text track cue\n   *\n   * @property {boolean} pauseOnExit\n   *           Pause when the end time is reached if true.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#texttrackcue}\n   */\n\n  /**\n   * A List of TextTrackCues.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#texttrackcuelist}\n   */\n  var TextTrackCueList = function () {\n\n    /**\n     * Create an instance of this class..\n     *\n     * @param {Array} cues\n     *        A list of cues to be initialized with\n     */\n    function TextTrackCueList(cues) {\n      classCallCheck(this, TextTrackCueList);\n\n      TextTrackCueList.prototype.setCues_.call(this, cues);\n\n      /**\n       * @memberof TextTrackCueList\n       * @member {number} length\n       *         The current number of `TextTrackCue`s in the TextTrackCueList.\n       * @instance\n       */\n      Object.defineProperty(this, 'length', {\n        get: function get$$1() {\n          return this.length_;\n        }\n      });\n    }\n\n    /**\n     * A setter for cues in this list. Creates getters\n     * an an index for the cues.\n     *\n     * @param {Array} cues\n     *        An array of cues to set\n     *\n     * @private\n     */\n\n\n    TextTrackCueList.prototype.setCues_ = function setCues_(cues) {\n      var oldLength = this.length || 0;\n      var i = 0;\n      var l = cues.length;\n\n      this.cues_ = cues;\n      this.length_ = cues.length;\n\n      var defineProp = function defineProp(index) {\n        if (!('' + index in this)) {\n          Object.defineProperty(this, '' + index, {\n            get: function get$$1() {\n              return this.cues_[index];\n            }\n          });\n        }\n      };\n\n      if (oldLength < l) {\n        i = oldLength;\n\n        for (; i < l; i++) {\n          defineProp.call(this, i);\n        }\n      }\n    };\n\n    /**\n     * Get a `TextTrackCue` that is currently in the `TextTrackCueList` by id.\n     *\n     * @param {string} id\n     *        The id of the cue that should be searched for.\n     *\n     * @return {TextTrackCueList~TextTrackCue|null}\n     *         A single cue or null if none was found.\n     */\n\n\n    TextTrackCueList.prototype.getCueById = function getCueById(id) {\n      var result = null;\n\n      for (var i = 0, l = this.length; i < l; i++) {\n        var cue = this[i];\n\n        if (cue.id === id) {\n          result = cue;\n          break;\n        }\n      }\n\n      return result;\n    };\n\n    return TextTrackCueList;\n  }();\n\n  /**\n   * @file track-kinds.js\n   */\n\n  /**\n   * All possible `VideoTrackKind`s\n   *\n   * @see https://html.spec.whatwg.org/multipage/embedded-content.html#dom-videotrack-kind\n   * @typedef VideoTrack~Kind\n   * @enum\n   */\n  var VideoTrackKind = {\n    alternative: 'alternative',\n    captions: 'captions',\n    main: 'main',\n    sign: 'sign',\n    subtitles: 'subtitles',\n    commentary: 'commentary'\n  };\n\n  /**\n   * All possible `AudioTrackKind`s\n   *\n   * @see https://html.spec.whatwg.org/multipage/embedded-content.html#dom-audiotrack-kind\n   * @typedef AudioTrack~Kind\n   * @enum\n   */\n  var AudioTrackKind = {\n    'alternative': 'alternative',\n    'descriptions': 'descriptions',\n    'main': 'main',\n    'main-desc': 'main-desc',\n    'translation': 'translation',\n    'commentary': 'commentary'\n  };\n\n  /**\n   * All possible `TextTrackKind`s\n   *\n   * @see https://html.spec.whatwg.org/multipage/embedded-content.html#dom-texttrack-kind\n   * @typedef TextTrack~Kind\n   * @enum\n   */\n  var TextTrackKind = {\n    subtitles: 'subtitles',\n    captions: 'captions',\n    descriptions: 'descriptions',\n    chapters: 'chapters',\n    metadata: 'metadata'\n  };\n\n  /**\n   * All possible `TextTrackMode`s\n   *\n   * @see https://html.spec.whatwg.org/multipage/embedded-content.html#texttrackmode\n   * @typedef TextTrack~Mode\n   * @enum\n   */\n  var TextTrackMode = {\n    disabled: 'disabled',\n    hidden: 'hidden',\n    showing: 'showing'\n  };\n\n  /**\n   * @file track.js\n   */\n\n  /**\n   * A Track class that contains all of the common functionality for {@link AudioTrack},\n   * {@link VideoTrack}, and {@link TextTrack}.\n   *\n   * > Note: This class should not be used directly\n   *\n   * @see {@link https://html.spec.whatwg.org/multipage/embedded-content.html}\n   * @extends EventTarget\n   * @abstract\n   */\n\n  var Track = function (_EventTarget) {\n    inherits(Track, _EventTarget);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Object} [options={}]\n     *        Object of option names and values\n     *\n     * @param {string} [options.kind='']\n     *        A valid kind for the track type you are creating.\n     *\n     * @param {string} [options.id='vjs_track_' + Guid.newGUID()]\n     *        A unique id for this AudioTrack.\n     *\n     * @param {string} [options.label='']\n     *        The menu label for this track.\n     *\n     * @param {string} [options.language='']\n     *        A valid two character language code.\n     *\n     * @abstract\n     */\n    function Track() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      classCallCheck(this, Track);\n\n      var _this = possibleConstructorReturn(this, _EventTarget.call(this));\n\n      var trackProps = {\n        id: options.id || 'vjs_track_' + newGUID(),\n        kind: options.kind || '',\n        label: options.label || '',\n        language: options.language || ''\n      };\n\n      /**\n       * @memberof Track\n       * @member {string} id\n       *         The id of this track. Cannot be changed after creation.\n       * @instance\n       *\n       * @readonly\n       */\n\n      /**\n       * @memberof Track\n       * @member {string} kind\n       *         The kind of track that this is. Cannot be changed after creation.\n       * @instance\n       *\n       * @readonly\n       */\n\n      /**\n       * @memberof Track\n       * @member {string} label\n       *         The label of this track. Cannot be changed after creation.\n       * @instance\n       *\n       * @readonly\n       */\n\n      /**\n       * @memberof Track\n       * @member {string} language\n       *         The two letter language code for this track. Cannot be changed after\n       *         creation.\n       * @instance\n       *\n       * @readonly\n       */\n\n      var _loop = function _loop(key) {\n        Object.defineProperty(_this, key, {\n          get: function get$$1() {\n            return trackProps[key];\n          },\n          set: function set$$1() {}\n        });\n      };\n\n      for (var key in trackProps) {\n        _loop(key);\n      }\n      return _this;\n    }\n\n    return Track;\n  }(EventTarget);\n\n  /**\n   * @file url.js\n   * @module url\n   */\n\n  /**\n   * @typedef {Object} url:URLObject\n   *\n   * @property {string} protocol\n   *           The protocol of the url that was parsed.\n   *\n   * @property {string} hostname\n   *           The hostname of the url that was parsed.\n   *\n   * @property {string} port\n   *           The port of the url that was parsed.\n   *\n   * @property {string} pathname\n   *           The pathname of the url that was parsed.\n   *\n   * @property {string} search\n   *           The search query of the url that was parsed.\n   *\n   * @property {string} hash\n   *           The hash of the url that was parsed.\n   *\n   * @property {string} host\n   *           The host of the url that was parsed.\n   */\n\n  /**\n   * Resolve and parse the elements of a URL.\n   *\n   * @param  {String} url\n   *         The url to parse\n   *\n   * @return {url:URLObject}\n   *         An object of url details\n   */\n  var parseUrl = function parseUrl(url) {\n    var props = ['protocol', 'hostname', 'port', 'pathname', 'search', 'hash', 'host'];\n\n    // add the url to an anchor and let the browser parse the URL\n    var a = document_1.createElement('a');\n\n    a.href = url;\n\n    // IE8 (and 9?) Fix\n    // ie8 doesn't parse the URL correctly until the anchor is actually\n    // added to the body, and an innerHTML is needed to trigger the parsing\n    var addToBody = a.host === '' && a.protocol !== 'file:';\n    var div = void 0;\n\n    if (addToBody) {\n      div = document_1.createElement('div');\n      div.innerHTML = '<a href=\"' + url + '\"></a>';\n      a = div.firstChild;\n      // prevent the div from affecting layout\n      div.setAttribute('style', 'display:none; position:absolute;');\n      document_1.body.appendChild(div);\n    }\n\n    // Copy the specific URL properties to a new object\n    // This is also needed for IE8 because the anchor loses its\n    // properties when it's removed from the dom\n    var details = {};\n\n    for (var i = 0; i < props.length; i++) {\n      details[props[i]] = a[props[i]];\n    }\n\n    // IE9 adds the port to the host property unlike everyone else. If\n    // a port identifier is added for standard ports, strip it.\n    if (details.protocol === 'http:') {\n      details.host = details.host.replace(/:80$/, '');\n    }\n\n    if (details.protocol === 'https:') {\n      details.host = details.host.replace(/:443$/, '');\n    }\n\n    if (!details.protocol) {\n      details.protocol = window_1.location.protocol;\n    }\n\n    if (addToBody) {\n      document_1.body.removeChild(div);\n    }\n\n    return details;\n  };\n\n  /**\n   * Get absolute version of relative URL. Used to tell flash correct URL.\n   *\n   *\n   * @param  {string} url\n   *         URL to make absolute\n   *\n   * @return {string}\n   *         Absolute URL\n   *\n   * @see http://stackoverflow.com/questions/470832/getting-an-absolute-url-from-a-relative-one-ie6-issue\n   */\n  var getAbsoluteURL = function getAbsoluteURL(url) {\n    // Check if absolute URL\n    if (!url.match(/^https?:\\/\\//)) {\n      // Convert to absolute URL. Flash hosted off-site needs an absolute URL.\n      var div = document_1.createElement('div');\n\n      div.innerHTML = '<a href=\"' + url + '\">x</a>';\n      url = div.firstChild.href;\n    }\n\n    return url;\n  };\n\n  /**\n   * Returns the extension of the passed file name. It will return an empty string\n   * if passed an invalid path.\n   *\n   * @param {string} path\n   *        The fileName path like '/path/to/file.mp4'\n   *\n   * @returns {string}\n   *          The extension in lower case or an empty string if no\n   *          extension could be found.\n   */\n  var getFileExtension = function getFileExtension(path) {\n    if (typeof path === 'string') {\n      var splitPathRe = /^(\\/?)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?)(\\.([^\\.\\/\\?]+)))(?:[\\/]*|[\\?].*)$/i;\n      var pathParts = splitPathRe.exec(path);\n\n      if (pathParts) {\n        return pathParts.pop().toLowerCase();\n      }\n    }\n\n    return '';\n  };\n\n  /**\n   * Returns whether the url passed is a cross domain request or not.\n   *\n   * @param {string} url\n   *        The url to check.\n   *\n   * @return {boolean}\n   *         Whether it is a cross domain request or not.\n   */\n  var isCrossOrigin = function isCrossOrigin(url) {\n    var winLoc = window_1.location;\n    var urlInfo = parseUrl(url);\n\n    // IE8 protocol relative urls will return ':' for protocol\n    var srcProtocol = urlInfo.protocol === ':' ? winLoc.protocol : urlInfo.protocol;\n\n    // Check if url is for another domain/origin\n    // IE8 doesn't know location.origin, so we won't rely on it here\n    var crossOrigin = srcProtocol + urlInfo.host !== winLoc.protocol + winLoc.host;\n\n    return crossOrigin;\n  };\n\n  var Url = /*#__PURE__*/Object.freeze({\n    parseUrl: parseUrl,\n    getAbsoluteURL: getAbsoluteURL,\n    getFileExtension: getFileExtension,\n    isCrossOrigin: isCrossOrigin\n  });\n\n  var isFunction_1 = isFunction;\n\n  var toString$1 = Object.prototype.toString;\n\n  function isFunction(fn) {\n    var string = toString$1.call(fn);\n    return string === '[object Function]' || typeof fn === 'function' && string !== '[object RegExp]' || typeof window !== 'undefined' && (\n    // IE8 and below\n    fn === window.setTimeout || fn === window.alert || fn === window.confirm || fn === window.prompt);\n  }\n\n  var isFunction$1 = /*#__PURE__*/Object.freeze({\n    default: isFunction_1,\n    __moduleExports: isFunction_1\n  });\n\n  var trim_1 = createCommonjsModule(function (module, exports) {\n    exports = module.exports = trim;\n\n    function trim(str) {\n      return str.replace(/^\\s*|\\s*$/g, '');\n    }\n\n    exports.left = function (str) {\n      return str.replace(/^\\s*/, '');\n    };\n\n    exports.right = function (str) {\n      return str.replace(/\\s*$/, '');\n    };\n  });\n  var trim_2 = trim_1.left;\n  var trim_3 = trim_1.right;\n\n  var trim = /*#__PURE__*/Object.freeze({\n    default: trim_1,\n    __moduleExports: trim_1,\n    left: trim_2,\n    right: trim_3\n  });\n\n  var isFunction$2 = ( isFunction$1 && isFunction_1 ) || isFunction$1;\n\n  var forEach_1 = forEach;\n\n  var toString$2 = Object.prototype.toString;\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n  function forEach(list, iterator, context) {\n      if (!isFunction$2(iterator)) {\n          throw new TypeError('iterator must be a function');\n      }\n\n      if (arguments.length < 3) {\n          context = this;\n      }\n\n      if (toString$2.call(list) === '[object Array]') forEachArray(list, iterator, context);else if (typeof list === 'string') forEachString(list, iterator, context);else forEachObject(list, iterator, context);\n  }\n\n  function forEachArray(array, iterator, context) {\n      for (var i = 0, len = array.length; i < len; i++) {\n          if (hasOwnProperty.call(array, i)) {\n              iterator.call(context, array[i], i, array);\n          }\n      }\n  }\n\n  function forEachString(string, iterator, context) {\n      for (var i = 0, len = string.length; i < len; i++) {\n          // no such thing as a sparse string.\n          iterator.call(context, string.charAt(i), i, string);\n      }\n  }\n\n  function forEachObject(object, iterator, context) {\n      for (var k in object) {\n          if (hasOwnProperty.call(object, k)) {\n              iterator.call(context, object[k], k, object);\n          }\n      }\n  }\n\n  var forEach$1 = /*#__PURE__*/Object.freeze({\n    default: forEach_1,\n    __moduleExports: forEach_1\n  });\n\n  var trim$1 = ( trim && trim_1 ) || trim;\n\n  var forEach$2 = ( forEach$1 && forEach_1 ) || forEach$1;\n\n  var isArray = function isArray(arg) {\n    return Object.prototype.toString.call(arg) === '[object Array]';\n  };\n\n  var parseHeaders = function parseHeaders(headers) {\n    if (!headers) return {};\n\n    var result = {};\n\n    forEach$2(trim$1(headers).split('\\n'), function (row) {\n      var index = row.indexOf(':'),\n          key = trim$1(row.slice(0, index)).toLowerCase(),\n          value = trim$1(row.slice(index + 1));\n\n      if (typeof result[key] === 'undefined') {\n        result[key] = value;\n      } else if (isArray(result[key])) {\n        result[key].push(value);\n      } else {\n        result[key] = [result[key], value];\n      }\n    });\n\n    return result;\n  };\n\n  var parseHeaders$1 = /*#__PURE__*/Object.freeze({\n    default: parseHeaders,\n    __moduleExports: parseHeaders\n  });\n\n  var immutable = extend;\n\n  var hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\n  function extend() {\n      var target = {};\n\n      for (var i = 0; i < arguments.length; i++) {\n          var source = arguments[i];\n\n          for (var key in source) {\n              if (hasOwnProperty$1.call(source, key)) {\n                  target[key] = source[key];\n              }\n          }\n      }\n\n      return target;\n  }\n\n  var immutable$1 = /*#__PURE__*/Object.freeze({\n    default: immutable,\n    __moduleExports: immutable\n  });\n\n  var parseHeaders$2 = ( parseHeaders$1 && parseHeaders ) || parseHeaders$1;\n\n  var xtend = ( immutable$1 && immutable ) || immutable$1;\n\n  var xhr = createXHR;\n  createXHR.XMLHttpRequest = window_1.XMLHttpRequest || noop;\n  createXHR.XDomainRequest = \"withCredentials\" in new createXHR.XMLHttpRequest() ? createXHR.XMLHttpRequest : window_1.XDomainRequest;\n\n  forEachArray$1([\"get\", \"put\", \"post\", \"patch\", \"head\", \"delete\"], function (method) {\n      createXHR[method === \"delete\" ? \"del\" : method] = function (uri, options, callback) {\n          options = initParams(uri, options, callback);\n          options.method = method.toUpperCase();\n          return _createXHR(options);\n      };\n  });\n\n  function forEachArray$1(array, iterator) {\n      for (var i = 0; i < array.length; i++) {\n          iterator(array[i]);\n      }\n  }\n\n  function isEmpty(obj) {\n      for (var i in obj) {\n          if (obj.hasOwnProperty(i)) return false;\n      }\n      return true;\n  }\n\n  function initParams(uri, options, callback) {\n      var params = uri;\n\n      if (isFunction$2(options)) {\n          callback = options;\n          if (typeof uri === \"string\") {\n              params = { uri: uri };\n          }\n      } else {\n          params = xtend(options, { uri: uri });\n      }\n\n      params.callback = callback;\n      return params;\n  }\n\n  function createXHR(uri, options, callback) {\n      options = initParams(uri, options, callback);\n      return _createXHR(options);\n  }\n\n  function _createXHR(options) {\n      if (typeof options.callback === \"undefined\") {\n          throw new Error(\"callback argument missing\");\n      }\n\n      var called = false;\n      var callback = function cbOnce(err, response, body) {\n          if (!called) {\n              called = true;\n              options.callback(err, response, body);\n          }\n      };\n\n      function readystatechange() {\n          if (xhr.readyState === 4) {\n              setTimeout(loadFunc, 0);\n          }\n      }\n\n      function getBody() {\n          // Chrome with requestType=blob throws errors arround when even testing access to responseText\n          var body = undefined;\n\n          if (xhr.response) {\n              body = xhr.response;\n          } else {\n              body = xhr.responseText || getXml(xhr);\n          }\n\n          if (isJson) {\n              try {\n                  body = JSON.parse(body);\n              } catch (e) {}\n          }\n\n          return body;\n      }\n\n      function errorFunc(evt) {\n          clearTimeout(timeoutTimer);\n          if (!(evt instanceof Error)) {\n              evt = new Error(\"\" + (evt || \"Unknown XMLHttpRequest Error\"));\n          }\n          evt.statusCode = 0;\n          return callback(evt, failureResponse);\n      }\n\n      // will load the data & process the response in a special response object\n      function loadFunc() {\n          if (aborted) return;\n          var status;\n          clearTimeout(timeoutTimer);\n          if (options.useXDR && xhr.status === undefined) {\n              //IE8 CORS GET successful response doesn't have a status field, but body is fine\n              status = 200;\n          } else {\n              status = xhr.status === 1223 ? 204 : xhr.status;\n          }\n          var response = failureResponse;\n          var err = null;\n\n          if (status !== 0) {\n              response = {\n                  body: getBody(),\n                  statusCode: status,\n                  method: method,\n                  headers: {},\n                  url: uri,\n                  rawRequest: xhr\n              };\n              if (xhr.getAllResponseHeaders) {\n                  //remember xhr can in fact be XDR for CORS in IE\n                  response.headers = parseHeaders$2(xhr.getAllResponseHeaders());\n              }\n          } else {\n              err = new Error(\"Internal XMLHttpRequest Error\");\n          }\n          return callback(err, response, response.body);\n      }\n\n      var xhr = options.xhr || null;\n\n      if (!xhr) {\n          if (options.cors || options.useXDR) {\n              xhr = new createXHR.XDomainRequest();\n          } else {\n              xhr = new createXHR.XMLHttpRequest();\n          }\n      }\n\n      var key;\n      var aborted;\n      var uri = xhr.url = options.uri || options.url;\n      var method = xhr.method = options.method || \"GET\";\n      var body = options.body || options.data;\n      var headers = xhr.headers = options.headers || {};\n      var sync = !!options.sync;\n      var isJson = false;\n      var timeoutTimer;\n      var failureResponse = {\n          body: undefined,\n          headers: {},\n          statusCode: 0,\n          method: method,\n          url: uri,\n          rawRequest: xhr\n      };\n\n      if (\"json\" in options && options.json !== false) {\n          isJson = true;\n          headers[\"accept\"] || headers[\"Accept\"] || (headers[\"Accept\"] = \"application/json\"); //Don't override existing accept header declared by user\n          if (method !== \"GET\" && method !== \"HEAD\") {\n              headers[\"content-type\"] || headers[\"Content-Type\"] || (headers[\"Content-Type\"] = \"application/json\"); //Don't override existing accept header declared by user\n              body = JSON.stringify(options.json === true ? body : options.json);\n          }\n      }\n\n      xhr.onreadystatechange = readystatechange;\n      xhr.onload = loadFunc;\n      xhr.onerror = errorFunc;\n      // IE9 must have onprogress be set to a unique function.\n      xhr.onprogress = function () {\n          // IE must die\n      };\n      xhr.onabort = function () {\n          aborted = true;\n      };\n      xhr.ontimeout = errorFunc;\n      xhr.open(method, uri, !sync, options.username, options.password);\n      //has to be after open\n      if (!sync) {\n          xhr.withCredentials = !!options.withCredentials;\n      }\n      // Cannot set timeout with sync request\n      // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly\n      // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent\n      if (!sync && options.timeout > 0) {\n          timeoutTimer = setTimeout(function () {\n              if (aborted) return;\n              aborted = true; //IE9 may still call readystatechange\n              xhr.abort(\"timeout\");\n              var e = new Error(\"XMLHttpRequest timeout\");\n              e.code = \"ETIMEDOUT\";\n              errorFunc(e);\n          }, options.timeout);\n      }\n\n      if (xhr.setRequestHeader) {\n          for (key in headers) {\n              if (headers.hasOwnProperty(key)) {\n                  xhr.setRequestHeader(key, headers[key]);\n              }\n          }\n      } else if (options.headers && !isEmpty(options.headers)) {\n          throw new Error(\"Headers cannot be set on an XDomainRequest object\");\n      }\n\n      if (\"responseType\" in options) {\n          xhr.responseType = options.responseType;\n      }\n\n      if (\"beforeSend\" in options && typeof options.beforeSend === \"function\") {\n          options.beforeSend(xhr);\n      }\n\n      // Microsoft Edge browser sends \"undefined\" when send is called with undefined value.\n      // XMLHttpRequest spec says to pass null as body to indicate no body\n      // See https://github.com/naugtur/xhr/issues/100.\n      xhr.send(body || null);\n\n      return xhr;\n  }\n\n  function getXml(xhr) {\n      if (xhr.responseType === \"document\") {\n          return xhr.responseXML;\n      }\n      var firefoxBugTakenEffect = xhr.responseXML && xhr.responseXML.documentElement.nodeName === \"parsererror\";\n      if (xhr.responseType === \"\" && !firefoxBugTakenEffect) {\n          return xhr.responseXML;\n      }\n\n      return null;\n  }\n\n  function noop() {}\n\n  /**\n   * @file text-track.js\n   */\n\n  /**\n   * Takes a webvtt file contents and parses it into cues\n   *\n   * @param {string} srcContent\n   *        webVTT file contents\n   *\n   * @param {TextTrack} track\n   *        TextTrack to add cues to. Cues come from the srcContent.\n   *\n   * @private\n   */\n  var parseCues = function parseCues(srcContent, track) {\n    var parser = new window_1.WebVTT.Parser(window_1, window_1.vttjs, window_1.WebVTT.StringDecoder());\n    var errors = [];\n\n    parser.oncue = function (cue) {\n      track.addCue(cue);\n    };\n\n    parser.onparsingerror = function (error) {\n      errors.push(error);\n    };\n\n    parser.onflush = function () {\n      track.trigger({\n        type: 'loadeddata',\n        target: track\n      });\n    };\n\n    parser.parse(srcContent);\n    if (errors.length > 0) {\n      if (window_1.console && window_1.console.groupCollapsed) {\n        window_1.console.groupCollapsed('Text Track parsing errors for ' + track.src);\n      }\n      errors.forEach(function (error) {\n        return log$1.error(error);\n      });\n      if (window_1.console && window_1.console.groupEnd) {\n        window_1.console.groupEnd();\n      }\n    }\n\n    parser.flush();\n  };\n\n  /**\n   * Load a `TextTrack` from a specified url.\n   *\n   * @param {string} src\n   *        Url to load track from.\n   *\n   * @param {TextTrack} track\n   *        Track to add cues to. Comes from the content at the end of `url`.\n   *\n   * @private\n   */\n  var loadTrack = function loadTrack(src, track) {\n    var opts = {\n      uri: src\n    };\n    var crossOrigin = isCrossOrigin(src);\n\n    if (crossOrigin) {\n      opts.cors = crossOrigin;\n    }\n\n    xhr(opts, bind(this, function (err, response, responseBody) {\n      if (err) {\n        return log$1.error(err, response);\n      }\n\n      track.loaded_ = true;\n\n      // Make sure that vttjs has loaded, otherwise, wait till it finished loading\n      // NOTE: this is only used for the alt/video.novtt.js build\n      if (typeof window_1.WebVTT !== 'function') {\n        if (track.tech_) {\n          var loadHandler = function loadHandler() {\n            return parseCues(responseBody, track);\n          };\n\n          track.tech_.on('vttjsloaded', loadHandler);\n          track.tech_.on('vttjserror', function () {\n            log$1.error('vttjs failed to load, stopping trying to process ' + track.src);\n            track.tech_.off('vttjsloaded', loadHandler);\n          });\n        }\n      } else {\n        parseCues(responseBody, track);\n      }\n    }));\n  };\n\n  /**\n   * A representation of a single `TextTrack`.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#texttrack}\n   * @extends Track\n   */\n\n  var TextTrack = function (_Track) {\n    inherits(TextTrack, _Track);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Object} options={}\n     *        Object of option names and values\n     *\n     * @param {Tech} options.tech\n     *        A reference to the tech that owns this TextTrack.\n     *\n     * @param {TextTrack~Kind} [options.kind='subtitles']\n     *        A valid text track kind.\n     *\n     * @param {TextTrack~Mode} [options.mode='disabled']\n     *        A valid text track mode.\n     *\n     * @param {string} [options.id='vjs_track_' + Guid.newGUID()]\n     *        A unique id for this TextTrack.\n     *\n     * @param {string} [options.label='']\n     *        The menu label for this track.\n     *\n     * @param {string} [options.language='']\n     *        A valid two character language code.\n     *\n     * @param {string} [options.srclang='']\n     *        A valid two character language code. An alternative, but deprioritized\n     *        version of `options.language`\n     *\n     * @param {string} [options.src]\n     *        A url to TextTrack cues.\n     *\n     * @param {boolean} [options.default]\n     *        If this track should default to on or off.\n     */\n    function TextTrack() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      classCallCheck(this, TextTrack);\n\n      if (!options.tech) {\n        throw new Error('A tech was not provided.');\n      }\n\n      var settings = mergeOptions(options, {\n        kind: TextTrackKind[options.kind] || 'subtitles',\n        language: options.language || options.srclang || ''\n      });\n      var mode = TextTrackMode[settings.mode] || 'disabled';\n      var default_ = settings.default;\n\n      if (settings.kind === 'metadata' || settings.kind === 'chapters') {\n        mode = 'hidden';\n      }\n\n      var _this = possibleConstructorReturn(this, _Track.call(this, settings));\n\n      _this.tech_ = settings.tech;\n\n      _this.cues_ = [];\n      _this.activeCues_ = [];\n\n      var cues = new TextTrackCueList(_this.cues_);\n      var activeCues = new TextTrackCueList(_this.activeCues_);\n      var changed = false;\n      var timeupdateHandler = bind(_this, function () {\n\n        // Accessing this.activeCues for the side-effects of updating itself\n        // due to it's nature as a getter function. Do not remove or cues will\n        // stop updating!\n        /* eslint-disable no-unused-expressions */\n        this.activeCues;\n        /* eslint-enable no-unused-expressions */\n        if (changed) {\n          this.trigger('cuechange');\n          changed = false;\n        }\n      });\n\n      if (mode !== 'disabled') {\n        _this.tech_.ready(function () {\n          _this.tech_.on('timeupdate', timeupdateHandler);\n        }, true);\n      }\n\n      Object.defineProperties(_this, {\n        /**\n         * @memberof TextTrack\n         * @member {boolean} default\n         *         If this track was set to be on or off by default. Cannot be changed after\n         *         creation.\n         * @instance\n         *\n         * @readonly\n         */\n        default: {\n          get: function get$$1() {\n            return default_;\n          },\n          set: function set$$1() {}\n        },\n\n        /**\n         * @memberof TextTrack\n         * @member {string} mode\n         *         Set the mode of this TextTrack to a valid {@link TextTrack~Mode}. Will\n         *         not be set if setting to an invalid mode.\n         * @instance\n         *\n         * @fires TextTrack#modechange\n         */\n        mode: {\n          get: function get$$1() {\n            return mode;\n          },\n          set: function set$$1(newMode) {\n            var _this2 = this;\n\n            if (!TextTrackMode[newMode]) {\n              return;\n            }\n            mode = newMode;\n            if (mode === 'showing') {\n\n              this.tech_.ready(function () {\n                _this2.tech_.on('timeupdate', timeupdateHandler);\n              }, true);\n            }\n            /**\n             * An event that fires when mode changes on this track. This allows\n             * the TextTrackList that holds this track to act accordingly.\n             *\n             * > Note: This is not part of the spec!\n             *\n             * @event TextTrack#modechange\n             * @type {EventTarget~Event}\n             */\n            this.trigger('modechange');\n          }\n        },\n\n        /**\n         * @memberof TextTrack\n         * @member {TextTrackCueList} cues\n         *         The text track cue list for this TextTrack.\n         * @instance\n         */\n        cues: {\n          get: function get$$1() {\n            if (!this.loaded_) {\n              return null;\n            }\n\n            return cues;\n          },\n          set: function set$$1() {}\n        },\n\n        /**\n         * @memberof TextTrack\n         * @member {TextTrackCueList} activeCues\n         *         The list text track cues that are currently active for this TextTrack.\n         * @instance\n         */\n        activeCues: {\n          get: function get$$1() {\n            if (!this.loaded_) {\n              return null;\n            }\n\n            // nothing to do\n            if (this.cues.length === 0) {\n              return activeCues;\n            }\n\n            var ct = this.tech_.currentTime();\n            var active = [];\n\n            for (var i = 0, l = this.cues.length; i < l; i++) {\n              var cue = this.cues[i];\n\n              if (cue.startTime <= ct && cue.endTime >= ct) {\n                active.push(cue);\n              } else if (cue.startTime === cue.endTime && cue.startTime <= ct && cue.startTime + 0.5 >= ct) {\n                active.push(cue);\n              }\n            }\n\n            changed = false;\n\n            if (active.length !== this.activeCues_.length) {\n              changed = true;\n            } else {\n              for (var _i = 0; _i < active.length; _i++) {\n                if (this.activeCues_.indexOf(active[_i]) === -1) {\n                  changed = true;\n                }\n              }\n            }\n\n            this.activeCues_ = active;\n            activeCues.setCues_(this.activeCues_);\n\n            return activeCues;\n          },\n          set: function set$$1() {}\n        }\n      });\n\n      if (settings.src) {\n        _this.src = settings.src;\n        loadTrack(settings.src, _this);\n      } else {\n        _this.loaded_ = true;\n      }\n      return _this;\n    }\n\n    /**\n     * Add a cue to the internal list of cues.\n     *\n     * @param {TextTrack~Cue} cue\n     *        The cue to add to our internal list\n     */\n\n\n    TextTrack.prototype.addCue = function addCue(originalCue) {\n      var cue = originalCue;\n\n      if (window_1.vttjs && !(originalCue instanceof window_1.vttjs.VTTCue)) {\n        cue = new window_1.vttjs.VTTCue(originalCue.startTime, originalCue.endTime, originalCue.text);\n\n        for (var prop in originalCue) {\n          if (!(prop in cue)) {\n            cue[prop] = originalCue[prop];\n          }\n        }\n\n        // make sure that `id` is copied over\n        cue.id = originalCue.id;\n        cue.originalCue_ = originalCue;\n      }\n\n      var tracks = this.tech_.textTracks();\n\n      for (var i = 0; i < tracks.length; i++) {\n        if (tracks[i] !== this) {\n          tracks[i].removeCue(cue);\n        }\n      }\n\n      this.cues_.push(cue);\n      this.cues.setCues_(this.cues_);\n    };\n\n    /**\n     * Remove a cue from our internal list\n     *\n     * @param {TextTrack~Cue} removeCue\n     *        The cue to remove from our internal list\n     */\n\n\n    TextTrack.prototype.removeCue = function removeCue(_removeCue) {\n      var i = this.cues_.length;\n\n      while (i--) {\n        var cue = this.cues_[i];\n\n        if (cue === _removeCue || cue.originalCue_ && cue.originalCue_ === _removeCue) {\n          this.cues_.splice(i, 1);\n          this.cues.setCues_(this.cues_);\n          break;\n        }\n      }\n    };\n\n    return TextTrack;\n  }(Track);\n\n  /**\n   * cuechange - One or more cues in the track have become active or stopped being active.\n   */\n\n\n  TextTrack.prototype.allowedEvents_ = {\n    cuechange: 'cuechange'\n  };\n\n  /**\n   * A representation of a single `AudioTrack`. If it is part of an {@link AudioTrackList}\n   * only one `AudioTrack` in the list will be enabled at a time.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#audiotrack}\n   * @extends Track\n   */\n\n  var AudioTrack = function (_Track) {\n    inherits(AudioTrack, _Track);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Object} [options={}]\n     *        Object of option names and values\n     *\n     * @param {AudioTrack~Kind} [options.kind='']\n     *        A valid audio track kind\n     *\n     * @param {string} [options.id='vjs_track_' + Guid.newGUID()]\n     *        A unique id for this AudioTrack.\n     *\n     * @param {string} [options.label='']\n     *        The menu label for this track.\n     *\n     * @param {string} [options.language='']\n     *        A valid two character language code.\n     *\n     * @param {boolean} [options.enabled]\n     *        If this track is the one that is currently playing. If this track is part of\n     *        an {@link AudioTrackList}, only one {@link AudioTrack} will be enabled.\n     */\n    function AudioTrack() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      classCallCheck(this, AudioTrack);\n\n      var settings = mergeOptions(options, {\n        kind: AudioTrackKind[options.kind] || ''\n      });\n\n      var _this = possibleConstructorReturn(this, _Track.call(this, settings));\n\n      var enabled = false;\n\n      /**\n       * @memberof AudioTrack\n       * @member {boolean} enabled\n       *         If this `AudioTrack` is enabled or not. When setting this will\n       *         fire {@link AudioTrack#enabledchange} if the state of enabled is changed.\n       * @instance\n       *\n       * @fires VideoTrack#selectedchange\n       */\n      Object.defineProperty(_this, 'enabled', {\n        get: function get$$1() {\n          return enabled;\n        },\n        set: function set$$1(newEnabled) {\n          // an invalid or unchanged value\n          if (typeof newEnabled !== 'boolean' || newEnabled === enabled) {\n            return;\n          }\n          enabled = newEnabled;\n\n          /**\n           * An event that fires when enabled changes on this track. This allows\n           * the AudioTrackList that holds this track to act accordingly.\n           *\n           * > Note: This is not part of the spec! Native tracks will do\n           *         this internally without an event.\n           *\n           * @event AudioTrack#enabledchange\n           * @type {EventTarget~Event}\n           */\n          this.trigger('enabledchange');\n        }\n      });\n\n      // if the user sets this track to selected then\n      // set selected to that true value otherwise\n      // we keep it false\n      if (settings.enabled) {\n        _this.enabled = settings.enabled;\n      }\n      _this.loaded_ = true;\n      return _this;\n    }\n\n    return AudioTrack;\n  }(Track);\n\n  /**\n   * A representation of a single `VideoTrack`.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#videotrack}\n   * @extends Track\n   */\n\n  var VideoTrack = function (_Track) {\n    inherits(VideoTrack, _Track);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Object} [options={}]\n     *        Object of option names and values\n     *\n     * @param {string} [options.kind='']\n     *        A valid {@link VideoTrack~Kind}\n     *\n     * @param {string} [options.id='vjs_track_' + Guid.newGUID()]\n     *        A unique id for this AudioTrack.\n     *\n     * @param {string} [options.label='']\n     *        The menu label for this track.\n     *\n     * @param {string} [options.language='']\n     *        A valid two character language code.\n     *\n     * @param {boolean} [options.selected]\n     *        If this track is the one that is currently playing.\n     */\n    function VideoTrack() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      classCallCheck(this, VideoTrack);\n\n      var settings = mergeOptions(options, {\n        kind: VideoTrackKind[options.kind] || ''\n      });\n\n      var _this = possibleConstructorReturn(this, _Track.call(this, settings));\n\n      var selected = false;\n\n      /**\n       * @memberof VideoTrack\n       * @member {boolean} selected\n       *         If this `VideoTrack` is selected or not. When setting this will\n       *         fire {@link VideoTrack#selectedchange} if the state of selected changed.\n       * @instance\n       *\n       * @fires VideoTrack#selectedchange\n       */\n      Object.defineProperty(_this, 'selected', {\n        get: function get$$1() {\n          return selected;\n        },\n        set: function set$$1(newSelected) {\n          // an invalid or unchanged value\n          if (typeof newSelected !== 'boolean' || newSelected === selected) {\n            return;\n          }\n          selected = newSelected;\n\n          /**\n           * An event that fires when selected changes on this track. This allows\n           * the VideoTrackList that holds this track to act accordingly.\n           *\n           * > Note: This is not part of the spec! Native tracks will do\n           *         this internally without an event.\n           *\n           * @event VideoTrack#selectedchange\n           * @type {EventTarget~Event}\n           */\n          this.trigger('selectedchange');\n        }\n      });\n\n      // if the user sets this track to selected then\n      // set selected to that true value otherwise\n      // we keep it false\n      if (settings.selected) {\n        _this.selected = settings.selected;\n      }\n      return _this;\n    }\n\n    return VideoTrack;\n  }(Track);\n\n  /**\n   * @file html-track-element.js\n   */\n\n  /**\n   * @memberof HTMLTrackElement\n   * @typedef {HTMLTrackElement~ReadyState}\n   * @enum {number}\n   */\n  var NONE = 0;\n  var LOADING = 1;\n  var LOADED = 2;\n  var ERROR = 3;\n\n  /**\n   * A single track represented in the DOM.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#htmltrackelement}\n   * @extends EventTarget\n   */\n\n  var HTMLTrackElement = function (_EventTarget) {\n    inherits(HTMLTrackElement, _EventTarget);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Object} options={}\n     *        Object of option names and values\n     *\n     * @param {Tech} options.tech\n     *        A reference to the tech that owns this HTMLTrackElement.\n     *\n     * @param {TextTrack~Kind} [options.kind='subtitles']\n     *        A valid text track kind.\n     *\n     * @param {TextTrack~Mode} [options.mode='disabled']\n     *        A valid text track mode.\n     *\n     * @param {string} [options.id='vjs_track_' + Guid.newGUID()]\n     *        A unique id for this TextTrack.\n     *\n     * @param {string} [options.label='']\n     *        The menu label for this track.\n     *\n     * @param {string} [options.language='']\n     *        A valid two character language code.\n     *\n     * @param {string} [options.srclang='']\n     *        A valid two character language code. An alternative, but deprioritized\n     *        vesion of `options.language`\n     *\n     * @param {string} [options.src]\n     *        A url to TextTrack cues.\n     *\n     * @param {boolean} [options.default]\n     *        If this track should default to on or off.\n     */\n    function HTMLTrackElement() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      classCallCheck(this, HTMLTrackElement);\n\n      var _this = possibleConstructorReturn(this, _EventTarget.call(this));\n\n      var readyState = void 0;\n\n      var track = new TextTrack(options);\n\n      _this.kind = track.kind;\n      _this.src = track.src;\n      _this.srclang = track.language;\n      _this.label = track.label;\n      _this.default = track.default;\n\n      Object.defineProperties(_this, {\n\n        /**\n         * @memberof HTMLTrackElement\n         * @member {HTMLTrackElement~ReadyState} readyState\n         *         The current ready state of the track element.\n         * @instance\n         */\n        readyState: {\n          get: function get$$1() {\n            return readyState;\n          }\n        },\n\n        /**\n         * @memberof HTMLTrackElement\n         * @member {TextTrack} track\n         *         The underlying TextTrack object.\n         * @instance\n         *\n         */\n        track: {\n          get: function get$$1() {\n            return track;\n          }\n        }\n      });\n\n      readyState = NONE;\n\n      /**\n       * @listens TextTrack#loadeddata\n       * @fires HTMLTrackElement#load\n       */\n      track.addEventListener('loadeddata', function () {\n        readyState = LOADED;\n\n        _this.trigger({\n          type: 'load',\n          target: _this\n        });\n      });\n      return _this;\n    }\n\n    return HTMLTrackElement;\n  }(EventTarget);\n\n  HTMLTrackElement.prototype.allowedEvents_ = {\n    load: 'load'\n  };\n\n  HTMLTrackElement.NONE = NONE;\n  HTMLTrackElement.LOADING = LOADING;\n  HTMLTrackElement.LOADED = LOADED;\n  HTMLTrackElement.ERROR = ERROR;\n\n  /*\n   * This file contains all track properties that are used in\n   * player.js, tech.js, html5.js and possibly other techs in the future.\n   */\n\n  var NORMAL = {\n    audio: {\n      ListClass: AudioTrackList,\n      TrackClass: AudioTrack,\n      capitalName: 'Audio'\n    },\n    video: {\n      ListClass: VideoTrackList,\n      TrackClass: VideoTrack,\n      capitalName: 'Video'\n    },\n    text: {\n      ListClass: TextTrackList,\n      TrackClass: TextTrack,\n      capitalName: 'Text'\n    }\n  };\n\n  Object.keys(NORMAL).forEach(function (type) {\n    NORMAL[type].getterName = type + 'Tracks';\n    NORMAL[type].privateName = type + 'Tracks_';\n  });\n\n  var REMOTE = {\n    remoteText: {\n      ListClass: TextTrackList,\n      TrackClass: TextTrack,\n      capitalName: 'RemoteText',\n      getterName: 'remoteTextTracks',\n      privateName: 'remoteTextTracks_'\n    },\n    remoteTextEl: {\n      ListClass: HtmlTrackElementList,\n      TrackClass: HTMLTrackElement,\n      capitalName: 'RemoteTextTrackEls',\n      getterName: 'remoteTextTrackEls',\n      privateName: 'remoteTextTrackEls_'\n    }\n  };\n\n  var ALL = mergeOptions(NORMAL, REMOTE);\n\n  REMOTE.names = Object.keys(REMOTE);\n  NORMAL.names = Object.keys(NORMAL);\n  ALL.names = [].concat(REMOTE.names).concat(NORMAL.names);\n\n  /**\n   * Copyright 2013 vtt.js Contributors\n   *\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *   http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */\n  /* vim: set shiftwidth=2 tabstop=2 autoindent cindent expandtab: */\n  var _objCreate = Object.create || function () {\n    function F() {}\n    return function (o) {\n      if (arguments.length !== 1) {\n        throw new Error('Object.create shim only accepts one parameter.');\n      }\n      F.prototype = o;\n      return new F();\n    };\n  }();\n\n  // Creates a new ParserError object from an errorData object. The errorData\n  // object should have default code and message properties. The default message\n  // property can be overriden by passing in a message parameter.\n  // See ParsingError.Errors below for acceptable errors.\n  function ParsingError(errorData, message) {\n    this.name = \"ParsingError\";\n    this.code = errorData.code;\n    this.message = message || errorData.message;\n  }\n  ParsingError.prototype = _objCreate(Error.prototype);\n  ParsingError.prototype.constructor = ParsingError;\n\n  // ParsingError metadata for acceptable ParsingErrors.\n  ParsingError.Errors = {\n    BadSignature: {\n      code: 0,\n      message: \"Malformed WebVTT signature.\"\n    },\n    BadTimeStamp: {\n      code: 1,\n      message: \"Malformed time stamp.\"\n    }\n  };\n\n  // Try to parse input as a time stamp.\n  function parseTimeStamp(input) {\n\n    function computeSeconds(h, m, s, f) {\n      return (h | 0) * 3600 + (m | 0) * 60 + (s | 0) + (f | 0) / 1000;\n    }\n\n    var m = input.match(/^(\\d+):(\\d{2})(:\\d{2})?\\.(\\d{3})/);\n    if (!m) {\n      return null;\n    }\n\n    if (m[3]) {\n      // Timestamp takes the form of [hours]:[minutes]:[seconds].[milliseconds]\n      return computeSeconds(m[1], m[2], m[3].replace(\":\", \"\"), m[4]);\n    } else if (m[1] > 59) {\n      // Timestamp takes the form of [hours]:[minutes].[milliseconds]\n      // First position is hours as it's over 59.\n      return computeSeconds(m[1], m[2], 0, m[4]);\n    } else {\n      // Timestamp takes the form of [minutes]:[seconds].[milliseconds]\n      return computeSeconds(0, m[1], m[2], m[4]);\n    }\n  }\n\n  // A settings object holds key/value pairs and will ignore anything but the first\n  // assignment to a specific key.\n  function Settings() {\n    this.values = _objCreate(null);\n  }\n\n  Settings.prototype = {\n    // Only accept the first assignment to any key.\n    set: function set(k, v) {\n      if (!this.get(k) && v !== \"\") {\n        this.values[k] = v;\n      }\n    },\n    // Return the value for a key, or a default value.\n    // If 'defaultKey' is passed then 'dflt' is assumed to be an object with\n    // a number of possible default values as properties where 'defaultKey' is\n    // the key of the property that will be chosen; otherwise it's assumed to be\n    // a single value.\n    get: function get(k, dflt, defaultKey) {\n      if (defaultKey) {\n        return this.has(k) ? this.values[k] : dflt[defaultKey];\n      }\n      return this.has(k) ? this.values[k] : dflt;\n    },\n    // Check whether we have a value for a key.\n    has: function has(k) {\n      return k in this.values;\n    },\n    // Accept a setting if its one of the given alternatives.\n    alt: function alt(k, v, a) {\n      for (var n = 0; n < a.length; ++n) {\n        if (v === a[n]) {\n          this.set(k, v);\n          break;\n        }\n      }\n    },\n    // Accept a setting if its a valid (signed) integer.\n    integer: function integer(k, v) {\n      if (/^-?\\d+$/.test(v)) {\n        // integer\n        this.set(k, parseInt(v, 10));\n      }\n    },\n    // Accept a setting if its a valid percentage.\n    percent: function percent(k, v) {\n      var m;\n      if (m = v.match(/^([\\d]{1,3})(\\.[\\d]*)?%$/)) {\n        v = parseFloat(v);\n        if (v >= 0 && v <= 100) {\n          this.set(k, v);\n          return true;\n        }\n      }\n      return false;\n    }\n  };\n\n  // Helper function to parse input into groups separated by 'groupDelim', and\n  // interprete each group as a key/value pair separated by 'keyValueDelim'.\n  function parseOptions(input, callback, keyValueDelim, groupDelim) {\n    var groups = groupDelim ? input.split(groupDelim) : [input];\n    for (var i in groups) {\n      if (typeof groups[i] !== \"string\") {\n        continue;\n      }\n      var kv = groups[i].split(keyValueDelim);\n      if (kv.length !== 2) {\n        continue;\n      }\n      var k = kv[0];\n      var v = kv[1];\n      callback(k, v);\n    }\n  }\n\n  function parseCue(input, cue, regionList) {\n    // Remember the original input if we need to throw an error.\n    var oInput = input;\n    // 4.1 WebVTT timestamp\n    function consumeTimeStamp() {\n      var ts = parseTimeStamp(input);\n      if (ts === null) {\n        throw new ParsingError(ParsingError.Errors.BadTimeStamp, \"Malformed timestamp: \" + oInput);\n      }\n      // Remove time stamp from input.\n      input = input.replace(/^[^\\sa-zA-Z-]+/, \"\");\n      return ts;\n    }\n\n    // 4.4.2 WebVTT cue settings\n    function consumeCueSettings(input, cue) {\n      var settings = new Settings();\n\n      parseOptions(input, function (k, v) {\n        switch (k) {\n          case \"region\":\n            // Find the last region we parsed with the same region id.\n            for (var i = regionList.length - 1; i >= 0; i--) {\n              if (regionList[i].id === v) {\n                settings.set(k, regionList[i].region);\n                break;\n              }\n            }\n            break;\n          case \"vertical\":\n            settings.alt(k, v, [\"rl\", \"lr\"]);\n            break;\n          case \"line\":\n            var vals = v.split(\",\"),\n                vals0 = vals[0];\n            settings.integer(k, vals0);\n            settings.percent(k, vals0) ? settings.set(\"snapToLines\", false) : null;\n            settings.alt(k, vals0, [\"auto\"]);\n            if (vals.length === 2) {\n              settings.alt(\"lineAlign\", vals[1], [\"start\", \"middle\", \"end\"]);\n            }\n            break;\n          case \"position\":\n            vals = v.split(\",\");\n            settings.percent(k, vals[0]);\n            if (vals.length === 2) {\n              settings.alt(\"positionAlign\", vals[1], [\"start\", \"middle\", \"end\"]);\n            }\n            break;\n          case \"size\":\n            settings.percent(k, v);\n            break;\n          case \"align\":\n            settings.alt(k, v, [\"start\", \"middle\", \"end\", \"left\", \"right\"]);\n            break;\n        }\n      }, /:/, /\\s/);\n\n      // Apply default values for any missing fields.\n      cue.region = settings.get(\"region\", null);\n      cue.vertical = settings.get(\"vertical\", \"\");\n      cue.line = settings.get(\"line\", \"auto\");\n      cue.lineAlign = settings.get(\"lineAlign\", \"start\");\n      cue.snapToLines = settings.get(\"snapToLines\", true);\n      cue.size = settings.get(\"size\", 100);\n      cue.align = settings.get(\"align\", \"middle\");\n      cue.position = settings.get(\"position\", {\n        start: 0,\n        left: 0,\n        middle: 50,\n        end: 100,\n        right: 100\n      }, cue.align);\n      cue.positionAlign = settings.get(\"positionAlign\", {\n        start: \"start\",\n        left: \"start\",\n        middle: \"middle\",\n        end: \"end\",\n        right: \"end\"\n      }, cue.align);\n    }\n\n    function skipWhitespace() {\n      input = input.replace(/^\\s+/, \"\");\n    }\n\n    // 4.1 WebVTT cue timings.\n    skipWhitespace();\n    cue.startTime = consumeTimeStamp(); // (1) collect cue start time\n    skipWhitespace();\n    if (input.substr(0, 3) !== \"-->\") {\n      // (3) next characters must match \"-->\"\n      throw new ParsingError(ParsingError.Errors.BadTimeStamp, \"Malformed time stamp (time stamps must be separated by '-->'): \" + oInput);\n    }\n    input = input.substr(3);\n    skipWhitespace();\n    cue.endTime = consumeTimeStamp(); // (5) collect cue end time\n\n    // 4.1 WebVTT cue settings list.\n    skipWhitespace();\n    consumeCueSettings(input, cue);\n  }\n\n  var ESCAPE = {\n    \"&amp;\": \"&\",\n    \"&lt;\": \"<\",\n    \"&gt;\": \">\",\n    \"&lrm;\": \"\\u200E\",\n    \"&rlm;\": \"\\u200F\",\n    \"&nbsp;\": \"\\xA0\"\n  };\n\n  var TAG_NAME = {\n    c: \"span\",\n    i: \"i\",\n    b: \"b\",\n    u: \"u\",\n    ruby: \"ruby\",\n    rt: \"rt\",\n    v: \"span\",\n    lang: \"span\"\n  };\n\n  var TAG_ANNOTATION = {\n    v: \"title\",\n    lang: \"lang\"\n  };\n\n  var NEEDS_PARENT = {\n    rt: \"ruby\"\n  };\n\n  // Parse content into a document fragment.\n  function parseContent(window, input) {\n    function nextToken() {\n      // Check for end-of-string.\n      if (!input) {\n        return null;\n      }\n\n      // Consume 'n' characters from the input.\n      function consume(result) {\n        input = input.substr(result.length);\n        return result;\n      }\n\n      var m = input.match(/^([^<]*)(<[^>]*>?)?/);\n      // If there is some text before the next tag, return it, otherwise return\n      // the tag.\n      return consume(m[1] ? m[1] : m[2]);\n    }\n\n    // Unescape a string 's'.\n    function unescape1(e) {\n      return ESCAPE[e];\n    }\n    function unescape(s) {\n      while (m = s.match(/&(amp|lt|gt|lrm|rlm|nbsp);/)) {\n        s = s.replace(m[0], unescape1);\n      }\n      return s;\n    }\n\n    function shouldAdd(current, element) {\n      return !NEEDS_PARENT[element.localName] || NEEDS_PARENT[element.localName] === current.localName;\n    }\n\n    // Create an element for this tag.\n    function createElement(type, annotation) {\n      var tagName = TAG_NAME[type];\n      if (!tagName) {\n        return null;\n      }\n      var element = window.document.createElement(tagName);\n      element.localName = tagName;\n      var name = TAG_ANNOTATION[type];\n      if (name && annotation) {\n        element[name] = annotation.trim();\n      }\n      return element;\n    }\n\n    var rootDiv = window.document.createElement(\"div\"),\n        current = rootDiv,\n        t,\n        tagStack = [];\n\n    while ((t = nextToken()) !== null) {\n      if (t[0] === '<') {\n        if (t[1] === \"/\") {\n          // If the closing tag matches, move back up to the parent node.\n          if (tagStack.length && tagStack[tagStack.length - 1] === t.substr(2).replace(\">\", \"\")) {\n            tagStack.pop();\n            current = current.parentNode;\n          }\n          // Otherwise just ignore the end tag.\n          continue;\n        }\n        var ts = parseTimeStamp(t.substr(1, t.length - 2));\n        var node;\n        if (ts) {\n          // Timestamps are lead nodes as well.\n          node = window.document.createProcessingInstruction(\"timestamp\", ts);\n          current.appendChild(node);\n          continue;\n        }\n        var m = t.match(/^<([^.\\s/0-9>]+)(\\.[^\\s\\\\>]+)?([^>\\\\]+)?(\\\\?)>?$/);\n        // If we can't parse the tag, skip to the next tag.\n        if (!m) {\n          continue;\n        }\n        // Try to construct an element, and ignore the tag if we couldn't.\n        node = createElement(m[1], m[3]);\n        if (!node) {\n          continue;\n        }\n        // Determine if the tag should be added based on the context of where it\n        // is placed in the cuetext.\n        if (!shouldAdd(current, node)) {\n          continue;\n        }\n        // Set the class list (as a list of classes, separated by space).\n        if (m[2]) {\n          node.className = m[2].substr(1).replace('.', ' ');\n        }\n        // Append the node to the current node, and enter the scope of the new\n        // node.\n        tagStack.push(m[1]);\n        current.appendChild(node);\n        current = node;\n        continue;\n      }\n\n      // Text nodes are leaf nodes.\n      current.appendChild(window.document.createTextNode(unescape(t)));\n    }\n\n    return rootDiv;\n  }\n\n  // This is a list of all the Unicode characters that have a strong\n  // right-to-left category. What this means is that these characters are\n  // written right-to-left for sure. It was generated by pulling all the strong\n  // right-to-left characters out of the Unicode data table. That table can\n  // found at: http://www.unicode.org/Public/UNIDATA/UnicodeData.txt\n  var strongRTLRanges = [[0x5be, 0x5be], [0x5c0, 0x5c0], [0x5c3, 0x5c3], [0x5c6, 0x5c6], [0x5d0, 0x5ea], [0x5f0, 0x5f4], [0x608, 0x608], [0x60b, 0x60b], [0x60d, 0x60d], [0x61b, 0x61b], [0x61e, 0x64a], [0x66d, 0x66f], [0x671, 0x6d5], [0x6e5, 0x6e6], [0x6ee, 0x6ef], [0x6fa, 0x70d], [0x70f, 0x710], [0x712, 0x72f], [0x74d, 0x7a5], [0x7b1, 0x7b1], [0x7c0, 0x7ea], [0x7f4, 0x7f5], [0x7fa, 0x7fa], [0x800, 0x815], [0x81a, 0x81a], [0x824, 0x824], [0x828, 0x828], [0x830, 0x83e], [0x840, 0x858], [0x85e, 0x85e], [0x8a0, 0x8a0], [0x8a2, 0x8ac], [0x200f, 0x200f], [0xfb1d, 0xfb1d], [0xfb1f, 0xfb28], [0xfb2a, 0xfb36], [0xfb38, 0xfb3c], [0xfb3e, 0xfb3e], [0xfb40, 0xfb41], [0xfb43, 0xfb44], [0xfb46, 0xfbc1], [0xfbd3, 0xfd3d], [0xfd50, 0xfd8f], [0xfd92, 0xfdc7], [0xfdf0, 0xfdfc], [0xfe70, 0xfe74], [0xfe76, 0xfefc], [0x10800, 0x10805], [0x10808, 0x10808], [0x1080a, 0x10835], [0x10837, 0x10838], [0x1083c, 0x1083c], [0x1083f, 0x10855], [0x10857, 0x1085f], [0x10900, 0x1091b], [0x10920, 0x10939], [0x1093f, 0x1093f], [0x10980, 0x109b7], [0x109be, 0x109bf], [0x10a00, 0x10a00], [0x10a10, 0x10a13], [0x10a15, 0x10a17], [0x10a19, 0x10a33], [0x10a40, 0x10a47], [0x10a50, 0x10a58], [0x10a60, 0x10a7f], [0x10b00, 0x10b35], [0x10b40, 0x10b55], [0x10b58, 0x10b72], [0x10b78, 0x10b7f], [0x10c00, 0x10c48], [0x1ee00, 0x1ee03], [0x1ee05, 0x1ee1f], [0x1ee21, 0x1ee22], [0x1ee24, 0x1ee24], [0x1ee27, 0x1ee27], [0x1ee29, 0x1ee32], [0x1ee34, 0x1ee37], [0x1ee39, 0x1ee39], [0x1ee3b, 0x1ee3b], [0x1ee42, 0x1ee42], [0x1ee47, 0x1ee47], [0x1ee49, 0x1ee49], [0x1ee4b, 0x1ee4b], [0x1ee4d, 0x1ee4f], [0x1ee51, 0x1ee52], [0x1ee54, 0x1ee54], [0x1ee57, 0x1ee57], [0x1ee59, 0x1ee59], [0x1ee5b, 0x1ee5b], [0x1ee5d, 0x1ee5d], [0x1ee5f, 0x1ee5f], [0x1ee61, 0x1ee62], [0x1ee64, 0x1ee64], [0x1ee67, 0x1ee6a], [0x1ee6c, 0x1ee72], [0x1ee74, 0x1ee77], [0x1ee79, 0x1ee7c], [0x1ee7e, 0x1ee7e], [0x1ee80, 0x1ee89], [0x1ee8b, 0x1ee9b], [0x1eea1, 0x1eea3], [0x1eea5, 0x1eea9], [0x1eeab, 0x1eebb], [0x10fffd, 0x10fffd]];\n\n  function isStrongRTLChar(charCode) {\n    for (var i = 0; i < strongRTLRanges.length; i++) {\n      var currentRange = strongRTLRanges[i];\n      if (charCode >= currentRange[0] && charCode <= currentRange[1]) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function determineBidi(cueDiv) {\n    var nodeStack = [],\n        text = \"\",\n        charCode;\n\n    if (!cueDiv || !cueDiv.childNodes) {\n      return \"ltr\";\n    }\n\n    function pushNodes(nodeStack, node) {\n      for (var i = node.childNodes.length - 1; i >= 0; i--) {\n        nodeStack.push(node.childNodes[i]);\n      }\n    }\n\n    function nextTextNode(nodeStack) {\n      if (!nodeStack || !nodeStack.length) {\n        return null;\n      }\n\n      var node = nodeStack.pop(),\n          text = node.textContent || node.innerText;\n      if (text) {\n        // TODO: This should match all unicode type B characters (paragraph\n        // separator characters). See issue #115.\n        var m = text.match(/^.*(\\n|\\r)/);\n        if (m) {\n          nodeStack.length = 0;\n          return m[0];\n        }\n        return text;\n      }\n      if (node.tagName === \"ruby\") {\n        return nextTextNode(nodeStack);\n      }\n      if (node.childNodes) {\n        pushNodes(nodeStack, node);\n        return nextTextNode(nodeStack);\n      }\n    }\n\n    pushNodes(nodeStack, cueDiv);\n    while (text = nextTextNode(nodeStack)) {\n      for (var i = 0; i < text.length; i++) {\n        charCode = text.charCodeAt(i);\n        if (isStrongRTLChar(charCode)) {\n          return \"rtl\";\n        }\n      }\n    }\n    return \"ltr\";\n  }\n\n  function computeLinePos(cue) {\n    if (typeof cue.line === \"number\" && (cue.snapToLines || cue.line >= 0 && cue.line <= 100)) {\n      return cue.line;\n    }\n    if (!cue.track || !cue.track.textTrackList || !cue.track.textTrackList.mediaElement) {\n      return -1;\n    }\n    var track = cue.track,\n        trackList = track.textTrackList,\n        count = 0;\n    for (var i = 0; i < trackList.length && trackList[i] !== track; i++) {\n      if (trackList[i].mode === \"showing\") {\n        count++;\n      }\n    }\n    return ++count * -1;\n  }\n\n  function StyleBox() {}\n\n  // Apply styles to a div. If there is no div passed then it defaults to the\n  // div on 'this'.\n  StyleBox.prototype.applyStyles = function (styles, div) {\n    div = div || this.div;\n    for (var prop in styles) {\n      if (styles.hasOwnProperty(prop)) {\n        div.style[prop] = styles[prop];\n      }\n    }\n  };\n\n  StyleBox.prototype.formatStyle = function (val, unit) {\n    return val === 0 ? 0 : val + unit;\n  };\n\n  // Constructs the computed display state of the cue (a div). Places the div\n  // into the overlay which should be a block level element (usually a div).\n  function CueStyleBox(window, cue, styleOptions) {\n    StyleBox.call(this);\n    this.cue = cue;\n\n    // Parse our cue's text into a DOM tree rooted at 'cueDiv'. This div will\n    // have inline positioning and will function as the cue background box.\n    this.cueDiv = parseContent(window, cue.text);\n    var styles = {\n      color: \"rgba(255, 255, 255, 1)\",\n      backgroundColor: \"rgba(0, 0, 0, 0.8)\",\n      position: \"relative\",\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n      display: \"inline\",\n      writingMode: cue.vertical === \"\" ? \"horizontal-tb\" : cue.vertical === \"lr\" ? \"vertical-lr\" : \"vertical-rl\",\n      unicodeBidi: \"plaintext\"\n    };\n\n    this.applyStyles(styles, this.cueDiv);\n\n    // Create an absolutely positioned div that will be used to position the cue\n    // div. Note, all WebVTT cue-setting alignments are equivalent to the CSS\n    // mirrors of them except \"middle\" which is \"center\" in CSS.\n    this.div = window.document.createElement(\"div\");\n    styles = {\n      direction: determineBidi(this.cueDiv),\n      writingMode: cue.vertical === \"\" ? \"horizontal-tb\" : cue.vertical === \"lr\" ? \"vertical-lr\" : \"vertical-rl\",\n      unicodeBidi: \"plaintext\",\n      textAlign: cue.align === \"middle\" ? \"center\" : cue.align,\n      font: styleOptions.font,\n      whiteSpace: \"pre-line\",\n      position: \"absolute\"\n    };\n\n    this.applyStyles(styles);\n    this.div.appendChild(this.cueDiv);\n\n    // Calculate the distance from the reference edge of the viewport to the text\n    // position of the cue box. The reference edge will be resolved later when\n    // the box orientation styles are applied.\n    var textPos = 0;\n    switch (cue.positionAlign) {\n      case \"start\":\n        textPos = cue.position;\n        break;\n      case \"middle\":\n        textPos = cue.position - cue.size / 2;\n        break;\n      case \"end\":\n        textPos = cue.position - cue.size;\n        break;\n    }\n\n    // Horizontal box orientation; textPos is the distance from the left edge of the\n    // area to the left edge of the box and cue.size is the distance extending to\n    // the right from there.\n    if (cue.vertical === \"\") {\n      this.applyStyles({\n        left: this.formatStyle(textPos, \"%\"),\n        width: this.formatStyle(cue.size, \"%\")\n      });\n      // Vertical box orientation; textPos is the distance from the top edge of the\n      // area to the top edge of the box and cue.size is the height extending\n      // downwards from there.\n    } else {\n      this.applyStyles({\n        top: this.formatStyle(textPos, \"%\"),\n        height: this.formatStyle(cue.size, \"%\")\n      });\n    }\n\n    this.move = function (box) {\n      this.applyStyles({\n        top: this.formatStyle(box.top, \"px\"),\n        bottom: this.formatStyle(box.bottom, \"px\"),\n        left: this.formatStyle(box.left, \"px\"),\n        right: this.formatStyle(box.right, \"px\"),\n        height: this.formatStyle(box.height, \"px\"),\n        width: this.formatStyle(box.width, \"px\")\n      });\n    };\n  }\n  CueStyleBox.prototype = _objCreate(StyleBox.prototype);\n  CueStyleBox.prototype.constructor = CueStyleBox;\n\n  // Represents the co-ordinates of an Element in a way that we can easily\n  // compute things with such as if it overlaps or intersects with another Element.\n  // Can initialize it with either a StyleBox or another BoxPosition.\n  function BoxPosition(obj) {\n    // Either a BoxPosition was passed in and we need to copy it, or a StyleBox\n    // was passed in and we need to copy the results of 'getBoundingClientRect'\n    // as the object returned is readonly. All co-ordinate values are in reference\n    // to the viewport origin (top left).\n    var lh, height, width, top;\n    if (obj.div) {\n      height = obj.div.offsetHeight;\n      width = obj.div.offsetWidth;\n      top = obj.div.offsetTop;\n\n      var rects = (rects = obj.div.childNodes) && (rects = rects[0]) && rects.getClientRects && rects.getClientRects();\n      obj = obj.div.getBoundingClientRect();\n      // In certain cases the outter div will be slightly larger then the sum of\n      // the inner div's lines. This could be due to bold text, etc, on some platforms.\n      // In this case we should get the average line height and use that. This will\n      // result in the desired behaviour.\n      lh = rects ? Math.max(rects[0] && rects[0].height || 0, obj.height / rects.length) : 0;\n    }\n    this.left = obj.left;\n    this.right = obj.right;\n    this.top = obj.top || top;\n    this.height = obj.height || height;\n    this.bottom = obj.bottom || top + (obj.height || height);\n    this.width = obj.width || width;\n    this.lineHeight = lh !== undefined ? lh : obj.lineHeight;\n  }\n\n  // Move the box along a particular axis. Optionally pass in an amount to move\n  // the box. If no amount is passed then the default is the line height of the\n  // box.\n  BoxPosition.prototype.move = function (axis, toMove) {\n    toMove = toMove !== undefined ? toMove : this.lineHeight;\n    switch (axis) {\n      case \"+x\":\n        this.left += toMove;\n        this.right += toMove;\n        break;\n      case \"-x\":\n        this.left -= toMove;\n        this.right -= toMove;\n        break;\n      case \"+y\":\n        this.top += toMove;\n        this.bottom += toMove;\n        break;\n      case \"-y\":\n        this.top -= toMove;\n        this.bottom -= toMove;\n        break;\n    }\n  };\n\n  // Check if this box overlaps another box, b2.\n  BoxPosition.prototype.overlaps = function (b2) {\n    return this.left < b2.right && this.right > b2.left && this.top < b2.bottom && this.bottom > b2.top;\n  };\n\n  // Check if this box overlaps any other boxes in boxes.\n  BoxPosition.prototype.overlapsAny = function (boxes) {\n    for (var i = 0; i < boxes.length; i++) {\n      if (this.overlaps(boxes[i])) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  // Check if this box is within another box.\n  BoxPosition.prototype.within = function (container) {\n    return this.top >= container.top && this.bottom <= container.bottom && this.left >= container.left && this.right <= container.right;\n  };\n\n  // Check if this box is entirely within the container or it is overlapping\n  // on the edge opposite of the axis direction passed. For example, if \"+x\" is\n  // passed and the box is overlapping on the left edge of the container, then\n  // return true.\n  BoxPosition.prototype.overlapsOppositeAxis = function (container, axis) {\n    switch (axis) {\n      case \"+x\":\n        return this.left < container.left;\n      case \"-x\":\n        return this.right > container.right;\n      case \"+y\":\n        return this.top < container.top;\n      case \"-y\":\n        return this.bottom > container.bottom;\n    }\n  };\n\n  // Find the percentage of the area that this box is overlapping with another\n  // box.\n  BoxPosition.prototype.intersectPercentage = function (b2) {\n    var x = Math.max(0, Math.min(this.right, b2.right) - Math.max(this.left, b2.left)),\n        y = Math.max(0, Math.min(this.bottom, b2.bottom) - Math.max(this.top, b2.top)),\n        intersectArea = x * y;\n    return intersectArea / (this.height * this.width);\n  };\n\n  // Convert the positions from this box to CSS compatible positions using\n  // the reference container's positions. This has to be done because this\n  // box's positions are in reference to the viewport origin, whereas, CSS\n  // values are in referecne to their respective edges.\n  BoxPosition.prototype.toCSSCompatValues = function (reference) {\n    return {\n      top: this.top - reference.top,\n      bottom: reference.bottom - this.bottom,\n      left: this.left - reference.left,\n      right: reference.right - this.right,\n      height: this.height,\n      width: this.width\n    };\n  };\n\n  // Get an object that represents the box's position without anything extra.\n  // Can pass a StyleBox, HTMLElement, or another BoxPositon.\n  BoxPosition.getSimpleBoxPosition = function (obj) {\n    var height = obj.div ? obj.div.offsetHeight : obj.tagName ? obj.offsetHeight : 0;\n    var width = obj.div ? obj.div.offsetWidth : obj.tagName ? obj.offsetWidth : 0;\n    var top = obj.div ? obj.div.offsetTop : obj.tagName ? obj.offsetTop : 0;\n\n    obj = obj.div ? obj.div.getBoundingClientRect() : obj.tagName ? obj.getBoundingClientRect() : obj;\n    var ret = {\n      left: obj.left,\n      right: obj.right,\n      top: obj.top || top,\n      height: obj.height || height,\n      bottom: obj.bottom || top + (obj.height || height),\n      width: obj.width || width\n    };\n    return ret;\n  };\n\n  // Move a StyleBox to its specified, or next best, position. The containerBox\n  // is the box that contains the StyleBox, such as a div. boxPositions are\n  // a list of other boxes that the styleBox can't overlap with.\n  function moveBoxToLinePosition(window, styleBox, containerBox, boxPositions) {\n\n    // Find the best position for a cue box, b, on the video. The axis parameter\n    // is a list of axis, the order of which, it will move the box along. For example:\n    // Passing [\"+x\", \"-x\"] will move the box first along the x axis in the positive\n    // direction. If it doesn't find a good position for it there it will then move\n    // it along the x axis in the negative direction.\n    function findBestPosition(b, axis) {\n      var bestPosition,\n          specifiedPosition = new BoxPosition(b),\n          percentage = 1; // Highest possible so the first thing we get is better.\n\n      for (var i = 0; i < axis.length; i++) {\n        while (b.overlapsOppositeAxis(containerBox, axis[i]) || b.within(containerBox) && b.overlapsAny(boxPositions)) {\n          b.move(axis[i]);\n        }\n        // We found a spot where we aren't overlapping anything. This is our\n        // best position.\n        if (b.within(containerBox)) {\n          return b;\n        }\n        var p = b.intersectPercentage(containerBox);\n        // If we're outside the container box less then we were on our last try\n        // then remember this position as the best position.\n        if (percentage > p) {\n          bestPosition = new BoxPosition(b);\n          percentage = p;\n        }\n        // Reset the box position to the specified position.\n        b = new BoxPosition(specifiedPosition);\n      }\n      return bestPosition || specifiedPosition;\n    }\n\n    var boxPosition = new BoxPosition(styleBox),\n        cue = styleBox.cue,\n        linePos = computeLinePos(cue),\n        axis = [];\n\n    // If we have a line number to align the cue to.\n    if (cue.snapToLines) {\n      var size;\n      switch (cue.vertical) {\n        case \"\":\n          axis = [\"+y\", \"-y\"];\n          size = \"height\";\n          break;\n        case \"rl\":\n          axis = [\"+x\", \"-x\"];\n          size = \"width\";\n          break;\n        case \"lr\":\n          axis = [\"-x\", \"+x\"];\n          size = \"width\";\n          break;\n      }\n\n      var step = boxPosition.lineHeight,\n          position = step * Math.round(linePos),\n          maxPosition = containerBox[size] + step,\n          initialAxis = axis[0];\n\n      // If the specified intial position is greater then the max position then\n      // clamp the box to the amount of steps it would take for the box to\n      // reach the max position.\n      if (Math.abs(position) > maxPosition) {\n        position = position < 0 ? -1 : 1;\n        position *= Math.ceil(maxPosition / step) * step;\n      }\n\n      // If computed line position returns negative then line numbers are\n      // relative to the bottom of the video instead of the top. Therefore, we\n      // need to increase our initial position by the length or width of the\n      // video, depending on the writing direction, and reverse our axis directions.\n      if (linePos < 0) {\n        position += cue.vertical === \"\" ? containerBox.height : containerBox.width;\n        axis = axis.reverse();\n      }\n\n      // Move the box to the specified position. This may not be its best\n      // position.\n      boxPosition.move(initialAxis, position);\n    } else {\n      // If we have a percentage line value for the cue.\n      var calculatedPercentage = boxPosition.lineHeight / containerBox.height * 100;\n\n      switch (cue.lineAlign) {\n        case \"middle\":\n          linePos -= calculatedPercentage / 2;\n          break;\n        case \"end\":\n          linePos -= calculatedPercentage;\n          break;\n      }\n\n      // Apply initial line position to the cue box.\n      switch (cue.vertical) {\n        case \"\":\n          styleBox.applyStyles({\n            top: styleBox.formatStyle(linePos, \"%\")\n          });\n          break;\n        case \"rl\":\n          styleBox.applyStyles({\n            left: styleBox.formatStyle(linePos, \"%\")\n          });\n          break;\n        case \"lr\":\n          styleBox.applyStyles({\n            right: styleBox.formatStyle(linePos, \"%\")\n          });\n          break;\n      }\n\n      axis = [\"+y\", \"-x\", \"+x\", \"-y\"];\n\n      // Get the box position again after we've applied the specified positioning\n      // to it.\n      boxPosition = new BoxPosition(styleBox);\n    }\n\n    var bestPosition = findBestPosition(boxPosition, axis);\n    styleBox.move(bestPosition.toCSSCompatValues(containerBox));\n  }\n\n  function WebVTT$1() {}\n  // Nothing\n\n\n  // Helper to allow strings to be decoded instead of the default binary utf8 data.\n  WebVTT$1.StringDecoder = function () {\n    return {\n      decode: function decode(data) {\n        if (!data) {\n          return \"\";\n        }\n        if (typeof data !== \"string\") {\n          throw new Error(\"Error - expected string data.\");\n        }\n        return decodeURIComponent(encodeURIComponent(data));\n      }\n    };\n  };\n\n  WebVTT$1.convertCueToDOMTree = function (window, cuetext) {\n    if (!window || !cuetext) {\n      return null;\n    }\n    return parseContent(window, cuetext);\n  };\n\n  var FONT_SIZE_PERCENT = 0.05;\n  var FONT_STYLE = \"sans-serif\";\n  var CUE_BACKGROUND_PADDING = \"1.5%\";\n\n  // Runs the processing model over the cues and regions passed to it.\n  // @param overlay A block level element (usually a div) that the computed cues\n  //                and regions will be placed into.\n  WebVTT$1.processCues = function (window, cues, overlay) {\n    if (!window || !cues || !overlay) {\n      return null;\n    }\n\n    // Remove all previous children.\n    while (overlay.firstChild) {\n      overlay.removeChild(overlay.firstChild);\n    }\n\n    var paddedOverlay = window.document.createElement(\"div\");\n    paddedOverlay.style.position = \"absolute\";\n    paddedOverlay.style.left = \"0\";\n    paddedOverlay.style.right = \"0\";\n    paddedOverlay.style.top = \"0\";\n    paddedOverlay.style.bottom = \"0\";\n    paddedOverlay.style.margin = CUE_BACKGROUND_PADDING;\n    overlay.appendChild(paddedOverlay);\n\n    // Determine if we need to compute the display states of the cues. This could\n    // be the case if a cue's state has been changed since the last computation or\n    // if it has not been computed yet.\n    function shouldCompute(cues) {\n      for (var i = 0; i < cues.length; i++) {\n        if (cues[i].hasBeenReset || !cues[i].displayState) {\n          return true;\n        }\n      }\n      return false;\n    }\n\n    // We don't need to recompute the cues' display states. Just reuse them.\n    if (!shouldCompute(cues)) {\n      for (var i = 0; i < cues.length; i++) {\n        paddedOverlay.appendChild(cues[i].displayState);\n      }\n      return;\n    }\n\n    var boxPositions = [],\n        containerBox = BoxPosition.getSimpleBoxPosition(paddedOverlay),\n        fontSize = Math.round(containerBox.height * FONT_SIZE_PERCENT * 100) / 100;\n    var styleOptions = {\n      font: fontSize + \"px \" + FONT_STYLE\n    };\n\n    (function () {\n      var styleBox, cue;\n\n      for (var i = 0; i < cues.length; i++) {\n        cue = cues[i];\n\n        // Compute the intial position and styles of the cue div.\n        styleBox = new CueStyleBox(window, cue, styleOptions);\n        paddedOverlay.appendChild(styleBox.div);\n\n        // Move the cue div to it's correct line position.\n        moveBoxToLinePosition(window, styleBox, containerBox, boxPositions);\n\n        // Remember the computed div so that we don't have to recompute it later\n        // if we don't have too.\n        cue.displayState = styleBox.div;\n\n        boxPositions.push(BoxPosition.getSimpleBoxPosition(styleBox));\n      }\n    })();\n  };\n\n  WebVTT$1.Parser = function (window, vttjs, decoder) {\n    if (!decoder) {\n      decoder = vttjs;\n      vttjs = {};\n    }\n    if (!vttjs) {\n      vttjs = {};\n    }\n\n    this.window = window;\n    this.vttjs = vttjs;\n    this.state = \"INITIAL\";\n    this.buffer = \"\";\n    this.decoder = decoder || new TextDecoder(\"utf8\");\n    this.regionList = [];\n  };\n\n  WebVTT$1.Parser.prototype = {\n    // If the error is a ParsingError then report it to the consumer if\n    // possible. If it's not a ParsingError then throw it like normal.\n    reportOrThrowError: function reportOrThrowError(e) {\n      if (e instanceof ParsingError) {\n        this.onparsingerror && this.onparsingerror(e);\n      } else {\n        throw e;\n      }\n    },\n    parse: function parse(data) {\n      var self = this;\n\n      // If there is no data then we won't decode it, but will just try to parse\n      // whatever is in buffer already. This may occur in circumstances, for\n      // example when flush() is called.\n      if (data) {\n        // Try to decode the data that we received.\n        self.buffer += self.decoder.decode(data, { stream: true });\n      }\n\n      function collectNextLine() {\n        var buffer = self.buffer;\n        var pos = 0;\n        while (pos < buffer.length && buffer[pos] !== '\\r' && buffer[pos] !== '\\n') {\n          ++pos;\n        }\n        var line = buffer.substr(0, pos);\n        // Advance the buffer early in case we fail below.\n        if (buffer[pos] === '\\r') {\n          ++pos;\n        }\n        if (buffer[pos] === '\\n') {\n          ++pos;\n        }\n        self.buffer = buffer.substr(pos);\n        return line;\n      }\n\n      // 3.4 WebVTT region and WebVTT region settings syntax\n      function parseRegion(input) {\n        var settings = new Settings();\n\n        parseOptions(input, function (k, v) {\n          switch (k) {\n            case \"id\":\n              settings.set(k, v);\n              break;\n            case \"width\":\n              settings.percent(k, v);\n              break;\n            case \"lines\":\n              settings.integer(k, v);\n              break;\n            case \"regionanchor\":\n            case \"viewportanchor\":\n              var xy = v.split(',');\n              if (xy.length !== 2) {\n                break;\n              }\n              // We have to make sure both x and y parse, so use a temporary\n              // settings object here.\n              var anchor = new Settings();\n              anchor.percent(\"x\", xy[0]);\n              anchor.percent(\"y\", xy[1]);\n              if (!anchor.has(\"x\") || !anchor.has(\"y\")) {\n                break;\n              }\n              settings.set(k + \"X\", anchor.get(\"x\"));\n              settings.set(k + \"Y\", anchor.get(\"y\"));\n              break;\n            case \"scroll\":\n              settings.alt(k, v, [\"up\"]);\n              break;\n          }\n        }, /=/, /\\s/);\n\n        // Create the region, using default values for any values that were not\n        // specified.\n        if (settings.has(\"id\")) {\n          var region = new (self.vttjs.VTTRegion || self.window.VTTRegion)();\n          region.width = settings.get(\"width\", 100);\n          region.lines = settings.get(\"lines\", 3);\n          region.regionAnchorX = settings.get(\"regionanchorX\", 0);\n          region.regionAnchorY = settings.get(\"regionanchorY\", 100);\n          region.viewportAnchorX = settings.get(\"viewportanchorX\", 0);\n          region.viewportAnchorY = settings.get(\"viewportanchorY\", 100);\n          region.scroll = settings.get(\"scroll\", \"\");\n          // Register the region.\n          self.onregion && self.onregion(region);\n          // Remember the VTTRegion for later in case we parse any VTTCues that\n          // reference it.\n          self.regionList.push({\n            id: settings.get(\"id\"),\n            region: region\n          });\n        }\n      }\n\n      // draft-pantos-http-live-streaming-20\n      // https://tools.ietf.org/html/draft-pantos-http-live-streaming-20#section-3.5\n      // 3.5 WebVTT\n      function parseTimestampMap(input) {\n        var settings = new Settings();\n\n        parseOptions(input, function (k, v) {\n          switch (k) {\n            case \"MPEGT\":\n              settings.integer(k + 'S', v);\n              break;\n            case \"LOCA\":\n              settings.set(k + 'L', parseTimeStamp(v));\n              break;\n          }\n        }, /[^\\d]:/, /,/);\n\n        self.ontimestampmap && self.ontimestampmap({\n          \"MPEGTS\": settings.get(\"MPEGTS\"),\n          \"LOCAL\": settings.get(\"LOCAL\")\n        });\n      }\n\n      // 3.2 WebVTT metadata header syntax\n      function parseHeader(input) {\n        if (input.match(/X-TIMESTAMP-MAP/)) {\n          // This line contains HLS X-TIMESTAMP-MAP metadata\n          parseOptions(input, function (k, v) {\n            switch (k) {\n              case \"X-TIMESTAMP-MAP\":\n                parseTimestampMap(v);\n                break;\n            }\n          }, /=/);\n        } else {\n          parseOptions(input, function (k, v) {\n            switch (k) {\n              case \"Region\":\n                // 3.3 WebVTT region metadata header syntax\n                parseRegion(v);\n                break;\n            }\n          }, /:/);\n        }\n      }\n\n      // 5.1 WebVTT file parsing.\n      try {\n        var line;\n        if (self.state === \"INITIAL\") {\n          // We can't start parsing until we have the first line.\n          if (!/\\r\\n|\\n/.test(self.buffer)) {\n            return this;\n          }\n\n          line = collectNextLine();\n\n          var m = line.match(/^WEBVTT([ \\t].*)?$/);\n          if (!m || !m[0]) {\n            throw new ParsingError(ParsingError.Errors.BadSignature);\n          }\n\n          self.state = \"HEADER\";\n        }\n\n        var alreadyCollectedLine = false;\n        while (self.buffer) {\n          // We can't parse a line until we have the full line.\n          if (!/\\r\\n|\\n/.test(self.buffer)) {\n            return this;\n          }\n\n          if (!alreadyCollectedLine) {\n            line = collectNextLine();\n          } else {\n            alreadyCollectedLine = false;\n          }\n\n          switch (self.state) {\n            case \"HEADER\":\n              // 13-18 - Allow a header (metadata) under the WEBVTT line.\n              if (/:/.test(line)) {\n                parseHeader(line);\n              } else if (!line) {\n                // An empty line terminates the header and starts the body (cues).\n                self.state = \"ID\";\n              }\n              continue;\n            case \"NOTE\":\n              // Ignore NOTE blocks.\n              if (!line) {\n                self.state = \"ID\";\n              }\n              continue;\n            case \"ID\":\n              // Check for the start of NOTE blocks.\n              if (/^NOTE($|[ \\t])/.test(line)) {\n                self.state = \"NOTE\";\n                break;\n              }\n              // 19-29 - Allow any number of line terminators, then initialize new cue values.\n              if (!line) {\n                continue;\n              }\n              self.cue = new (self.vttjs.VTTCue || self.window.VTTCue)(0, 0, \"\");\n              self.state = \"CUE\";\n              // 30-39 - Check if self line contains an optional identifier or timing data.\n              if (line.indexOf(\"-->\") === -1) {\n                self.cue.id = line;\n                continue;\n              }\n            // Process line as start of a cue.\n            /*falls through*/\n            case \"CUE\":\n              // 40 - Collect cue timings and settings.\n              try {\n                parseCue(line, self.cue, self.regionList);\n              } catch (e) {\n                self.reportOrThrowError(e);\n                // In case of an error ignore rest of the cue.\n                self.cue = null;\n                self.state = \"BADCUE\";\n                continue;\n              }\n              self.state = \"CUETEXT\";\n              continue;\n            case \"CUETEXT\":\n              var hasSubstring = line.indexOf(\"-->\") !== -1;\n              // 34 - If we have an empty line then report the cue.\n              // 35 - If we have the special substring '-->' then report the cue,\n              // but do not collect the line as we need to process the current\n              // one as a new cue.\n              if (!line || hasSubstring && (alreadyCollectedLine = true)) {\n                // We are done parsing self cue.\n                self.oncue && self.oncue(self.cue);\n                self.cue = null;\n                self.state = \"ID\";\n                continue;\n              }\n              if (self.cue.text) {\n                self.cue.text += \"\\n\";\n              }\n              self.cue.text += line;\n              continue;\n            case \"BADCUE\":\n              // BADCUE\n              // 54-62 - Collect and discard the remaining cue.\n              if (!line) {\n                self.state = \"ID\";\n              }\n              continue;\n          }\n        }\n      } catch (e) {\n        self.reportOrThrowError(e);\n\n        // If we are currently parsing a cue, report what we have.\n        if (self.state === \"CUETEXT\" && self.cue && self.oncue) {\n          self.oncue(self.cue);\n        }\n        self.cue = null;\n        // Enter BADWEBVTT state if header was not parsed correctly otherwise\n        // another exception occurred so enter BADCUE state.\n        self.state = self.state === \"INITIAL\" ? \"BADWEBVTT\" : \"BADCUE\";\n      }\n      return this;\n    },\n    flush: function flush() {\n      var self = this;\n      try {\n        // Finish decoding the stream.\n        self.buffer += self.decoder.decode();\n        // Synthesize the end of the current cue or region.\n        if (self.cue || self.state === \"HEADER\") {\n          self.buffer += \"\\n\\n\";\n          self.parse();\n        }\n        // If we've flushed, parsed, and we're still on the INITIAL state then\n        // that means we don't have enough of the stream to parse the first\n        // line.\n        if (self.state === \"INITIAL\") {\n          throw new ParsingError(ParsingError.Errors.BadSignature);\n        }\n      } catch (e) {\n        self.reportOrThrowError(e);\n      }\n      self.onflush && self.onflush();\n      return this;\n    }\n  };\n\n  var vtt = WebVTT$1;\n\n  var vtt$1 = /*#__PURE__*/Object.freeze({\n    default: vtt,\n    __moduleExports: vtt\n  });\n\n  /**\n   * Copyright 2013 vtt.js Contributors\n   *\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *   http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var autoKeyword = \"auto\";\n  var directionSetting = {\n    \"\": 1,\n    \"lr\": 1,\n    \"rl\": 1\n  };\n  var alignSetting = {\n    \"start\": 1,\n    \"middle\": 1,\n    \"end\": 1,\n    \"left\": 1,\n    \"right\": 1\n  };\n\n  function findDirectionSetting(value) {\n    if (typeof value !== \"string\") {\n      return false;\n    }\n    var dir = directionSetting[value.toLowerCase()];\n    return dir ? value.toLowerCase() : false;\n  }\n\n  function findAlignSetting(value) {\n    if (typeof value !== \"string\") {\n      return false;\n    }\n    var align = alignSetting[value.toLowerCase()];\n    return align ? value.toLowerCase() : false;\n  }\n\n  function VTTCue(startTime, endTime, text) {\n    /**\n     * Shim implementation specific properties. These properties are not in\n     * the spec.\n     */\n\n    // Lets us know when the VTTCue's data has changed in such a way that we need\n    // to recompute its display state. This lets us compute its display state\n    // lazily.\n    this.hasBeenReset = false;\n\n    /**\n     * VTTCue and TextTrackCue properties\n     * http://dev.w3.org/html5/webvtt/#vttcue-interface\n     */\n\n    var _id = \"\";\n    var _pauseOnExit = false;\n    var _startTime = startTime;\n    var _endTime = endTime;\n    var _text = text;\n    var _region = null;\n    var _vertical = \"\";\n    var _snapToLines = true;\n    var _line = \"auto\";\n    var _lineAlign = \"start\";\n    var _position = 50;\n    var _positionAlign = \"middle\";\n    var _size = 50;\n    var _align = \"middle\";\n\n    Object.defineProperties(this, {\n      \"id\": {\n        enumerable: true,\n        get: function get() {\n          return _id;\n        },\n        set: function set(value) {\n          _id = \"\" + value;\n        }\n      },\n\n      \"pauseOnExit\": {\n        enumerable: true,\n        get: function get() {\n          return _pauseOnExit;\n        },\n        set: function set(value) {\n          _pauseOnExit = !!value;\n        }\n      },\n\n      \"startTime\": {\n        enumerable: true,\n        get: function get() {\n          return _startTime;\n        },\n        set: function set(value) {\n          if (typeof value !== \"number\") {\n            throw new TypeError(\"Start time must be set to a number.\");\n          }\n          _startTime = value;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"endTime\": {\n        enumerable: true,\n        get: function get() {\n          return _endTime;\n        },\n        set: function set(value) {\n          if (typeof value !== \"number\") {\n            throw new TypeError(\"End time must be set to a number.\");\n          }\n          _endTime = value;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"text\": {\n        enumerable: true,\n        get: function get() {\n          return _text;\n        },\n        set: function set(value) {\n          _text = \"\" + value;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"region\": {\n        enumerable: true,\n        get: function get() {\n          return _region;\n        },\n        set: function set(value) {\n          _region = value;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"vertical\": {\n        enumerable: true,\n        get: function get() {\n          return _vertical;\n        },\n        set: function set(value) {\n          var setting = findDirectionSetting(value);\n          // Have to check for false because the setting an be an empty string.\n          if (setting === false) {\n            throw new SyntaxError(\"An invalid or illegal string was specified.\");\n          }\n          _vertical = setting;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"snapToLines\": {\n        enumerable: true,\n        get: function get() {\n          return _snapToLines;\n        },\n        set: function set(value) {\n          _snapToLines = !!value;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"line\": {\n        enumerable: true,\n        get: function get() {\n          return _line;\n        },\n        set: function set(value) {\n          if (typeof value !== \"number\" && value !== autoKeyword) {\n            throw new SyntaxError(\"An invalid number or illegal string was specified.\");\n          }\n          _line = value;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"lineAlign\": {\n        enumerable: true,\n        get: function get() {\n          return _lineAlign;\n        },\n        set: function set(value) {\n          var setting = findAlignSetting(value);\n          if (!setting) {\n            throw new SyntaxError(\"An invalid or illegal string was specified.\");\n          }\n          _lineAlign = setting;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"position\": {\n        enumerable: true,\n        get: function get() {\n          return _position;\n        },\n        set: function set(value) {\n          if (value < 0 || value > 100) {\n            throw new Error(\"Position must be between 0 and 100.\");\n          }\n          _position = value;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"positionAlign\": {\n        enumerable: true,\n        get: function get() {\n          return _positionAlign;\n        },\n        set: function set(value) {\n          var setting = findAlignSetting(value);\n          if (!setting) {\n            throw new SyntaxError(\"An invalid or illegal string was specified.\");\n          }\n          _positionAlign = setting;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"size\": {\n        enumerable: true,\n        get: function get() {\n          return _size;\n        },\n        set: function set(value) {\n          if (value < 0 || value > 100) {\n            throw new Error(\"Size must be between 0 and 100.\");\n          }\n          _size = value;\n          this.hasBeenReset = true;\n        }\n      },\n\n      \"align\": {\n        enumerable: true,\n        get: function get() {\n          return _align;\n        },\n        set: function set(value) {\n          var setting = findAlignSetting(value);\n          if (!setting) {\n            throw new SyntaxError(\"An invalid or illegal string was specified.\");\n          }\n          _align = setting;\n          this.hasBeenReset = true;\n        }\n      }\n    });\n\n    /**\n     * Other <track> spec defined properties\n     */\n\n    // http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#text-track-cue-display-state\n    this.displayState = undefined;\n  }\n\n  /**\n   * VTTCue methods\n   */\n\n  VTTCue.prototype.getCueAsHTML = function () {\n    // Assume WebVTT.convertCueToDOMTree is on the global.\n    return WebVTT.convertCueToDOMTree(window, this.text);\n  };\n\n  var vttcue = VTTCue;\n\n  var vttcue$1 = /*#__PURE__*/Object.freeze({\n    default: vttcue,\n    __moduleExports: vttcue\n  });\n\n  /**\n   * Copyright 2013 vtt.js Contributors\n   *\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *   http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  var scrollSetting = {\n    \"\": true,\n    \"up\": true\n  };\n\n  function findScrollSetting(value) {\n    if (typeof value !== \"string\") {\n      return false;\n    }\n    var scroll = scrollSetting[value.toLowerCase()];\n    return scroll ? value.toLowerCase() : false;\n  }\n\n  function isValidPercentValue(value) {\n    return typeof value === \"number\" && value >= 0 && value <= 100;\n  }\n\n  // VTTRegion shim http://dev.w3.org/html5/webvtt/#vttregion-interface\n  function VTTRegion() {\n    var _width = 100;\n    var _lines = 3;\n    var _regionAnchorX = 0;\n    var _regionAnchorY = 100;\n    var _viewportAnchorX = 0;\n    var _viewportAnchorY = 100;\n    var _scroll = \"\";\n\n    Object.defineProperties(this, {\n      \"width\": {\n        enumerable: true,\n        get: function get() {\n          return _width;\n        },\n        set: function set(value) {\n          if (!isValidPercentValue(value)) {\n            throw new Error(\"Width must be between 0 and 100.\");\n          }\n          _width = value;\n        }\n      },\n      \"lines\": {\n        enumerable: true,\n        get: function get() {\n          return _lines;\n        },\n        set: function set(value) {\n          if (typeof value !== \"number\") {\n            throw new TypeError(\"Lines must be set to a number.\");\n          }\n          _lines = value;\n        }\n      },\n      \"regionAnchorY\": {\n        enumerable: true,\n        get: function get() {\n          return _regionAnchorY;\n        },\n        set: function set(value) {\n          if (!isValidPercentValue(value)) {\n            throw new Error(\"RegionAnchorX must be between 0 and 100.\");\n          }\n          _regionAnchorY = value;\n        }\n      },\n      \"regionAnchorX\": {\n        enumerable: true,\n        get: function get() {\n          return _regionAnchorX;\n        },\n        set: function set(value) {\n          if (!isValidPercentValue(value)) {\n            throw new Error(\"RegionAnchorY must be between 0 and 100.\");\n          }\n          _regionAnchorX = value;\n        }\n      },\n      \"viewportAnchorY\": {\n        enumerable: true,\n        get: function get() {\n          return _viewportAnchorY;\n        },\n        set: function set(value) {\n          if (!isValidPercentValue(value)) {\n            throw new Error(\"ViewportAnchorY must be between 0 and 100.\");\n          }\n          _viewportAnchorY = value;\n        }\n      },\n      \"viewportAnchorX\": {\n        enumerable: true,\n        get: function get() {\n          return _viewportAnchorX;\n        },\n        set: function set(value) {\n          if (!isValidPercentValue(value)) {\n            throw new Error(\"ViewportAnchorX must be between 0 and 100.\");\n          }\n          _viewportAnchorX = value;\n        }\n      },\n      \"scroll\": {\n        enumerable: true,\n        get: function get() {\n          return _scroll;\n        },\n        set: function set(value) {\n          var setting = findScrollSetting(value);\n          // Have to check for false as an empty string is a legal value.\n          if (setting === false) {\n            throw new SyntaxError(\"An invalid or illegal string was specified.\");\n          }\n          _scroll = setting;\n        }\n      }\n    });\n  }\n\n  var vttregion = VTTRegion;\n\n  var vttregion$1 = /*#__PURE__*/Object.freeze({\n    default: vttregion,\n    __moduleExports: vttregion\n  });\n\n  var require$$0 = ( vtt$1 && vtt ) || vtt$1;\n\n  var require$$1 = ( vttcue$1 && vttcue ) || vttcue$1;\n\n  var require$$2 = ( vttregion$1 && vttregion ) || vttregion$1;\n\n  var browserIndex = createCommonjsModule(function (module) {\n    /**\n     * Copyright 2013 vtt.js Contributors\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *   http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n\n    // Default exports for Node. Export the extended versions of VTTCue and\n    // VTTRegion in Node since we likely want the capability to convert back and\n    // forth between JSON. If we don't then it's not that big of a deal since we're\n    // off browser.\n\n\n    var vttjs = module.exports = {\n      WebVTT: require$$0,\n      VTTCue: require$$1,\n      VTTRegion: require$$2\n    };\n\n    window_1.vttjs = vttjs;\n    window_1.WebVTT = vttjs.WebVTT;\n\n    var cueShim = vttjs.VTTCue;\n    var regionShim = vttjs.VTTRegion;\n    var nativeVTTCue = window_1.VTTCue;\n    var nativeVTTRegion = window_1.VTTRegion;\n\n    vttjs.shim = function () {\n      window_1.VTTCue = cueShim;\n      window_1.VTTRegion = regionShim;\n    };\n\n    vttjs.restore = function () {\n      window_1.VTTCue = nativeVTTCue;\n      window_1.VTTRegion = nativeVTTRegion;\n    };\n\n    if (!window_1.VTTCue) {\n      vttjs.shim();\n    }\n  });\n  var browserIndex_1 = browserIndex.WebVTT;\n  var browserIndex_2 = browserIndex.VTTCue;\n  var browserIndex_3 = browserIndex.VTTRegion;\n\n  /**\n   * @file tech.js\n   */\n\n  /**\n   * An Object containing a structure like: `{src: 'url', type: 'mimetype'}` or string\n   * that just contains the src url alone.\n   * * `var SourceObject = {src: 'http://ex.com/video.mp4', type: 'video/mp4'};`\n     * `var SourceString = 'http://example.com/some-video.mp4';`\n   *\n   * @typedef {Object|string} Tech~SourceObject\n   *\n   * @property {string} src\n   *           The url to the source\n   *\n   * @property {string} type\n   *           The mime type of the source\n   */\n\n  /**\n   * A function used by {@link Tech} to create a new {@link TextTrack}.\n   *\n   * @private\n   *\n   * @param {Tech} self\n   *        An instance of the Tech class.\n   *\n   * @param {string} kind\n   *        `TextTrack` kind (subtitles, captions, descriptions, chapters, or metadata)\n   *\n   * @param {string} [label]\n   *        Label to identify the text track\n   *\n   * @param {string} [language]\n   *        Two letter language abbreviation\n   *\n   * @param {Object} [options={}]\n   *        An object with additional text track options\n   *\n   * @return {TextTrack}\n   *          The text track that was created.\n   */\n  function createTrackHelper(self, kind, label, language) {\n    var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n    var tracks = self.textTracks();\n\n    options.kind = kind;\n\n    if (label) {\n      options.label = label;\n    }\n    if (language) {\n      options.language = language;\n    }\n    options.tech = self;\n\n    var track = new ALL.text.TrackClass(options);\n\n    tracks.addTrack(track);\n\n    return track;\n  }\n\n  /**\n   * This is the base class for media playback technology controllers, such as\n   * {@link Flash} and {@link HTML5}\n   *\n   * @extends Component\n   */\n\n  var Tech = function (_Component) {\n    inherits(Tech, _Component);\n\n    /**\n     * Create an instance of this Tech.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Component~ReadyCallback} ready\n     *        Callback function to call when the `HTML5` Tech is ready.\n     */\n    function Tech() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var ready = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n      classCallCheck(this, Tech);\n\n      // we don't want the tech to report user activity automatically.\n      // This is done manually in addControlsListeners\n      options.reportTouchActivity = false;\n\n      // keep track of whether the current source has played at all to\n      // implement a very limited played()\n      var _this = possibleConstructorReturn(this, _Component.call(this, null, options, ready));\n\n      _this.hasStarted_ = false;\n      _this.on('playing', function () {\n        this.hasStarted_ = true;\n      });\n      _this.on('loadstart', function () {\n        this.hasStarted_ = false;\n      });\n\n      ALL.names.forEach(function (name) {\n        var props = ALL[name];\n\n        if (options && options[props.getterName]) {\n          _this[props.privateName] = options[props.getterName];\n        }\n      });\n\n      // Manually track progress in cases where the browser/flash player doesn't report it.\n      if (!_this.featuresProgressEvents) {\n        _this.manualProgressOn();\n      }\n\n      // Manually track timeupdates in cases where the browser/flash player doesn't report it.\n      if (!_this.featuresTimeupdateEvents) {\n        _this.manualTimeUpdatesOn();\n      }\n\n      ['Text', 'Audio', 'Video'].forEach(function (track) {\n        if (options['native' + track + 'Tracks'] === false) {\n          _this['featuresNative' + track + 'Tracks'] = false;\n        }\n      });\n\n      if (options.nativeCaptions === false || options.nativeTextTracks === false) {\n        _this.featuresNativeTextTracks = false;\n      } else if (options.nativeCaptions === true || options.nativeTextTracks === true) {\n        _this.featuresNativeTextTracks = true;\n      }\n\n      if (!_this.featuresNativeTextTracks) {\n        _this.emulateTextTracks();\n      }\n\n      _this.autoRemoteTextTracks_ = new ALL.text.ListClass();\n\n      _this.initTrackListeners();\n\n      // Turn on component tap events only if not using native controls\n      if (!options.nativeControlsForTouch) {\n        _this.emitTapEvents();\n      }\n\n      if (_this.constructor) {\n        _this.name_ = _this.constructor.name || 'Unknown Tech';\n      }\n      return _this;\n    }\n\n    /**\n     * A special function to trigger source set in a way that will allow player\n     * to re-trigger if the player or tech are not ready yet.\n     *\n     * @fires Tech#sourceset\n     * @param {string} src The source string at the time of the source changing.\n     */\n\n\n    Tech.prototype.triggerSourceset = function triggerSourceset(src) {\n      var _this2 = this;\n\n      if (!this.isReady_) {\n        // on initial ready we have to trigger source set\n        // 1ms after ready so that player can watch for it.\n        this.one('ready', function () {\n          return _this2.setTimeout(function () {\n            return _this2.triggerSourceset(src);\n          }, 1);\n        });\n      }\n\n      /**\n       * Fired when the source is set on the tech causing the media element\n       * to reload.\n       *\n       * @see {@link Player#event:sourceset}\n       * @event Tech#sourceset\n       * @type {EventTarget~Event}\n       */\n      this.trigger({\n        src: src,\n        type: 'sourceset'\n      });\n    };\n\n    /* Fallbacks for unsupported event types\n    ================================================================================ */\n\n    /**\n     * Polyfill the `progress` event for browsers that don't support it natively.\n     *\n     * @see {@link Tech#trackProgress}\n     */\n\n\n    Tech.prototype.manualProgressOn = function manualProgressOn() {\n      this.on('durationchange', this.onDurationChange);\n\n      this.manualProgress = true;\n\n      // Trigger progress watching when a source begins loading\n      this.one('ready', this.trackProgress);\n    };\n\n    /**\n     * Turn off the polyfill for `progress` events that was created in\n     * {@link Tech#manualProgressOn}\n     */\n\n\n    Tech.prototype.manualProgressOff = function manualProgressOff() {\n      this.manualProgress = false;\n      this.stopTrackingProgress();\n\n      this.off('durationchange', this.onDurationChange);\n    };\n\n    /**\n     * This is used to trigger a `progress` event when the buffered percent changes. It\n     * sets an interval function that will be called every 500 milliseconds to check if the\n     * buffer end percent has changed.\n     *\n     * > This function is called by {@link Tech#manualProgressOn}\n     *\n     * @param {EventTarget~Event} event\n     *        The `ready` event that caused this to run.\n     *\n     * @listens Tech#ready\n     * @fires Tech#progress\n     */\n\n\n    Tech.prototype.trackProgress = function trackProgress(event) {\n      this.stopTrackingProgress();\n      this.progressInterval = this.setInterval(bind(this, function () {\n        // Don't trigger unless buffered amount is greater than last time\n\n        var numBufferedPercent = this.bufferedPercent();\n\n        if (this.bufferedPercent_ !== numBufferedPercent) {\n          /**\n           * See {@link Player#progress}\n           *\n           * @event Tech#progress\n           * @type {EventTarget~Event}\n           */\n          this.trigger('progress');\n        }\n\n        this.bufferedPercent_ = numBufferedPercent;\n\n        if (numBufferedPercent === 1) {\n          this.stopTrackingProgress();\n        }\n      }), 500);\n    };\n\n    /**\n     * Update our internal duration on a `durationchange` event by calling\n     * {@link Tech#duration}.\n     *\n     * @param {EventTarget~Event} event\n     *        The `durationchange` event that caused this to run.\n     *\n     * @listens Tech#durationchange\n     */\n\n\n    Tech.prototype.onDurationChange = function onDurationChange(event) {\n      this.duration_ = this.duration();\n    };\n\n    /**\n     * Get and create a `TimeRange` object for buffering.\n     *\n     * @return {TimeRange}\n     *         The time range object that was created.\n     */\n\n\n    Tech.prototype.buffered = function buffered() {\n      return createTimeRanges(0, 0);\n    };\n\n    /**\n     * Get the percentage of the current video that is currently buffered.\n     *\n     * @return {number}\n     *         A number from 0 to 1 that represents the decimal percentage of the\n     *         video that is buffered.\n     *\n     */\n\n\n    Tech.prototype.bufferedPercent = function bufferedPercent$$1() {\n      return bufferedPercent(this.buffered(), this.duration_);\n    };\n\n    /**\n     * Turn off the polyfill for `progress` events that was created in\n     * {@link Tech#manualProgressOn}\n     * Stop manually tracking progress events by clearing the interval that was set in\n     * {@link Tech#trackProgress}.\n     */\n\n\n    Tech.prototype.stopTrackingProgress = function stopTrackingProgress() {\n      this.clearInterval(this.progressInterval);\n    };\n\n    /**\n     * Polyfill the `timeupdate` event for browsers that don't support it.\n     *\n     * @see {@link Tech#trackCurrentTime}\n     */\n\n\n    Tech.prototype.manualTimeUpdatesOn = function manualTimeUpdatesOn() {\n      this.manualTimeUpdates = true;\n\n      this.on('play', this.trackCurrentTime);\n      this.on('pause', this.stopTrackingCurrentTime);\n    };\n\n    /**\n     * Turn off the polyfill for `timeupdate` events that was created in\n     * {@link Tech#manualTimeUpdatesOn}\n     */\n\n\n    Tech.prototype.manualTimeUpdatesOff = function manualTimeUpdatesOff() {\n      this.manualTimeUpdates = false;\n      this.stopTrackingCurrentTime();\n      this.off('play', this.trackCurrentTime);\n      this.off('pause', this.stopTrackingCurrentTime);\n    };\n\n    /**\n     * Sets up an interval function to track current time and trigger `timeupdate` every\n     * 250 milliseconds.\n     *\n     * @listens Tech#play\n     * @triggers Tech#timeupdate\n     */\n\n\n    Tech.prototype.trackCurrentTime = function trackCurrentTime() {\n      if (this.currentTimeInterval) {\n        this.stopTrackingCurrentTime();\n      }\n      this.currentTimeInterval = this.setInterval(function () {\n        /**\n         * Triggered at an interval of 250ms to indicated that time is passing in the video.\n         *\n         * @event Tech#timeupdate\n         * @type {EventTarget~Event}\n         */\n        this.trigger({ type: 'timeupdate', target: this, manuallyTriggered: true });\n\n        // 42 = 24 fps // 250 is what Webkit uses // FF uses 15\n      }, 250);\n    };\n\n    /**\n     * Stop the interval function created in {@link Tech#trackCurrentTime} so that the\n     * `timeupdate` event is no longer triggered.\n     *\n     * @listens {Tech#pause}\n     */\n\n\n    Tech.prototype.stopTrackingCurrentTime = function stopTrackingCurrentTime() {\n      this.clearInterval(this.currentTimeInterval);\n\n      // #1002 - if the video ends right before the next timeupdate would happen,\n      // the progress bar won't make it all the way to the end\n      this.trigger({ type: 'timeupdate', target: this, manuallyTriggered: true });\n    };\n\n    /**\n     * Turn off all event polyfills, clear the `Tech`s {@link AudioTrackList},\n     * {@link VideoTrackList}, and {@link TextTrackList}, and dispose of this Tech.\n     *\n     * @fires Component#dispose\n     */\n\n\n    Tech.prototype.dispose = function dispose() {\n\n      // clear out all tracks because we can't reuse them between techs\n      this.clearTracks(NORMAL.names);\n\n      // Turn off any manual progress or timeupdate tracking\n      if (this.manualProgress) {\n        this.manualProgressOff();\n      }\n\n      if (this.manualTimeUpdates) {\n        this.manualTimeUpdatesOff();\n      }\n\n      _Component.prototype.dispose.call(this);\n    };\n\n    /**\n     * Clear out a single `TrackList` or an array of `TrackLists` given their names.\n     *\n     * > Note: Techs without source handlers should call this between sources for `video`\n     *         & `audio` tracks. You don't want to use them between tracks!\n     *\n     * @param {string[]|string} types\n     *        TrackList names to clear, valid names are `video`, `audio`, and\n     *        `text`.\n     */\n\n\n    Tech.prototype.clearTracks = function clearTracks(types) {\n      var _this3 = this;\n\n      types = [].concat(types);\n      // clear out all tracks because we can't reuse them between techs\n      types.forEach(function (type) {\n        var list = _this3[type + 'Tracks']() || [];\n        var i = list.length;\n\n        while (i--) {\n          var track = list[i];\n\n          if (type === 'text') {\n            _this3.removeRemoteTextTrack(track);\n          }\n          list.removeTrack(track);\n        }\n      });\n    };\n\n    /**\n     * Remove any TextTracks added via addRemoteTextTrack that are\n     * flagged for automatic garbage collection\n     */\n\n\n    Tech.prototype.cleanupAutoTextTracks = function cleanupAutoTextTracks() {\n      var list = this.autoRemoteTextTracks_ || [];\n      var i = list.length;\n\n      while (i--) {\n        var track = list[i];\n\n        this.removeRemoteTextTrack(track);\n      }\n    };\n\n    /**\n     * Reset the tech, which will removes all sources and reset the internal readyState.\n     *\n     * @abstract\n     */\n\n\n    Tech.prototype.reset = function reset() {};\n\n    /**\n     * Get or set an error on the Tech.\n     *\n     * @param {MediaError} [err]\n     *        Error to set on the Tech\n     *\n     * @return {MediaError|null}\n     *         The current error object on the tech, or null if there isn't one.\n     */\n\n\n    Tech.prototype.error = function error(err) {\n      if (err !== undefined) {\n        this.error_ = new MediaError(err);\n        this.trigger('error');\n      }\n      return this.error_;\n    };\n\n    /**\n     * Returns the `TimeRange`s that have been played through for the current source.\n     *\n     * > NOTE: This implementation is incomplete. It does not track the played `TimeRange`.\n     *         It only checks whether the source has played at all or not.\n     *\n     * @return {TimeRange}\n     *         - A single time range if this video has played\n     *         - An empty set of ranges if not.\n     */\n\n\n    Tech.prototype.played = function played() {\n      if (this.hasStarted_) {\n        return createTimeRanges(0, 0);\n      }\n      return createTimeRanges();\n    };\n\n    /**\n     * Causes a manual time update to occur if {@link Tech#manualTimeUpdatesOn} was\n     * previously called.\n     *\n     * @fires Tech#timeupdate\n     */\n\n\n    Tech.prototype.setCurrentTime = function setCurrentTime() {\n      // improve the accuracy of manual timeupdates\n      if (this.manualTimeUpdates) {\n        /**\n         * A manual `timeupdate` event.\n         *\n         * @event Tech#timeupdate\n         * @type {EventTarget~Event}\n         */\n        this.trigger({ type: 'timeupdate', target: this, manuallyTriggered: true });\n      }\n    };\n\n    /**\n     * Turn on listeners for {@link VideoTrackList}, {@link {AudioTrackList}, and\n     * {@link TextTrackList} events.\n     *\n     * This adds {@link EventTarget~EventListeners} for `addtrack`, and  `removetrack`.\n     *\n     * @fires Tech#audiotrackchange\n     * @fires Tech#videotrackchange\n     * @fires Tech#texttrackchange\n     */\n\n\n    Tech.prototype.initTrackListeners = function initTrackListeners() {\n      var _this4 = this;\n\n      /**\n       * Triggered when tracks are added or removed on the Tech {@link AudioTrackList}\n       *\n       * @event Tech#audiotrackchange\n       * @type {EventTarget~Event}\n       */\n\n      /**\n       * Triggered when tracks are added or removed on the Tech {@link VideoTrackList}\n       *\n       * @event Tech#videotrackchange\n       * @type {EventTarget~Event}\n       */\n\n      /**\n       * Triggered when tracks are added or removed on the Tech {@link TextTrackList}\n       *\n       * @event Tech#texttrackchange\n       * @type {EventTarget~Event}\n       */\n      NORMAL.names.forEach(function (name) {\n        var props = NORMAL[name];\n        var trackListChanges = function trackListChanges() {\n          _this4.trigger(name + 'trackchange');\n        };\n\n        var tracks = _this4[props.getterName]();\n\n        tracks.addEventListener('removetrack', trackListChanges);\n        tracks.addEventListener('addtrack', trackListChanges);\n\n        _this4.on('dispose', function () {\n          tracks.removeEventListener('removetrack', trackListChanges);\n          tracks.removeEventListener('addtrack', trackListChanges);\n        });\n      });\n    };\n\n    /**\n     * Emulate TextTracks using vtt.js if necessary\n     *\n     * @fires Tech#vttjsloaded\n     * @fires Tech#vttjserror\n     */\n\n\n    Tech.prototype.addWebVttScript_ = function addWebVttScript_() {\n      var _this5 = this;\n\n      if (window_1.WebVTT) {\n        return;\n      }\n\n      // Initially, Tech.el_ is a child of a dummy-div wait until the Component system\n      // signals that the Tech is ready at which point Tech.el_ is part of the DOM\n      // before inserting the WebVTT script\n      if (document_1.body.contains(this.el())) {\n\n        // load via require if available and vtt.js script location was not passed in\n        // as an option. novtt builds will turn the above require call into an empty object\n        // which will cause this if check to always fail.\n        if (!this.options_['vtt.js'] && isPlain(browserIndex) && Object.keys(browserIndex).length > 0) {\n          this.trigger('vttjsloaded');\n          return;\n        }\n\n        // load vtt.js via the script location option or the cdn of no location was\n        // passed in\n        var script = document_1.createElement('script');\n\n        script.src = this.options_['vtt.js'] || 'https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js';\n        script.onload = function () {\n          /**\n           * Fired when vtt.js is loaded.\n           *\n           * @event Tech#vttjsloaded\n           * @type {EventTarget~Event}\n           */\n          _this5.trigger('vttjsloaded');\n        };\n        script.onerror = function () {\n          /**\n           * Fired when vtt.js was not loaded due to an error\n           *\n           * @event Tech#vttjsloaded\n           * @type {EventTarget~Event}\n           */\n          _this5.trigger('vttjserror');\n        };\n        this.on('dispose', function () {\n          script.onload = null;\n          script.onerror = null;\n        });\n        // but have not loaded yet and we set it to true before the inject so that\n        // we don't overwrite the injected window.WebVTT if it loads right away\n        window_1.WebVTT = true;\n        this.el().parentNode.appendChild(script);\n      } else {\n        this.ready(this.addWebVttScript_);\n      }\n    };\n\n    /**\n     * Emulate texttracks\n     *\n     */\n\n\n    Tech.prototype.emulateTextTracks = function emulateTextTracks() {\n      var _this6 = this;\n\n      var tracks = this.textTracks();\n      var remoteTracks = this.remoteTextTracks();\n      var handleAddTrack = function handleAddTrack(e) {\n        return tracks.addTrack(e.track);\n      };\n      var handleRemoveTrack = function handleRemoveTrack(e) {\n        return tracks.removeTrack(e.track);\n      };\n\n      remoteTracks.on('addtrack', handleAddTrack);\n      remoteTracks.on('removetrack', handleRemoveTrack);\n\n      this.addWebVttScript_();\n\n      var updateDisplay = function updateDisplay() {\n        return _this6.trigger('texttrackchange');\n      };\n\n      var textTracksChanges = function textTracksChanges() {\n        updateDisplay();\n\n        for (var i = 0; i < tracks.length; i++) {\n          var track = tracks[i];\n\n          track.removeEventListener('cuechange', updateDisplay);\n          if (track.mode === 'showing') {\n            track.addEventListener('cuechange', updateDisplay);\n          }\n        }\n      };\n\n      textTracksChanges();\n      tracks.addEventListener('change', textTracksChanges);\n      tracks.addEventListener('addtrack', textTracksChanges);\n      tracks.addEventListener('removetrack', textTracksChanges);\n\n      this.on('dispose', function () {\n        remoteTracks.off('addtrack', handleAddTrack);\n        remoteTracks.off('removetrack', handleRemoveTrack);\n        tracks.removeEventListener('change', textTracksChanges);\n        tracks.removeEventListener('addtrack', textTracksChanges);\n        tracks.removeEventListener('removetrack', textTracksChanges);\n\n        for (var i = 0; i < tracks.length; i++) {\n          var track = tracks[i];\n\n          track.removeEventListener('cuechange', updateDisplay);\n        }\n      });\n    };\n\n    /**\n     * Create and returns a remote {@link TextTrack} object.\n     *\n     * @param {string} kind\n     *        `TextTrack` kind (subtitles, captions, descriptions, chapters, or metadata)\n     *\n     * @param {string} [label]\n     *        Label to identify the text track\n     *\n     * @param {string} [language]\n     *        Two letter language abbreviation\n     *\n     * @return {TextTrack}\n     *         The TextTrack that gets created.\n     */\n\n\n    Tech.prototype.addTextTrack = function addTextTrack(kind, label, language) {\n      if (!kind) {\n        throw new Error('TextTrack kind is required but was not provided');\n      }\n\n      return createTrackHelper(this, kind, label, language);\n    };\n\n    /**\n     * Create an emulated TextTrack for use by addRemoteTextTrack\n     *\n     * This is intended to be overridden by classes that inherit from\n     * Tech in order to create native or custom TextTracks.\n     *\n     * @param {Object} options\n     *        The object should contain the options to initialize the TextTrack with.\n     *\n     * @param {string} [options.kind]\n     *        `TextTrack` kind (subtitles, captions, descriptions, chapters, or metadata).\n     *\n     * @param {string} [options.label].\n     *        Label to identify the text track\n     *\n     * @param {string} [options.language]\n     *        Two letter language abbreviation.\n     *\n     * @return {HTMLTrackElement}\n     *         The track element that gets created.\n     */\n\n\n    Tech.prototype.createRemoteTextTrack = function createRemoteTextTrack(options) {\n      var track = mergeOptions(options, {\n        tech: this\n      });\n\n      return new REMOTE.remoteTextEl.TrackClass(track);\n    };\n\n    /**\n     * Creates a remote text track object and returns an html track element.\n     *\n     * > Note: This can be an emulated {@link HTMLTrackElement} or a native one.\n     *\n     * @param {Object} options\n     *        See {@link Tech#createRemoteTextTrack} for more detailed properties.\n     *\n     * @param {boolean} [manualCleanup=true]\n     *        - When false: the TextTrack will be automatically removed from the video\n     *          element whenever the source changes\n     *        - When True: The TextTrack will have to be cleaned up manually\n     *\n     * @return {HTMLTrackElement}\n     *         An Html Track Element.\n     *\n     * @deprecated The default functionality for this function will be equivalent\n     *             to \"manualCleanup=false\" in the future. The manualCleanup parameter will\n     *             also be removed.\n     */\n\n\n    Tech.prototype.addRemoteTextTrack = function addRemoteTextTrack() {\n      var _this7 = this;\n\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var manualCleanup = arguments[1];\n\n      var htmlTrackElement = this.createRemoteTextTrack(options);\n\n      if (manualCleanup !== true && manualCleanup !== false) {\n        // deprecation warning\n        log$1.warn('Calling addRemoteTextTrack without explicitly setting the \"manualCleanup\" parameter to `true` is deprecated and default to `false` in future version of video.js');\n        manualCleanup = true;\n      }\n\n      // store HTMLTrackElement and TextTrack to remote list\n      this.remoteTextTrackEls().addTrackElement_(htmlTrackElement);\n      this.remoteTextTracks().addTrack(htmlTrackElement.track);\n\n      if (manualCleanup !== true) {\n        // create the TextTrackList if it doesn't exist\n        this.ready(function () {\n          return _this7.autoRemoteTextTracks_.addTrack(htmlTrackElement.track);\n        });\n      }\n\n      return htmlTrackElement;\n    };\n\n    /**\n     * Remove a remote text track from the remote `TextTrackList`.\n     *\n     * @param {TextTrack} track\n     *        `TextTrack` to remove from the `TextTrackList`\n     */\n\n\n    Tech.prototype.removeRemoteTextTrack = function removeRemoteTextTrack(track) {\n      var trackElement = this.remoteTextTrackEls().getTrackElementByTrack_(track);\n\n      // remove HTMLTrackElement and TextTrack from remote list\n      this.remoteTextTrackEls().removeTrackElement_(trackElement);\n      this.remoteTextTracks().removeTrack(track);\n      this.autoRemoteTextTracks_.removeTrack(track);\n    };\n\n    /**\n     * Gets available media playback quality metrics as specified by the W3C's Media\n     * Playback Quality API.\n     *\n     * @see [Spec]{@link https://wicg.github.io/media-playback-quality}\n     *\n     * @return {Object}\n     *         An object with supported media playback quality metrics\n     *\n     * @abstract\n     */\n\n\n    Tech.prototype.getVideoPlaybackQuality = function getVideoPlaybackQuality() {\n      return {};\n    };\n\n    /**\n     * A method to set a poster from a `Tech`.\n     *\n     * @abstract\n     */\n\n\n    Tech.prototype.setPoster = function setPoster() {};\n\n    /**\n     * A method to check for the presence of the 'playsinline' <video> attribute.\n     *\n     * @abstract\n     */\n\n\n    Tech.prototype.playsinline = function playsinline() {};\n\n    /**\n     * A method to set or unset the 'playsinline' <video> attribute.\n     *\n     * @abstract\n     */\n\n\n    Tech.prototype.setPlaysinline = function setPlaysinline() {};\n\n    /**\n     * Attempt to force override of native audio tracks.\n     *\n     * @param {Boolean} override - If set to true native audio will be overridden,\n     * otherwise native audio will potentially be used.\n     *\n     * @abstract\n     */\n\n\n    Tech.prototype.overrideNativeAudioTracks = function overrideNativeAudioTracks() {};\n\n    /**\n     * Attempt to force override of native video tracks.\n     *\n     * @param {Boolean} override - If set to true native video will be overridden,\n     * otherwise native video will potentially be used.\n     *\n     * @abstract\n     */\n\n\n    Tech.prototype.overrideNativeVideoTracks = function overrideNativeVideoTracks() {};\n\n    /*\n     * Check if the tech can support the given mime-type.\n     *\n     * The base tech does not support any type, but source handlers might\n     * overwrite this.\n     *\n     * @param  {string} type\n     *         The mimetype to check for support\n     *\n     * @return {string}\n     *         'probably', 'maybe', or empty string\n     *\n     * @see [Spec]{@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/canPlayType}\n     *\n     * @abstract\n     */\n\n\n    Tech.prototype.canPlayType = function canPlayType() {\n      return '';\n    };\n\n    /**\n     * Check if the type is supported by this tech.\n     *\n     * The base tech does not support any type, but source handlers might\n     * overwrite this.\n     *\n     * @param {string} type\n     *        The media type to check\n     * @return {string} Returns the native video element's response\n     */\n\n\n    Tech.canPlayType = function canPlayType() {\n      return '';\n    };\n\n    /**\n     * Check if the tech can support the given source\n     * @param {Object} srcObj\n     *        The source object\n     * @param {Object} options\n     *        The options passed to the tech\n     * @return {string} 'probably', 'maybe', or '' (empty string)\n     */\n\n\n    Tech.canPlaySource = function canPlaySource(srcObj, options) {\n      return Tech.canPlayType(srcObj.type);\n    };\n\n    /*\n     * Return whether the argument is a Tech or not.\n     * Can be passed either a Class like `Html5` or a instance like `player.tech_`\n     *\n     * @param {Object} component\n     *        The item to check\n     *\n     * @return {boolean}\n     *         Whether it is a tech or not\n     *         - True if it is a tech\n     *         - False if it is not\n     */\n\n\n    Tech.isTech = function isTech(component) {\n      return component.prototype instanceof Tech || component instanceof Tech || component === Tech;\n    };\n\n    /**\n     * Registers a `Tech` into a shared list for videojs.\n     *\n     * @param {string} name\n     *        Name of the `Tech` to register.\n     *\n     * @param {Object} tech\n     *        The `Tech` class to register.\n     */\n\n\n    Tech.registerTech = function registerTech(name, tech) {\n      if (!Tech.techs_) {\n        Tech.techs_ = {};\n      }\n\n      if (!Tech.isTech(tech)) {\n        throw new Error('Tech ' + name + ' must be a Tech');\n      }\n\n      if (!Tech.canPlayType) {\n        throw new Error('Techs must have a static canPlayType method on them');\n      }\n      if (!Tech.canPlaySource) {\n        throw new Error('Techs must have a static canPlaySource method on them');\n      }\n\n      name = toTitleCase(name);\n\n      Tech.techs_[name] = tech;\n      if (name !== 'Tech') {\n        // camel case the techName for use in techOrder\n        Tech.defaultTechOrder_.push(name);\n      }\n      return tech;\n    };\n\n    /**\n     * Get a `Tech` from the shared list by name.\n     *\n     * @param {string} name\n     *        `camelCase` or `TitleCase` name of the Tech to get\n     *\n     * @return {Tech|undefined}\n     *         The `Tech` or undefined if there was no tech with the name requested.\n     */\n\n\n    Tech.getTech = function getTech(name) {\n      if (!name) {\n        return;\n      }\n\n      name = toTitleCase(name);\n\n      if (Tech.techs_ && Tech.techs_[name]) {\n        return Tech.techs_[name];\n      }\n\n      if (window_1 && window_1.videojs && window_1.videojs[name]) {\n        log$1.warn('The ' + name + ' tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)');\n        return window_1.videojs[name];\n      }\n    };\n\n    return Tech;\n  }(Component);\n\n  /**\n   * Get the {@link VideoTrackList}\n   *\n   * @returns {VideoTrackList}\n   * @method Tech.prototype.videoTracks\n   */\n\n  /**\n   * Get the {@link AudioTrackList}\n   *\n   * @returns {AudioTrackList}\n   * @method Tech.prototype.audioTracks\n   */\n\n  /**\n   * Get the {@link TextTrackList}\n   *\n   * @returns {TextTrackList}\n   * @method Tech.prototype.textTracks\n   */\n\n  /**\n   * Get the remote element {@link TextTrackList}\n   *\n   * @returns {TextTrackList}\n   * @method Tech.prototype.remoteTextTracks\n   */\n\n  /**\n   * Get the remote element {@link HtmlTrackElementList}\n   *\n   * @returns {HtmlTrackElementList}\n   * @method Tech.prototype.remoteTextTrackEls\n   */\n\n  ALL.names.forEach(function (name) {\n    var props = ALL[name];\n\n    Tech.prototype[props.getterName] = function () {\n      this[props.privateName] = this[props.privateName] || new props.ListClass();\n      return this[props.privateName];\n    };\n  });\n\n  /**\n   * List of associated text tracks\n   *\n   * @type {TextTrackList}\n   * @private\n   * @property Tech#textTracks_\n   */\n\n  /**\n   * List of associated audio tracks.\n   *\n   * @type {AudioTrackList}\n   * @private\n   * @property Tech#audioTracks_\n   */\n\n  /**\n   * List of associated video tracks.\n   *\n   * @type {VideoTrackList}\n   * @private\n   * @property Tech#videoTracks_\n   */\n\n  /**\n   * Boolean indicating whether the `Tech` supports volume control.\n   *\n   * @type {boolean}\n   * @default\n   */\n  Tech.prototype.featuresVolumeControl = true;\n\n  /**\n   * Boolean indicating whether the `Tech` supports fullscreen resize control.\n   * Resizing plugins using request fullscreen reloads the plugin\n   *\n   * @type {boolean}\n   * @default\n   */\n  Tech.prototype.featuresFullscreenResize = false;\n\n  /**\n   * Boolean indicating whether the `Tech` supports changing the speed at which the video\n   * plays. Examples:\n   *   - Set player to play 2x (twice) as fast\n   *   - Set player to play 0.5x (half) as fast\n   *\n   * @type {boolean}\n   * @default\n   */\n  Tech.prototype.featuresPlaybackRate = false;\n\n  /**\n   * Boolean indicating whether the `Tech` supports the `progress` event. This is currently\n   * not triggered by video-js-swf. This will be used to determine if\n   * {@link Tech#manualProgressOn} should be called.\n   *\n   * @type {boolean}\n   * @default\n   */\n  Tech.prototype.featuresProgressEvents = false;\n\n  /**\n   * Boolean indicating whether the `Tech` supports the `sourceset` event.\n   *\n   * A tech should set this to `true` and then use {@link Tech#triggerSourceset}\n   * to trigger a {@link Tech#event:sourceset} at the earliest time after getting\n   * a new source.\n   *\n   * @type {boolean}\n   * @default\n   */\n  Tech.prototype.featuresSourceset = false;\n\n  /**\n   * Boolean indicating whether the `Tech` supports the `timeupdate` event. This is currently\n   * not triggered by video-js-swf. This will be used to determine if\n   * {@link Tech#manualTimeUpdates} should be called.\n   *\n   * @type {boolean}\n   * @default\n   */\n  Tech.prototype.featuresTimeupdateEvents = false;\n\n  /**\n   * Boolean indicating whether the `Tech` supports the native `TextTrack`s.\n   * This will help us integrate with native `TextTrack`s if the browser supports them.\n   *\n   * @type {boolean}\n   * @default\n   */\n  Tech.prototype.featuresNativeTextTracks = false;\n\n  /**\n   * A functional mixin for techs that want to use the Source Handler pattern.\n   * Source handlers are scripts for handling specific formats.\n   * The source handler pattern is used for adaptive formats (HLS, DASH) that\n   * manually load video data and feed it into a Source Buffer (Media Source Extensions)\n   * Example: `Tech.withSourceHandlers.call(MyTech);`\n   *\n   * @param {Tech} _Tech\n   *        The tech to add source handler functions to.\n   *\n   * @mixes Tech~SourceHandlerAdditions\n   */\n  Tech.withSourceHandlers = function (_Tech) {\n\n    /**\n     * Register a source handler\n     *\n     * @param {Function} handler\n     *        The source handler class\n     *\n     * @param {number} [index]\n     *        Register it at the following index\n     */\n    _Tech.registerSourceHandler = function (handler, index) {\n      var handlers = _Tech.sourceHandlers;\n\n      if (!handlers) {\n        handlers = _Tech.sourceHandlers = [];\n      }\n\n      if (index === undefined) {\n        // add to the end of the list\n        index = handlers.length;\n      }\n\n      handlers.splice(index, 0, handler);\n    };\n\n    /**\n     * Check if the tech can support the given type. Also checks the\n     * Techs sourceHandlers.\n     *\n     * @param {string} type\n     *         The mimetype to check.\n     *\n     * @return {string}\n     *         'probably', 'maybe', or '' (empty string)\n     */\n    _Tech.canPlayType = function (type) {\n      var handlers = _Tech.sourceHandlers || [];\n      var can = void 0;\n\n      for (var i = 0; i < handlers.length; i++) {\n        can = handlers[i].canPlayType(type);\n\n        if (can) {\n          return can;\n        }\n      }\n\n      return '';\n    };\n\n    /**\n     * Returns the first source handler that supports the source.\n     *\n     * TODO: Answer question: should 'probably' be prioritized over 'maybe'\n     *\n     * @param {Tech~SourceObject} source\n     *        The source object\n     *\n     * @param {Object} options\n     *        The options passed to the tech\n     *\n     * @return {SourceHandler|null}\n     *          The first source handler that supports the source or null if\n     *          no SourceHandler supports the source\n     */\n    _Tech.selectSourceHandler = function (source, options) {\n      var handlers = _Tech.sourceHandlers || [];\n      var can = void 0;\n\n      for (var i = 0; i < handlers.length; i++) {\n        can = handlers[i].canHandleSource(source, options);\n\n        if (can) {\n          return handlers[i];\n        }\n      }\n\n      return null;\n    };\n\n    /**\n     * Check if the tech can support the given source.\n     *\n     * @param {Tech~SourceObject} srcObj\n     *        The source object\n     *\n     * @param {Object} options\n     *        The options passed to the tech\n     *\n     * @return {string}\n     *         'probably', 'maybe', or '' (empty string)\n     */\n    _Tech.canPlaySource = function (srcObj, options) {\n      var sh = _Tech.selectSourceHandler(srcObj, options);\n\n      if (sh) {\n        return sh.canHandleSource(srcObj, options);\n      }\n\n      return '';\n    };\n\n    /**\n     * When using a source handler, prefer its implementation of\n     * any function normally provided by the tech.\n     */\n    var deferrable = ['seekable', 'seeking', 'duration'];\n\n    /**\n     * A wrapper around {@link Tech#seekable} that will call a `SourceHandler`s seekable\n     * function if it exists, with a fallback to the Techs seekable function.\n     *\n     * @method _Tech.seekable\n     */\n\n    /**\n     * A wrapper around {@link Tech#duration} that will call a `SourceHandler`s duration\n     * function if it exists, otherwise it will fallback to the techs duration function.\n     *\n     * @method _Tech.duration\n     */\n\n    deferrable.forEach(function (fnName) {\n      var originalFn = this[fnName];\n\n      if (typeof originalFn !== 'function') {\n        return;\n      }\n\n      this[fnName] = function () {\n        if (this.sourceHandler_ && this.sourceHandler_[fnName]) {\n          return this.sourceHandler_[fnName].apply(this.sourceHandler_, arguments);\n        }\n        return originalFn.apply(this, arguments);\n      };\n    }, _Tech.prototype);\n\n    /**\n     * Create a function for setting the source using a source object\n     * and source handlers.\n     * Should never be called unless a source handler was found.\n     *\n     * @param {Tech~SourceObject} source\n     *        A source object with src and type keys\n     */\n    _Tech.prototype.setSource = function (source) {\n      var sh = _Tech.selectSourceHandler(source, this.options_);\n\n      if (!sh) {\n        // Fall back to a native source hander when unsupported sources are\n        // deliberately set\n        if (_Tech.nativeSourceHandler) {\n          sh = _Tech.nativeSourceHandler;\n        } else {\n          log$1.error('No source handler found for the current source.');\n        }\n      }\n\n      // Dispose any existing source handler\n      this.disposeSourceHandler();\n      this.off('dispose', this.disposeSourceHandler);\n\n      if (sh !== _Tech.nativeSourceHandler) {\n        this.currentSource_ = source;\n      }\n\n      this.sourceHandler_ = sh.handleSource(source, this, this.options_);\n      this.on('dispose', this.disposeSourceHandler);\n    };\n\n    /**\n     * Clean up any existing SourceHandlers and listeners when the Tech is disposed.\n     *\n     * @listens Tech#dispose\n     */\n    _Tech.prototype.disposeSourceHandler = function () {\n      // if we have a source and get another one\n      // then we are loading something new\n      // than clear all of our current tracks\n      if (this.currentSource_) {\n        this.clearTracks(['audio', 'video']);\n        this.currentSource_ = null;\n      }\n\n      // always clean up auto-text tracks\n      this.cleanupAutoTextTracks();\n\n      if (this.sourceHandler_) {\n\n        if (this.sourceHandler_.dispose) {\n          this.sourceHandler_.dispose();\n        }\n\n        this.sourceHandler_ = null;\n      }\n    };\n  };\n\n  // The base Tech class needs to be registered as a Component. It is the only\n  // Tech that can be registered as a Component.\n  Component.registerComponent('Tech', Tech);\n  Tech.registerTech('Tech', Tech);\n\n  /**\n   * A list of techs that should be added to techOrder on Players\n   *\n   * @private\n   */\n  Tech.defaultTechOrder_ = [];\n\n  var middlewares = {};\n  var middlewareInstances = {};\n\n  var TERMINATOR = {};\n\n  function use(type, middleware) {\n    middlewares[type] = middlewares[type] || [];\n    middlewares[type].push(middleware);\n  }\n\n  function setSource(player, src, next) {\n    player.setTimeout(function () {\n      return setSourceHelper(src, middlewares[src.type], next, player);\n    }, 1);\n  }\n\n  function setTech(middleware, tech) {\n    middleware.forEach(function (mw) {\n      return mw.setTech && mw.setTech(tech);\n    });\n  }\n\n  /**\n   * Calls a getter on the tech first, through each middleware\n   * from right to left to the player.\n   */\n  function get$1(middleware, tech, method) {\n    return middleware.reduceRight(middlewareIterator(method), tech[method]());\n  }\n\n  /**\n   * Takes the argument given to the player and calls the setter method on each\n   * middleware from left to right to the tech.\n   */\n  function set$1(middleware, tech, method, arg) {\n    return tech[method](middleware.reduce(middlewareIterator(method), arg));\n  }\n\n  /**\n   * Takes the argument given to the player and calls the `call` version of the method\n   * on each middleware from left to right.\n   * Then, call the passed in method on the tech and return the result unchanged\n   * back to the player, through middleware, this time from right to left.\n   */\n  function mediate(middleware, tech, method) {\n    var arg = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n    var callMethod = 'call' + toTitleCase(method);\n    var middlewareValue = middleware.reduce(middlewareIterator(callMethod), arg);\n    var terminated = middlewareValue === TERMINATOR;\n    var returnValue = terminated ? null : tech[method](middlewareValue);\n\n    executeRight(middleware, method, returnValue, terminated);\n\n    return returnValue;\n  }\n\n  var allowedGetters = {\n    buffered: 1,\n    currentTime: 1,\n    duration: 1,\n    seekable: 1,\n    played: 1,\n    paused: 1\n  };\n\n  var allowedSetters = {\n    setCurrentTime: 1\n  };\n\n  var allowedMediators = {\n    play: 1,\n    pause: 1\n  };\n\n  function middlewareIterator(method) {\n    return function (value, mw) {\n      // if the previous middleware terminated, pass along the termination\n      if (value === TERMINATOR) {\n        return TERMINATOR;\n      }\n\n      if (mw[method]) {\n        return mw[method](value);\n      }\n\n      return value;\n    };\n  }\n\n  function executeRight(mws, method, value, terminated) {\n    for (var i = mws.length - 1; i >= 0; i--) {\n      var mw = mws[i];\n\n      if (mw[method]) {\n        mw[method](terminated, value);\n      }\n    }\n  }\n\n  function clearCacheForPlayer(player) {\n    middlewareInstances[player.id()] = null;\n  }\n\n  /**\n   * {\n   *  [playerId]: [[mwFactory, mwInstance], ...]\n   * }\n   */\n  function getOrCreateFactory(player, mwFactory) {\n    var mws = middlewareInstances[player.id()];\n    var mw = null;\n\n    if (mws === undefined || mws === null) {\n      mw = mwFactory(player);\n      middlewareInstances[player.id()] = [[mwFactory, mw]];\n      return mw;\n    }\n\n    for (var i = 0; i < mws.length; i++) {\n      var _mws$i = mws[i],\n          mwf = _mws$i[0],\n          mwi = _mws$i[1];\n\n\n      if (mwf !== mwFactory) {\n        continue;\n      }\n\n      mw = mwi;\n    }\n\n    if (mw === null) {\n      mw = mwFactory(player);\n      mws.push([mwFactory, mw]);\n    }\n\n    return mw;\n  }\n\n  function setSourceHelper() {\n    var src = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var middleware = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var next = arguments[2];\n    var player = arguments[3];\n    var acc = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];\n    var lastRun = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;\n    var mwFactory = middleware[0],\n        mwrest = middleware.slice(1);\n\n    // if mwFactory is a string, then we're at a fork in the road\n\n    if (typeof mwFactory === 'string') {\n      setSourceHelper(src, middlewares[mwFactory], next, player, acc, lastRun);\n\n      // if we have an mwFactory, call it with the player to get the mw,\n      // then call the mw's setSource method\n    } else if (mwFactory) {\n      var mw = getOrCreateFactory(player, mwFactory);\n\n      mw.setSource(assign({}, src), function (err, _src) {\n\n        // something happened, try the next middleware on the current level\n        // make sure to use the old src\n        if (err) {\n          return setSourceHelper(src, mwrest, next, player, acc, lastRun);\n        }\n\n        // we've succeeded, now we need to go deeper\n        acc.push(mw);\n\n        // if it's the same type, continue down the current chain\n        // otherwise, we want to go down the new chain\n        setSourceHelper(_src, src.type === _src.type ? mwrest : middlewares[_src.type], next, player, acc, lastRun);\n      });\n    } else if (mwrest.length) {\n      setSourceHelper(src, mwrest, next, player, acc, lastRun);\n    } else if (lastRun) {\n      next(src, acc);\n    } else {\n      setSourceHelper(src, middlewares['*'], next, player, acc, true);\n    }\n  }\n\n  /**\n   * Mimetypes\n   *\n   * @see http://hul.harvard.edu/ois/////systems/wax/wax-public-help/mimetypes.htm\n   * @typedef Mimetypes~Kind\n   * @enum\n   */\n  var MimetypesKind = {\n    opus: 'video/ogg',\n    ogv: 'video/ogg',\n    mp4: 'video/mp4',\n    mov: 'video/mp4',\n    m4v: 'video/mp4',\n    mkv: 'video/x-matroska',\n    mp3: 'audio/mpeg',\n    aac: 'audio/aac',\n    oga: 'audio/ogg',\n    m3u8: 'application/x-mpegURL'\n  };\n\n  /**\n   * Get the mimetype of a given src url if possible\n   *\n   * @param {string} src\n   *        The url to the src\n   *\n   * @return {string}\n   *         return the mimetype if it was known or empty string otherwise\n   */\n  var getMimetype = function getMimetype() {\n    var src = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n    var ext = getFileExtension(src);\n    var mimetype = MimetypesKind[ext.toLowerCase()];\n\n    return mimetype || '';\n  };\n\n  /**\n   * Find the mime type of a given source string if possible. Uses the player\n   * source cache.\n   *\n   * @param {Player} player\n   *        The player object\n   *\n   * @param {string} src\n   *        The source string\n   *\n   * @return {string}\n   *         The type that was found\n   */\n  var findMimetype = function findMimetype(player, src) {\n    if (!src) {\n      return '';\n    }\n\n    // 1. check for the type in the `source` cache\n    if (player.cache_.source.src === src && player.cache_.source.type) {\n      return player.cache_.source.type;\n    }\n\n    // 2. see if we have this source in our `currentSources` cache\n    var matchingSources = player.cache_.sources.filter(function (s) {\n      return s.src === src;\n    });\n\n    if (matchingSources.length) {\n      return matchingSources[0].type;\n    }\n\n    // 3. look for the src url in source elements and use the type there\n    var sources = player.$$('source');\n\n    for (var i = 0; i < sources.length; i++) {\n      var s = sources[i];\n\n      if (s.type && s.src && s.src === src) {\n        return s.type;\n      }\n    }\n\n    // 4. finally fallback to our list of mime types based on src url extension\n    return getMimetype(src);\n  };\n\n  /**\n   * @module filter-source\n   */\n\n  /**\n   * Filter out single bad source objects or multiple source objects in an\n   * array. Also flattens nested source object arrays into a 1 dimensional\n   * array of source objects.\n   *\n   * @param {Tech~SourceObject|Tech~SourceObject[]} src\n   *        The src object to filter\n   *\n   * @return {Tech~SourceObject[]}\n   *         An array of sourceobjects containing only valid sources\n   *\n   * @private\n   */\n  var filterSource = function filterSource(src) {\n    // traverse array\n    if (Array.isArray(src)) {\n      var newsrc = [];\n\n      src.forEach(function (srcobj) {\n        srcobj = filterSource(srcobj);\n\n        if (Array.isArray(srcobj)) {\n          newsrc = newsrc.concat(srcobj);\n        } else if (isObject(srcobj)) {\n          newsrc.push(srcobj);\n        }\n      });\n\n      src = newsrc;\n    } else if (typeof src === 'string' && src.trim()) {\n      // convert string into object\n      src = [fixSource({ src: src })];\n    } else if (isObject(src) && typeof src.src === 'string' && src.src && src.src.trim()) {\n      // src is already valid\n      src = [fixSource(src)];\n    } else {\n      // invalid source, turn it into an empty array\n      src = [];\n    }\n\n    return src;\n  };\n\n  /**\n   * Checks src mimetype, adding it when possible\n   *\n   * @param {Tech~SourceObject} src\n   *        The src object to check\n   * @return {Tech~SourceObject}\n   *        src Object with known type\n   */\n  function fixSource(src) {\n    var mimetype = getMimetype(src.src);\n\n    if (!src.type && mimetype) {\n      src.type = mimetype;\n    }\n\n    return src;\n  }\n\n  /**\n   * @file loader.js\n   */\n\n  /**\n   * The `MediaLoader` is the `Component` that decides which playback technology to load\n   * when a player is initialized.\n   *\n   * @extends Component\n   */\n\n  var MediaLoader = function (_Component) {\n    inherits(MediaLoader, _Component);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should attach to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Component~ReadyCallback} [ready]\n     *        The function that is run when this component is ready.\n     */\n    function MediaLoader(player, options, ready) {\n      classCallCheck(this, MediaLoader);\n\n      // MediaLoader has no element\n      var options_ = mergeOptions({ createEl: false }, options);\n\n      // If there are no sources when the player is initialized,\n      // load the first supported playback technology.\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options_, ready));\n\n      if (!options.playerOptions.sources || options.playerOptions.sources.length === 0) {\n        for (var i = 0, j = options.playerOptions.techOrder; i < j.length; i++) {\n          var techName = toTitleCase(j[i]);\n          var tech = Tech.getTech(techName);\n\n          // Support old behavior of techs being registered as components.\n          // Remove once that deprecated behavior is removed.\n          if (!techName) {\n            tech = Component.getComponent(techName);\n          }\n\n          // Check if the browser supports this technology\n          if (tech && tech.isSupported()) {\n            player.loadTech_(techName);\n            break;\n          }\n        }\n      } else {\n        // Loop through playback technologies (HTML5, Flash) and check for support.\n        // Then load the best source.\n        // A few assumptions here:\n        //   All playback technologies respect preload false.\n        player.src(options.playerOptions.sources);\n      }\n      return _this;\n    }\n\n    return MediaLoader;\n  }(Component);\n\n  Component.registerComponent('MediaLoader', MediaLoader);\n\n  /**\n   * @file clickable-component.js\n   */\n\n  /**\n   * Clickable Component which is clickable or keyboard actionable,\n   * but is not a native HTML button.\n   *\n   * @extends Component\n   */\n\n  var ClickableComponent = function (_Component) {\n    inherits(ClickableComponent, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param  {Player} player\n     *         The `Player` that this class should be attached to.\n     *\n     * @param  {Object} [options]\n     *         The key/value store of player options.\n     */\n    function ClickableComponent(player, options) {\n      classCallCheck(this, ClickableComponent);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      _this.emitTapEvents();\n\n      _this.enable();\n      return _this;\n    }\n\n    /**\n     * Create the `Component`s DOM element.\n     *\n     * @param {string} [tag=div]\n     *        The element's node type.\n     *\n     * @param {Object} [props={}]\n     *        An object of properties that should be set on the element.\n     *\n     * @param {Object} [attributes={}]\n     *        An object of attributes that should be set on the element.\n     *\n     * @return {Element}\n     *         The element that gets created.\n     */\n\n\n    ClickableComponent.prototype.createEl = function createEl$$1() {\n      var tag = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'div';\n      var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      props = assign({\n        innerHTML: '<span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>',\n        className: this.buildCSSClass(),\n        tabIndex: 0\n      }, props);\n\n      if (tag === 'button') {\n        log$1.error('Creating a ClickableComponent with an HTML element of ' + tag + ' is not supported; use a Button instead.');\n      }\n\n      // Add ARIA attributes for clickable element which is not a native HTML button\n      attributes = assign({\n        role: 'button'\n      }, attributes);\n\n      this.tabIndex_ = props.tabIndex;\n\n      var el = _Component.prototype.createEl.call(this, tag, props, attributes);\n\n      this.createControlTextEl(el);\n\n      return el;\n    };\n\n    ClickableComponent.prototype.dispose = function dispose() {\n      // remove controlTextEl_ on dispose\n      this.controlTextEl_ = null;\n\n      _Component.prototype.dispose.call(this);\n    };\n\n    /**\n     * Create a control text element on this `Component`\n     *\n     * @param {Element} [el]\n     *        Parent element for the control text.\n     *\n     * @return {Element}\n     *         The control text element that gets created.\n     */\n\n\n    ClickableComponent.prototype.createControlTextEl = function createControlTextEl(el) {\n      this.controlTextEl_ = createEl('span', {\n        className: 'vjs-control-text'\n      }, {\n        // let the screen reader user know that the text of the element may change\n        'aria-live': 'polite'\n      });\n\n      if (el) {\n        el.appendChild(this.controlTextEl_);\n      }\n\n      this.controlText(this.controlText_, el);\n\n      return this.controlTextEl_;\n    };\n\n    /**\n     * Get or set the localize text to use for the controls on the `Component`.\n     *\n     * @param {string} [text]\n     *        Control text for element.\n     *\n     * @param {Element} [el=this.el()]\n     *        Element to set the title on.\n     *\n     * @return {string}\n     *         - The control text when getting\n     */\n\n\n    ClickableComponent.prototype.controlText = function controlText(text) {\n      var el = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.el();\n\n      if (text === undefined) {\n        return this.controlText_ || 'Need Text';\n      }\n\n      var localizedText = this.localize(text);\n\n      this.controlText_ = text;\n      textContent(this.controlTextEl_, localizedText);\n      if (!this.nonIconControl) {\n        // Set title attribute if only an icon is shown\n        el.setAttribute('title', localizedText);\n      }\n    };\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    ClickableComponent.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-control vjs-button ' + _Component.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * Enable this `Component`s element.\n     */\n\n\n    ClickableComponent.prototype.enable = function enable() {\n      if (!this.enabled_) {\n        this.enabled_ = true;\n        this.removeClass('vjs-disabled');\n        this.el_.setAttribute('aria-disabled', 'false');\n        if (typeof this.tabIndex_ !== 'undefined') {\n          this.el_.setAttribute('tabIndex', this.tabIndex_);\n        }\n        this.on(['tap', 'click'], this.handleClick);\n        this.on('focus', this.handleFocus);\n        this.on('blur', this.handleBlur);\n      }\n    };\n\n    /**\n     * Disable this `Component`s element.\n     */\n\n\n    ClickableComponent.prototype.disable = function disable() {\n      this.enabled_ = false;\n      this.addClass('vjs-disabled');\n      this.el_.setAttribute('aria-disabled', 'true');\n      if (typeof this.tabIndex_ !== 'undefined') {\n        this.el_.removeAttribute('tabIndex');\n      }\n      this.off(['tap', 'click'], this.handleClick);\n      this.off('focus', this.handleFocus);\n      this.off('blur', this.handleBlur);\n    };\n\n    /**\n     * This gets called when a `ClickableComponent` gets:\n     * - Clicked (via the `click` event, listening starts in the constructor)\n     * - Tapped (via the `tap` event, listening starts in the constructor)\n     * - The following things happen in order:\n     *   1. {@link ClickableComponent#handleFocus} is called via a `focus` event on the\n     *      `ClickableComponent`.\n     *   2. {@link ClickableComponent#handleFocus} adds a listener for `keydown` on using\n     *      {@link ClickableComponent#handleKeyPress}.\n     *   3. `ClickableComponent` has not had a `blur` event (`blur` means that focus was lost). The user presses\n     *      the space or enter key.\n     *   4. {@link ClickableComponent#handleKeyPress} calls this function with the `keydown`\n     *      event as a parameter.\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     * @abstract\n     */\n\n\n    ClickableComponent.prototype.handleClick = function handleClick(event) {};\n\n    /**\n     * This gets called when a `ClickableComponent` gains focus via a `focus` event.\n     * Turns on listening for `keydown` events. When they happen it\n     * calls `this.handleKeyPress`.\n     *\n     * @param {EventTarget~Event} event\n     *        The `focus` event that caused this function to be called.\n     *\n     * @listens focus\n     */\n\n\n    ClickableComponent.prototype.handleFocus = function handleFocus(event) {\n      on(document_1, 'keydown', bind(this, this.handleKeyPress));\n    };\n\n    /**\n     * Called when this ClickableComponent has focus and a key gets pressed down. By\n     * default it will call `this.handleClick` when the key is space or enter.\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown` event that caused this function to be called.\n     *\n     * @listens keydown\n     */\n\n\n    ClickableComponent.prototype.handleKeyPress = function handleKeyPress(event) {\n\n      // Support Space (32) or Enter (13) key operation to fire a click event\n      if (event.which === 32 || event.which === 13) {\n        event.preventDefault();\n        this.trigger('click');\n      } else if (_Component.prototype.handleKeyPress) {\n\n        // Pass keypress handling up for unsupported keys\n        _Component.prototype.handleKeyPress.call(this, event);\n      }\n    };\n\n    /**\n     * Called when a `ClickableComponent` loses focus. Turns off the listener for\n     * `keydown` events. Which Stops `this.handleKeyPress` from getting called.\n     *\n     * @param {EventTarget~Event} event\n     *        The `blur` event that caused this function to be called.\n     *\n     * @listens blur\n     */\n\n\n    ClickableComponent.prototype.handleBlur = function handleBlur(event) {\n      off(document_1, 'keydown', bind(this, this.handleKeyPress));\n    };\n\n    return ClickableComponent;\n  }(Component);\n\n  Component.registerComponent('ClickableComponent', ClickableComponent);\n\n  /**\n   * @file poster-image.js\n   */\n\n  /**\n   * A `ClickableComponent` that handles showing the poster image for the player.\n   *\n   * @extends ClickableComponent\n   */\n\n  var PosterImage = function (_ClickableComponent) {\n    inherits(PosterImage, _ClickableComponent);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should attach to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function PosterImage(player, options) {\n      classCallCheck(this, PosterImage);\n\n      var _this = possibleConstructorReturn(this, _ClickableComponent.call(this, player, options));\n\n      _this.update();\n      player.on('posterchange', bind(_this, _this.update));\n      return _this;\n    }\n\n    /**\n     * Clean up and dispose of the `PosterImage`.\n     */\n\n\n    PosterImage.prototype.dispose = function dispose() {\n      this.player().off('posterchange', this.update);\n      _ClickableComponent.prototype.dispose.call(this);\n    };\n\n    /**\n     * Create the `PosterImage`s DOM element.\n     *\n     * @return {Element}\n     *         The element that gets created.\n     */\n\n\n    PosterImage.prototype.createEl = function createEl$$1() {\n      var el = createEl('div', {\n        className: 'vjs-poster',\n\n        // Don't want poster to be tabbable.\n        tabIndex: -1\n      });\n\n      return el;\n    };\n\n    /**\n     * An {@link EventTarget~EventListener} for {@link Player#posterchange} events.\n     *\n     * @listens Player#posterchange\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `Player#posterchange` event that triggered this function.\n     */\n\n\n    PosterImage.prototype.update = function update(event) {\n      var url = this.player().poster();\n\n      this.setSrc(url);\n\n      // If there's no poster source we should display:none on this component\n      // so it's not still clickable or right-clickable\n      if (url) {\n        this.show();\n      } else {\n        this.hide();\n      }\n    };\n\n    /**\n     * Set the source of the `PosterImage` depending on the display method.\n     *\n     * @param {string} url\n     *        The URL to the source for the `PosterImage`.\n     */\n\n\n    PosterImage.prototype.setSrc = function setSrc(url) {\n      var backgroundImage = '';\n\n      // Any falsy value should stay as an empty string, otherwise\n      // this will throw an extra error\n      if (url) {\n        backgroundImage = 'url(\"' + url + '\")';\n      }\n\n      this.el_.style.backgroundImage = backgroundImage;\n    };\n\n    /**\n     * An {@link EventTarget~EventListener} for clicks on the `PosterImage`. See\n     * {@link ClickableComponent#handleClick} for instances where this will be triggered.\n     *\n     * @listens tap\n     * @listens click\n     * @listens keydown\n     *\n     * @param {EventTarget~Event} event\n     +        The `click`, `tap` or `keydown` event that caused this function to be called.\n     */\n\n\n    PosterImage.prototype.handleClick = function handleClick(event) {\n      // We don't want a click to trigger playback when controls are disabled\n      if (!this.player_.controls()) {\n        return;\n      }\n\n      if (this.player_.paused()) {\n        this.player_.play();\n      } else {\n        this.player_.pause();\n      }\n    };\n\n    return PosterImage;\n  }(ClickableComponent);\n\n  Component.registerComponent('PosterImage', PosterImage);\n\n  /**\n   * @file text-track-display.js\n   */\n\n  var darkGray = '#222';\n  var lightGray = '#ccc';\n  var fontMap = {\n    monospace: 'monospace',\n    sansSerif: 'sans-serif',\n    serif: 'serif',\n    monospaceSansSerif: '\"Andale Mono\", \"Lucida Console\", monospace',\n    monospaceSerif: '\"Courier New\", monospace',\n    proportionalSansSerif: 'sans-serif',\n    proportionalSerif: 'serif',\n    casual: '\"Comic Sans MS\", Impact, fantasy',\n    script: '\"Monotype Corsiva\", cursive',\n    smallcaps: '\"Andale Mono\", \"Lucida Console\", monospace, sans-serif'\n  };\n\n  /**\n   * Construct an rgba color from a given hex color code.\n   *\n   * @param {number} color\n   *        Hex number for color, like #f0e.\n   *\n   * @param {number} opacity\n   *        Value for opacity, 0.0 - 1.0.\n   *\n   * @return {string}\n   *         The rgba color that was created, like 'rgba(255, 0, 0, 0.3)'.\n   *\n   * @private\n   */\n  function constructColor(color, opacity) {\n    return 'rgba(' +\n    // color looks like \"#f0e\"\n    parseInt(color[1] + color[1], 16) + ',' + parseInt(color[2] + color[2], 16) + ',' + parseInt(color[3] + color[3], 16) + ',' + opacity + ')';\n  }\n\n  /**\n   * Try to update the style of a DOM element. Some style changes will throw an error,\n   * particularly in IE8. Those should be noops.\n   *\n   * @param {Element} el\n   *        The DOM element to be styled.\n   *\n   * @param {string} style\n   *        The CSS property on the element that should be styled.\n   *\n   * @param {string} rule\n   *        The style rule that should be applied to the property.\n   *\n   * @private\n   */\n  function tryUpdateStyle(el, style, rule) {\n    try {\n      el.style[style] = rule;\n    } catch (e) {\n\n      // Satisfies linter.\n      return;\n    }\n  }\n\n  /**\n   * The component for displaying text track cues.\n   *\n   * @extends Component\n   */\n\n  var TextTrackDisplay = function (_Component) {\n    inherits(TextTrackDisplay, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Component~ReadyCallback} [ready]\n     *        The function to call when `TextTrackDisplay` is ready.\n     */\n    function TextTrackDisplay(player, options, ready) {\n      classCallCheck(this, TextTrackDisplay);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options, ready));\n\n      player.on('loadstart', bind(_this, _this.toggleDisplay));\n      player.on('texttrackchange', bind(_this, _this.updateDisplay));\n      player.on('loadstart', bind(_this, _this.preselectTrack));\n\n      // This used to be called during player init, but was causing an error\n      // if a track should show by default and the display hadn't loaded yet.\n      // Should probably be moved to an external track loader when we support\n      // tracks that don't need a display.\n      player.ready(bind(_this, function () {\n        if (player.tech_ && player.tech_.featuresNativeTextTracks) {\n          this.hide();\n          return;\n        }\n\n        player.on('fullscreenchange', bind(this, this.updateDisplay));\n\n        var tracks = this.options_.playerOptions.tracks || [];\n\n        for (var i = 0; i < tracks.length; i++) {\n          this.player_.addRemoteTextTrack(tracks[i], true);\n        }\n\n        this.preselectTrack();\n      }));\n      return _this;\n    }\n\n    /**\n    * Preselect a track following this precedence:\n    * - matches the previously selected {@link TextTrack}'s language and kind\n    * - matches the previously selected {@link TextTrack}'s language only\n    * - is the first default captions track\n    * - is the first default descriptions track\n    *\n    * @listens Player#loadstart\n    */\n\n\n    TextTrackDisplay.prototype.preselectTrack = function preselectTrack() {\n      var modes = { captions: 1, subtitles: 1 };\n      var trackList = this.player_.textTracks();\n      var userPref = this.player_.cache_.selectedLanguage;\n      var firstDesc = void 0;\n      var firstCaptions = void 0;\n      var preferredTrack = void 0;\n\n      for (var i = 0; i < trackList.length; i++) {\n        var track = trackList[i];\n\n        if (userPref && userPref.enabled && userPref.language === track.language) {\n          // Always choose the track that matches both language and kind\n          if (track.kind === userPref.kind) {\n            preferredTrack = track;\n            // or choose the first track that matches language\n          } else if (!preferredTrack) {\n            preferredTrack = track;\n          }\n\n          // clear everything if offTextTrackMenuItem was clicked\n        } else if (userPref && !userPref.enabled) {\n          preferredTrack = null;\n          firstDesc = null;\n          firstCaptions = null;\n        } else if (track.default) {\n          if (track.kind === 'descriptions' && !firstDesc) {\n            firstDesc = track;\n          } else if (track.kind in modes && !firstCaptions) {\n            firstCaptions = track;\n          }\n        }\n      }\n\n      // The preferredTrack matches the user preference and takes\n      // precedence over all the other tracks.\n      // So, display the preferredTrack before the first default track\n      // and the subtitles/captions track before the descriptions track\n      if (preferredTrack) {\n        preferredTrack.mode = 'showing';\n      } else if (firstCaptions) {\n        firstCaptions.mode = 'showing';\n      } else if (firstDesc) {\n        firstDesc.mode = 'showing';\n      }\n    };\n\n    /**\n     * Turn display of {@link TextTrack}'s from the current state into the other state.\n     * There are only two states:\n     * - 'shown'\n     * - 'hidden'\n     *\n     * @listens Player#loadstart\n     */\n\n\n    TextTrackDisplay.prototype.toggleDisplay = function toggleDisplay() {\n      if (this.player_.tech_ && this.player_.tech_.featuresNativeTextTracks) {\n        this.hide();\n      } else {\n        this.show();\n      }\n    };\n\n    /**\n     * Create the {@link Component}'s DOM element.\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    TextTrackDisplay.prototype.createEl = function createEl() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-text-track-display'\n      }, {\n        'aria-live': 'off',\n        'aria-atomic': 'true'\n      });\n    };\n\n    /**\n     * Clear all displayed {@link TextTrack}s.\n     */\n\n\n    TextTrackDisplay.prototype.clearDisplay = function clearDisplay() {\n      if (typeof window_1.WebVTT === 'function') {\n        window_1.WebVTT.processCues(window_1, [], this.el_);\n      }\n    };\n\n    /**\n     * Update the displayed TextTrack when a either a {@link Player#texttrackchange} or\n     * a {@link Player#fullscreenchange} is fired.\n     *\n     * @listens Player#texttrackchange\n     * @listens Player#fullscreenchange\n     */\n\n\n    TextTrackDisplay.prototype.updateDisplay = function updateDisplay() {\n      var tracks = this.player_.textTracks();\n\n      this.clearDisplay();\n\n      // Track display prioritization model: if multiple tracks are 'showing',\n      //  display the first 'subtitles' or 'captions' track which is 'showing',\n      //  otherwise display the first 'descriptions' track which is 'showing'\n\n      var descriptionsTrack = null;\n      var captionsSubtitlesTrack = null;\n      var i = tracks.length;\n\n      while (i--) {\n        var track = tracks[i];\n\n        if (track.mode === 'showing') {\n          if (track.kind === 'descriptions') {\n            descriptionsTrack = track;\n          } else {\n            captionsSubtitlesTrack = track;\n          }\n        }\n      }\n\n      if (captionsSubtitlesTrack) {\n        if (this.getAttribute('aria-live') !== 'off') {\n          this.setAttribute('aria-live', 'off');\n        }\n        this.updateForTrack(captionsSubtitlesTrack);\n      } else if (descriptionsTrack) {\n        if (this.getAttribute('aria-live') !== 'assertive') {\n          this.setAttribute('aria-live', 'assertive');\n        }\n        this.updateForTrack(descriptionsTrack);\n      }\n    };\n\n    /**\n     * Add an {@link TextTrack} to to the {@link Tech}s {@link TextTrackList}.\n     *\n     * @param {TextTrack} track\n     *        Text track object to be added to the list.\n     */\n\n\n    TextTrackDisplay.prototype.updateForTrack = function updateForTrack(track) {\n      if (typeof window_1.WebVTT !== 'function' || !track.activeCues) {\n        return;\n      }\n\n      var cues = [];\n\n      for (var _i = 0; _i < track.activeCues.length; _i++) {\n        cues.push(track.activeCues[_i]);\n      }\n\n      window_1.WebVTT.processCues(window_1, cues, this.el_);\n\n      if (!this.player_.textTrackSettings) {\n        return;\n      }\n\n      var overrides = this.player_.textTrackSettings.getValues();\n\n      var i = cues.length;\n\n      while (i--) {\n        var cue = cues[i];\n\n        if (!cue) {\n          continue;\n        }\n\n        var cueDiv = cue.displayState;\n\n        if (overrides.color) {\n          cueDiv.firstChild.style.color = overrides.color;\n        }\n        if (overrides.textOpacity) {\n          tryUpdateStyle(cueDiv.firstChild, 'color', constructColor(overrides.color || '#fff', overrides.textOpacity));\n        }\n        if (overrides.backgroundColor) {\n          cueDiv.firstChild.style.backgroundColor = overrides.backgroundColor;\n        }\n        if (overrides.backgroundOpacity) {\n          tryUpdateStyle(cueDiv.firstChild, 'backgroundColor', constructColor(overrides.backgroundColor || '#000', overrides.backgroundOpacity));\n        }\n        if (overrides.windowColor) {\n          if (overrides.windowOpacity) {\n            tryUpdateStyle(cueDiv, 'backgroundColor', constructColor(overrides.windowColor, overrides.windowOpacity));\n          } else {\n            cueDiv.style.backgroundColor = overrides.windowColor;\n          }\n        }\n        if (overrides.edgeStyle) {\n          if (overrides.edgeStyle === 'dropshadow') {\n            cueDiv.firstChild.style.textShadow = '2px 2px 3px ' + darkGray + ', 2px 2px 4px ' + darkGray + ', 2px 2px 5px ' + darkGray;\n          } else if (overrides.edgeStyle === 'raised') {\n            cueDiv.firstChild.style.textShadow = '1px 1px ' + darkGray + ', 2px 2px ' + darkGray + ', 3px 3px ' + darkGray;\n          } else if (overrides.edgeStyle === 'depressed') {\n            cueDiv.firstChild.style.textShadow = '1px 1px ' + lightGray + ', 0 1px ' + lightGray + ', -1px -1px ' + darkGray + ', 0 -1px ' + darkGray;\n          } else if (overrides.edgeStyle === 'uniform') {\n            cueDiv.firstChild.style.textShadow = '0 0 4px ' + darkGray + ', 0 0 4px ' + darkGray + ', 0 0 4px ' + darkGray + ', 0 0 4px ' + darkGray;\n          }\n        }\n        if (overrides.fontPercent && overrides.fontPercent !== 1) {\n          var fontSize = window_1.parseFloat(cueDiv.style.fontSize);\n\n          cueDiv.style.fontSize = fontSize * overrides.fontPercent + 'px';\n          cueDiv.style.height = 'auto';\n          cueDiv.style.top = 'auto';\n          cueDiv.style.bottom = '2px';\n        }\n        if (overrides.fontFamily && overrides.fontFamily !== 'default') {\n          if (overrides.fontFamily === 'small-caps') {\n            cueDiv.firstChild.style.fontVariant = 'small-caps';\n          } else {\n            cueDiv.firstChild.style.fontFamily = fontMap[overrides.fontFamily];\n          }\n        }\n      }\n    };\n\n    return TextTrackDisplay;\n  }(Component);\n\n  Component.registerComponent('TextTrackDisplay', TextTrackDisplay);\n\n  /**\n   * @file loading-spinner.js\n   */\n\n  /**\n   * A loading spinner for use during waiting/loading events.\n   *\n   * @extends Component\n   */\n\n  var LoadingSpinner = function (_Component) {\n    inherits(LoadingSpinner, _Component);\n\n    function LoadingSpinner() {\n      classCallCheck(this, LoadingSpinner);\n      return possibleConstructorReturn(this, _Component.apply(this, arguments));\n    }\n\n    /**\n     * Create the `LoadingSpinner`s DOM element.\n     *\n     * @return {Element}\n     *         The dom element that gets created.\n     */\n    LoadingSpinner.prototype.createEl = function createEl$$1() {\n      var isAudio = this.player_.isAudio();\n      var playerType = this.localize(isAudio ? 'Audio Player' : 'Video Player');\n      var controlText = createEl('span', {\n        className: 'vjs-control-text',\n        innerHTML: this.localize('{1} is loading.', [playerType])\n      });\n\n      var el = _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-loading-spinner',\n        dir: 'ltr'\n      });\n\n      el.appendChild(controlText);\n\n      return el;\n    };\n\n    return LoadingSpinner;\n  }(Component);\n\n  Component.registerComponent('LoadingSpinner', LoadingSpinner);\n\n  /**\n   * @file button.js\n   */\n\n  /**\n   * Base class for all buttons.\n   *\n   * @extends ClickableComponent\n   */\n\n  var Button = function (_ClickableComponent) {\n    inherits(Button, _ClickableComponent);\n\n    function Button() {\n      classCallCheck(this, Button);\n      return possibleConstructorReturn(this, _ClickableComponent.apply(this, arguments));\n    }\n\n    /**\n     * Create the `Button`s DOM element.\n     *\n     * @param {string} [tag=\"button\"]\n     *        The element's node type. This argument is IGNORED: no matter what\n     *        is passed, it will always create a `button` element.\n     *\n     * @param {Object} [props={}]\n     *        An object of properties that should be set on the element.\n     *\n     * @param {Object} [attributes={}]\n     *        An object of attributes that should be set on the element.\n     *\n     * @return {Element}\n     *         The element that gets created.\n     */\n    Button.prototype.createEl = function createEl(tag) {\n      var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      tag = 'button';\n\n      props = assign({\n        innerHTML: '<span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>',\n        className: this.buildCSSClass()\n      }, props);\n\n      // Add attributes for button element\n      attributes = assign({\n\n        // Necessary since the default button type is \"submit\"\n        type: 'button'\n      }, attributes);\n\n      var el = Component.prototype.createEl.call(this, tag, props, attributes);\n\n      this.createControlTextEl(el);\n\n      return el;\n    };\n\n    /**\n     * Add a child `Component` inside of this `Button`.\n     *\n     * @param {string|Component} child\n     *        The name or instance of a child to add.\n     *\n     * @param {Object} [options={}]\n     *        The key/value store of options that will get passed to children of\n     *        the child.\n     *\n     * @return {Component}\n     *         The `Component` that gets added as a child. When using a string the\n     *         `Component` will get created by this process.\n     *\n     * @deprecated since version 5\n     */\n\n\n    Button.prototype.addChild = function addChild(child) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var className = this.constructor.name;\n\n      log$1.warn('Adding an actionable (user controllable) child to a Button (' + className + ') is not supported; use a ClickableComponent instead.');\n\n      // Avoid the error message generated by ClickableComponent's addChild method\n      return Component.prototype.addChild.call(this, child, options);\n    };\n\n    /**\n     * Enable the `Button` element so that it can be activated or clicked. Use this with\n     * {@link Button#disable}.\n     */\n\n\n    Button.prototype.enable = function enable() {\n      _ClickableComponent.prototype.enable.call(this);\n      this.el_.removeAttribute('disabled');\n    };\n\n    /**\n     * Disable the `Button` element so that it cannot be activated or clicked. Use this with\n     * {@link Button#enable}.\n     */\n\n\n    Button.prototype.disable = function disable() {\n      _ClickableComponent.prototype.disable.call(this);\n      this.el_.setAttribute('disabled', 'disabled');\n    };\n\n    /**\n     * This gets called when a `Button` has focus and `keydown` is triggered via a key\n     * press.\n     *\n     * @param {EventTarget~Event} event\n     *        The event that caused this function to get called.\n     *\n     * @listens keydown\n     */\n\n\n    Button.prototype.handleKeyPress = function handleKeyPress(event) {\n\n      // Ignore Space (32) or Enter (13) key operation, which is handled by the browser for a button.\n      if (event.which === 32 || event.which === 13) {\n        return;\n      }\n\n      // Pass keypress handling up for unsupported keys\n      _ClickableComponent.prototype.handleKeyPress.call(this, event);\n    };\n\n    return Button;\n  }(ClickableComponent);\n\n  Component.registerComponent('Button', Button);\n\n  /**\n   * @file big-play-button.js\n   */\n\n  /**\n   * The initial play button that shows before the video has played. The hiding of the\n   * `BigPlayButton` get done via CSS and `Player` states.\n   *\n   * @extends Button\n   */\n\n  var BigPlayButton = function (_Button) {\n    inherits(BigPlayButton, _Button);\n\n    function BigPlayButton(player, options) {\n      classCallCheck(this, BigPlayButton);\n\n      var _this = possibleConstructorReturn(this, _Button.call(this, player, options));\n\n      _this.mouseused_ = false;\n\n      _this.on('mousedown', _this.handleMouseDown);\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object. Always returns 'vjs-big-play-button'.\n     */\n\n\n    BigPlayButton.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-big-play-button';\n    };\n\n    /**\n     * This gets called when a `BigPlayButton` \"clicked\". See {@link ClickableComponent}\n     * for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    BigPlayButton.prototype.handleClick = function handleClick(event) {\n      var playPromise = this.player_.play();\n\n      // exit early if clicked via the mouse\n      if (this.mouseused_ && event.clientX && event.clientY) {\n        return;\n      }\n\n      var cb = this.player_.getChild('controlBar');\n      var playToggle = cb && cb.getChild('playToggle');\n\n      if (!playToggle) {\n        this.player_.focus();\n        return;\n      }\n\n      var playFocus = function playFocus() {\n        return playToggle.focus();\n      };\n\n      if (isPromise(playPromise)) {\n        playPromise.then(playFocus, function () {});\n      } else {\n        this.setTimeout(playFocus, 1);\n      }\n    };\n\n    BigPlayButton.prototype.handleKeyPress = function handleKeyPress(event) {\n      this.mouseused_ = false;\n\n      _Button.prototype.handleKeyPress.call(this, event);\n    };\n\n    BigPlayButton.prototype.handleMouseDown = function handleMouseDown(event) {\n      this.mouseused_ = true;\n    };\n\n    return BigPlayButton;\n  }(Button);\n\n  /**\n   * The text that should display over the `BigPlayButton`s controls. Added to for localization.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  BigPlayButton.prototype.controlText_ = 'Play Video';\n\n  Component.registerComponent('BigPlayButton', BigPlayButton);\n\n  /**\n   * @file close-button.js\n   */\n\n  /**\n   * The `CloseButton` is a `{@link Button}` that fires a `close` event when\n   * it gets clicked.\n   *\n   * @extends Button\n   */\n\n  var CloseButton = function (_Button) {\n    inherits(CloseButton, _Button);\n\n    /**\n     * Creates an instance of the this class.\n     *\n     * @param  {Player} player\n     *         The `Player` that this class should be attached to.\n     *\n     * @param  {Object} [options]\n     *         The key/value store of player options.\n     */\n    function CloseButton(player, options) {\n      classCallCheck(this, CloseButton);\n\n      var _this = possibleConstructorReturn(this, _Button.call(this, player, options));\n\n      _this.controlText(options && options.controlText || _this.localize('Close'));\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    CloseButton.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-close-button ' + _Button.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * This gets called when a `CloseButton` gets clicked. See\n     * {@link ClickableComponent#handleClick} for more information on when this will be\n     * triggered\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     * @fires CloseButton#close\n     */\n\n\n    CloseButton.prototype.handleClick = function handleClick(event) {\n\n      /**\n       * Triggered when the a `CloseButton` is clicked.\n       *\n       * @event CloseButton#close\n       * @type {EventTarget~Event}\n       *\n       * @property {boolean} [bubbles=false]\n       *           set to false so that the close event does not\n       *           bubble up to parents if there is no listener\n       */\n      this.trigger({ type: 'close', bubbles: false });\n    };\n\n    return CloseButton;\n  }(Button);\n\n  Component.registerComponent('CloseButton', CloseButton);\n\n  /**\n   * @file play-toggle.js\n   */\n\n  /**\n   * Button to toggle between play and pause.\n   *\n   * @extends Button\n   */\n\n  var PlayToggle = function (_Button) {\n    inherits(PlayToggle, _Button);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function PlayToggle(player, options) {\n      classCallCheck(this, PlayToggle);\n\n      var _this = possibleConstructorReturn(this, _Button.call(this, player, options));\n\n      _this.on(player, 'play', _this.handlePlay);\n      _this.on(player, 'pause', _this.handlePause);\n      _this.on(player, 'ended', _this.handleEnded);\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    PlayToggle.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-play-control ' + _Button.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * This gets called when an `PlayToggle` is \"clicked\". See\n     * {@link ClickableComponent} for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    PlayToggle.prototype.handleClick = function handleClick(event) {\n      if (this.player_.paused()) {\n        this.player_.play();\n      } else {\n        this.player_.pause();\n      }\n    };\n\n    /**\n     * This gets called once after the video has ended and the user seeks so that\n     * we can change the replay button back to a play button.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The event that caused this function to run.\n     *\n     * @listens Player#seeked\n     */\n\n\n    PlayToggle.prototype.handleSeeked = function handleSeeked(event) {\n      this.removeClass('vjs-ended');\n\n      if (this.player_.paused()) {\n        this.handlePause(event);\n      } else {\n        this.handlePlay(event);\n      }\n    };\n\n    /**\n     * Add the vjs-playing class to the element so it can change appearance.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The event that caused this function to run.\n     *\n     * @listens Player#play\n     */\n\n\n    PlayToggle.prototype.handlePlay = function handlePlay(event) {\n      this.removeClass('vjs-ended');\n      this.removeClass('vjs-paused');\n      this.addClass('vjs-playing');\n      // change the button text to \"Pause\"\n      this.controlText('Pause');\n    };\n\n    /**\n     * Add the vjs-paused class to the element so it can change appearance.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The event that caused this function to run.\n     *\n     * @listens Player#pause\n     */\n\n\n    PlayToggle.prototype.handlePause = function handlePause(event) {\n      this.removeClass('vjs-playing');\n      this.addClass('vjs-paused');\n      // change the button text to \"Play\"\n      this.controlText('Play');\n    };\n\n    /**\n     * Add the vjs-ended class to the element so it can change appearance\n     *\n     * @param {EventTarget~Event} [event]\n     *        The event that caused this function to run.\n     *\n     * @listens Player#ended\n     */\n\n\n    PlayToggle.prototype.handleEnded = function handleEnded(event) {\n      this.removeClass('vjs-playing');\n      this.addClass('vjs-ended');\n      // change the button text to \"Replay\"\n      this.controlText('Replay');\n\n      // on the next seek remove the replay button\n      this.one(this.player_, 'seeked', this.handleSeeked);\n    };\n\n    return PlayToggle;\n  }(Button);\n\n  /**\n   * The text that should display over the `PlayToggle`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  PlayToggle.prototype.controlText_ = 'Play';\n\n  Component.registerComponent('PlayToggle', PlayToggle);\n\n  /**\n   * @file format-time.js\n   * @module format-time\n   */\n\n  /**\n  * Format seconds as a time string, H:MM:SS or M:SS. Supplying a guide (in seconds)\n  * will force a number of leading zeros to cover the length of the guide.\n  *\n  * @param {number} seconds\n  *        Number of seconds to be turned into a string\n  *\n  * @param {number} guide\n  *        Number (in seconds) to model the string after\n  *\n  * @return {string}\n  *         Time formatted as H:MM:SS or M:SS\n  */\n  var defaultImplementation = function defaultImplementation(seconds, guide) {\n    seconds = seconds < 0 ? 0 : seconds;\n    var s = Math.floor(seconds % 60);\n    var m = Math.floor(seconds / 60 % 60);\n    var h = Math.floor(seconds / 3600);\n    var gm = Math.floor(guide / 60 % 60);\n    var gh = Math.floor(guide / 3600);\n\n    // handle invalid times\n    if (isNaN(seconds) || seconds === Infinity) {\n      // '-' is false for all relational operators (e.g. <, >=) so this setting\n      // will add the minimum number of fields specified by the guide\n      h = m = s = '-';\n    }\n\n    // Check if we need to show hours\n    h = h > 0 || gh > 0 ? h + ':' : '';\n\n    // If hours are showing, we may need to add a leading zero.\n    // Always show at least one digit of minutes.\n    m = ((h || gm >= 10) && m < 10 ? '0' + m : m) + ':';\n\n    // Check if leading zero is need for seconds\n    s = s < 10 ? '0' + s : s;\n\n    return h + m + s;\n  };\n\n  var implementation = defaultImplementation;\n\n  /**\n   * Replaces the default formatTime implementation with a custom implementation.\n   *\n   * @param {Function} customImplementation\n   *        A function which will be used in place of the default formatTime implementation.\n   *        Will receive the current time in seconds and the guide (in seconds) as arguments.\n   */\n  function setFormatTime(customImplementation) {\n    implementation = customImplementation;\n  }\n\n  /**\n   * Resets formatTime to the default implementation.\n   */\n  function resetFormatTime() {\n    implementation = defaultImplementation;\n  }\n\n  function formatTime (seconds) {\n    var guide = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : seconds;\n\n    return implementation(seconds, guide);\n  }\n\n  /**\n   * @file time-display.js\n   */\n\n  /**\n   * Displays the time left in the video\n   *\n   * @extends Component\n   */\n\n  var TimeDisplay = function (_Component) {\n    inherits(TimeDisplay, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function TimeDisplay(player, options) {\n      classCallCheck(this, TimeDisplay);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      _this.throttledUpdateContent = throttle(bind(_this, _this.updateContent), 25);\n      _this.on(player, 'timeupdate', _this.throttledUpdateContent);\n      return _this;\n    }\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    TimeDisplay.prototype.createEl = function createEl$$1(plainName) {\n      var className = this.buildCSSClass();\n      var el = _Component.prototype.createEl.call(this, 'div', {\n        className: className + ' vjs-time-control vjs-control',\n        innerHTML: '<span class=\"vjs-control-text\">' + this.localize(this.labelText_) + '\\xA0</span>'\n      });\n\n      this.contentEl_ = createEl('span', {\n        className: className + '-display'\n      }, {\n        // tell screen readers not to automatically read the time as it changes\n        'aria-live': 'off'\n      });\n\n      this.updateTextNode_();\n      el.appendChild(this.contentEl_);\n      return el;\n    };\n\n    TimeDisplay.prototype.dispose = function dispose() {\n      this.contentEl_ = null;\n      this.textNode_ = null;\n\n      _Component.prototype.dispose.call(this);\n    };\n\n    /**\n     * Updates the \"remaining time\" text node with new content using the\n     * contents of the `formattedTime_` property.\n     *\n     * @private\n     */\n\n\n    TimeDisplay.prototype.updateTextNode_ = function updateTextNode_() {\n      if (!this.contentEl_) {\n        return;\n      }\n\n      while (this.contentEl_.firstChild) {\n        this.contentEl_.removeChild(this.contentEl_.firstChild);\n      }\n\n      this.textNode_ = document_1.createTextNode(this.formattedTime_ || this.formatTime_(0));\n      this.contentEl_.appendChild(this.textNode_);\n    };\n\n    /**\n     * Generates a formatted time for this component to use in display.\n     *\n     * @param  {number} time\n     *         A numeric time, in seconds.\n     *\n     * @return {string}\n     *         A formatted time\n     *\n     * @private\n     */\n\n\n    TimeDisplay.prototype.formatTime_ = function formatTime_(time) {\n      return formatTime(time);\n    };\n\n    /**\n     * Updates the time display text node if it has what was passed in changed\n     * the formatted time.\n     *\n     * @param {number} time\n     *        The time to update to\n     *\n     * @private\n     */\n\n\n    TimeDisplay.prototype.updateFormattedTime_ = function updateFormattedTime_(time) {\n      var formattedTime = this.formatTime_(time);\n\n      if (formattedTime === this.formattedTime_) {\n        return;\n      }\n\n      this.formattedTime_ = formattedTime;\n      this.requestAnimationFrame(this.updateTextNode_);\n    };\n\n    /**\n     * To be filled out in the child class, should update the displayed time\n     * in accordance with the fact that the current time has changed.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `timeupdate`  event that caused this to run.\n     *\n     * @listens Player#timeupdate\n     */\n\n\n    TimeDisplay.prototype.updateContent = function updateContent(event) {};\n\n    return TimeDisplay;\n  }(Component);\n\n  /**\n   * The text that is added to the `TimeDisplay` for screen reader users.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  TimeDisplay.prototype.labelText_ = 'Time';\n\n  /**\n   * The text that should display over the `TimeDisplay`s controls. Added to for localization.\n   *\n   * @type {string}\n   * @private\n   *\n   * @deprecated in v7; controlText_ is not used in non-active display Components\n   */\n  TimeDisplay.prototype.controlText_ = 'Time';\n\n  Component.registerComponent('TimeDisplay', TimeDisplay);\n\n  /**\n   * @file current-time-display.js\n   */\n\n  /**\n   * Displays the current time\n   *\n   * @extends Component\n   */\n\n  var CurrentTimeDisplay = function (_TimeDisplay) {\n    inherits(CurrentTimeDisplay, _TimeDisplay);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function CurrentTimeDisplay(player, options) {\n      classCallCheck(this, CurrentTimeDisplay);\n\n      var _this = possibleConstructorReturn(this, _TimeDisplay.call(this, player, options));\n\n      _this.on(player, 'ended', _this.handleEnded);\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    CurrentTimeDisplay.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-current-time';\n    };\n\n    /**\n     * Update current time display\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `timeupdate` event that caused this function to run.\n     *\n     * @listens Player#timeupdate\n     */\n\n\n    CurrentTimeDisplay.prototype.updateContent = function updateContent(event) {\n      // Allows for smooth scrubbing, when player can't keep up.\n      var time = this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime();\n\n      this.updateFormattedTime_(time);\n    };\n\n    /**\n     * When the player fires ended there should be no time left. Sadly\n     * this is not always the case, lets make it seem like that is the case\n     * for users.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `ended` event that caused this to run.\n     *\n     * @listens Player#ended\n     */\n\n\n    CurrentTimeDisplay.prototype.handleEnded = function handleEnded(event) {\n      if (!this.player_.duration()) {\n        return;\n      }\n      this.updateFormattedTime_(this.player_.duration());\n    };\n\n    return CurrentTimeDisplay;\n  }(TimeDisplay);\n\n  /**\n   * The text that is added to the `CurrentTimeDisplay` for screen reader users.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  CurrentTimeDisplay.prototype.labelText_ = 'Current Time';\n\n  /**\n   * The text that should display over the `CurrentTimeDisplay`s controls. Added to for localization.\n   *\n   * @type {string}\n   * @private\n   *\n   * @deprecated in v7; controlText_ is not used in non-active display Components\n   */\n  CurrentTimeDisplay.prototype.controlText_ = 'Current Time';\n\n  Component.registerComponent('CurrentTimeDisplay', CurrentTimeDisplay);\n\n  /**\n   * @file duration-display.js\n   */\n\n  /**\n   * Displays the duration\n   *\n   * @extends Component\n   */\n\n  var DurationDisplay = function (_TimeDisplay) {\n    inherits(DurationDisplay, _TimeDisplay);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function DurationDisplay(player, options) {\n      classCallCheck(this, DurationDisplay);\n\n      // we do not want to/need to throttle duration changes,\n      // as they should always display the changed duration as\n      // it has changed\n      var _this = possibleConstructorReturn(this, _TimeDisplay.call(this, player, options));\n\n      _this.on(player, 'durationchange', _this.updateContent);\n\n      // Also listen for timeupdate (in the parent) and loadedmetadata because removing those\n      // listeners could have broken dependent applications/libraries. These\n      // can likely be removed for 7.0.\n      _this.on(player, 'loadedmetadata', _this.throttledUpdateContent);\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    DurationDisplay.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-duration';\n    };\n\n    /**\n     * Update duration time display.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `durationchange`, `timeupdate`, or `loadedmetadata` event that caused\n     *        this function to be called.\n     *\n     * @listens Player#durationchange\n     * @listens Player#timeupdate\n     * @listens Player#loadedmetadata\n     */\n\n\n    DurationDisplay.prototype.updateContent = function updateContent(event) {\n      var duration = this.player_.duration();\n\n      if (duration && this.duration_ !== duration) {\n        this.duration_ = duration;\n        this.updateFormattedTime_(duration);\n      }\n    };\n\n    return DurationDisplay;\n  }(TimeDisplay);\n\n  /**\n   * The text that is added to the `DurationDisplay` for screen reader users.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  DurationDisplay.prototype.labelText_ = 'Duration';\n\n  /**\n   * The text that should display over the `DurationDisplay`s controls. Added to for localization.\n   *\n   * @type {string}\n   * @private\n   *\n   * @deprecated in v7; controlText_ is not used in non-active display Components\n   */\n  DurationDisplay.prototype.controlText_ = 'Duration';\n\n  Component.registerComponent('DurationDisplay', DurationDisplay);\n\n  /**\n   * @file time-divider.js\n   */\n\n  /**\n   * The separator between the current time and duration.\n   * Can be hidden if it's not needed in the design.\n   *\n   * @extends Component\n   */\n\n  var TimeDivider = function (_Component) {\n    inherits(TimeDivider, _Component);\n\n    function TimeDivider() {\n      classCallCheck(this, TimeDivider);\n      return possibleConstructorReturn(this, _Component.apply(this, arguments));\n    }\n\n    /**\n     * Create the component's DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n    TimeDivider.prototype.createEl = function createEl() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-time-control vjs-time-divider',\n        innerHTML: '<div><span>/</span></div>'\n      });\n    };\n\n    return TimeDivider;\n  }(Component);\n\n  Component.registerComponent('TimeDivider', TimeDivider);\n\n  /**\n   * @file remaining-time-display.js\n   */\n  /**\n   * Displays the time left in the video\n   *\n   * @extends Component\n   */\n\n  var RemainingTimeDisplay = function (_TimeDisplay) {\n    inherits(RemainingTimeDisplay, _TimeDisplay);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function RemainingTimeDisplay(player, options) {\n      classCallCheck(this, RemainingTimeDisplay);\n\n      var _this = possibleConstructorReturn(this, _TimeDisplay.call(this, player, options));\n\n      _this.on(player, 'durationchange', _this.throttledUpdateContent);\n      _this.on(player, 'ended', _this.handleEnded);\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    RemainingTimeDisplay.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-remaining-time';\n    };\n\n    /**\n     * The remaining time display prefixes numbers with a \"minus\" character.\n     *\n     * @param  {number} time\n     *         A numeric time, in seconds.\n     *\n     * @return {string}\n     *         A formatted time\n     *\n     * @private\n     */\n\n\n    RemainingTimeDisplay.prototype.formatTime_ = function formatTime_(time) {\n      // TODO: The \"-\" should be decorative, and not announced by a screen reader\n      return '-' + _TimeDisplay.prototype.formatTime_.call(this, time);\n    };\n\n    /**\n     * Update remaining time display.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `timeupdate` or `durationchange` event that caused this to run.\n     *\n     * @listens Player#timeupdate\n     * @listens Player#durationchange\n     */\n\n\n    RemainingTimeDisplay.prototype.updateContent = function updateContent(event) {\n      if (!this.player_.duration()) {\n        return;\n      }\n\n      // @deprecated We should only use remainingTimeDisplay\n      // as of video.js 7\n      if (this.player_.remainingTimeDisplay) {\n        this.updateFormattedTime_(this.player_.remainingTimeDisplay());\n      } else {\n        this.updateFormattedTime_(this.player_.remainingTime());\n      }\n    };\n\n    /**\n     * When the player fires ended there should be no time left. Sadly\n     * this is not always the case, lets make it seem like that is the case\n     * for users.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `ended` event that caused this to run.\n     *\n     * @listens Player#ended\n     */\n\n\n    RemainingTimeDisplay.prototype.handleEnded = function handleEnded(event) {\n      if (!this.player_.duration()) {\n        return;\n      }\n      this.updateFormattedTime_(0);\n    };\n\n    return RemainingTimeDisplay;\n  }(TimeDisplay);\n\n  /**\n   * The text that is added to the `RemainingTimeDisplay` for screen reader users.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  RemainingTimeDisplay.prototype.labelText_ = 'Remaining Time';\n\n  /**\n   * The text that should display over the `RemainingTimeDisplay`s controls. Added to for localization.\n   *\n   * @type {string}\n   * @private\n   *\n   * @deprecated in v7; controlText_ is not used in non-active display Components\n   */\n  RemainingTimeDisplay.prototype.controlText_ = 'Remaining Time';\n\n  Component.registerComponent('RemainingTimeDisplay', RemainingTimeDisplay);\n\n  /**\n   * @file live-display.js\n   */\n\n  // TODO - Future make it click to snap to live\n\n  /**\n   * Displays the live indicator when duration is Infinity.\n   *\n   * @extends Component\n   */\n\n  var LiveDisplay = function (_Component) {\n    inherits(LiveDisplay, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function LiveDisplay(player, options) {\n      classCallCheck(this, LiveDisplay);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      _this.updateShowing();\n      _this.on(_this.player(), 'durationchange', _this.updateShowing);\n      return _this;\n    }\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    LiveDisplay.prototype.createEl = function createEl$$1() {\n      var el = _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-live-control vjs-control'\n      });\n\n      this.contentEl_ = createEl('div', {\n        className: 'vjs-live-display',\n        innerHTML: '<span class=\"vjs-control-text\">' + this.localize('Stream Type') + '\\xA0</span>' + this.localize('LIVE')\n      }, {\n        'aria-live': 'off'\n      });\n\n      el.appendChild(this.contentEl_);\n      return el;\n    };\n\n    LiveDisplay.prototype.dispose = function dispose() {\n      this.contentEl_ = null;\n\n      _Component.prototype.dispose.call(this);\n    };\n\n    /**\n     * Check the duration to see if the LiveDisplay should be showing or not. Then show/hide\n     * it accordingly\n     *\n     * @param {EventTarget~Event} [event]\n     *        The {@link Player#durationchange} event that caused this function to run.\n     *\n     * @listens Player#durationchange\n     */\n\n\n    LiveDisplay.prototype.updateShowing = function updateShowing(event) {\n      if (this.player().duration() === Infinity) {\n        this.show();\n      } else {\n        this.hide();\n      }\n    };\n\n    return LiveDisplay;\n  }(Component);\n\n  Component.registerComponent('LiveDisplay', LiveDisplay);\n\n  /**\n   * @file slider.js\n   */\n\n  /**\n   * The base functionality for a slider. Can be vertical or horizontal.\n   * For instance the volume bar or the seek bar on a video is a slider.\n   *\n   * @extends Component\n   */\n\n  var Slider = function (_Component) {\n    inherits(Slider, _Component);\n\n    /**\n     * Create an instance of this class\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function Slider(player, options) {\n      classCallCheck(this, Slider);\n\n      // Set property names to bar to match with the child Slider class is looking for\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      _this.bar = _this.getChild(_this.options_.barName);\n\n      // Set a horizontal or vertical class on the slider depending on the slider type\n      _this.vertical(!!_this.options_.vertical);\n\n      _this.enable();\n      return _this;\n    }\n\n    /**\n     * Are controls are currently enabled for this slider or not.\n     *\n     * @return {boolean}\n     *         true if controls are enabled, false otherwise\n     */\n\n\n    Slider.prototype.enabled = function enabled() {\n      return this.enabled_;\n    };\n\n    /**\n     * Enable controls for this slider if they are disabled\n     */\n\n\n    Slider.prototype.enable = function enable() {\n      if (this.enabled()) {\n        return;\n      }\n\n      this.on('mousedown', this.handleMouseDown);\n      this.on('touchstart', this.handleMouseDown);\n      this.on('focus', this.handleFocus);\n      this.on('blur', this.handleBlur);\n      this.on('click', this.handleClick);\n\n      this.on(this.player_, 'controlsvisible', this.update);\n\n      if (this.playerEvent) {\n        this.on(this.player_, this.playerEvent, this.update);\n      }\n\n      this.removeClass('disabled');\n      this.setAttribute('tabindex', 0);\n\n      this.enabled_ = true;\n    };\n\n    /**\n     * Disable controls for this slider if they are enabled\n     */\n\n\n    Slider.prototype.disable = function disable() {\n      if (!this.enabled()) {\n        return;\n      }\n      var doc = this.bar.el_.ownerDocument;\n\n      this.off('mousedown', this.handleMouseDown);\n      this.off('touchstart', this.handleMouseDown);\n      this.off('focus', this.handleFocus);\n      this.off('blur', this.handleBlur);\n      this.off('click', this.handleClick);\n      this.off(this.player_, 'controlsvisible', this.update);\n      this.off(doc, 'mousemove', this.handleMouseMove);\n      this.off(doc, 'mouseup', this.handleMouseUp);\n      this.off(doc, 'touchmove', this.handleMouseMove);\n      this.off(doc, 'touchend', this.handleMouseUp);\n      this.removeAttribute('tabindex');\n\n      this.addClass('disabled');\n\n      if (this.playerEvent) {\n        this.off(this.player_, this.playerEvent, this.update);\n      }\n      this.enabled_ = false;\n    };\n\n    /**\n     * Create the `Slider`s DOM element.\n     *\n     * @param {string} type\n     *        Type of element to create.\n     *\n     * @param {Object} [props={}]\n     *        List of properties in Object form.\n     *\n     * @param {Object} [attributes={}]\n     *        list of attributes in Object form.\n     *\n     * @return {Element}\n     *         The element that gets created.\n     */\n\n\n    Slider.prototype.createEl = function createEl$$1(type) {\n      var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      // Add the slider element class to all sub classes\n      props.className = props.className + ' vjs-slider';\n      props = assign({\n        tabIndex: 0\n      }, props);\n\n      attributes = assign({\n        'role': 'slider',\n        'aria-valuenow': 0,\n        'aria-valuemin': 0,\n        'aria-valuemax': 100,\n        'tabIndex': 0\n      }, attributes);\n\n      return _Component.prototype.createEl.call(this, type, props, attributes);\n    };\n\n    /**\n     * Handle `mousedown` or `touchstart` events on the `Slider`.\n     *\n     * @param {EventTarget~Event} event\n     *        `mousedown` or `touchstart` event that triggered this function\n     *\n     * @listens mousedown\n     * @listens touchstart\n     * @fires Slider#slideractive\n     */\n\n\n    Slider.prototype.handleMouseDown = function handleMouseDown(event) {\n      var doc = this.bar.el_.ownerDocument;\n\n      event.preventDefault();\n      blockTextSelection();\n\n      this.addClass('vjs-sliding');\n      /**\n       * Triggered when the slider is in an active state\n       *\n       * @event Slider#slideractive\n       * @type {EventTarget~Event}\n       */\n      this.trigger('slideractive');\n\n      this.on(doc, 'mousemove', this.handleMouseMove);\n      this.on(doc, 'mouseup', this.handleMouseUp);\n      this.on(doc, 'touchmove', this.handleMouseMove);\n      this.on(doc, 'touchend', this.handleMouseUp);\n\n      this.handleMouseMove(event);\n    };\n\n    /**\n     * Handle the `mousemove`, `touchmove`, and `mousedown` events on this `Slider`.\n     * The `mousemove` and `touchmove` events will only only trigger this function during\n     * `mousedown` and `touchstart`. This is due to {@link Slider#handleMouseDown} and\n     * {@link Slider#handleMouseUp}.\n     *\n     * @param {EventTarget~Event} event\n     *        `mousedown`, `mousemove`, `touchstart`, or `touchmove` event that triggered\n     *        this function\n     *\n     * @listens mousemove\n     * @listens touchmove\n     */\n\n\n    Slider.prototype.handleMouseMove = function handleMouseMove(event) {};\n\n    /**\n     * Handle `mouseup` or `touchend` events on the `Slider`.\n     *\n     * @param {EventTarget~Event} event\n     *        `mouseup` or `touchend` event that triggered this function.\n     *\n     * @listens touchend\n     * @listens mouseup\n     * @fires Slider#sliderinactive\n     */\n\n\n    Slider.prototype.handleMouseUp = function handleMouseUp() {\n      var doc = this.bar.el_.ownerDocument;\n\n      unblockTextSelection();\n\n      this.removeClass('vjs-sliding');\n      /**\n       * Triggered when the slider is no longer in an active state.\n       *\n       * @event Slider#sliderinactive\n       * @type {EventTarget~Event}\n       */\n      this.trigger('sliderinactive');\n\n      this.off(doc, 'mousemove', this.handleMouseMove);\n      this.off(doc, 'mouseup', this.handleMouseUp);\n      this.off(doc, 'touchmove', this.handleMouseMove);\n      this.off(doc, 'touchend', this.handleMouseUp);\n\n      this.update();\n    };\n\n    /**\n     * Update the progress bar of the `Slider`.\n     *\n     * @returns {number}\n     *          The percentage of progress the progress bar represents as a\n     *          number from 0 to 1.\n     */\n\n\n    Slider.prototype.update = function update() {\n\n      // In VolumeBar init we have a setTimeout for update that pops and update\n      // to the end of the execution stack. The player is destroyed before then\n      // update will cause an error\n      if (!this.el_) {\n        return;\n      }\n\n      // If scrubbing, we could use a cached value to make the handle keep up\n      // with the user's mouse. On HTML5 browsers scrubbing is really smooth, but\n      // some flash players are slow, so we might want to utilize this later.\n      // var progress =  (this.player_.scrubbing()) ? this.player_.getCache().currentTime / this.player_.duration() : this.player_.currentTime() / this.player_.duration();\n      var progress = this.getPercent();\n      var bar = this.bar;\n\n      // If there's no bar...\n      if (!bar) {\n        return;\n      }\n\n      // Protect against no duration and other division issues\n      if (typeof progress !== 'number' || progress !== progress || progress < 0 || progress === Infinity) {\n        progress = 0;\n      }\n\n      // Convert to a percentage for setting\n      var percentage = (progress * 100).toFixed(2) + '%';\n      var style = bar.el().style;\n\n      // Set the new bar width or height\n      if (this.vertical()) {\n        style.height = percentage;\n      } else {\n        style.width = percentage;\n      }\n\n      return progress;\n    };\n\n    /**\n     * Calculate distance for slider\n     *\n     * @param {EventTarget~Event} event\n     *        The event that caused this function to run.\n     *\n     * @return {number}\n     *         The current position of the Slider.\n     *         - position.x for vertical `Slider`s\n     *         - position.y for horizontal `Slider`s\n     */\n\n\n    Slider.prototype.calculateDistance = function calculateDistance(event) {\n      var position = getPointerPosition(this.el_, event);\n\n      if (this.vertical()) {\n        return position.y;\n      }\n      return position.x;\n    };\n\n    /**\n     * Handle a `focus` event on this `Slider`.\n     *\n     * @param {EventTarget~Event} event\n     *        The `focus` event that caused this function to run.\n     *\n     * @listens focus\n     */\n\n\n    Slider.prototype.handleFocus = function handleFocus() {\n      this.on(this.bar.el_.ownerDocument, 'keydown', this.handleKeyPress);\n    };\n\n    /**\n     * Handle a `keydown` event on the `Slider`. Watches for left, rigth, up, and down\n     * arrow keys. This function will only be called when the slider has focus. See\n     * {@link Slider#handleFocus} and {@link Slider#handleBlur}.\n     *\n     * @param {EventTarget~Event} event\n     *        the `keydown` event that caused this function to run.\n     *\n     * @listens keydown\n     */\n\n\n    Slider.prototype.handleKeyPress = function handleKeyPress(event) {\n      // Left and Down Arrows\n      if (event.which === 37 || event.which === 40) {\n        event.preventDefault();\n        this.stepBack();\n\n        // Up and Right Arrows\n      } else if (event.which === 38 || event.which === 39) {\n        event.preventDefault();\n        this.stepForward();\n      }\n    };\n\n    /**\n     * Handle a `blur` event on this `Slider`.\n     *\n     * @param {EventTarget~Event} event\n     *        The `blur` event that caused this function to run.\n     *\n     * @listens blur\n     */\n\n    Slider.prototype.handleBlur = function handleBlur() {\n      this.off(this.bar.el_.ownerDocument, 'keydown', this.handleKeyPress);\n    };\n\n    /**\n     * Listener for click events on slider, used to prevent clicks\n     *   from bubbling up to parent elements like button menus.\n     *\n     * @param {Object} event\n     *        Event that caused this object to run\n     */\n\n\n    Slider.prototype.handleClick = function handleClick(event) {\n      event.stopImmediatePropagation();\n      event.preventDefault();\n    };\n\n    /**\n     * Get/set if slider is horizontal for vertical\n     *\n     * @param {boolean} [bool]\n     *        - true if slider is vertical,\n     *        - false is horizontal\n     *\n     * @return {boolean}\n     *         - true if slider is vertical, and getting\n     *         - false if the slider is horizontal, and getting\n     */\n\n\n    Slider.prototype.vertical = function vertical(bool) {\n      if (bool === undefined) {\n        return this.vertical_ || false;\n      }\n\n      this.vertical_ = !!bool;\n\n      if (this.vertical_) {\n        this.addClass('vjs-slider-vertical');\n      } else {\n        this.addClass('vjs-slider-horizontal');\n      }\n    };\n\n    return Slider;\n  }(Component);\n\n  Component.registerComponent('Slider', Slider);\n\n  /**\n   * @file load-progress-bar.js\n   */\n\n  /**\n   * Shows loading progress\n   *\n   * @extends Component\n   */\n\n  var LoadProgressBar = function (_Component) {\n    inherits(LoadProgressBar, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function LoadProgressBar(player, options) {\n      classCallCheck(this, LoadProgressBar);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      _this.partEls_ = [];\n      _this.on(player, 'progress', _this.update);\n      return _this;\n    }\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    LoadProgressBar.prototype.createEl = function createEl$$1() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-load-progress',\n        innerHTML: '<span class=\"vjs-control-text\"><span>' + this.localize('Loaded') + '</span>: 0%</span>'\n      });\n    };\n\n    LoadProgressBar.prototype.dispose = function dispose() {\n      this.partEls_ = null;\n\n      _Component.prototype.dispose.call(this);\n    };\n\n    /**\n     * Update progress bar\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `progress` event that caused this function to run.\n     *\n     * @listens Player#progress\n     */\n\n\n    LoadProgressBar.prototype.update = function update(event) {\n      var buffered = this.player_.buffered();\n      var duration = this.player_.duration();\n      var bufferedEnd = this.player_.bufferedEnd();\n      var children = this.partEls_;\n\n      // get the percent width of a time compared to the total end\n      var percentify = function percentify(time, end) {\n        // no NaN\n        var percent = time / end || 0;\n\n        return (percent >= 1 ? 1 : percent) * 100 + '%';\n      };\n\n      // update the width of the progress bar\n      this.el_.style.width = percentify(bufferedEnd, duration);\n\n      // add child elements to represent the individual buffered time ranges\n      for (var i = 0; i < buffered.length; i++) {\n        var start = buffered.start(i);\n        var end = buffered.end(i);\n        var part = children[i];\n\n        if (!part) {\n          part = this.el_.appendChild(createEl());\n          children[i] = part;\n        }\n\n        // set the percent based on the width of the progress bar (bufferedEnd)\n        part.style.left = percentify(start, bufferedEnd);\n        part.style.width = percentify(end - start, bufferedEnd);\n      }\n\n      // remove unused buffered range elements\n      for (var _i = children.length; _i > buffered.length; _i--) {\n        this.el_.removeChild(children[_i - 1]);\n      }\n      children.length = buffered.length;\n    };\n\n    return LoadProgressBar;\n  }(Component);\n\n  Component.registerComponent('LoadProgressBar', LoadProgressBar);\n\n  /**\n   * @file time-tooltip.js\n   */\n\n  /**\n   * Time tooltips display a time above the progress bar.\n   *\n   * @extends Component\n   */\n\n  var TimeTooltip = function (_Component) {\n    inherits(TimeTooltip, _Component);\n\n    function TimeTooltip() {\n      classCallCheck(this, TimeTooltip);\n      return possibleConstructorReturn(this, _Component.apply(this, arguments));\n    }\n\n    /**\n     * Create the time tooltip DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n    TimeTooltip.prototype.createEl = function createEl$$1() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-time-tooltip'\n      });\n    };\n\n    /**\n     * Updates the position of the time tooltip relative to the `SeekBar`.\n     *\n     * @param {Object} seekBarRect\n     *        The `ClientRect` for the {@link SeekBar} element.\n     *\n     * @param {number} seekBarPoint\n     *        A number from 0 to 1, representing a horizontal reference point\n     *        from the left edge of the {@link SeekBar}\n     */\n\n\n    TimeTooltip.prototype.update = function update(seekBarRect, seekBarPoint, content) {\n      var tooltipRect = getBoundingClientRect(this.el_);\n      var playerRect = getBoundingClientRect(this.player_.el());\n      var seekBarPointPx = seekBarRect.width * seekBarPoint;\n\n      // do nothing if either rect isn't available\n      // for example, if the player isn't in the DOM for testing\n      if (!playerRect || !tooltipRect) {\n        return;\n      }\n\n      // This is the space left of the `seekBarPoint` available within the bounds\n      // of the player. We calculate any gap between the left edge of the player\n      // and the left edge of the `SeekBar` and add the number of pixels in the\n      // `SeekBar` before hitting the `seekBarPoint`\n      var spaceLeftOfPoint = seekBarRect.left - playerRect.left + seekBarPointPx;\n\n      // This is the space right of the `seekBarPoint` available within the bounds\n      // of the player. We calculate the number of pixels from the `seekBarPoint`\n      // to the right edge of the `SeekBar` and add to that any gap between the\n      // right edge of the `SeekBar` and the player.\n      var spaceRightOfPoint = seekBarRect.width - seekBarPointPx + (playerRect.right - seekBarRect.right);\n\n      // This is the number of pixels by which the tooltip will need to be pulled\n      // further to the right to center it over the `seekBarPoint`.\n      var pullTooltipBy = tooltipRect.width / 2;\n\n      // Adjust the `pullTooltipBy` distance to the left or right depending on\n      // the results of the space calculations above.\n      if (spaceLeftOfPoint < pullTooltipBy) {\n        pullTooltipBy += pullTooltipBy - spaceLeftOfPoint;\n      } else if (spaceRightOfPoint < pullTooltipBy) {\n        pullTooltipBy = spaceRightOfPoint;\n      }\n\n      // Due to the imprecision of decimal/ratio based calculations and varying\n      // rounding behaviors, there are cases where the spacing adjustment is off\n      // by a pixel or two. This adds insurance to these calculations.\n      if (pullTooltipBy < 0) {\n        pullTooltipBy = 0;\n      } else if (pullTooltipBy > tooltipRect.width) {\n        pullTooltipBy = tooltipRect.width;\n      }\n\n      this.el_.style.right = '-' + pullTooltipBy + 'px';\n      textContent(this.el_, content);\n    };\n\n    return TimeTooltip;\n  }(Component);\n\n  Component.registerComponent('TimeTooltip', TimeTooltip);\n\n  /**\n   * @file play-progress-bar.js\n   */\n\n  /**\n   * Used by {@link SeekBar} to display media playback progress as part of the\n   * {@link ProgressControl}.\n   *\n   * @extends Component\n   */\n\n  var PlayProgressBar = function (_Component) {\n    inherits(PlayProgressBar, _Component);\n\n    function PlayProgressBar() {\n      classCallCheck(this, PlayProgressBar);\n      return possibleConstructorReturn(this, _Component.apply(this, arguments));\n    }\n\n    /**\n     * Create the the DOM element for this class.\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n    PlayProgressBar.prototype.createEl = function createEl() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-play-progress vjs-slider-bar',\n        innerHTML: '<span class=\"vjs-control-text\"><span>' + this.localize('Progress') + '</span>: 0%</span>'\n      });\n    };\n\n    /**\n     * Enqueues updates to its own DOM as well as the DOM of its\n     * {@link TimeTooltip} child.\n     *\n     * @param {Object} seekBarRect\n     *        The `ClientRect` for the {@link SeekBar} element.\n     *\n     * @param {number} seekBarPoint\n     *        A number from 0 to 1, representing a horizontal reference point\n     *        from the left edge of the {@link SeekBar}\n     */\n\n\n    PlayProgressBar.prototype.update = function update(seekBarRect, seekBarPoint) {\n      var _this2 = this;\n\n      // If there is an existing rAF ID, cancel it so we don't over-queue.\n      if (this.rafId_) {\n        this.cancelAnimationFrame(this.rafId_);\n      }\n\n      this.rafId_ = this.requestAnimationFrame(function () {\n        var time = _this2.player_.scrubbing() ? _this2.player_.getCache().currentTime : _this2.player_.currentTime();\n\n        var content = formatTime(time, _this2.player_.duration());\n        var timeTooltip = _this2.getChild('timeTooltip');\n\n        if (timeTooltip) {\n          timeTooltip.update(seekBarRect, seekBarPoint, content);\n        }\n      });\n    };\n\n    return PlayProgressBar;\n  }(Component);\n\n  /**\n   * Default options for {@link PlayProgressBar}.\n   *\n   * @type {Object}\n   * @private\n   */\n\n\n  PlayProgressBar.prototype.options_ = {\n    children: []\n  };\n\n  // Time tooltips should not be added to a player on mobile devices\n  if (!IS_IOS && !IS_ANDROID) {\n    PlayProgressBar.prototype.options_.children.push('timeTooltip');\n  }\n\n  Component.registerComponent('PlayProgressBar', PlayProgressBar);\n\n  /**\n   * @file mouse-time-display.js\n   */\n\n  /**\n   * The {@link MouseTimeDisplay} component tracks mouse movement over the\n   * {@link ProgressControl}. It displays an indicator and a {@link TimeTooltip}\n   * indicating the time which is represented by a given point in the\n   * {@link ProgressControl}.\n   *\n   * @extends Component\n   */\n\n  var MouseTimeDisplay = function (_Component) {\n    inherits(MouseTimeDisplay, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The {@link Player} that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function MouseTimeDisplay(player, options) {\n      classCallCheck(this, MouseTimeDisplay);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      _this.update = throttle(bind(_this, _this.update), 25);\n      return _this;\n    }\n\n    /**\n     * Create the DOM element for this class.\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    MouseTimeDisplay.prototype.createEl = function createEl() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-mouse-display'\n      });\n    };\n\n    /**\n     * Enqueues updates to its own DOM as well as the DOM of its\n     * {@link TimeTooltip} child.\n     *\n     * @param {Object} seekBarRect\n     *        The `ClientRect` for the {@link SeekBar} element.\n     *\n     * @param {number} seekBarPoint\n     *        A number from 0 to 1, representing a horizontal reference point\n     *        from the left edge of the {@link SeekBar}\n     */\n\n\n    MouseTimeDisplay.prototype.update = function update(seekBarRect, seekBarPoint) {\n      var _this2 = this;\n\n      // If there is an existing rAF ID, cancel it so we don't over-queue.\n      if (this.rafId_) {\n        this.cancelAnimationFrame(this.rafId_);\n      }\n\n      this.rafId_ = this.requestAnimationFrame(function () {\n        var duration = _this2.player_.duration();\n        var content = formatTime(seekBarPoint * duration, duration);\n\n        _this2.el_.style.left = seekBarRect.width * seekBarPoint + 'px';\n        _this2.getChild('timeTooltip').update(seekBarRect, seekBarPoint, content);\n      });\n    };\n\n    return MouseTimeDisplay;\n  }(Component);\n\n  /**\n   * Default options for `MouseTimeDisplay`\n   *\n   * @type {Object}\n   * @private\n   */\n\n\n  MouseTimeDisplay.prototype.options_ = {\n    children: ['timeTooltip']\n  };\n\n  Component.registerComponent('MouseTimeDisplay', MouseTimeDisplay);\n\n  /**\n   * @file seek-bar.js\n   */\n\n  // The number of seconds the `step*` functions move the timeline.\n  var STEP_SECONDS = 5;\n\n  // The interval at which the bar should update as it progresses.\n  var UPDATE_REFRESH_INTERVAL = 30;\n\n  /**\n   * Seek bar and container for the progress bars. Uses {@link PlayProgressBar}\n   * as its `bar`.\n   *\n   * @extends Slider\n   */\n\n  var SeekBar = function (_Slider) {\n    inherits(SeekBar, _Slider);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function SeekBar(player, options) {\n      classCallCheck(this, SeekBar);\n\n      var _this = possibleConstructorReturn(this, _Slider.call(this, player, options));\n\n      _this.setEventHandlers_();\n      return _this;\n    }\n\n    /**\n     * Sets the event handlers\n     *\n     * @private\n     */\n\n\n    SeekBar.prototype.setEventHandlers_ = function setEventHandlers_() {\n      var _this2 = this;\n\n      this.update = throttle(bind(this, this.update), UPDATE_REFRESH_INTERVAL);\n\n      this.on(this.player_, 'timeupdate', this.update);\n      this.on(this.player_, 'ended', this.handleEnded);\n\n      // when playing, let's ensure we smoothly update the play progress bar\n      // via an interval\n      this.updateInterval = null;\n\n      this.on(this.player_, ['playing'], function () {\n        _this2.clearInterval(_this2.updateInterval);\n\n        _this2.updateInterval = _this2.setInterval(function () {\n          _this2.requestAnimationFrame(function () {\n            _this2.update();\n          });\n        }, UPDATE_REFRESH_INTERVAL);\n      });\n\n      this.on(this.player_, ['ended', 'pause', 'waiting'], function () {\n        _this2.clearInterval(_this2.updateInterval);\n      });\n\n      this.on(this.player_, ['timeupdate', 'ended'], this.update);\n    };\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    SeekBar.prototype.createEl = function createEl$$1() {\n      return _Slider.prototype.createEl.call(this, 'div', {\n        className: 'vjs-progress-holder'\n      }, {\n        'aria-label': this.localize('Progress Bar')\n      });\n    };\n\n    /**\n     * This function updates the play progress bar and accessibility\n     * attributes to whatever is passed in.\n     *\n     * @param {number} currentTime\n     *        The currentTime value that should be used for accessibility\n     *\n     * @param {number} percent\n     *        The percentage as a decimal that the bar should be filled from 0-1.\n     *\n     * @private\n     */\n\n\n    SeekBar.prototype.update_ = function update_(currentTime, percent) {\n      var duration = this.player_.duration();\n\n      // machine readable value of progress bar (percentage complete)\n      this.el_.setAttribute('aria-valuenow', (percent * 100).toFixed(2));\n\n      // human readable value of progress bar (time complete)\n      this.el_.setAttribute('aria-valuetext', this.localize('progress bar timing: currentTime={1} duration={2}', [formatTime(currentTime, duration), formatTime(duration, duration)], '{1} of {2}'));\n\n      // Update the `PlayProgressBar`.\n      this.bar.update(getBoundingClientRect(this.el_), percent);\n    };\n\n    /**\n     * Update the seek bar's UI.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `timeupdate` or `ended` event that caused this to run.\n     *\n     * @listens Player#timeupdate\n     *\n     * @returns {number}\n     *          The current percent at a number from 0-1\n     */\n\n\n    SeekBar.prototype.update = function update(event) {\n      var percent = _Slider.prototype.update.call(this);\n\n      this.update_(this.getCurrentTime_(), percent);\n      return percent;\n    };\n\n    /**\n     * Get the value of current time but allows for smooth scrubbing,\n     * when player can't keep up.\n     *\n     * @return {number}\n     *         The current time value to display\n     *\n     * @private\n     */\n\n\n    SeekBar.prototype.getCurrentTime_ = function getCurrentTime_() {\n      return this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime();\n    };\n\n    /**\n     * We want the seek bar to be full on ended\n     * no matter what the actual internal values are. so we force it.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `timeupdate` or `ended` event that caused this to run.\n     *\n     * @listens Player#ended\n     */\n\n\n    SeekBar.prototype.handleEnded = function handleEnded(event) {\n      this.update_(this.player_.duration(), 1);\n    };\n\n    /**\n     * Get the percentage of media played so far.\n     *\n     * @return {number}\n     *         The percentage of media played so far (0 to 1).\n     */\n\n\n    SeekBar.prototype.getPercent = function getPercent() {\n      var percent = this.getCurrentTime_() / this.player_.duration();\n\n      return percent >= 1 ? 1 : percent || 0;\n    };\n\n    /**\n     * Handle mouse down on seek bar\n     *\n     * @param {EventTarget~Event} event\n     *        The `mousedown` event that caused this to run.\n     *\n     * @listens mousedown\n     */\n\n\n    SeekBar.prototype.handleMouseDown = function handleMouseDown(event) {\n      if (!isSingleLeftClick(event)) {\n        return;\n      }\n\n      // Stop event propagation to prevent double fire in progress-control.js\n      event.stopPropagation();\n      this.player_.scrubbing(true);\n\n      this.videoWasPlaying = !this.player_.paused();\n      this.player_.pause();\n\n      _Slider.prototype.handleMouseDown.call(this, event);\n    };\n\n    /**\n     * Handle mouse move on seek bar\n     *\n     * @param {EventTarget~Event} event\n     *        The `mousemove` event that caused this to run.\n     *\n     * @listens mousemove\n     */\n\n\n    SeekBar.prototype.handleMouseMove = function handleMouseMove(event) {\n      if (!isSingleLeftClick(event)) {\n        return;\n      }\n\n      var newTime = this.calculateDistance(event) * this.player_.duration();\n\n      // Don't let video end while scrubbing.\n      if (newTime === this.player_.duration()) {\n        newTime = newTime - 0.1;\n      }\n\n      // Set new time (tell player to seek to new time)\n      this.player_.currentTime(newTime);\n    };\n\n    SeekBar.prototype.enable = function enable() {\n      _Slider.prototype.enable.call(this);\n      var mouseTimeDisplay = this.getChild('mouseTimeDisplay');\n\n      if (!mouseTimeDisplay) {\n        return;\n      }\n\n      mouseTimeDisplay.show();\n    };\n\n    SeekBar.prototype.disable = function disable() {\n      _Slider.prototype.disable.call(this);\n      var mouseTimeDisplay = this.getChild('mouseTimeDisplay');\n\n      if (!mouseTimeDisplay) {\n        return;\n      }\n\n      mouseTimeDisplay.hide();\n    };\n\n    /**\n     * Handle mouse up on seek bar\n     *\n     * @param {EventTarget~Event} event\n     *        The `mouseup` event that caused this to run.\n     *\n     * @listens mouseup\n     */\n\n\n    SeekBar.prototype.handleMouseUp = function handleMouseUp(event) {\n      _Slider.prototype.handleMouseUp.call(this, event);\n\n      // Stop event propagation to prevent double fire in progress-control.js\n      if (event) {\n        event.stopPropagation();\n      }\n      this.player_.scrubbing(false);\n\n      /**\n       * Trigger timeupdate because we're done seeking and the time has changed.\n       * This is particularly useful for if the player is paused to time the time displays.\n       *\n       * @event Tech#timeupdate\n       * @type {EventTarget~Event}\n       */\n      this.player_.trigger({ type: 'timeupdate', target: this, manuallyTriggered: true });\n      if (this.videoWasPlaying) {\n        silencePromise(this.player_.play());\n      }\n    };\n\n    /**\n     * Move more quickly fast forward for keyboard-only users\n     */\n\n\n    SeekBar.prototype.stepForward = function stepForward() {\n      this.player_.currentTime(this.player_.currentTime() + STEP_SECONDS);\n    };\n\n    /**\n     * Move more quickly rewind for keyboard-only users\n     */\n\n\n    SeekBar.prototype.stepBack = function stepBack() {\n      this.player_.currentTime(this.player_.currentTime() - STEP_SECONDS);\n    };\n\n    /**\n     * Toggles the playback state of the player\n     * This gets called when enter or space is used on the seekbar\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown` event that caused this function to be called\n     *\n     */\n\n\n    SeekBar.prototype.handleAction = function handleAction(event) {\n      if (this.player_.paused()) {\n        this.player_.play();\n      } else {\n        this.player_.pause();\n      }\n    };\n\n    /**\n     * Called when this SeekBar has focus and a key gets pressed down. By\n     * default it will call `this.handleAction` when the key is space or enter.\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown` event that caused this function to be called.\n     *\n     * @listens keydown\n     */\n\n\n    SeekBar.prototype.handleKeyPress = function handleKeyPress(event) {\n\n      // Support Space (32) or Enter (13) key operation to fire a click event\n      if (event.which === 32 || event.which === 13) {\n        event.preventDefault();\n        this.handleAction(event);\n      } else if (_Slider.prototype.handleKeyPress) {\n\n        // Pass keypress handling up for unsupported keys\n        _Slider.prototype.handleKeyPress.call(this, event);\n      }\n    };\n\n    return SeekBar;\n  }(Slider);\n\n  /**\n   * Default options for the `SeekBar`\n   *\n   * @type {Object}\n   * @private\n   */\n\n\n  SeekBar.prototype.options_ = {\n    children: ['loadProgressBar', 'playProgressBar'],\n    barName: 'playProgressBar'\n  };\n\n  // MouseTimeDisplay tooltips should not be added to a player on mobile devices\n  if (!IS_IOS && !IS_ANDROID) {\n    SeekBar.prototype.options_.children.splice(1, 0, 'mouseTimeDisplay');\n  }\n\n  /**\n   * Call the update event for this Slider when this event happens on the player.\n   *\n   * @type {string}\n   */\n  SeekBar.prototype.playerEvent = 'timeupdate';\n\n  Component.registerComponent('SeekBar', SeekBar);\n\n  /**\n   * @file progress-control.js\n   */\n\n  /**\n   * The Progress Control component contains the seek bar, load progress,\n   * and play progress.\n   *\n   * @extends Component\n   */\n\n  var ProgressControl = function (_Component) {\n    inherits(ProgressControl, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function ProgressControl(player, options) {\n      classCallCheck(this, ProgressControl);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      _this.handleMouseMove = throttle(bind(_this, _this.handleMouseMove), 25);\n      _this.throttledHandleMouseSeek = throttle(bind(_this, _this.handleMouseSeek), 25);\n\n      _this.enable();\n      return _this;\n    }\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    ProgressControl.prototype.createEl = function createEl$$1() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-progress-control vjs-control'\n      });\n    };\n\n    /**\n     * When the mouse moves over the `ProgressControl`, the pointer position\n     * gets passed down to the `MouseTimeDisplay` component.\n     *\n     * @param {EventTarget~Event} event\n     *        The `mousemove` event that caused this function to run.\n     *\n     * @listen mousemove\n     */\n\n\n    ProgressControl.prototype.handleMouseMove = function handleMouseMove(event) {\n      var seekBar = this.getChild('seekBar');\n\n      if (seekBar) {\n        var mouseTimeDisplay = seekBar.getChild('mouseTimeDisplay');\n        var seekBarEl = seekBar.el();\n        var seekBarRect = getBoundingClientRect(seekBarEl);\n        var seekBarPoint = getPointerPosition(seekBarEl, event).x;\n\n        // The default skin has a gap on either side of the `SeekBar`. This means\n        // that it's possible to trigger this behavior outside the boundaries of\n        // the `SeekBar`. This ensures we stay within it at all times.\n        if (seekBarPoint > 1) {\n          seekBarPoint = 1;\n        } else if (seekBarPoint < 0) {\n          seekBarPoint = 0;\n        }\n\n        if (mouseTimeDisplay) {\n          mouseTimeDisplay.update(seekBarRect, seekBarPoint);\n        }\n      }\n    };\n\n    /**\n     * A throttled version of the {@link ProgressControl#handleMouseSeek} listener.\n     *\n     * @method ProgressControl#throttledHandleMouseSeek\n     * @param {EventTarget~Event} event\n     *        The `mousemove` event that caused this function to run.\n     *\n     * @listen mousemove\n     * @listen touchmove\n     */\n\n    /**\n     * Handle `mousemove` or `touchmove` events on the `ProgressControl`.\n     *\n     * @param {EventTarget~Event} event\n     *        `mousedown` or `touchstart` event that triggered this function\n     *\n     * @listens mousemove\n     * @listens touchmove\n     */\n\n\n    ProgressControl.prototype.handleMouseSeek = function handleMouseSeek(event) {\n      var seekBar = this.getChild('seekBar');\n\n      if (seekBar) {\n        seekBar.handleMouseMove(event);\n      }\n    };\n\n    /**\n     * Are controls are currently enabled for this progress control.\n     *\n     * @return {boolean}\n     *         true if controls are enabled, false otherwise\n     */\n\n\n    ProgressControl.prototype.enabled = function enabled() {\n      return this.enabled_;\n    };\n\n    /**\n     * Disable all controls on the progress control and its children\n     */\n\n\n    ProgressControl.prototype.disable = function disable() {\n      this.children().forEach(function (child) {\n        return child.disable && child.disable();\n      });\n\n      if (!this.enabled()) {\n        return;\n      }\n\n      this.off(['mousedown', 'touchstart'], this.handleMouseDown);\n      this.off(this.el_, 'mousemove', this.handleMouseMove);\n      this.handleMouseUp();\n\n      this.addClass('disabled');\n\n      this.enabled_ = false;\n    };\n\n    /**\n     * Enable all controls on the progress control and its children\n     */\n\n\n    ProgressControl.prototype.enable = function enable() {\n      this.children().forEach(function (child) {\n        return child.enable && child.enable();\n      });\n\n      if (this.enabled()) {\n        return;\n      }\n\n      this.on(['mousedown', 'touchstart'], this.handleMouseDown);\n      this.on(this.el_, 'mousemove', this.handleMouseMove);\n      this.removeClass('disabled');\n\n      this.enabled_ = true;\n    };\n\n    /**\n     * Handle `mousedown` or `touchstart` events on the `ProgressControl`.\n     *\n     * @param {EventTarget~Event} event\n     *        `mousedown` or `touchstart` event that triggered this function\n     *\n     * @listens mousedown\n     * @listens touchstart\n     */\n\n\n    ProgressControl.prototype.handleMouseDown = function handleMouseDown(event) {\n      var doc = this.el_.ownerDocument;\n      var seekBar = this.getChild('seekBar');\n\n      if (seekBar) {\n        seekBar.handleMouseDown(event);\n      }\n\n      this.on(doc, 'mousemove', this.throttledHandleMouseSeek);\n      this.on(doc, 'touchmove', this.throttledHandleMouseSeek);\n      this.on(doc, 'mouseup', this.handleMouseUp);\n      this.on(doc, 'touchend', this.handleMouseUp);\n    };\n\n    /**\n     * Handle `mouseup` or `touchend` events on the `ProgressControl`.\n     *\n     * @param {EventTarget~Event} event\n     *        `mouseup` or `touchend` event that triggered this function.\n     *\n     * @listens touchend\n     * @listens mouseup\n     */\n\n\n    ProgressControl.prototype.handleMouseUp = function handleMouseUp(event) {\n      var doc = this.el_.ownerDocument;\n      var seekBar = this.getChild('seekBar');\n\n      if (seekBar) {\n        seekBar.handleMouseUp(event);\n      }\n\n      this.off(doc, 'mousemove', this.throttledHandleMouseSeek);\n      this.off(doc, 'touchmove', this.throttledHandleMouseSeek);\n      this.off(doc, 'mouseup', this.handleMouseUp);\n      this.off(doc, 'touchend', this.handleMouseUp);\n    };\n\n    return ProgressControl;\n  }(Component);\n\n  /**\n   * Default options for `ProgressControl`\n   *\n   * @type {Object}\n   * @private\n   */\n\n\n  ProgressControl.prototype.options_ = {\n    children: ['seekBar']\n  };\n\n  Component.registerComponent('ProgressControl', ProgressControl);\n\n  /**\n   * @file fullscreen-toggle.js\n   */\n\n  /**\n   * Toggle fullscreen video\n   *\n   * @extends Button\n   */\n\n  var FullscreenToggle = function (_Button) {\n    inherits(FullscreenToggle, _Button);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function FullscreenToggle(player, options) {\n      classCallCheck(this, FullscreenToggle);\n\n      var _this = possibleConstructorReturn(this, _Button.call(this, player, options));\n\n      _this.on(player, 'fullscreenchange', _this.handleFullscreenChange);\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    FullscreenToggle.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-fullscreen-control ' + _Button.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * Handles fullscreenchange on the player and change control text accordingly.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The {@link Player#fullscreenchange} event that caused this function to be\n     *        called.\n     *\n     * @listens Player#fullscreenchange\n     */\n\n\n    FullscreenToggle.prototype.handleFullscreenChange = function handleFullscreenChange(event) {\n      if (this.player_.isFullscreen()) {\n        this.controlText('Non-Fullscreen');\n      } else {\n        this.controlText('Fullscreen');\n      }\n    };\n\n    /**\n     * This gets called when an `FullscreenToggle` is \"clicked\". See\n     * {@link ClickableComponent} for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    FullscreenToggle.prototype.handleClick = function handleClick(event) {\n      if (!this.player_.isFullscreen()) {\n        this.player_.requestFullscreen();\n      } else {\n        this.player_.exitFullscreen();\n      }\n    };\n\n    return FullscreenToggle;\n  }(Button);\n\n  /**\n   * The text that should display over the `FullscreenToggle`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  FullscreenToggle.prototype.controlText_ = 'Fullscreen';\n\n  Component.registerComponent('FullscreenToggle', FullscreenToggle);\n\n  /**\n   * Check if volume control is supported and if it isn't hide the\n   * `Component` that was passed  using the `vjs-hidden` class.\n   *\n   * @param {Component} self\n   *        The component that should be hidden if volume is unsupported\n   *\n   * @param {Player} player\n   *        A reference to the player\n   *\n   * @private\n   */\n  var checkVolumeSupport = function checkVolumeSupport(self, player) {\n    // hide volume controls when they're not supported by the current tech\n    if (player.tech_ && !player.tech_.featuresVolumeControl) {\n      self.addClass('vjs-hidden');\n    }\n\n    self.on(player, 'loadstart', function () {\n      if (!player.tech_.featuresVolumeControl) {\n        self.addClass('vjs-hidden');\n      } else {\n        self.removeClass('vjs-hidden');\n      }\n    });\n  };\n\n  /**\n   * @file volume-level.js\n   */\n\n  /**\n   * Shows volume level\n   *\n   * @extends Component\n   */\n\n  var VolumeLevel = function (_Component) {\n    inherits(VolumeLevel, _Component);\n\n    function VolumeLevel() {\n      classCallCheck(this, VolumeLevel);\n      return possibleConstructorReturn(this, _Component.apply(this, arguments));\n    }\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n    VolumeLevel.prototype.createEl = function createEl() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-volume-level',\n        innerHTML: '<span class=\"vjs-control-text\"></span>'\n      });\n    };\n\n    return VolumeLevel;\n  }(Component);\n\n  Component.registerComponent('VolumeLevel', VolumeLevel);\n\n  /**\n   * @file volume-bar.js\n   */\n\n  /**\n   * The bar that contains the volume level and can be clicked on to adjust the level\n   *\n   * @extends Slider\n   */\n\n  var VolumeBar = function (_Slider) {\n    inherits(VolumeBar, _Slider);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function VolumeBar(player, options) {\n      classCallCheck(this, VolumeBar);\n\n      var _this = possibleConstructorReturn(this, _Slider.call(this, player, options));\n\n      _this.on('slideractive', _this.updateLastVolume_);\n      _this.on(player, 'volumechange', _this.updateARIAAttributes);\n      player.ready(function () {\n        return _this.updateARIAAttributes();\n      });\n      return _this;\n    }\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    VolumeBar.prototype.createEl = function createEl$$1() {\n      return _Slider.prototype.createEl.call(this, 'div', {\n        className: 'vjs-volume-bar vjs-slider-bar'\n      }, {\n        'aria-label': this.localize('Volume Level'),\n        'aria-live': 'polite'\n      });\n    };\n\n    /**\n     * Handle mouse down on volume bar\n     *\n     * @param {EventTarget~Event} event\n     *        The `mousedown` event that caused this to run.\n     *\n     * @listens mousedown\n     */\n\n\n    VolumeBar.prototype.handleMouseDown = function handleMouseDown(event) {\n      if (!isSingleLeftClick(event)) {\n        return;\n      }\n\n      _Slider.prototype.handleMouseDown.call(this, event);\n    };\n\n    /**\n     * Handle movement events on the {@link VolumeMenuButton}.\n     *\n     * @param {EventTarget~Event} event\n     *        The event that caused this function to run.\n     *\n     * @listens mousemove\n     */\n\n\n    VolumeBar.prototype.handleMouseMove = function handleMouseMove(event) {\n      if (!isSingleLeftClick(event)) {\n        return;\n      }\n\n      this.checkMuted();\n      this.player_.volume(this.calculateDistance(event));\n    };\n\n    /**\n     * If the player is muted unmute it.\n     */\n\n\n    VolumeBar.prototype.checkMuted = function checkMuted() {\n      if (this.player_.muted()) {\n        this.player_.muted(false);\n      }\n    };\n\n    /**\n     * Get percent of volume level\n     *\n     * @return {number}\n     *         Volume level percent as a decimal number.\n     */\n\n\n    VolumeBar.prototype.getPercent = function getPercent() {\n      if (this.player_.muted()) {\n        return 0;\n      }\n      return this.player_.volume();\n    };\n\n    /**\n     * Increase volume level for keyboard users\n     */\n\n\n    VolumeBar.prototype.stepForward = function stepForward() {\n      this.checkMuted();\n      this.player_.volume(this.player_.volume() + 0.1);\n    };\n\n    /**\n     * Decrease volume level for keyboard users\n     */\n\n\n    VolumeBar.prototype.stepBack = function stepBack() {\n      this.checkMuted();\n      this.player_.volume(this.player_.volume() - 0.1);\n    };\n\n    /**\n     * Update ARIA accessibility attributes\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `volumechange` event that caused this function to run.\n     *\n     * @listens Player#volumechange\n     */\n\n\n    VolumeBar.prototype.updateARIAAttributes = function updateARIAAttributes(event) {\n      var ariaValue = this.player_.muted() ? 0 : this.volumeAsPercentage_();\n\n      this.el_.setAttribute('aria-valuenow', ariaValue);\n      this.el_.setAttribute('aria-valuetext', ariaValue + '%');\n    };\n\n    /**\n     * Returns the current value of the player volume as a percentage\n     *\n     * @private\n     */\n\n\n    VolumeBar.prototype.volumeAsPercentage_ = function volumeAsPercentage_() {\n      return Math.round(this.player_.volume() * 100);\n    };\n\n    /**\n     * When user starts dragging the VolumeBar, store the volume and listen for\n     * the end of the drag. When the drag ends, if the volume was set to zero,\n     * set lastVolume to the stored volume.\n     *\n     * @listens slideractive\n     * @private\n     */\n\n\n    VolumeBar.prototype.updateLastVolume_ = function updateLastVolume_() {\n      var _this2 = this;\n\n      var volumeBeforeDrag = this.player_.volume();\n\n      this.one('sliderinactive', function () {\n        if (_this2.player_.volume() === 0) {\n          _this2.player_.lastVolume_(volumeBeforeDrag);\n        }\n      });\n    };\n\n    return VolumeBar;\n  }(Slider);\n\n  /**\n   * Default options for the `VolumeBar`\n   *\n   * @type {Object}\n   * @private\n   */\n\n\n  VolumeBar.prototype.options_ = {\n    children: ['volumeLevel'],\n    barName: 'volumeLevel'\n  };\n\n  /**\n   * Call the update event for this Slider when this event happens on the player.\n   *\n   * @type {string}\n   */\n  VolumeBar.prototype.playerEvent = 'volumechange';\n\n  Component.registerComponent('VolumeBar', VolumeBar);\n\n  /**\n   * @file volume-control.js\n   */\n\n  /**\n   * The component for controlling the volume level\n   *\n   * @extends Component\n   */\n\n  var VolumeControl = function (_Component) {\n    inherits(VolumeControl, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options={}]\n     *        The key/value store of player options.\n     */\n    function VolumeControl(player) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      classCallCheck(this, VolumeControl);\n\n      options.vertical = options.vertical || false;\n\n      // Pass the vertical option down to the VolumeBar if\n      // the VolumeBar is turned on.\n      if (typeof options.volumeBar === 'undefined' || isPlain(options.volumeBar)) {\n        options.volumeBar = options.volumeBar || {};\n        options.volumeBar.vertical = options.vertical;\n      }\n\n      // hide this control if volume support is missing\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      checkVolumeSupport(_this, player);\n\n      _this.throttledHandleMouseMove = throttle(bind(_this, _this.handleMouseMove), 25);\n\n      _this.on('mousedown', _this.handleMouseDown);\n      _this.on('touchstart', _this.handleMouseDown);\n\n      // while the slider is active (the mouse has been pressed down and\n      // is dragging) or in focus we do not want to hide the VolumeBar\n      _this.on(_this.volumeBar, ['focus', 'slideractive'], function () {\n        _this.volumeBar.addClass('vjs-slider-active');\n        _this.addClass('vjs-slider-active');\n        _this.trigger('slideractive');\n      });\n\n      _this.on(_this.volumeBar, ['blur', 'sliderinactive'], function () {\n        _this.volumeBar.removeClass('vjs-slider-active');\n        _this.removeClass('vjs-slider-active');\n        _this.trigger('sliderinactive');\n      });\n      return _this;\n    }\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    VolumeControl.prototype.createEl = function createEl() {\n      var orientationClass = 'vjs-volume-horizontal';\n\n      if (this.options_.vertical) {\n        orientationClass = 'vjs-volume-vertical';\n      }\n\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-volume-control vjs-control ' + orientationClass\n      });\n    };\n\n    /**\n     * Handle `mousedown` or `touchstart` events on the `VolumeControl`.\n     *\n     * @param {EventTarget~Event} event\n     *        `mousedown` or `touchstart` event that triggered this function\n     *\n     * @listens mousedown\n     * @listens touchstart\n     */\n\n\n    VolumeControl.prototype.handleMouseDown = function handleMouseDown(event) {\n      var doc = this.el_.ownerDocument;\n\n      this.on(doc, 'mousemove', this.throttledHandleMouseMove);\n      this.on(doc, 'touchmove', this.throttledHandleMouseMove);\n      this.on(doc, 'mouseup', this.handleMouseUp);\n      this.on(doc, 'touchend', this.handleMouseUp);\n    };\n\n    /**\n     * Handle `mouseup` or `touchend` events on the `VolumeControl`.\n     *\n     * @param {EventTarget~Event} event\n     *        `mouseup` or `touchend` event that triggered this function.\n     *\n     * @listens touchend\n     * @listens mouseup\n     */\n\n\n    VolumeControl.prototype.handleMouseUp = function handleMouseUp(event) {\n      var doc = this.el_.ownerDocument;\n\n      this.off(doc, 'mousemove', this.throttledHandleMouseMove);\n      this.off(doc, 'touchmove', this.throttledHandleMouseMove);\n      this.off(doc, 'mouseup', this.handleMouseUp);\n      this.off(doc, 'touchend', this.handleMouseUp);\n    };\n\n    /**\n     * Handle `mousedown` or `touchstart` events on the `VolumeControl`.\n     *\n     * @param {EventTarget~Event} event\n     *        `mousedown` or `touchstart` event that triggered this function\n     *\n     * @listens mousedown\n     * @listens touchstart\n     */\n\n\n    VolumeControl.prototype.handleMouseMove = function handleMouseMove(event) {\n      this.volumeBar.handleMouseMove(event);\n    };\n\n    return VolumeControl;\n  }(Component);\n\n  /**\n   * Default options for the `VolumeControl`\n   *\n   * @type {Object}\n   * @private\n   */\n\n\n  VolumeControl.prototype.options_ = {\n    children: ['volumeBar']\n  };\n\n  Component.registerComponent('VolumeControl', VolumeControl);\n\n  /**\n   * @file mute-toggle.js\n   */\n\n  /**\n   * A button component for muting the audio.\n   *\n   * @extends Button\n   */\n\n  var MuteToggle = function (_Button) {\n    inherits(MuteToggle, _Button);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function MuteToggle(player, options) {\n      classCallCheck(this, MuteToggle);\n\n      // hide this control if volume support is missing\n      var _this = possibleConstructorReturn(this, _Button.call(this, player, options));\n\n      checkVolumeSupport(_this, player);\n\n      _this.on(player, ['loadstart', 'volumechange'], _this.update);\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    MuteToggle.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-mute-control ' + _Button.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * This gets called when an `MuteToggle` is \"clicked\". See\n     * {@link ClickableComponent} for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    MuteToggle.prototype.handleClick = function handleClick(event) {\n      var vol = this.player_.volume();\n      var lastVolume = this.player_.lastVolume_();\n\n      if (vol === 0) {\n        var volumeToSet = lastVolume < 0.1 ? 0.1 : lastVolume;\n\n        this.player_.volume(volumeToSet);\n        this.player_.muted(false);\n      } else {\n        this.player_.muted(this.player_.muted() ? false : true);\n      }\n    };\n\n    /**\n     * Update the `MuteToggle` button based on the state of `volume` and `muted`\n     * on the player.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The {@link Player#loadstart} event if this function was called\n     *        through an event.\n     *\n     * @listens Player#loadstart\n     * @listens Player#volumechange\n     */\n\n\n    MuteToggle.prototype.update = function update(event) {\n      this.updateIcon_();\n      this.updateControlText_();\n    };\n\n    /**\n     * Update the appearance of the `MuteToggle` icon.\n     *\n     * Possible states (given `level` variable below):\n     * - 0: crossed out\n     * - 1: zero bars of volume\n     * - 2: one bar of volume\n     * - 3: two bars of volume\n     *\n     * @private\n     */\n\n\n    MuteToggle.prototype.updateIcon_ = function updateIcon_() {\n      var vol = this.player_.volume();\n      var level = 3;\n\n      if (vol === 0 || this.player_.muted()) {\n        level = 0;\n      } else if (vol < 0.33) {\n        level = 1;\n      } else if (vol < 0.67) {\n        level = 2;\n      }\n\n      // TODO improve muted icon classes\n      for (var i = 0; i < 4; i++) {\n        removeClass(this.el_, 'vjs-vol-' + i);\n      }\n      addClass(this.el_, 'vjs-vol-' + level);\n    };\n\n    /**\n     * If `muted` has changed on the player, update the control text\n     * (`title` attribute on `vjs-mute-control` element and content of\n     * `vjs-control-text` element).\n     *\n     * @private\n     */\n\n\n    MuteToggle.prototype.updateControlText_ = function updateControlText_() {\n      var soundOff = this.player_.muted() || this.player_.volume() === 0;\n      var text = soundOff ? 'Unmute' : 'Mute';\n\n      if (this.controlText() !== text) {\n        this.controlText(text);\n      }\n    };\n\n    return MuteToggle;\n  }(Button);\n\n  /**\n   * The text that should display over the `MuteToggle`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  MuteToggle.prototype.controlText_ = 'Mute';\n\n  Component.registerComponent('MuteToggle', MuteToggle);\n\n  /**\n   * @file volume-control.js\n   */\n\n  /**\n   * A Component to contain the MuteToggle and VolumeControl so that\n   * they can work together.\n   *\n   * @extends Component\n   */\n\n  var VolumePanel = function (_Component) {\n    inherits(VolumePanel, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options={}]\n     *        The key/value store of player options.\n     */\n    function VolumePanel(player) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      classCallCheck(this, VolumePanel);\n\n      if (typeof options.inline !== 'undefined') {\n        options.inline = options.inline;\n      } else {\n        options.inline = true;\n      }\n\n      // pass the inline option down to the VolumeControl as vertical if\n      // the VolumeControl is on.\n      if (typeof options.volumeControl === 'undefined' || isPlain(options.volumeControl)) {\n        options.volumeControl = options.volumeControl || {};\n        options.volumeControl.vertical = !options.inline;\n      }\n\n      // hide this control if volume support is missing\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      checkVolumeSupport(_this, player);\n\n      // while the slider is active (the mouse has been pressed down and\n      // is dragging) we do not want to hide the VolumeBar\n      _this.on(_this.volumeControl, ['slideractive'], _this.sliderActive_);\n\n      _this.on(_this.volumeControl, ['sliderinactive'], _this.sliderInactive_);\n      return _this;\n    }\n\n    /**\n     * Add vjs-slider-active class to the VolumePanel\n     *\n     * @listens VolumeControl#slideractive\n     * @private\n     */\n\n\n    VolumePanel.prototype.sliderActive_ = function sliderActive_() {\n      this.addClass('vjs-slider-active');\n    };\n\n    /**\n     * Removes vjs-slider-active class to the VolumePanel\n     *\n     * @listens VolumeControl#sliderinactive\n     * @private\n     */\n\n\n    VolumePanel.prototype.sliderInactive_ = function sliderInactive_() {\n      this.removeClass('vjs-slider-active');\n    };\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    VolumePanel.prototype.createEl = function createEl() {\n      var orientationClass = 'vjs-volume-panel-horizontal';\n\n      if (!this.options_.inline) {\n        orientationClass = 'vjs-volume-panel-vertical';\n      }\n\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-volume-panel vjs-control ' + orientationClass\n      });\n    };\n\n    return VolumePanel;\n  }(Component);\n\n  /**\n   * Default options for the `VolumeControl`\n   *\n   * @type {Object}\n   * @private\n   */\n\n\n  VolumePanel.prototype.options_ = {\n    children: ['muteToggle', 'volumeControl']\n  };\n\n  Component.registerComponent('VolumePanel', VolumePanel);\n\n  /**\n   * @file menu.js\n   */\n\n  /**\n   * The Menu component is used to build popup menus, including subtitle and\n   * captions selection menus.\n   *\n   * @extends Component\n   */\n\n  var Menu = function (_Component) {\n    inherits(Menu, _Component);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Player} player\n     *        the player that this component should attach to\n     *\n     * @param {Object} [options]\n     *        Object of option names and values\n     *\n     */\n    function Menu(player, options) {\n      classCallCheck(this, Menu);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      if (options) {\n        _this.menuButton_ = options.menuButton;\n      }\n\n      _this.focusedChild_ = -1;\n\n      _this.on('keydown', _this.handleKeyPress);\n      return _this;\n    }\n\n    /**\n     * Add a {@link MenuItem} to the menu.\n     *\n     * @param {Object|string} component\n     *        The name or instance of the `MenuItem` to add.\n     *\n     */\n\n\n    Menu.prototype.addItem = function addItem(component) {\n      this.addChild(component);\n      component.on('click', bind(this, function (event) {\n        // Unpress the associated MenuButton, and move focus back to it\n        if (this.menuButton_) {\n          this.menuButton_.unpressButton();\n\n          // don't focus menu button if item is a caption settings item\n          // because focus will move elsewhere\n          if (component.name() !== 'CaptionSettingsMenuItem') {\n            this.menuButton_.focus();\n          }\n        }\n      }));\n    };\n\n    /**\n     * Create the `Menu`s DOM element.\n     *\n     * @return {Element}\n     *         the element that was created\n     */\n\n\n    Menu.prototype.createEl = function createEl$$1() {\n      var contentElType = this.options_.contentElType || 'ul';\n\n      this.contentEl_ = createEl(contentElType, {\n        className: 'vjs-menu-content'\n      });\n\n      this.contentEl_.setAttribute('role', 'menu');\n\n      var el = _Component.prototype.createEl.call(this, 'div', {\n        append: this.contentEl_,\n        className: 'vjs-menu'\n      });\n\n      el.appendChild(this.contentEl_);\n\n      // Prevent clicks from bubbling up. Needed for Menu Buttons,\n      // where a click on the parent is significant\n      on(el, 'click', function (event) {\n        event.preventDefault();\n        event.stopImmediatePropagation();\n      });\n\n      return el;\n    };\n\n    Menu.prototype.dispose = function dispose() {\n      this.contentEl_ = null;\n\n      _Component.prototype.dispose.call(this);\n    };\n\n    /**\n     * Handle a `keydown` event on this menu. This listener is added in the constructor.\n     *\n     * @param {EventTarget~Event} event\n     *        A `keydown` event that happened on the menu.\n     *\n     * @listens keydown\n     */\n\n\n    Menu.prototype.handleKeyPress = function handleKeyPress(event) {\n      // Left and Down Arrows\n      if (event.which === 37 || event.which === 40) {\n        event.preventDefault();\n        this.stepForward();\n\n        // Up and Right Arrows\n      } else if (event.which === 38 || event.which === 39) {\n        event.preventDefault();\n        this.stepBack();\n      }\n    };\n\n    /**\n     * Move to next (lower) menu item for keyboard users.\n     */\n\n\n    Menu.prototype.stepForward = function stepForward() {\n      var stepChild = 0;\n\n      if (this.focusedChild_ !== undefined) {\n        stepChild = this.focusedChild_ + 1;\n      }\n      this.focus(stepChild);\n    };\n\n    /**\n     * Move to previous (higher) menu item for keyboard users.\n     */\n\n\n    Menu.prototype.stepBack = function stepBack() {\n      var stepChild = 0;\n\n      if (this.focusedChild_ !== undefined) {\n        stepChild = this.focusedChild_ - 1;\n      }\n      this.focus(stepChild);\n    };\n\n    /**\n     * Set focus on a {@link MenuItem} in the `Menu`.\n     *\n     * @param {Object|string} [item=0]\n     *        Index of child item set focus on.\n     */\n\n\n    Menu.prototype.focus = function focus() {\n      var item = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      var children = this.children().slice();\n      var haveTitle = children.length && children[0].className && /vjs-menu-title/.test(children[0].className);\n\n      if (haveTitle) {\n        children.shift();\n      }\n\n      if (children.length > 0) {\n        if (item < 0) {\n          item = 0;\n        } else if (item >= children.length) {\n          item = children.length - 1;\n        }\n\n        this.focusedChild_ = item;\n\n        children[item].el_.focus();\n      }\n    };\n\n    return Menu;\n  }(Component);\n\n  Component.registerComponent('Menu', Menu);\n\n  /**\n   * @file menu-button.js\n   */\n\n  /**\n   * A `MenuButton` class for any popup {@link Menu}.\n   *\n   * @extends Component\n   */\n\n  var MenuButton = function (_Component) {\n    inherits(MenuButton, _Component);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options={}]\n     *        The key/value store of player options.\n     */\n    function MenuButton(player) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      classCallCheck(this, MenuButton);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options));\n\n      _this.menuButton_ = new Button(player, options);\n\n      _this.menuButton_.controlText(_this.controlText_);\n      _this.menuButton_.el_.setAttribute('aria-haspopup', 'true');\n\n      // Add buildCSSClass values to the button, not the wrapper\n      var buttonClass = Button.prototype.buildCSSClass();\n\n      _this.menuButton_.el_.className = _this.buildCSSClass() + ' ' + buttonClass;\n      _this.menuButton_.removeClass('vjs-control');\n\n      _this.addChild(_this.menuButton_);\n\n      _this.update();\n\n      _this.enabled_ = true;\n\n      _this.on(_this.menuButton_, 'tap', _this.handleClick);\n      _this.on(_this.menuButton_, 'click', _this.handleClick);\n      _this.on(_this.menuButton_, 'focus', _this.handleFocus);\n      _this.on(_this.menuButton_, 'blur', _this.handleBlur);\n\n      _this.on('keydown', _this.handleSubmenuKeyPress);\n      return _this;\n    }\n\n    /**\n     * Update the menu based on the current state of its items.\n     */\n\n\n    MenuButton.prototype.update = function update() {\n      var menu = this.createMenu();\n\n      if (this.menu) {\n        this.menu.dispose();\n        this.removeChild(this.menu);\n      }\n\n      this.menu = menu;\n      this.addChild(menu);\n\n      /**\n       * Track the state of the menu button\n       *\n       * @type {Boolean}\n       * @private\n       */\n      this.buttonPressed_ = false;\n      this.menuButton_.el_.setAttribute('aria-expanded', 'false');\n\n      if (this.items && this.items.length <= this.hideThreshold_) {\n        this.hide();\n      } else {\n        this.show();\n      }\n    };\n\n    /**\n     * Create the menu and add all items to it.\n     *\n     * @return {Menu}\n     *         The constructed menu\n     */\n\n\n    MenuButton.prototype.createMenu = function createMenu() {\n      var menu = new Menu(this.player_, { menuButton: this });\n\n      /**\n       * Hide the menu if the number of items is less than or equal to this threshold. This defaults\n       * to 0 and whenever we add items which can be hidden to the menu we'll increment it. We list\n       * it here because every time we run `createMenu` we need to reset the value.\n       *\n       * @protected\n       * @type {Number}\n       */\n      this.hideThreshold_ = 0;\n\n      // Add a title list item to the top\n      if (this.options_.title) {\n        var title = createEl('li', {\n          className: 'vjs-menu-title',\n          innerHTML: toTitleCase(this.options_.title),\n          tabIndex: -1\n        });\n\n        this.hideThreshold_ += 1;\n\n        menu.children_.unshift(title);\n        prependTo(title, menu.contentEl());\n      }\n\n      this.items = this.createItems();\n\n      if (this.items) {\n        // Add menu items to the menu\n        for (var i = 0; i < this.items.length; i++) {\n          menu.addItem(this.items[i]);\n        }\n      }\n\n      return menu;\n    };\n\n    /**\n     * Create the list of menu items. Specific to each subclass.\n     *\n     * @abstract\n     */\n\n\n    MenuButton.prototype.createItems = function createItems() {};\n\n    /**\n     * Create the `MenuButtons`s DOM element.\n     *\n     * @return {Element}\n     *         The element that gets created.\n     */\n\n\n    MenuButton.prototype.createEl = function createEl$$1() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: this.buildWrapperCSSClass()\n      }, {});\n    };\n\n    /**\n     * Allow sub components to stack CSS class names for the wrapper element\n     *\n     * @return {string}\n     *         The constructed wrapper DOM `className`\n     */\n\n\n    MenuButton.prototype.buildWrapperCSSClass = function buildWrapperCSSClass() {\n      var menuButtonClass = 'vjs-menu-button';\n\n      // If the inline option is passed, we want to use different styles altogether.\n      if (this.options_.inline === true) {\n        menuButtonClass += '-inline';\n      } else {\n        menuButtonClass += '-popup';\n      }\n\n      // TODO: Fix the CSS so that this isn't necessary\n      var buttonClass = Button.prototype.buildCSSClass();\n\n      return 'vjs-menu-button ' + menuButtonClass + ' ' + buttonClass + ' ' + _Component.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    MenuButton.prototype.buildCSSClass = function buildCSSClass() {\n      var menuButtonClass = 'vjs-menu-button';\n\n      // If the inline option is passed, we want to use different styles altogether.\n      if (this.options_.inline === true) {\n        menuButtonClass += '-inline';\n      } else {\n        menuButtonClass += '-popup';\n      }\n\n      return 'vjs-menu-button ' + menuButtonClass + ' ' + _Component.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * Get or set the localized control text that will be used for accessibility.\n     *\n     * > NOTE: This will come from the internal `menuButton_` element.\n     *\n     * @param {string} [text]\n     *        Control text for element.\n     *\n     * @param {Element} [el=this.menuButton_.el()]\n     *        Element to set the title on.\n     *\n     * @return {string}\n     *         - The control text when getting\n     */\n\n\n    MenuButton.prototype.controlText = function controlText(text) {\n      var el = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.menuButton_.el();\n\n      return this.menuButton_.controlText(text, el);\n    };\n\n    /**\n     * Handle a click on a `MenuButton`.\n     * See {@link ClickableComponent#handleClick} for instances where this is called.\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    MenuButton.prototype.handleClick = function handleClick(event) {\n      // When you click the button it adds focus, which will show the menu.\n      // So we'll remove focus when the mouse leaves the button. Focus is needed\n      // for tab navigation.\n\n      this.one(this.menu.contentEl(), 'mouseleave', bind(this, function (e) {\n        this.unpressButton();\n        this.el_.blur();\n      }));\n      if (this.buttonPressed_) {\n        this.unpressButton();\n      } else {\n        this.pressButton();\n      }\n    };\n\n    /**\n     * Set the focus to the actual button, not to this element\n     */\n\n\n    MenuButton.prototype.focus = function focus() {\n      this.menuButton_.focus();\n    };\n\n    /**\n     * Remove the focus from the actual button, not this element\n     */\n\n\n    MenuButton.prototype.blur = function blur() {\n      this.menuButton_.blur();\n    };\n\n    /**\n     * This gets called when a `MenuButton` gains focus via a `focus` event.\n     * Turns on listening for `keydown` events. When they happen it\n     * calls `this.handleKeyPress`.\n     *\n     * @param {EventTarget~Event} event\n     *        The `focus` event that caused this function to be called.\n     *\n     * @listens focus\n     */\n\n\n    MenuButton.prototype.handleFocus = function handleFocus() {\n      on(document_1, 'keydown', bind(this, this.handleKeyPress));\n    };\n\n    /**\n     * Called when a `MenuButton` loses focus. Turns off the listener for\n     * `keydown` events. Which Stops `this.handleKeyPress` from getting called.\n     *\n     * @param {EventTarget~Event} event\n     *        The `blur` event that caused this function to be called.\n     *\n     * @listens blur\n     */\n\n\n    MenuButton.prototype.handleBlur = function handleBlur() {\n      off(document_1, 'keydown', bind(this, this.handleKeyPress));\n    };\n\n    /**\n     * Handle tab, escape, down arrow, and up arrow keys for `MenuButton`. See\n     * {@link ClickableComponent#handleKeyPress} for instances where this is called.\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown` event that caused this function to be called.\n     *\n     * @listens keydown\n     */\n\n\n    MenuButton.prototype.handleKeyPress = function handleKeyPress(event) {\n\n      // Escape (27) key or Tab (9) key unpress the 'button'\n      if (event.which === 27 || event.which === 9) {\n        if (this.buttonPressed_) {\n          this.unpressButton();\n        }\n        // Don't preventDefault for Tab key - we still want to lose focus\n        if (event.which !== 9) {\n          event.preventDefault();\n          // Set focus back to the menu button's button\n          this.menuButton_.el_.focus();\n        }\n        // Up (38) key or Down (40) key press the 'button'\n      } else if (event.which === 38 || event.which === 40) {\n        if (!this.buttonPressed_) {\n          this.pressButton();\n          event.preventDefault();\n        }\n      }\n    };\n\n    /**\n     * Handle a `keydown` event on a sub-menu. The listener for this is added in\n     * the constructor.\n     *\n     * @param {EventTarget~Event} event\n     *        Key press event\n     *\n     * @listens keydown\n     */\n\n\n    MenuButton.prototype.handleSubmenuKeyPress = function handleSubmenuKeyPress(event) {\n\n      // Escape (27) key or Tab (9) key unpress the 'button'\n      if (event.which === 27 || event.which === 9) {\n        if (this.buttonPressed_) {\n          this.unpressButton();\n        }\n        // Don't preventDefault for Tab key - we still want to lose focus\n        if (event.which !== 9) {\n          event.preventDefault();\n          // Set focus back to the menu button's button\n          this.menuButton_.el_.focus();\n        }\n      }\n    };\n\n    /**\n     * Put the current `MenuButton` into a pressed state.\n     */\n\n\n    MenuButton.prototype.pressButton = function pressButton() {\n      if (this.enabled_) {\n        this.buttonPressed_ = true;\n        this.menu.lockShowing();\n        this.menuButton_.el_.setAttribute('aria-expanded', 'true');\n\n        // set the focus into the submenu, except on iOS where it is resulting in\n        // undesired scrolling behavior when the player is in an iframe\n        if (IS_IOS && isInFrame()) {\n          // Return early so that the menu isn't focused\n          return;\n        }\n\n        this.menu.focus();\n      }\n    };\n\n    /**\n     * Take the current `MenuButton` out of a pressed state.\n     */\n\n\n    MenuButton.prototype.unpressButton = function unpressButton() {\n      if (this.enabled_) {\n        this.buttonPressed_ = false;\n        this.menu.unlockShowing();\n        this.menuButton_.el_.setAttribute('aria-expanded', 'false');\n      }\n    };\n\n    /**\n     * Disable the `MenuButton`. Don't allow it to be clicked.\n     */\n\n\n    MenuButton.prototype.disable = function disable() {\n      this.unpressButton();\n\n      this.enabled_ = false;\n      this.addClass('vjs-disabled');\n\n      this.menuButton_.disable();\n    };\n\n    /**\n     * Enable the `MenuButton`. Allow it to be clicked.\n     */\n\n\n    MenuButton.prototype.enable = function enable() {\n      this.enabled_ = true;\n      this.removeClass('vjs-disabled');\n\n      this.menuButton_.enable();\n    };\n\n    return MenuButton;\n  }(Component);\n\n  Component.registerComponent('MenuButton', MenuButton);\n\n  /**\n   * @file track-button.js\n   */\n\n  /**\n   * The base class for buttons that toggle specific  track types (e.g. subtitles).\n   *\n   * @extends MenuButton\n   */\n\n  var TrackButton = function (_MenuButton) {\n    inherits(TrackButton, _MenuButton);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function TrackButton(player, options) {\n      classCallCheck(this, TrackButton);\n\n      var tracks = options.tracks;\n\n      var _this = possibleConstructorReturn(this, _MenuButton.call(this, player, options));\n\n      if (_this.items.length <= 1) {\n        _this.hide();\n      }\n\n      if (!tracks) {\n        return possibleConstructorReturn(_this);\n      }\n\n      var updateHandler = bind(_this, _this.update);\n\n      tracks.addEventListener('removetrack', updateHandler);\n      tracks.addEventListener('addtrack', updateHandler);\n      _this.player_.on('ready', updateHandler);\n\n      _this.player_.on('dispose', function () {\n        tracks.removeEventListener('removetrack', updateHandler);\n        tracks.removeEventListener('addtrack', updateHandler);\n      });\n      return _this;\n    }\n\n    return TrackButton;\n  }(MenuButton);\n\n  Component.registerComponent('TrackButton', TrackButton);\n\n  /**\n   * @file menu-item.js\n   */\n\n  /**\n   * The component for a menu item. `<li>`\n   *\n   * @extends ClickableComponent\n   */\n\n  var MenuItem = function (_ClickableComponent) {\n    inherits(MenuItem, _ClickableComponent);\n\n    /**\n     * Creates an instance of the this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options={}]\n     *        The key/value store of player options.\n     *\n     */\n    function MenuItem(player, options) {\n      classCallCheck(this, MenuItem);\n\n      var _this = possibleConstructorReturn(this, _ClickableComponent.call(this, player, options));\n\n      _this.selectable = options.selectable;\n      _this.isSelected_ = options.selected || false;\n\n      _this.selected(_this.isSelected_);\n\n      if (_this.selectable) {\n        // TODO: May need to be either menuitemcheckbox or menuitemradio,\n        //       and may need logical grouping of menu items.\n        _this.el_.setAttribute('role', 'menuitemcheckbox');\n      } else {\n        _this.el_.setAttribute('role', 'menuitem');\n      }\n      return _this;\n    }\n\n    /**\n     * Create the `MenuItem's DOM element\n     *\n     * @param {string} [type=li]\n     *        Element's node type, not actually used, always set to `li`.\n     *\n     * @param {Object} [props={}]\n     *        An object of properties that should be set on the element\n     *\n     * @param {Object} [attrs={}]\n     *        An object of attributes that should be set on the element\n     *\n     * @return {Element}\n     *         The element that gets created.\n     */\n\n\n    MenuItem.prototype.createEl = function createEl(type, props, attrs) {\n      // The control is textual, not just an icon\n      this.nonIconControl = true;\n\n      return _ClickableComponent.prototype.createEl.call(this, 'li', assign({\n        className: 'vjs-menu-item',\n        innerHTML: '<span class=\"vjs-menu-item-text\">' + this.localize(this.options_.label) + '</span>',\n        tabIndex: -1\n      }, props), attrs);\n    };\n\n    /**\n     * Any click on a `MenuItem` puts int into the selected state.\n     * See {@link ClickableComponent#handleClick} for instances where this is called.\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    MenuItem.prototype.handleClick = function handleClick(event) {\n      this.selected(true);\n    };\n\n    /**\n     * Set the state for this menu item as selected or not.\n     *\n     * @param {boolean} selected\n     *        if the menu item is selected or not\n     */\n\n\n    MenuItem.prototype.selected = function selected(_selected) {\n      if (this.selectable) {\n        if (_selected) {\n          this.addClass('vjs-selected');\n          this.el_.setAttribute('aria-checked', 'true');\n          // aria-checked isn't fully supported by browsers/screen readers,\n          // so indicate selected state to screen reader in the control text.\n          this.controlText(', selected');\n          this.isSelected_ = true;\n        } else {\n          this.removeClass('vjs-selected');\n          this.el_.setAttribute('aria-checked', 'false');\n          // Indicate un-selected state to screen reader\n          this.controlText('');\n          this.isSelected_ = false;\n        }\n      }\n    };\n\n    return MenuItem;\n  }(ClickableComponent);\n\n  Component.registerComponent('MenuItem', MenuItem);\n\n  /**\n   * @file text-track-menu-item.js\n   */\n\n  /**\n   * The specific menu item type for selecting a language within a text track kind\n   *\n   * @extends MenuItem\n   */\n\n  var TextTrackMenuItem = function (_MenuItem) {\n    inherits(TextTrackMenuItem, _MenuItem);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function TextTrackMenuItem(player, options) {\n      classCallCheck(this, TextTrackMenuItem);\n\n      var track = options.track;\n      var tracks = player.textTracks();\n\n      // Modify options for parent MenuItem class's init.\n      options.label = track.label || track.language || 'Unknown';\n      options.selected = track.mode === 'showing';\n\n      var _this = possibleConstructorReturn(this, _MenuItem.call(this, player, options));\n\n      _this.track = track;\n      var changeHandler = function changeHandler() {\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        _this.handleTracksChange.apply(_this, args);\n      };\n      var selectedLanguageChangeHandler = function selectedLanguageChangeHandler() {\n        for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          args[_key2] = arguments[_key2];\n        }\n\n        _this.handleSelectedLanguageChange.apply(_this, args);\n      };\n\n      player.on(['loadstart', 'texttrackchange'], changeHandler);\n      tracks.addEventListener('change', changeHandler);\n      tracks.addEventListener('selectedlanguagechange', selectedLanguageChangeHandler);\n      _this.on('dispose', function () {\n        player.off(['loadstart', 'texttrackchange'], changeHandler);\n        tracks.removeEventListener('change', changeHandler);\n        tracks.removeEventListener('selectedlanguagechange', selectedLanguageChangeHandler);\n      });\n\n      // iOS7 doesn't dispatch change events to TextTrackLists when an\n      // associated track's mode changes. Without something like\n      // Object.observe() (also not present on iOS7), it's not\n      // possible to detect changes to the mode attribute and polyfill\n      // the change event. As a poor substitute, we manually dispatch\n      // change events whenever the controls modify the mode.\n      if (tracks.onchange === undefined) {\n        var event = void 0;\n\n        _this.on(['tap', 'click'], function () {\n          if (_typeof(window_1.Event) !== 'object') {\n            // Android 2.3 throws an Illegal Constructor error for window.Event\n            try {\n              event = new window_1.Event('change');\n            } catch (err) {\n              // continue regardless of error\n            }\n          }\n\n          if (!event) {\n            event = document_1.createEvent('Event');\n            event.initEvent('change', true, true);\n          }\n\n          tracks.dispatchEvent(event);\n        });\n      }\n\n      // set the default state based on current tracks\n      _this.handleTracksChange();\n      return _this;\n    }\n\n    /**\n     * This gets called when an `TextTrackMenuItem` is \"clicked\". See\n     * {@link ClickableComponent} for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} event\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    TextTrackMenuItem.prototype.handleClick = function handleClick(event) {\n      var kind = this.track.kind;\n      var kinds = this.track.kinds;\n      var tracks = this.player_.textTracks();\n\n      if (!kinds) {\n        kinds = [kind];\n      }\n\n      _MenuItem.prototype.handleClick.call(this, event);\n\n      if (!tracks) {\n        return;\n      }\n\n      for (var i = 0; i < tracks.length; i++) {\n        var track = tracks[i];\n\n        if (track === this.track && kinds.indexOf(track.kind) > -1) {\n          if (track.mode !== 'showing') {\n            track.mode = 'showing';\n          }\n        } else if (track.mode !== 'disabled') {\n          track.mode = 'disabled';\n        }\n      }\n    };\n\n    /**\n     * Handle text track list change\n     *\n     * @param {EventTarget~Event} event\n     *        The `change` event that caused this function to be called.\n     *\n     * @listens TextTrackList#change\n     */\n\n\n    TextTrackMenuItem.prototype.handleTracksChange = function handleTracksChange(event) {\n      var shouldBeSelected = this.track.mode === 'showing';\n\n      // Prevent redundant selected() calls because they may cause\n      // screen readers to read the appended control text unnecessarily\n      if (shouldBeSelected !== this.isSelected_) {\n        this.selected(shouldBeSelected);\n      }\n    };\n\n    TextTrackMenuItem.prototype.handleSelectedLanguageChange = function handleSelectedLanguageChange(event) {\n      if (this.track.mode === 'showing') {\n        var selectedLanguage = this.player_.cache_.selectedLanguage;\n\n        // Don't replace the kind of track across the same language\n        if (selectedLanguage && selectedLanguage.enabled && selectedLanguage.language === this.track.language && selectedLanguage.kind !== this.track.kind) {\n          return;\n        }\n\n        this.player_.cache_.selectedLanguage = {\n          enabled: true,\n          language: this.track.language,\n          kind: this.track.kind\n        };\n      }\n    };\n\n    TextTrackMenuItem.prototype.dispose = function dispose() {\n      // remove reference to track object on dispose\n      this.track = null;\n\n      _MenuItem.prototype.dispose.call(this);\n    };\n\n    return TextTrackMenuItem;\n  }(MenuItem);\n\n  Component.registerComponent('TextTrackMenuItem', TextTrackMenuItem);\n\n  /**\n   * @file off-text-track-menu-item.js\n   */\n\n  /**\n   * A special menu item for turning of a specific type of text track\n   *\n   * @extends TextTrackMenuItem\n   */\n\n  var OffTextTrackMenuItem = function (_TextTrackMenuItem) {\n    inherits(OffTextTrackMenuItem, _TextTrackMenuItem);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function OffTextTrackMenuItem(player, options) {\n      classCallCheck(this, OffTextTrackMenuItem);\n\n      // Create pseudo track info\n      // Requires options['kind']\n      options.track = {\n        player: player,\n        kind: options.kind,\n        kinds: options.kinds,\n        default: false,\n        mode: 'disabled'\n      };\n\n      if (!options.kinds) {\n        options.kinds = [options.kind];\n      }\n\n      if (options.label) {\n        options.track.label = options.label;\n      } else {\n        options.track.label = options.kinds.join(' and ') + ' off';\n      }\n\n      // MenuItem is selectable\n      options.selectable = true;\n\n      return possibleConstructorReturn(this, _TextTrackMenuItem.call(this, player, options));\n    }\n\n    /**\n     * Handle text track change\n     *\n     * @param {EventTarget~Event} event\n     *        The event that caused this function to run\n     */\n\n\n    OffTextTrackMenuItem.prototype.handleTracksChange = function handleTracksChange(event) {\n      var tracks = this.player().textTracks();\n      var shouldBeSelected = true;\n\n      for (var i = 0, l = tracks.length; i < l; i++) {\n        var track = tracks[i];\n\n        if (this.options_.kinds.indexOf(track.kind) > -1 && track.mode === 'showing') {\n          shouldBeSelected = false;\n          break;\n        }\n      }\n\n      // Prevent redundant selected() calls because they may cause\n      // screen readers to read the appended control text unnecessarily\n      if (shouldBeSelected !== this.isSelected_) {\n        this.selected(shouldBeSelected);\n      }\n    };\n\n    OffTextTrackMenuItem.prototype.handleSelectedLanguageChange = function handleSelectedLanguageChange(event) {\n      var tracks = this.player().textTracks();\n      var allHidden = true;\n\n      for (var i = 0, l = tracks.length; i < l; i++) {\n        var track = tracks[i];\n\n        if (['captions', 'descriptions', 'subtitles'].indexOf(track.kind) > -1 && track.mode === 'showing') {\n          allHidden = false;\n          break;\n        }\n      }\n\n      if (allHidden) {\n        this.player_.cache_.selectedLanguage = {\n          enabled: false\n        };\n      }\n    };\n\n    return OffTextTrackMenuItem;\n  }(TextTrackMenuItem);\n\n  Component.registerComponent('OffTextTrackMenuItem', OffTextTrackMenuItem);\n\n  /**\n   * @file text-track-button.js\n   */\n\n  /**\n   * The base class for buttons that toggle specific text track types (e.g. subtitles)\n   *\n   * @extends MenuButton\n   */\n\n  var TextTrackButton = function (_TrackButton) {\n    inherits(TextTrackButton, _TrackButton);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options={}]\n     *        The key/value store of player options.\n     */\n    function TextTrackButton(player) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      classCallCheck(this, TextTrackButton);\n\n      options.tracks = player.textTracks();\n\n      return possibleConstructorReturn(this, _TrackButton.call(this, player, options));\n    }\n\n    /**\n     * Create a menu item for each text track\n     *\n     * @param {TextTrackMenuItem[]} [items=[]]\n     *        Existing array of items to use during creation\n     *\n     * @return {TextTrackMenuItem[]}\n     *         Array of menu items that were created\n     */\n\n\n    TextTrackButton.prototype.createItems = function createItems() {\n      var items = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var TrackMenuItem = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : TextTrackMenuItem;\n\n\n      // Label is an override for the [track] off label\n      // USed to localise captions/subtitles\n      var label = void 0;\n\n      if (this.label_) {\n        label = this.label_ + ' off';\n      }\n      // Add an OFF menu item to turn all tracks off\n      items.push(new OffTextTrackMenuItem(this.player_, {\n        kinds: this.kinds_,\n        kind: this.kind_,\n        label: label\n      }));\n\n      this.hideThreshold_ += 1;\n\n      var tracks = this.player_.textTracks();\n\n      if (!Array.isArray(this.kinds_)) {\n        this.kinds_ = [this.kind_];\n      }\n\n      for (var i = 0; i < tracks.length; i++) {\n        var track = tracks[i];\n\n        // only add tracks that are of an appropriate kind and have a label\n        if (this.kinds_.indexOf(track.kind) > -1) {\n\n          var item = new TrackMenuItem(this.player_, {\n            track: track,\n            // MenuItem is selectable\n            selectable: true\n          });\n\n          item.addClass('vjs-' + track.kind + '-menu-item');\n          items.push(item);\n        }\n      }\n\n      return items;\n    };\n\n    return TextTrackButton;\n  }(TrackButton);\n\n  Component.registerComponent('TextTrackButton', TextTrackButton);\n\n  /**\n   * @file chapters-track-menu-item.js\n   */\n\n  /**\n   * The chapter track menu item\n   *\n   * @extends MenuItem\n   */\n\n  var ChaptersTrackMenuItem = function (_MenuItem) {\n    inherits(ChaptersTrackMenuItem, _MenuItem);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function ChaptersTrackMenuItem(player, options) {\n      classCallCheck(this, ChaptersTrackMenuItem);\n\n      var track = options.track;\n      var cue = options.cue;\n      var currentTime = player.currentTime();\n\n      // Modify options for parent MenuItem class's init.\n      options.selectable = true;\n      options.label = cue.text;\n      options.selected = cue.startTime <= currentTime && currentTime < cue.endTime;\n\n      var _this = possibleConstructorReturn(this, _MenuItem.call(this, player, options));\n\n      _this.track = track;\n      _this.cue = cue;\n      track.addEventListener('cuechange', bind(_this, _this.update));\n      return _this;\n    }\n\n    /**\n     * This gets called when an `ChaptersTrackMenuItem` is \"clicked\". See\n     * {@link ClickableComponent} for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    ChaptersTrackMenuItem.prototype.handleClick = function handleClick(event) {\n      _MenuItem.prototype.handleClick.call(this);\n      this.player_.currentTime(this.cue.startTime);\n      this.update(this.cue.startTime);\n    };\n\n    /**\n     * Update chapter menu item\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `cuechange` event that caused this function to run.\n     *\n     * @listens TextTrack#cuechange\n     */\n\n\n    ChaptersTrackMenuItem.prototype.update = function update(event) {\n      var cue = this.cue;\n      var currentTime = this.player_.currentTime();\n\n      // vjs.log(currentTime, cue.startTime);\n      this.selected(cue.startTime <= currentTime && currentTime < cue.endTime);\n    };\n\n    return ChaptersTrackMenuItem;\n  }(MenuItem);\n\n  Component.registerComponent('ChaptersTrackMenuItem', ChaptersTrackMenuItem);\n\n  /**\n   * @file chapters-button.js\n   */\n\n  /**\n   * The button component for toggling and selecting chapters\n   * Chapters act much differently than other text tracks\n   * Cues are navigation vs. other tracks of alternative languages\n   *\n   * @extends TextTrackButton\n   */\n\n  var ChaptersButton = function (_TextTrackButton) {\n    inherits(ChaptersButton, _TextTrackButton);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Component~ReadyCallback} [ready]\n     *        The function to call when this function is ready.\n     */\n    function ChaptersButton(player, options, ready) {\n      classCallCheck(this, ChaptersButton);\n      return possibleConstructorReturn(this, _TextTrackButton.call(this, player, options, ready));\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    ChaptersButton.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-chapters-button ' + _TextTrackButton.prototype.buildCSSClass.call(this);\n    };\n\n    ChaptersButton.prototype.buildWrapperCSSClass = function buildWrapperCSSClass() {\n      return 'vjs-chapters-button ' + _TextTrackButton.prototype.buildWrapperCSSClass.call(this);\n    };\n\n    /**\n     * Update the menu based on the current state of its items.\n     *\n     * @param {EventTarget~Event} [event]\n     *        An event that triggered this function to run.\n     *\n     * @listens TextTrackList#addtrack\n     * @listens TextTrackList#removetrack\n     * @listens TextTrackList#change\n     */\n\n\n    ChaptersButton.prototype.update = function update(event) {\n      if (!this.track_ || event && (event.type === 'addtrack' || event.type === 'removetrack')) {\n        this.setTrack(this.findChaptersTrack());\n      }\n      _TextTrackButton.prototype.update.call(this);\n    };\n\n    /**\n     * Set the currently selected track for the chapters button.\n     *\n     * @param {TextTrack} track\n     *        The new track to select. Nothing will change if this is the currently selected\n     *        track.\n     */\n\n\n    ChaptersButton.prototype.setTrack = function setTrack(track) {\n      if (this.track_ === track) {\n        return;\n      }\n\n      if (!this.updateHandler_) {\n        this.updateHandler_ = this.update.bind(this);\n      }\n\n      // here this.track_ refers to the old track instance\n      if (this.track_) {\n        var remoteTextTrackEl = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);\n\n        if (remoteTextTrackEl) {\n          remoteTextTrackEl.removeEventListener('load', this.updateHandler_);\n        }\n\n        this.track_ = null;\n      }\n\n      this.track_ = track;\n\n      // here this.track_ refers to the new track instance\n      if (this.track_) {\n        this.track_.mode = 'hidden';\n\n        var _remoteTextTrackEl = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);\n\n        if (_remoteTextTrackEl) {\n          _remoteTextTrackEl.addEventListener('load', this.updateHandler_);\n        }\n      }\n    };\n\n    /**\n     * Find the track object that is currently in use by this ChaptersButton\n     *\n     * @return {TextTrack|undefined}\n     *         The current track or undefined if none was found.\n     */\n\n\n    ChaptersButton.prototype.findChaptersTrack = function findChaptersTrack() {\n      var tracks = this.player_.textTracks() || [];\n\n      for (var i = tracks.length - 1; i >= 0; i--) {\n        // We will always choose the last track as our chaptersTrack\n        var track = tracks[i];\n\n        if (track.kind === this.kind_) {\n          return track;\n        }\n      }\n    };\n\n    /**\n     * Get the caption for the ChaptersButton based on the track label. This will also\n     * use the current tracks localized kind as a fallback if a label does not exist.\n     *\n     * @return {string}\n     *         The tracks current label or the localized track kind.\n     */\n\n\n    ChaptersButton.prototype.getMenuCaption = function getMenuCaption() {\n      if (this.track_ && this.track_.label) {\n        return this.track_.label;\n      }\n      return this.localize(toTitleCase(this.kind_));\n    };\n\n    /**\n     * Create menu from chapter track\n     *\n     * @return {Menu}\n     *         New menu for the chapter buttons\n     */\n\n\n    ChaptersButton.prototype.createMenu = function createMenu() {\n      this.options_.title = this.getMenuCaption();\n      return _TextTrackButton.prototype.createMenu.call(this);\n    };\n\n    /**\n     * Create a menu item for each text track\n     *\n     * @return {TextTrackMenuItem[]}\n     *         Array of menu items\n     */\n\n\n    ChaptersButton.prototype.createItems = function createItems() {\n      var items = [];\n\n      if (!this.track_) {\n        return items;\n      }\n\n      var cues = this.track_.cues;\n\n      if (!cues) {\n        return items;\n      }\n\n      for (var i = 0, l = cues.length; i < l; i++) {\n        var cue = cues[i];\n        var mi = new ChaptersTrackMenuItem(this.player_, { track: this.track_, cue: cue });\n\n        items.push(mi);\n      }\n\n      return items;\n    };\n\n    return ChaptersButton;\n  }(TextTrackButton);\n\n  /**\n   * `kind` of TextTrack to look for to associate it with this menu.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  ChaptersButton.prototype.kind_ = 'chapters';\n\n  /**\n   * The text that should display over the `ChaptersButton`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n  ChaptersButton.prototype.controlText_ = 'Chapters';\n\n  Component.registerComponent('ChaptersButton', ChaptersButton);\n\n  /**\n   * @file descriptions-button.js\n   */\n\n  /**\n   * The button component for toggling and selecting descriptions\n   *\n   * @extends TextTrackButton\n   */\n\n  var DescriptionsButton = function (_TextTrackButton) {\n    inherits(DescriptionsButton, _TextTrackButton);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Component~ReadyCallback} [ready]\n     *        The function to call when this component is ready.\n     */\n    function DescriptionsButton(player, options, ready) {\n      classCallCheck(this, DescriptionsButton);\n\n      var _this = possibleConstructorReturn(this, _TextTrackButton.call(this, player, options, ready));\n\n      var tracks = player.textTracks();\n      var changeHandler = bind(_this, _this.handleTracksChange);\n\n      tracks.addEventListener('change', changeHandler);\n      _this.on('dispose', function () {\n        tracks.removeEventListener('change', changeHandler);\n      });\n      return _this;\n    }\n\n    /**\n     * Handle text track change\n     *\n     * @param {EventTarget~Event} event\n     *        The event that caused this function to run\n     *\n     * @listens TextTrackList#change\n     */\n\n\n    DescriptionsButton.prototype.handleTracksChange = function handleTracksChange(event) {\n      var tracks = this.player().textTracks();\n      var disabled = false;\n\n      // Check whether a track of a different kind is showing\n      for (var i = 0, l = tracks.length; i < l; i++) {\n        var track = tracks[i];\n\n        if (track.kind !== this.kind_ && track.mode === 'showing') {\n          disabled = true;\n          break;\n        }\n      }\n\n      // If another track is showing, disable this menu button\n      if (disabled) {\n        this.disable();\n      } else {\n        this.enable();\n      }\n    };\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    DescriptionsButton.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-descriptions-button ' + _TextTrackButton.prototype.buildCSSClass.call(this);\n    };\n\n    DescriptionsButton.prototype.buildWrapperCSSClass = function buildWrapperCSSClass() {\n      return 'vjs-descriptions-button ' + _TextTrackButton.prototype.buildWrapperCSSClass.call(this);\n    };\n\n    return DescriptionsButton;\n  }(TextTrackButton);\n\n  /**\n   * `kind` of TextTrack to look for to associate it with this menu.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  DescriptionsButton.prototype.kind_ = 'descriptions';\n\n  /**\n   * The text that should display over the `DescriptionsButton`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n  DescriptionsButton.prototype.controlText_ = 'Descriptions';\n\n  Component.registerComponent('DescriptionsButton', DescriptionsButton);\n\n  /**\n   * @file subtitles-button.js\n   */\n\n  /**\n   * The button component for toggling and selecting subtitles\n   *\n   * @extends TextTrackButton\n   */\n\n  var SubtitlesButton = function (_TextTrackButton) {\n    inherits(SubtitlesButton, _TextTrackButton);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Component~ReadyCallback} [ready]\n     *        The function to call when this component is ready.\n     */\n    function SubtitlesButton(player, options, ready) {\n      classCallCheck(this, SubtitlesButton);\n      return possibleConstructorReturn(this, _TextTrackButton.call(this, player, options, ready));\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    SubtitlesButton.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-subtitles-button ' + _TextTrackButton.prototype.buildCSSClass.call(this);\n    };\n\n    SubtitlesButton.prototype.buildWrapperCSSClass = function buildWrapperCSSClass() {\n      return 'vjs-subtitles-button ' + _TextTrackButton.prototype.buildWrapperCSSClass.call(this);\n    };\n\n    return SubtitlesButton;\n  }(TextTrackButton);\n\n  /**\n   * `kind` of TextTrack to look for to associate it with this menu.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  SubtitlesButton.prototype.kind_ = 'subtitles';\n\n  /**\n   * The text that should display over the `SubtitlesButton`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n  SubtitlesButton.prototype.controlText_ = 'Subtitles';\n\n  Component.registerComponent('SubtitlesButton', SubtitlesButton);\n\n  /**\n   * @file caption-settings-menu-item.js\n   */\n\n  /**\n   * The menu item for caption track settings menu\n   *\n   * @extends TextTrackMenuItem\n   */\n\n  var CaptionSettingsMenuItem = function (_TextTrackMenuItem) {\n    inherits(CaptionSettingsMenuItem, _TextTrackMenuItem);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function CaptionSettingsMenuItem(player, options) {\n      classCallCheck(this, CaptionSettingsMenuItem);\n\n      options.track = {\n        player: player,\n        kind: options.kind,\n        label: options.kind + ' settings',\n        selectable: false,\n        default: false,\n        mode: 'disabled'\n      };\n\n      // CaptionSettingsMenuItem has no concept of 'selected'\n      options.selectable = false;\n\n      options.name = 'CaptionSettingsMenuItem';\n\n      var _this = possibleConstructorReturn(this, _TextTrackMenuItem.call(this, player, options));\n\n      _this.addClass('vjs-texttrack-settings');\n      _this.controlText(', opens ' + options.kind + ' settings dialog');\n      return _this;\n    }\n\n    /**\n     * This gets called when an `CaptionSettingsMenuItem` is \"clicked\". See\n     * {@link ClickableComponent} for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    CaptionSettingsMenuItem.prototype.handleClick = function handleClick(event) {\n      this.player().getChild('textTrackSettings').open();\n    };\n\n    return CaptionSettingsMenuItem;\n  }(TextTrackMenuItem);\n\n  Component.registerComponent('CaptionSettingsMenuItem', CaptionSettingsMenuItem);\n\n  /**\n   * @file captions-button.js\n   */\n\n  /**\n   * The button component for toggling and selecting captions\n   *\n   * @extends TextTrackButton\n   */\n\n  var CaptionsButton = function (_TextTrackButton) {\n    inherits(CaptionsButton, _TextTrackButton);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Component~ReadyCallback} [ready]\n     *        The function to call when this component is ready.\n     */\n    function CaptionsButton(player, options, ready) {\n      classCallCheck(this, CaptionsButton);\n      return possibleConstructorReturn(this, _TextTrackButton.call(this, player, options, ready));\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    CaptionsButton.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-captions-button ' + _TextTrackButton.prototype.buildCSSClass.call(this);\n    };\n\n    CaptionsButton.prototype.buildWrapperCSSClass = function buildWrapperCSSClass() {\n      return 'vjs-captions-button ' + _TextTrackButton.prototype.buildWrapperCSSClass.call(this);\n    };\n\n    /**\n     * Create caption menu items\n     *\n     * @return {CaptionSettingsMenuItem[]}\n     *         The array of current menu items.\n     */\n\n\n    CaptionsButton.prototype.createItems = function createItems() {\n      var items = [];\n\n      if (!(this.player().tech_ && this.player().tech_.featuresNativeTextTracks) && this.player().getChild('textTrackSettings')) {\n        items.push(new CaptionSettingsMenuItem(this.player_, { kind: this.kind_ }));\n\n        this.hideThreshold_ += 1;\n      }\n\n      return _TextTrackButton.prototype.createItems.call(this, items);\n    };\n\n    return CaptionsButton;\n  }(TextTrackButton);\n\n  /**\n   * `kind` of TextTrack to look for to associate it with this menu.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  CaptionsButton.prototype.kind_ = 'captions';\n\n  /**\n   * The text that should display over the `CaptionsButton`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n  CaptionsButton.prototype.controlText_ = 'Captions';\n\n  Component.registerComponent('CaptionsButton', CaptionsButton);\n\n  /**\n   * @file subs-caps-menu-item.js\n   */\n\n  /**\n   * SubsCapsMenuItem has an [cc] icon to distinguish captions from subtitles\n   * in the SubsCapsMenu.\n   *\n   * @extends TextTrackMenuItem\n   */\n\n  var SubsCapsMenuItem = function (_TextTrackMenuItem) {\n    inherits(SubsCapsMenuItem, _TextTrackMenuItem);\n\n    function SubsCapsMenuItem() {\n      classCallCheck(this, SubsCapsMenuItem);\n      return possibleConstructorReturn(this, _TextTrackMenuItem.apply(this, arguments));\n    }\n\n    SubsCapsMenuItem.prototype.createEl = function createEl(type, props, attrs) {\n      var innerHTML = '<span class=\"vjs-menu-item-text\">' + this.localize(this.options_.label);\n\n      if (this.options_.track.kind === 'captions') {\n        innerHTML += '\\n        <span aria-hidden=\"true\" class=\"vjs-icon-placeholder\"></span>\\n        <span class=\"vjs-control-text\"> ' + this.localize('Captions') + '</span>\\n      ';\n      }\n\n      innerHTML += '</span>';\n\n      var el = _TextTrackMenuItem.prototype.createEl.call(this, type, assign({\n        innerHTML: innerHTML\n      }, props), attrs);\n\n      return el;\n    };\n\n    return SubsCapsMenuItem;\n  }(TextTrackMenuItem);\n\n  Component.registerComponent('SubsCapsMenuItem', SubsCapsMenuItem);\n\n  /**\n   * @file sub-caps-button.js\n   */\n  /**\n   * The button component for toggling and selecting captions and/or subtitles\n   *\n   * @extends TextTrackButton\n   */\n\n  var SubsCapsButton = function (_TextTrackButton) {\n    inherits(SubsCapsButton, _TextTrackButton);\n\n    function SubsCapsButton(player) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      classCallCheck(this, SubsCapsButton);\n\n      // Although North America uses \"captions\" in most cases for\n      // \"captions and subtitles\" other locales use \"subtitles\"\n      var _this = possibleConstructorReturn(this, _TextTrackButton.call(this, player, options));\n\n      _this.label_ = 'subtitles';\n      if (['en', 'en-us', 'en-ca', 'fr-ca'].indexOf(_this.player_.language_) > -1) {\n        _this.label_ = 'captions';\n      }\n      _this.menuButton_.controlText(toTitleCase(_this.label_));\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    SubsCapsButton.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-subs-caps-button ' + _TextTrackButton.prototype.buildCSSClass.call(this);\n    };\n\n    SubsCapsButton.prototype.buildWrapperCSSClass = function buildWrapperCSSClass() {\n      return 'vjs-subs-caps-button ' + _TextTrackButton.prototype.buildWrapperCSSClass.call(this);\n    };\n\n    /**\n     * Create caption/subtitles menu items\n     *\n     * @return {CaptionSettingsMenuItem[]}\n     *         The array of current menu items.\n     */\n\n\n    SubsCapsButton.prototype.createItems = function createItems() {\n      var items = [];\n\n      if (!(this.player().tech_ && this.player().tech_.featuresNativeTextTracks) && this.player().getChild('textTrackSettings')) {\n        items.push(new CaptionSettingsMenuItem(this.player_, { kind: this.label_ }));\n\n        this.hideThreshold_ += 1;\n      }\n\n      items = _TextTrackButton.prototype.createItems.call(this, items, SubsCapsMenuItem);\n      return items;\n    };\n\n    return SubsCapsButton;\n  }(TextTrackButton);\n\n  /**\n   * `kind`s of TextTrack to look for to associate it with this menu.\n   *\n   * @type {array}\n   * @private\n   */\n\n\n  SubsCapsButton.prototype.kinds_ = ['captions', 'subtitles'];\n\n  /**\n   * The text that should display over the `SubsCapsButton`s controls.\n   *\n   *\n   * @type {string}\n   * @private\n   */\n  SubsCapsButton.prototype.controlText_ = 'Subtitles';\n\n  Component.registerComponent('SubsCapsButton', SubsCapsButton);\n\n  /**\n   * @file audio-track-menu-item.js\n   */\n\n  /**\n   * An {@link AudioTrack} {@link MenuItem}\n   *\n   * @extends MenuItem\n   */\n\n  var AudioTrackMenuItem = function (_MenuItem) {\n    inherits(AudioTrackMenuItem, _MenuItem);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function AudioTrackMenuItem(player, options) {\n      classCallCheck(this, AudioTrackMenuItem);\n\n      var track = options.track;\n      var tracks = player.audioTracks();\n\n      // Modify options for parent MenuItem class's init.\n      options.label = track.label || track.language || 'Unknown';\n      options.selected = track.enabled;\n\n      var _this = possibleConstructorReturn(this, _MenuItem.call(this, player, options));\n\n      _this.track = track;\n\n      var changeHandler = function changeHandler() {\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        _this.handleTracksChange.apply(_this, args);\n      };\n\n      tracks.addEventListener('change', changeHandler);\n      _this.on('dispose', function () {\n        tracks.removeEventListener('change', changeHandler);\n      });\n      return _this;\n    }\n\n    /**\n     * This gets called when an `AudioTrackMenuItem is \"clicked\". See {@link ClickableComponent}\n     * for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    AudioTrackMenuItem.prototype.handleClick = function handleClick(event) {\n      var tracks = this.player_.audioTracks();\n\n      _MenuItem.prototype.handleClick.call(this, event);\n\n      for (var i = 0; i < tracks.length; i++) {\n        var track = tracks[i];\n\n        track.enabled = track === this.track;\n      }\n    };\n\n    /**\n     * Handle any {@link AudioTrack} change.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The {@link AudioTrackList#change} event that caused this to run.\n     *\n     * @listens AudioTrackList#change\n     */\n\n\n    AudioTrackMenuItem.prototype.handleTracksChange = function handleTracksChange(event) {\n      this.selected(this.track.enabled);\n    };\n\n    return AudioTrackMenuItem;\n  }(MenuItem);\n\n  Component.registerComponent('AudioTrackMenuItem', AudioTrackMenuItem);\n\n  /**\n   * @file audio-track-button.js\n   */\n\n  /**\n   * The base class for buttons that toggle specific {@link AudioTrack} types.\n   *\n   * @extends TrackButton\n   */\n\n  var AudioTrackButton = function (_TrackButton) {\n    inherits(AudioTrackButton, _TrackButton);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options={}]\n     *        The key/value store of player options.\n     */\n    function AudioTrackButton(player) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      classCallCheck(this, AudioTrackButton);\n\n      options.tracks = player.audioTracks();\n\n      return possibleConstructorReturn(this, _TrackButton.call(this, player, options));\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    AudioTrackButton.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-audio-button ' + _TrackButton.prototype.buildCSSClass.call(this);\n    };\n\n    AudioTrackButton.prototype.buildWrapperCSSClass = function buildWrapperCSSClass() {\n      return 'vjs-audio-button ' + _TrackButton.prototype.buildWrapperCSSClass.call(this);\n    };\n\n    /**\n     * Create a menu item for each audio track\n     *\n     * @param {AudioTrackMenuItem[]} [items=[]]\n     *        An array of existing menu items to use.\n     *\n     * @return {AudioTrackMenuItem[]}\n     *         An array of menu items\n     */\n\n\n    AudioTrackButton.prototype.createItems = function createItems() {\n      var items = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n      // if there's only one audio track, there no point in showing it\n      this.hideThreshold_ = 1;\n\n      var tracks = this.player_.audioTracks();\n\n      for (var i = 0; i < tracks.length; i++) {\n        var track = tracks[i];\n\n        items.push(new AudioTrackMenuItem(this.player_, {\n          track: track,\n          // MenuItem is selectable\n          selectable: true\n        }));\n      }\n\n      return items;\n    };\n\n    return AudioTrackButton;\n  }(TrackButton);\n\n  /**\n   * The text that should display over the `AudioTrackButton`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  AudioTrackButton.prototype.controlText_ = 'Audio Track';\n  Component.registerComponent('AudioTrackButton', AudioTrackButton);\n\n  /**\n   * @file playback-rate-menu-item.js\n   */\n\n  /**\n   * The specific menu item type for selecting a playback rate.\n   *\n   * @extends MenuItem\n   */\n\n  var PlaybackRateMenuItem = function (_MenuItem) {\n    inherits(PlaybackRateMenuItem, _MenuItem);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function PlaybackRateMenuItem(player, options) {\n      classCallCheck(this, PlaybackRateMenuItem);\n\n      var label = options.rate;\n      var rate = parseFloat(label, 10);\n\n      // Modify options for parent MenuItem class's init.\n      options.label = label;\n      options.selected = rate === 1;\n      options.selectable = true;\n\n      var _this = possibleConstructorReturn(this, _MenuItem.call(this, player, options));\n\n      _this.label = label;\n      _this.rate = rate;\n\n      _this.on(player, 'ratechange', _this.update);\n      return _this;\n    }\n\n    /**\n     * This gets called when an `PlaybackRateMenuItem` is \"clicked\". See\n     * {@link ClickableComponent} for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    PlaybackRateMenuItem.prototype.handleClick = function handleClick(event) {\n      _MenuItem.prototype.handleClick.call(this);\n      this.player().playbackRate(this.rate);\n    };\n\n    /**\n     * Update the PlaybackRateMenuItem when the playbackrate changes.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `ratechange` event that caused this function to run.\n     *\n     * @listens Player#ratechange\n     */\n\n\n    PlaybackRateMenuItem.prototype.update = function update(event) {\n      this.selected(this.player().playbackRate() === this.rate);\n    };\n\n    return PlaybackRateMenuItem;\n  }(MenuItem);\n\n  /**\n   * The text that should display over the `PlaybackRateMenuItem`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  PlaybackRateMenuItem.prototype.contentElType = 'button';\n\n  Component.registerComponent('PlaybackRateMenuItem', PlaybackRateMenuItem);\n\n  /**\n   * @file playback-rate-menu-button.js\n   */\n\n  /**\n   * The component for controlling the playback rate.\n   *\n   * @extends MenuButton\n   */\n\n  var PlaybackRateMenuButton = function (_MenuButton) {\n    inherits(PlaybackRateMenuButton, _MenuButton);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     */\n    function PlaybackRateMenuButton(player, options) {\n      classCallCheck(this, PlaybackRateMenuButton);\n\n      var _this = possibleConstructorReturn(this, _MenuButton.call(this, player, options));\n\n      _this.updateVisibility();\n      _this.updateLabel();\n\n      _this.on(player, 'loadstart', _this.updateVisibility);\n      _this.on(player, 'ratechange', _this.updateLabel);\n      return _this;\n    }\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    PlaybackRateMenuButton.prototype.createEl = function createEl$$1() {\n      var el = _MenuButton.prototype.createEl.call(this);\n\n      this.labelEl_ = createEl('div', {\n        className: 'vjs-playback-rate-value',\n        innerHTML: '1x'\n      });\n\n      el.appendChild(this.labelEl_);\n\n      return el;\n    };\n\n    PlaybackRateMenuButton.prototype.dispose = function dispose() {\n      this.labelEl_ = null;\n\n      _MenuButton.prototype.dispose.call(this);\n    };\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n\n\n    PlaybackRateMenuButton.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-playback-rate ' + _MenuButton.prototype.buildCSSClass.call(this);\n    };\n\n    PlaybackRateMenuButton.prototype.buildWrapperCSSClass = function buildWrapperCSSClass() {\n      return 'vjs-playback-rate ' + _MenuButton.prototype.buildWrapperCSSClass.call(this);\n    };\n\n    /**\n     * Create the playback rate menu\n     *\n     * @return {Menu}\n     *         Menu object populated with {@link PlaybackRateMenuItem}s\n     */\n\n\n    PlaybackRateMenuButton.prototype.createMenu = function createMenu() {\n      var menu = new Menu(this.player());\n      var rates = this.playbackRates();\n\n      if (rates) {\n        for (var i = rates.length - 1; i >= 0; i--) {\n          menu.addChild(new PlaybackRateMenuItem(this.player(), { rate: rates[i] + 'x' }));\n        }\n      }\n\n      return menu;\n    };\n\n    /**\n     * Updates ARIA accessibility attributes\n     */\n\n\n    PlaybackRateMenuButton.prototype.updateARIAAttributes = function updateARIAAttributes() {\n      // Current playback rate\n      this.el().setAttribute('aria-valuenow', this.player().playbackRate());\n    };\n\n    /**\n     * This gets called when an `PlaybackRateMenuButton` is \"clicked\". See\n     * {@link ClickableComponent} for more detailed information on what a click can be.\n     *\n     * @param {EventTarget~Event} [event]\n     *        The `keydown`, `tap`, or `click` event that caused this function to be\n     *        called.\n     *\n     * @listens tap\n     * @listens click\n     */\n\n\n    PlaybackRateMenuButton.prototype.handleClick = function handleClick(event) {\n      // select next rate option\n      var currentRate = this.player().playbackRate();\n      var rates = this.playbackRates();\n\n      // this will select first one if the last one currently selected\n      var newRate = rates[0];\n\n      for (var i = 0; i < rates.length; i++) {\n        if (rates[i] > currentRate) {\n          newRate = rates[i];\n          break;\n        }\n      }\n      this.player().playbackRate(newRate);\n    };\n\n    /**\n     * Get possible playback rates\n     *\n     * @return {Array}\n     *         All possible playback rates\n     */\n\n\n    PlaybackRateMenuButton.prototype.playbackRates = function playbackRates() {\n      return this.options_.playbackRates || this.options_.playerOptions && this.options_.playerOptions.playbackRates;\n    };\n\n    /**\n     * Get whether playback rates is supported by the tech\n     * and an array of playback rates exists\n     *\n     * @return {boolean}\n     *         Whether changing playback rate is supported\n     */\n\n\n    PlaybackRateMenuButton.prototype.playbackRateSupported = function playbackRateSupported() {\n      return this.player().tech_ && this.player().tech_.featuresPlaybackRate && this.playbackRates() && this.playbackRates().length > 0;\n    };\n\n    /**\n     * Hide playback rate controls when they're no playback rate options to select\n     *\n     * @param {EventTarget~Event} [event]\n     *        The event that caused this function to run.\n     *\n     * @listens Player#loadstart\n     */\n\n\n    PlaybackRateMenuButton.prototype.updateVisibility = function updateVisibility(event) {\n      if (this.playbackRateSupported()) {\n        this.removeClass('vjs-hidden');\n      } else {\n        this.addClass('vjs-hidden');\n      }\n    };\n\n    /**\n     * Update button label when rate changed\n     *\n     * @param {EventTarget~Event} [event]\n     *        The event that caused this function to run.\n     *\n     * @listens Player#ratechange\n     */\n\n\n    PlaybackRateMenuButton.prototype.updateLabel = function updateLabel(event) {\n      if (this.playbackRateSupported()) {\n        this.labelEl_.innerHTML = this.player().playbackRate() + 'x';\n      }\n    };\n\n    return PlaybackRateMenuButton;\n  }(MenuButton);\n\n  /**\n   * The text that should display over the `FullscreenToggle`s controls. Added for localization.\n   *\n   * @type {string}\n   * @private\n   */\n\n\n  PlaybackRateMenuButton.prototype.controlText_ = 'Playback Rate';\n\n  Component.registerComponent('PlaybackRateMenuButton', PlaybackRateMenuButton);\n\n  /**\n   * @file spacer.js\n   */\n\n  /**\n   * Just an empty spacer element that can be used as an append point for plugins, etc.\n   * Also can be used to create space between elements when necessary.\n   *\n   * @extends Component\n   */\n\n  var Spacer = function (_Component) {\n    inherits(Spacer, _Component);\n\n    function Spacer() {\n      classCallCheck(this, Spacer);\n      return possibleConstructorReturn(this, _Component.apply(this, arguments));\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n    Spacer.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-spacer ' + _Component.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    Spacer.prototype.createEl = function createEl() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: this.buildCSSClass()\n      });\n    };\n\n    return Spacer;\n  }(Component);\n\n  Component.registerComponent('Spacer', Spacer);\n\n  /**\n   * @file custom-control-spacer.js\n   */\n\n  /**\n   * Spacer specifically meant to be used as an insertion point for new plugins, etc.\n   *\n   * @extends Spacer\n   */\n\n  var CustomControlSpacer = function (_Spacer) {\n    inherits(CustomControlSpacer, _Spacer);\n\n    function CustomControlSpacer() {\n      classCallCheck(this, CustomControlSpacer);\n      return possibleConstructorReturn(this, _Spacer.apply(this, arguments));\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     */\n    CustomControlSpacer.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-custom-control-spacer ' + _Spacer.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n\n\n    CustomControlSpacer.prototype.createEl = function createEl() {\n      var el = _Spacer.prototype.createEl.call(this, {\n        className: this.buildCSSClass()\n      });\n\n      // No-flex/table-cell mode requires there be some content\n      // in the cell to fill the remaining space of the table.\n      el.innerHTML = '\\xA0';\n      return el;\n    };\n\n    return CustomControlSpacer;\n  }(Spacer);\n\n  Component.registerComponent('CustomControlSpacer', CustomControlSpacer);\n\n  /**\n   * @file control-bar.js\n   */\n\n  /**\n   * Container of main controls.\n   *\n   * @extends Component\n   */\n\n  var ControlBar = function (_Component) {\n    inherits(ControlBar, _Component);\n\n    function ControlBar() {\n      classCallCheck(this, ControlBar);\n      return possibleConstructorReturn(this, _Component.apply(this, arguments));\n    }\n\n    /**\n     * Create the `Component`'s DOM element\n     *\n     * @return {Element}\n     *         The element that was created.\n     */\n    ControlBar.prototype.createEl = function createEl() {\n      return _Component.prototype.createEl.call(this, 'div', {\n        className: 'vjs-control-bar',\n        dir: 'ltr'\n      });\n    };\n\n    return ControlBar;\n  }(Component);\n\n  /**\n   * Default options for `ControlBar`\n   *\n   * @type {Object}\n   * @private\n   */\n\n\n  ControlBar.prototype.options_ = {\n    children: ['playToggle', 'volumePanel', 'currentTimeDisplay', 'timeDivider', 'durationDisplay', 'progressControl', 'liveDisplay', 'remainingTimeDisplay', 'customControlSpacer', 'playbackRateMenuButton', 'chaptersButton', 'descriptionsButton', 'subsCapsButton', 'audioTrackButton', 'fullscreenToggle']\n  };\n\n  Component.registerComponent('ControlBar', ControlBar);\n\n  /**\n   * @file error-display.js\n   */\n\n  /**\n   * A display that indicates an error has occurred. This means that the video\n   * is unplayable.\n   *\n   * @extends ModalDialog\n   */\n\n  var ErrorDisplay = function (_ModalDialog) {\n    inherits(ErrorDisplay, _ModalDialog);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param  {Player} player\n     *         The `Player` that this class should be attached to.\n     *\n     * @param  {Object} [options]\n     *         The key/value store of player options.\n     */\n    function ErrorDisplay(player, options) {\n      classCallCheck(this, ErrorDisplay);\n\n      var _this = possibleConstructorReturn(this, _ModalDialog.call(this, player, options));\n\n      _this.on(player, 'error', _this.open);\n      return _this;\n    }\n\n    /**\n     * Builds the default DOM `className`.\n     *\n     * @return {string}\n     *         The DOM `className` for this object.\n     *\n     * @deprecated Since version 5.\n     */\n\n\n    ErrorDisplay.prototype.buildCSSClass = function buildCSSClass() {\n      return 'vjs-error-display ' + _ModalDialog.prototype.buildCSSClass.call(this);\n    };\n\n    /**\n     * Gets the localized error message based on the `Player`s error.\n     *\n     * @return {string}\n     *         The `Player`s error message localized or an empty string.\n     */\n\n\n    ErrorDisplay.prototype.content = function content() {\n      var error = this.player().error();\n\n      return error ? this.localize(error.message) : '';\n    };\n\n    return ErrorDisplay;\n  }(ModalDialog);\n\n  /**\n   * The default options for an `ErrorDisplay`.\n   *\n   * @private\n   */\n\n\n  ErrorDisplay.prototype.options_ = mergeOptions(ModalDialog.prototype.options_, {\n    pauseOnOpen: false,\n    fillAlways: true,\n    temporary: false,\n    uncloseable: true\n  });\n\n  Component.registerComponent('ErrorDisplay', ErrorDisplay);\n\n  /**\n   * @file text-track-settings.js\n   */\n\n  var LOCAL_STORAGE_KEY = 'vjs-text-track-settings';\n\n  var COLOR_BLACK = ['#000', 'Black'];\n  var COLOR_BLUE = ['#00F', 'Blue'];\n  var COLOR_CYAN = ['#0FF', 'Cyan'];\n  var COLOR_GREEN = ['#0F0', 'Green'];\n  var COLOR_MAGENTA = ['#F0F', 'Magenta'];\n  var COLOR_RED = ['#F00', 'Red'];\n  var COLOR_WHITE = ['#FFF', 'White'];\n  var COLOR_YELLOW = ['#FF0', 'Yellow'];\n\n  var OPACITY_OPAQUE = ['1', 'Opaque'];\n  var OPACITY_SEMI = ['0.5', 'Semi-Transparent'];\n  var OPACITY_TRANS = ['0', 'Transparent'];\n\n  // Configuration for the various <select> elements in the DOM of this component.\n  //\n  // Possible keys include:\n  //\n  // `default`:\n  //   The default option index. Only needs to be provided if not zero.\n  // `parser`:\n  //   A function which is used to parse the value from the selected option in\n  //   a customized way.\n  // `selector`:\n  //   The selector used to find the associated <select> element.\n  var selectConfigs = {\n    backgroundColor: {\n      selector: '.vjs-bg-color > select',\n      id: 'captions-background-color-%s',\n      label: 'Color',\n      options: [COLOR_BLACK, COLOR_WHITE, COLOR_RED, COLOR_GREEN, COLOR_BLUE, COLOR_YELLOW, COLOR_MAGENTA, COLOR_CYAN]\n    },\n\n    backgroundOpacity: {\n      selector: '.vjs-bg-opacity > select',\n      id: 'captions-background-opacity-%s',\n      label: 'Transparency',\n      options: [OPACITY_OPAQUE, OPACITY_SEMI, OPACITY_TRANS]\n    },\n\n    color: {\n      selector: '.vjs-fg-color > select',\n      id: 'captions-foreground-color-%s',\n      label: 'Color',\n      options: [COLOR_WHITE, COLOR_BLACK, COLOR_RED, COLOR_GREEN, COLOR_BLUE, COLOR_YELLOW, COLOR_MAGENTA, COLOR_CYAN]\n    },\n\n    edgeStyle: {\n      selector: '.vjs-edge-style > select',\n      id: '%s',\n      label: 'Text Edge Style',\n      options: [['none', 'None'], ['raised', 'Raised'], ['depressed', 'Depressed'], ['uniform', 'Uniform'], ['dropshadow', 'Dropshadow']]\n    },\n\n    fontFamily: {\n      selector: '.vjs-font-family > select',\n      id: 'captions-font-family-%s',\n      label: 'Font Family',\n      options: [['proportionalSansSerif', 'Proportional Sans-Serif'], ['monospaceSansSerif', 'Monospace Sans-Serif'], ['proportionalSerif', 'Proportional Serif'], ['monospaceSerif', 'Monospace Serif'], ['casual', 'Casual'], ['script', 'Script'], ['small-caps', 'Small Caps']]\n    },\n\n    fontPercent: {\n      selector: '.vjs-font-percent > select',\n      id: 'captions-font-size-%s',\n      label: 'Font Size',\n      options: [['0.50', '50%'], ['0.75', '75%'], ['1.00', '100%'], ['1.25', '125%'], ['1.50', '150%'], ['1.75', '175%'], ['2.00', '200%'], ['3.00', '300%'], ['4.00', '400%']],\n      default: 2,\n      parser: function parser(v) {\n        return v === '1.00' ? null : Number(v);\n      }\n    },\n\n    textOpacity: {\n      selector: '.vjs-text-opacity > select',\n      id: 'captions-foreground-opacity-%s',\n      label: 'Transparency',\n      options: [OPACITY_OPAQUE, OPACITY_SEMI]\n    },\n\n    // Options for this object are defined below.\n    windowColor: {\n      selector: '.vjs-window-color > select',\n      id: 'captions-window-color-%s',\n      label: 'Color'\n    },\n\n    // Options for this object are defined below.\n    windowOpacity: {\n      selector: '.vjs-window-opacity > select',\n      id: 'captions-window-opacity-%s',\n      label: 'Transparency',\n      options: [OPACITY_TRANS, OPACITY_SEMI, OPACITY_OPAQUE]\n    }\n  };\n\n  selectConfigs.windowColor.options = selectConfigs.backgroundColor.options;\n\n  /**\n   * Get the actual value of an option.\n   *\n   * @param  {string} value\n   *         The value to get\n   *\n   * @param  {Function} [parser]\n   *         Optional function to adjust the value.\n   *\n   * @return {Mixed}\n   *         - Will be `undefined` if no value exists\n   *         - Will be `undefined` if the given value is \"none\".\n   *         - Will be the actual value otherwise.\n   *\n   * @private\n   */\n  function parseOptionValue(value, parser) {\n    if (parser) {\n      value = parser(value);\n    }\n\n    if (value && value !== 'none') {\n      return value;\n    }\n  }\n\n  /**\n   * Gets the value of the selected <option> element within a <select> element.\n   *\n   * @param  {Element} el\n   *         the element to look in\n   *\n   * @param  {Function} [parser]\n   *         Optional function to adjust the value.\n   *\n   * @return {Mixed}\n   *         - Will be `undefined` if no value exists\n   *         - Will be `undefined` if the given value is \"none\".\n   *         - Will be the actual value otherwise.\n   *\n   * @private\n   */\n  function getSelectedOptionValue(el, parser) {\n    var value = el.options[el.options.selectedIndex].value;\n\n    return parseOptionValue(value, parser);\n  }\n\n  /**\n   * Sets the selected <option> element within a <select> element based on a\n   * given value.\n   *\n   * @param {Element} el\n   *        The element to look in.\n   *\n   * @param {string} value\n   *        the property to look on.\n   *\n   * @param {Function} [parser]\n   *        Optional function to adjust the value before comparing.\n   *\n   * @private\n   */\n  function setSelectedOption(el, value, parser) {\n    if (!value) {\n      return;\n    }\n\n    for (var i = 0; i < el.options.length; i++) {\n      if (parseOptionValue(el.options[i].value, parser) === value) {\n        el.selectedIndex = i;\n        break;\n      }\n    }\n  }\n\n  /**\n   * Manipulate Text Tracks settings.\n   *\n   * @extends ModalDialog\n   */\n\n  var TextTrackSettings = function (_ModalDialog) {\n    inherits(TextTrackSettings, _ModalDialog);\n\n    /**\n     * Creates an instance of this class.\n     *\n     * @param {Player} player\n     *         The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *         The key/value store of player options.\n     */\n    function TextTrackSettings(player, options) {\n      classCallCheck(this, TextTrackSettings);\n\n      options.temporary = false;\n\n      var _this = possibleConstructorReturn(this, _ModalDialog.call(this, player, options));\n\n      _this.updateDisplay = bind(_this, _this.updateDisplay);\n\n      // fill the modal and pretend we have opened it\n      _this.fill();\n      _this.hasBeenOpened_ = _this.hasBeenFilled_ = true;\n\n      _this.endDialog = createEl('p', {\n        className: 'vjs-control-text',\n        textContent: _this.localize('End of dialog window.')\n      });\n      _this.el().appendChild(_this.endDialog);\n\n      _this.setDefaults();\n\n      // Grab `persistTextTrackSettings` from the player options if not passed in child options\n      if (options.persistTextTrackSettings === undefined) {\n        _this.options_.persistTextTrackSettings = _this.options_.playerOptions.persistTextTrackSettings;\n      }\n\n      _this.on(_this.$('.vjs-done-button'), 'click', function () {\n        _this.saveSettings();\n        _this.close();\n      });\n\n      _this.on(_this.$('.vjs-default-button'), 'click', function () {\n        _this.setDefaults();\n        _this.updateDisplay();\n      });\n\n      each(selectConfigs, function (config) {\n        _this.on(_this.$(config.selector), 'change', _this.updateDisplay);\n      });\n\n      if (_this.options_.persistTextTrackSettings) {\n        _this.restoreSettings();\n      }\n      return _this;\n    }\n\n    TextTrackSettings.prototype.dispose = function dispose() {\n      this.endDialog = null;\n\n      _ModalDialog.prototype.dispose.call(this);\n    };\n\n    /**\n     * Create a <select> element with configured options.\n     *\n     * @param {string} key\n     *        Configuration key to use during creation.\n     *\n     * @return {string}\n     *         An HTML string.\n     *\n     * @private\n     */\n\n\n    TextTrackSettings.prototype.createElSelect_ = function createElSelect_(key) {\n      var _this2 = this;\n\n      var legendId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'label';\n\n      var config = selectConfigs[key];\n      var id = config.id.replace('%s', this.id_);\n      var selectLabelledbyIds = [legendId, id].join(' ').trim();\n\n      return ['<' + type + ' id=\"' + id + '\" class=\"' + (type === 'label' ? 'vjs-label' : '') + '\">', this.localize(config.label), '</' + type + '>', '<select aria-labelledby=\"' + selectLabelledbyIds + '\">'].concat(config.options.map(function (o) {\n        var optionId = id + '-' + o[1].replace(/\\W+/g, '');\n\n        return ['<option id=\"' + optionId + '\" value=\"' + o[0] + '\" ', 'aria-labelledby=\"' + selectLabelledbyIds + ' ' + optionId + '\">', _this2.localize(o[1]), '</option>'].join('');\n      })).concat('</select>').join('');\n    };\n\n    /**\n     * Create foreground color element for the component\n     *\n     * @return {string}\n     *         An HTML string.\n     *\n     * @private\n     */\n\n\n    TextTrackSettings.prototype.createElFgColor_ = function createElFgColor_() {\n      var legendId = 'captions-text-legend-' + this.id_;\n\n      return ['<fieldset class=\"vjs-fg-color vjs-track-setting\">', '<legend id=\"' + legendId + '\">', this.localize('Text'), '</legend>', this.createElSelect_('color', legendId), '<span class=\"vjs-text-opacity vjs-opacity\">', this.createElSelect_('textOpacity', legendId), '</span>', '</fieldset>'].join('');\n    };\n\n    /**\n     * Create background color element for the component\n     *\n     * @return {string}\n     *         An HTML string.\n     *\n     * @private\n     */\n\n\n    TextTrackSettings.prototype.createElBgColor_ = function createElBgColor_() {\n      var legendId = 'captions-background-' + this.id_;\n\n      return ['<fieldset class=\"vjs-bg-color vjs-track-setting\">', '<legend id=\"' + legendId + '\">', this.localize('Background'), '</legend>', this.createElSelect_('backgroundColor', legendId), '<span class=\"vjs-bg-opacity vjs-opacity\">', this.createElSelect_('backgroundOpacity', legendId), '</span>', '</fieldset>'].join('');\n    };\n\n    /**\n     * Create window color element for the component\n     *\n     * @return {string}\n     *         An HTML string.\n     *\n     * @private\n     */\n\n\n    TextTrackSettings.prototype.createElWinColor_ = function createElWinColor_() {\n      var legendId = 'captions-window-' + this.id_;\n\n      return ['<fieldset class=\"vjs-window-color vjs-track-setting\">', '<legend id=\"' + legendId + '\">', this.localize('Window'), '</legend>', this.createElSelect_('windowColor', legendId), '<span class=\"vjs-window-opacity vjs-opacity\">', this.createElSelect_('windowOpacity', legendId), '</span>', '</fieldset>'].join('');\n    };\n\n    /**\n     * Create color elements for the component\n     *\n     * @return {Element}\n     *         The element that was created\n     *\n     * @private\n     */\n\n\n    TextTrackSettings.prototype.createElColors_ = function createElColors_() {\n      return createEl('div', {\n        className: 'vjs-track-settings-colors',\n        innerHTML: [this.createElFgColor_(), this.createElBgColor_(), this.createElWinColor_()].join('')\n      });\n    };\n\n    /**\n     * Create font elements for the component\n     *\n     * @return {Element}\n     *         The element that was created.\n     *\n     * @private\n     */\n\n\n    TextTrackSettings.prototype.createElFont_ = function createElFont_() {\n      return createEl('div', {\n        className: 'vjs-track-settings-font',\n        innerHTML: ['<fieldset class=\"vjs-font-percent vjs-track-setting\">', this.createElSelect_('fontPercent', '', 'legend'), '</fieldset>', '<fieldset class=\"vjs-edge-style vjs-track-setting\">', this.createElSelect_('edgeStyle', '', 'legend'), '</fieldset>', '<fieldset class=\"vjs-font-family vjs-track-setting\">', this.createElSelect_('fontFamily', '', 'legend'), '</fieldset>'].join('')\n      });\n    };\n\n    /**\n     * Create controls for the component\n     *\n     * @return {Element}\n     *         The element that was created.\n     *\n     * @private\n     */\n\n\n    TextTrackSettings.prototype.createElControls_ = function createElControls_() {\n      var defaultsDescription = this.localize('restore all settings to the default values');\n\n      return createEl('div', {\n        className: 'vjs-track-settings-controls',\n        innerHTML: ['<button class=\"vjs-default-button\" title=\"' + defaultsDescription + '\">', this.localize('Reset'), '<span class=\"vjs-control-text\"> ' + defaultsDescription + '</span>', '</button>', '<button class=\"vjs-done-button\">' + this.localize('Done') + '</button>'].join('')\n      });\n    };\n\n    TextTrackSettings.prototype.content = function content() {\n      return [this.createElColors_(), this.createElFont_(), this.createElControls_()];\n    };\n\n    TextTrackSettings.prototype.label = function label() {\n      return this.localize('Caption Settings Dialog');\n    };\n\n    TextTrackSettings.prototype.description = function description() {\n      return this.localize('Beginning of dialog window. Escape will cancel and close the window.');\n    };\n\n    TextTrackSettings.prototype.buildCSSClass = function buildCSSClass() {\n      return _ModalDialog.prototype.buildCSSClass.call(this) + ' vjs-text-track-settings';\n    };\n\n    /**\n     * Gets an object of text track settings (or null).\n     *\n     * @return {Object}\n     *         An object with config values parsed from the DOM or localStorage.\n     */\n\n\n    TextTrackSettings.prototype.getValues = function getValues() {\n      var _this3 = this;\n\n      return reduce(selectConfigs, function (accum, config, key) {\n        var value = getSelectedOptionValue(_this3.$(config.selector), config.parser);\n\n        if (value !== undefined) {\n          accum[key] = value;\n        }\n\n        return accum;\n      }, {});\n    };\n\n    /**\n     * Sets text track settings from an object of values.\n     *\n     * @param {Object} values\n     *        An object with config values parsed from the DOM or localStorage.\n     */\n\n\n    TextTrackSettings.prototype.setValues = function setValues(values) {\n      var _this4 = this;\n\n      each(selectConfigs, function (config, key) {\n        setSelectedOption(_this4.$(config.selector), values[key], config.parser);\n      });\n    };\n\n    /**\n     * Sets all `<select>` elements to their default values.\n     */\n\n\n    TextTrackSettings.prototype.setDefaults = function setDefaults() {\n      var _this5 = this;\n\n      each(selectConfigs, function (config) {\n        var index = config.hasOwnProperty('default') ? config.default : 0;\n\n        _this5.$(config.selector).selectedIndex = index;\n      });\n    };\n\n    /**\n     * Restore texttrack settings from localStorage\n     */\n\n\n    TextTrackSettings.prototype.restoreSettings = function restoreSettings() {\n      var values = void 0;\n\n      try {\n        values = JSON.parse(window_1.localStorage.getItem(LOCAL_STORAGE_KEY));\n      } catch (err) {\n        log$1.warn(err);\n      }\n\n      if (values) {\n        this.setValues(values);\n      }\n    };\n\n    /**\n     * Save text track settings to localStorage\n     */\n\n\n    TextTrackSettings.prototype.saveSettings = function saveSettings() {\n      if (!this.options_.persistTextTrackSettings) {\n        return;\n      }\n\n      var values = this.getValues();\n\n      try {\n        if (Object.keys(values).length) {\n          window_1.localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(values));\n        } else {\n          window_1.localStorage.removeItem(LOCAL_STORAGE_KEY);\n        }\n      } catch (err) {\n        log$1.warn(err);\n      }\n    };\n\n    /**\n     * Update display of text track settings\n     */\n\n\n    TextTrackSettings.prototype.updateDisplay = function updateDisplay() {\n      var ttDisplay = this.player_.getChild('textTrackDisplay');\n\n      if (ttDisplay) {\n        ttDisplay.updateDisplay();\n      }\n    };\n\n    /**\n     * conditionally blur the element and refocus the captions button\n     *\n     * @private\n     */\n\n\n    TextTrackSettings.prototype.conditionalBlur_ = function conditionalBlur_() {\n      this.previouslyActiveEl_ = null;\n      this.off(document_1, 'keydown', this.handleKeyDown);\n\n      var cb = this.player_.controlBar;\n      var subsCapsBtn = cb && cb.subsCapsButton;\n      var ccBtn = cb && cb.captionsButton;\n\n      if (subsCapsBtn) {\n        subsCapsBtn.focus();\n      } else if (ccBtn) {\n        ccBtn.focus();\n      }\n    };\n\n    return TextTrackSettings;\n  }(ModalDialog);\n\n  Component.registerComponent('TextTrackSettings', TextTrackSettings);\n\n  /**\n   * @file resize-manager.js\n   */\n\n  /**\n   * A Resize Manager. It is in charge of triggering `playerresize` on the player in the right conditions.\n   *\n   * It'll either create an iframe and use a debounced resize handler on it or use the new {@link https://wicg.github.io/ResizeObserver/|ResizeObserver}.\n   *\n   * If the ResizeObserver is available natively, it will be used. A polyfill can be passed in as an option.\n   * If a `playerresize` event is not needed, the ResizeManager component can be removed from the player, see the example below.\n   * @example <caption>How to disable the resize manager</caption>\n   * const player = videojs('#vid', {\n   *   resizeManager: false\n   * });\n   *\n   * @see {@link https://wicg.github.io/ResizeObserver/|ResizeObserver specification}\n   *\n   * @extends Component\n   */\n\n  var ResizeManager = function (_Component) {\n    inherits(ResizeManager, _Component);\n\n    /**\n     * Create the ResizeManager.\n     *\n     * @param {Object} player\n     *        The `Player` that this class should be attached to.\n     *\n     * @param {Object} [options]\n     *        The key/value store of ResizeManager options.\n     *\n     * @param {Object} [options.ResizeObserver]\n     *        A polyfill for ResizeObserver can be passed in here.\n     *        If this is set to null it will ignore the native ResizeObserver and fall back to the iframe fallback.\n     */\n    function ResizeManager(player, options) {\n      classCallCheck(this, ResizeManager);\n\n      var RESIZE_OBSERVER_AVAILABLE = options.ResizeObserver || window_1.ResizeObserver;\n\n      // if `null` was passed, we want to disable the ResizeObserver\n      if (options.ResizeObserver === null) {\n        RESIZE_OBSERVER_AVAILABLE = false;\n      }\n\n      // Only create an element when ResizeObserver isn't available\n      var options_ = mergeOptions({ createEl: !RESIZE_OBSERVER_AVAILABLE }, options);\n\n      var _this = possibleConstructorReturn(this, _Component.call(this, player, options_));\n\n      _this.ResizeObserver = options.ResizeObserver || window_1.ResizeObserver;\n      _this.loadListener_ = null;\n      _this.resizeObserver_ = null;\n      _this.debouncedHandler_ = debounce(function () {\n        _this.resizeHandler();\n      }, 100, false, player);\n\n      if (RESIZE_OBSERVER_AVAILABLE) {\n        _this.resizeObserver_ = new _this.ResizeObserver(_this.debouncedHandler_);\n        _this.resizeObserver_.observe(player.el());\n      } else {\n        _this.loadListener_ = function () {\n          if (_this.el_.contentWindow) {\n            on(_this.el_.contentWindow, 'resize', _this.debouncedHandler_);\n          }\n          _this.off('load', _this.loadListener_);\n        };\n\n        _this.on('load', _this.loadListener_);\n      }\n      return _this;\n    }\n\n    ResizeManager.prototype.createEl = function createEl() {\n      return _Component.prototype.createEl.call(this, 'iframe', {\n        className: 'vjs-resize-manager'\n      });\n    };\n\n    /**\n     * Called when a resize is triggered on the iframe or a resize is observed via the ResizeObserver\n     *\n     * @fires Player#playerresize\n     */\n\n\n    ResizeManager.prototype.resizeHandler = function resizeHandler() {\n      /**\n       * Called when the player size has changed\n       *\n       * @event Player#playerresize\n       * @type {EventTarget~Event}\n       */\n      this.player_.trigger('playerresize');\n    };\n\n    ResizeManager.prototype.dispose = function dispose() {\n      if (this.resizeObserver_) {\n        if (this.player_.el()) {\n          this.resizeObserver_.unobserve(this.player_.el());\n        }\n        this.resizeObserver_.disconnect();\n      }\n\n      if (this.el_ && this.el_.contentWindow) {\n        off(this.el_.contentWindow, 'resize', this.debouncedHandler_);\n      }\n\n      if (this.loadListener_) {\n        this.off('load', this.loadListener_);\n      }\n\n      this.ResizeObserver = null;\n      this.resizeObserver = null;\n      this.debouncedHandler_ = null;\n      this.loadListener_ = null;\n    };\n\n    return ResizeManager;\n  }(Component);\n\n  Component.registerComponent('ResizeManager', ResizeManager);\n\n  /**\n   * This function is used to fire a sourceset when there is something\n   * similar to `mediaEl.load()` being called. It will try to find the source via\n   * the `src` attribute and then the `<source>` elements. It will then fire `sourceset`\n   * with the source that was found or empty string if we cannot know. If it cannot\n   * find a source then `sourceset` will not be fired.\n   *\n   * @param {Html5} tech\n   *        The tech object that sourceset was setup on\n   *\n   * @return {boolean}\n   *         returns false if the sourceset was not fired and true otherwise.\n   */\n  var sourcesetLoad = function sourcesetLoad(tech) {\n    var el = tech.el();\n\n    // if `el.src` is set, that source will be loaded.\n    if (el.hasAttribute('src')) {\n      tech.triggerSourceset(el.src);\n      return true;\n    }\n\n    /**\n     * Since there isn't a src property on the media element, source elements will be used for\n     * implementing the source selection algorithm. This happens asynchronously and\n     * for most cases were there is more than one source we cannot tell what source will\n     * be loaded, without re-implementing the source selection algorithm. At this time we are not\n     * going to do that. There are three special cases that we do handle here though:\n     *\n     * 1. If there are no sources, do not fire `sourceset`.\n     * 2. If there is only one `<source>` with a `src` property/attribute that is our `src`\n     * 3. If there is more than one `<source>` but all of them have the same `src` url.\n     *    That will be our src.\n     */\n    var sources = tech.$$('source');\n    var srcUrls = [];\n    var src = '';\n\n    // if there are no sources, do not fire sourceset\n    if (!sources.length) {\n      return false;\n    }\n\n    // only count valid/non-duplicate source elements\n    for (var i = 0; i < sources.length; i++) {\n      var url = sources[i].src;\n\n      if (url && srcUrls.indexOf(url) === -1) {\n        srcUrls.push(url);\n      }\n    }\n\n    // there were no valid sources\n    if (!srcUrls.length) {\n      return false;\n    }\n\n    // there is only one valid source element url\n    // use that\n    if (srcUrls.length === 1) {\n      src = srcUrls[0];\n    }\n\n    tech.triggerSourceset(src);\n    return true;\n  };\n\n  /**\n   * our implementation of an `innerHTML` descriptor for browsers\n   * that do not have one.\n   */\n  var innerHTMLDescriptorPolyfill = Object.defineProperty({}, 'innerHTML', {\n    get: function get() {\n      return this.cloneNode(true).innerHTML;\n    },\n    set: function set(v) {\n      // make a dummy node to use innerHTML on\n      var dummy = document_1.createElement(this.nodeName.toLowerCase());\n\n      // set innerHTML to the value provided\n      dummy.innerHTML = v;\n\n      // make a document fragment to hold the nodes from dummy\n      var docFrag = document_1.createDocumentFragment();\n\n      // copy all of the nodes created by the innerHTML on dummy\n      // to the document fragment\n      while (dummy.childNodes.length) {\n        docFrag.appendChild(dummy.childNodes[0]);\n      }\n\n      // remove content\n      this.innerText = '';\n\n      // now we add all of that html in one by appending the\n      // document fragment. This is how innerHTML does it.\n      window_1.Element.prototype.appendChild.call(this, docFrag);\n\n      // then return the result that innerHTML's setter would\n      return this.innerHTML;\n    }\n  });\n\n  /**\n   * Get a property descriptor given a list of priorities and the\n   * property to get.\n   */\n  var getDescriptor = function getDescriptor(priority, prop) {\n    var descriptor = {};\n\n    for (var i = 0; i < priority.length; i++) {\n      descriptor = Object.getOwnPropertyDescriptor(priority[i], prop);\n\n      if (descriptor && descriptor.set && descriptor.get) {\n        break;\n      }\n    }\n\n    descriptor.enumerable = true;\n    descriptor.configurable = true;\n\n    return descriptor;\n  };\n\n  var getInnerHTMLDescriptor = function getInnerHTMLDescriptor(tech) {\n    return getDescriptor([tech.el(), window_1.HTMLMediaElement.prototype, window_1.Element.prototype, innerHTMLDescriptorPolyfill], 'innerHTML');\n  };\n\n  /**\n   * Patches browser internal functions so that we can tell synchronously\n   * if a `<source>` was appended to the media element. For some reason this\n   * causes a `sourceset` if the the media element is ready and has no source.\n   * This happens when:\n   * - The page has just loaded and the media element does not have a source.\n   * - The media element was emptied of all sources, then `load()` was called.\n   *\n   * It does this by patching the following functions/properties when they are supported:\n   *\n   * - `append()` - can be used to add a `<source>` element to the media element\n   * - `appendChild()` - can be used to add a `<source>` element to the media element\n   * - `insertAdjacentHTML()` -  can be used to add a `<source>` element to the media element\n   * - `innerHTML` -  can be used to add a `<source>` element to the media element\n   *\n   * @param {Html5} tech\n   *        The tech object that sourceset is being setup on.\n   */\n  var firstSourceWatch = function firstSourceWatch(tech) {\n    var el = tech.el();\n\n    // make sure firstSourceWatch isn't setup twice.\n    if (el.resetSourceWatch_) {\n      return;\n    }\n\n    var old = {};\n    var innerDescriptor = getInnerHTMLDescriptor(tech);\n    var appendWrapper = function appendWrapper(appendFn) {\n      return function () {\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        var retval = appendFn.apply(el, args);\n\n        sourcesetLoad(tech);\n\n        return retval;\n      };\n    };\n\n    ['append', 'appendChild', 'insertAdjacentHTML'].forEach(function (k) {\n      if (!el[k]) {\n        return;\n      }\n\n      // store the old function\n      old[k] = el[k];\n\n      // call the old function with a sourceset if a source\n      // was loaded\n      el[k] = appendWrapper(old[k]);\n    });\n\n    Object.defineProperty(el, 'innerHTML', mergeOptions(innerDescriptor, {\n      set: appendWrapper(innerDescriptor.set)\n    }));\n\n    el.resetSourceWatch_ = function () {\n      el.resetSourceWatch_ = null;\n      Object.keys(old).forEach(function (k) {\n        el[k] = old[k];\n      });\n\n      Object.defineProperty(el, 'innerHTML', innerDescriptor);\n    };\n\n    // on the first sourceset, we need to revert our changes\n    tech.one('sourceset', el.resetSourceWatch_);\n  };\n\n  /**\n   * our implementation of a `src` descriptor for browsers\n   * that do not have one.\n   */\n  var srcDescriptorPolyfill = Object.defineProperty({}, 'src', {\n    get: function get() {\n      if (this.hasAttribute('src')) {\n        return getAbsoluteURL(window_1.Element.prototype.getAttribute.call(this, 'src'));\n      }\n\n      return '';\n    },\n    set: function set(v) {\n      window_1.Element.prototype.setAttribute.call(this, 'src', v);\n\n      return v;\n    }\n  });\n\n  var getSrcDescriptor = function getSrcDescriptor(tech) {\n    return getDescriptor([tech.el(), window_1.HTMLMediaElement.prototype, srcDescriptorPolyfill], 'src');\n  };\n\n  /**\n   * setup `sourceset` handling on the `Html5` tech. This function\n   * patches the following element properties/functions:\n   *\n   * - `src` - to determine when `src` is set\n   * - `setAttribute()` - to determine when `src` is set\n   * - `load()` - this re-triggers the source selection algorithm, and can\n   *              cause a sourceset.\n   *\n   * If there is no source when we are adding `sourceset` support or during a `load()`\n   * we also patch the functions listed in `firstSourceWatch`.\n   *\n   * @param {Html5} tech\n   *        The tech to patch\n   */\n  var setupSourceset = function setupSourceset(tech) {\n    if (!tech.featuresSourceset) {\n      return;\n    }\n\n    var el = tech.el();\n\n    // make sure sourceset isn't setup twice.\n    if (el.resetSourceset_) {\n      return;\n    }\n\n    var srcDescriptor = getSrcDescriptor(tech);\n    var oldSetAttribute = el.setAttribute;\n    var oldLoad = el.load;\n\n    Object.defineProperty(el, 'src', mergeOptions(srcDescriptor, {\n      set: function set(v) {\n        var retval = srcDescriptor.set.call(el, v);\n\n        // we use the getter here to get the actual value set on src\n        tech.triggerSourceset(el.src);\n\n        return retval;\n      }\n    }));\n\n    el.setAttribute = function (n, v) {\n      var retval = oldSetAttribute.call(el, n, v);\n\n      if (/src/i.test(n)) {\n        tech.triggerSourceset(el.src);\n      }\n\n      return retval;\n    };\n\n    el.load = function () {\n      var retval = oldLoad.call(el);\n\n      // if load was called, but there was no source to fire\n      // sourceset on. We have to watch for a source append\n      // as that can trigger a `sourceset` when the media element\n      // has no source\n      if (!sourcesetLoad(tech)) {\n        tech.triggerSourceset('');\n        firstSourceWatch(tech);\n      }\n\n      return retval;\n    };\n\n    if (el.currentSrc) {\n      tech.triggerSourceset(el.currentSrc);\n    } else if (!sourcesetLoad(tech)) {\n      firstSourceWatch(tech);\n    }\n\n    el.resetSourceset_ = function () {\n      el.resetSourceset_ = null;\n      el.load = oldLoad;\n      el.setAttribute = oldSetAttribute;\n      Object.defineProperty(el, 'src', srcDescriptor);\n      if (el.resetSourceWatch_) {\n        el.resetSourceWatch_();\n      }\n    };\n  };\n\n  var _templateObject$1 = taggedTemplateLiteralLoose(['Text Tracks are being loaded from another origin but the crossorigin attribute isn\\'t used.\\n            This may prevent text tracks from loading.'], ['Text Tracks are being loaded from another origin but the crossorigin attribute isn\\'t used.\\n            This may prevent text tracks from loading.']);\n\n  /**\n   * HTML5 Media Controller - Wrapper for HTML5 Media API\n   *\n   * @mixes Tech~SourceHandlerAdditions\n   * @extends Tech\n   */\n\n  var Html5 = function (_Tech) {\n    inherits(Html5, _Tech);\n\n    /**\n     * Create an instance of this Tech.\n     *\n     * @param {Object} [options]\n     *        The key/value store of player options.\n     *\n     * @param {Component~ReadyCallback} ready\n     *        Callback function to call when the `HTML5` Tech is ready.\n     */\n    function Html5(options, ready) {\n      classCallCheck(this, Html5);\n\n      var _this = possibleConstructorReturn(this, _Tech.call(this, options, ready));\n\n      var source = options.source;\n      var crossoriginTracks = false;\n\n      // Set the source if one is provided\n      // 1) Check if the source is new (if not, we want to keep the original so playback isn't interrupted)\n      // 2) Check to see if the network state of the tag was failed at init, and if so, reset the source\n      // anyway so the error gets fired.\n      if (source && (_this.el_.currentSrc !== source.src || options.tag && options.tag.initNetworkState_ === 3)) {\n        _this.setSource(source);\n      } else {\n        _this.handleLateInit_(_this.el_);\n      }\n\n      // setup sourceset after late sourceset/init\n      if (options.enableSourceset) {\n        _this.setupSourcesetHandling_();\n      }\n\n      if (_this.el_.hasChildNodes()) {\n\n        var nodes = _this.el_.childNodes;\n        var nodesLength = nodes.length;\n        var removeNodes = [];\n\n        while (nodesLength--) {\n          var node = nodes[nodesLength];\n          var nodeName = node.nodeName.toLowerCase();\n\n          if (nodeName === 'track') {\n            if (!_this.featuresNativeTextTracks) {\n              // Empty video tag tracks so the built-in player doesn't use them also.\n              // This may not be fast enough to stop HTML5 browsers from reading the tags\n              // so we'll need to turn off any default tracks if we're manually doing\n              // captions and subtitles. videoElement.textTracks\n              removeNodes.push(node);\n            } else {\n              // store HTMLTrackElement and TextTrack to remote list\n              _this.remoteTextTrackEls().addTrackElement_(node);\n              _this.remoteTextTracks().addTrack(node.track);\n              _this.textTracks().addTrack(node.track);\n              if (!crossoriginTracks && !_this.el_.hasAttribute('crossorigin') && isCrossOrigin(node.src)) {\n                crossoriginTracks = true;\n              }\n            }\n          }\n        }\n\n        for (var i = 0; i < removeNodes.length; i++) {\n          _this.el_.removeChild(removeNodes[i]);\n        }\n      }\n\n      _this.proxyNativeTracks_();\n      if (_this.featuresNativeTextTracks && crossoriginTracks) {\n        log$1.warn(tsml(_templateObject$1));\n      }\n\n      // prevent iOS Safari from disabling metadata text tracks during native playback\n      _this.restoreMetadataTracksInIOSNativePlayer_();\n\n      // Determine if native controls should be used\n      // Our goal should be to get the custom controls on mobile solid everywhere\n      // so we can remove this all together. Right now this will block custom\n      // controls on touch enabled laptops like the Chrome Pixel\n      if ((TOUCH_ENABLED || IS_IPHONE || IS_NATIVE_ANDROID) && options.nativeControlsForTouch === true) {\n        _this.setControls(true);\n      }\n\n      // on iOS, we want to proxy `webkitbeginfullscreen` and `webkitendfullscreen`\n      // into a `fullscreenchange` event\n      _this.proxyWebkitFullscreen_();\n\n      _this.triggerReady();\n      return _this;\n    }\n\n    /**\n     * Dispose of `HTML5` media element and remove all tracks.\n     */\n\n\n    Html5.prototype.dispose = function dispose() {\n      if (this.el_ && this.el_.resetSourceset_) {\n        this.el_.resetSourceset_();\n      }\n      Html5.disposeMediaElement(this.el_);\n      this.options_ = null;\n\n      // tech will handle clearing of the emulated track list\n      _Tech.prototype.dispose.call(this);\n    };\n\n    /**\n     * Modify the media element so that we can detect when\n     * the source is changed. Fires `sourceset` just after the source has changed\n     */\n\n\n    Html5.prototype.setupSourcesetHandling_ = function setupSourcesetHandling_() {\n      setupSourceset(this);\n    };\n\n    /**\n     * When a captions track is enabled in the iOS Safari native player, all other\n     * tracks are disabled (including metadata tracks), which nulls all of their\n     * associated cue points. This will restore metadata tracks to their pre-fullscreen\n     * state in those cases so that cue points are not needlessly lost.\n     *\n     * @private\n     */\n\n\n    Html5.prototype.restoreMetadataTracksInIOSNativePlayer_ = function restoreMetadataTracksInIOSNativePlayer_() {\n      var textTracks = this.textTracks();\n      var metadataTracksPreFullscreenState = void 0;\n\n      // captures a snapshot of every metadata track's current state\n      var takeMetadataTrackSnapshot = function takeMetadataTrackSnapshot() {\n        metadataTracksPreFullscreenState = [];\n\n        for (var i = 0; i < textTracks.length; i++) {\n          var track = textTracks[i];\n\n          if (track.kind === 'metadata') {\n            metadataTracksPreFullscreenState.push({\n              track: track,\n              storedMode: track.mode\n            });\n          }\n        }\n      };\n\n      // snapshot each metadata track's initial state, and update the snapshot\n      // each time there is a track 'change' event\n      takeMetadataTrackSnapshot();\n      textTracks.addEventListener('change', takeMetadataTrackSnapshot);\n\n      this.on('dispose', function () {\n        return textTracks.removeEventListener('change', takeMetadataTrackSnapshot);\n      });\n\n      var restoreTrackMode = function restoreTrackMode() {\n        for (var i = 0; i < metadataTracksPreFullscreenState.length; i++) {\n          var storedTrack = metadataTracksPreFullscreenState[i];\n\n          if (storedTrack.track.mode === 'disabled' && storedTrack.track.mode !== storedTrack.storedMode) {\n            storedTrack.track.mode = storedTrack.storedMode;\n          }\n        }\n        // we only want this handler to be executed on the first 'change' event\n        textTracks.removeEventListener('change', restoreTrackMode);\n      };\n\n      // when we enter fullscreen playback, stop updating the snapshot and\n      // restore all track modes to their pre-fullscreen state\n      this.on('webkitbeginfullscreen', function () {\n        textTracks.removeEventListener('change', takeMetadataTrackSnapshot);\n\n        // remove the listener before adding it just in case it wasn't previously removed\n        textTracks.removeEventListener('change', restoreTrackMode);\n        textTracks.addEventListener('change', restoreTrackMode);\n      });\n\n      // start updating the snapshot again after leaving fullscreen\n      this.on('webkitendfullscreen', function () {\n        // remove the listener before adding it just in case it wasn't previously removed\n        textTracks.removeEventListener('change', takeMetadataTrackSnapshot);\n        textTracks.addEventListener('change', takeMetadataTrackSnapshot);\n\n        // remove the restoreTrackMode handler in case it wasn't triggered during fullscreen playback\n        textTracks.removeEventListener('change', restoreTrackMode);\n      });\n    };\n\n    /**\n     * Attempt to force override of tracks for the given type\n     *\n     * @param {String} type - Track type to override, possible values include 'Audio',\n     * 'Video', and 'Text'.\n     * @param {Boolean} override - If set to true native audio/video will be overridden,\n     * otherwise native audio/video will potentially be used.\n     * @private\n     */\n\n\n    Html5.prototype.overrideNative_ = function overrideNative_(type, override) {\n      var _this2 = this;\n\n      // If there is no behavioral change don't add/remove listeners\n      if (override !== this['featuresNative' + type + 'Tracks']) {\n        return;\n      }\n\n      var lowerCaseType = type.toLowerCase();\n\n      if (this[lowerCaseType + 'TracksListeners_']) {\n        Object.keys(this[lowerCaseType + 'TracksListeners_']).forEach(function (eventName) {\n          var elTracks = _this2.el()[lowerCaseType + 'Tracks'];\n\n          elTracks.removeEventListener(eventName, _this2[lowerCaseType + 'TracksListeners_'][eventName]);\n        });\n      }\n\n      this['featuresNative' + type + 'Tracks'] = !override;\n      this[lowerCaseType + 'TracksListeners_'] = null;\n\n      this.proxyNativeTracksForType_(lowerCaseType);\n    };\n\n    /**\n     * Attempt to force override of native audio tracks.\n     *\n     * @param {Boolean} override - If set to true native audio will be overridden,\n     * otherwise native audio will potentially be used.\n     */\n\n\n    Html5.prototype.overrideNativeAudioTracks = function overrideNativeAudioTracks(override) {\n      this.overrideNative_('Audio', override);\n    };\n\n    /**\n     * Attempt to force override of native video tracks.\n     *\n     * @param {Boolean} override - If set to true native video will be overridden,\n     * otherwise native video will potentially be used.\n     */\n\n\n    Html5.prototype.overrideNativeVideoTracks = function overrideNativeVideoTracks(override) {\n      this.overrideNative_('Video', override);\n    };\n\n    /**\n      * Proxy native track list events for the given type to our track\n      * lists if the browser we are playing in supports that type of track list.\n      *\n      * @param {string} name - Track type; values include 'audio', 'video', and 'text'\n      * @private\n      */\n\n\n    Html5.prototype.proxyNativeTracksForType_ = function proxyNativeTracksForType_(name) {\n      var _this3 = this;\n\n      var props = NORMAL[name];\n      var elTracks = this.el()[props.getterName];\n      var techTracks = this[props.getterName]();\n\n      if (!this['featuresNative' + props.capitalName + 'Tracks'] || !elTracks || !elTracks.addEventListener) {\n        return;\n      }\n      var listeners = {\n        change: function change(e) {\n          techTracks.trigger({\n            type: 'change',\n            target: techTracks,\n            currentTarget: techTracks,\n            srcElement: techTracks\n          });\n        },\n        addtrack: function addtrack(e) {\n          techTracks.addTrack(e.track);\n        },\n        removetrack: function removetrack(e) {\n          techTracks.removeTrack(e.track);\n        }\n      };\n      var removeOldTracks = function removeOldTracks() {\n        var removeTracks = [];\n\n        for (var i = 0; i < techTracks.length; i++) {\n          var found = false;\n\n          for (var j = 0; j < elTracks.length; j++) {\n            if (elTracks[j] === techTracks[i]) {\n              found = true;\n              break;\n            }\n          }\n\n          if (!found) {\n            removeTracks.push(techTracks[i]);\n          }\n        }\n\n        while (removeTracks.length) {\n          techTracks.removeTrack(removeTracks.shift());\n        }\n      };\n\n      this[props.getterName + 'Listeners_'] = listeners;\n\n      Object.keys(listeners).forEach(function (eventName) {\n        var listener = listeners[eventName];\n\n        elTracks.addEventListener(eventName, listener);\n        _this3.on('dispose', function (e) {\n          return elTracks.removeEventListener(eventName, listener);\n        });\n      });\n\n      // Remove (native) tracks that are not used anymore\n      this.on('loadstart', removeOldTracks);\n      this.on('dispose', function (e) {\n        return _this3.off('loadstart', removeOldTracks);\n      });\n    };\n\n    /**\n     * Proxy all native track list events to our track lists if the browser we are playing\n     * in supports that type of track list.\n     *\n     * @private\n     */\n\n\n    Html5.prototype.proxyNativeTracks_ = function proxyNativeTracks_() {\n      var _this4 = this;\n\n      NORMAL.names.forEach(function (name) {\n        _this4.proxyNativeTracksForType_(name);\n      });\n    };\n\n    /**\n     * Create the `Html5` Tech's DOM element.\n     *\n     * @return {Element}\n     *         The element that gets created.\n     */\n\n\n    Html5.prototype.createEl = function createEl$$1() {\n      var el = this.options_.tag;\n\n      // Check if this browser supports moving the element into the box.\n      // On the iPhone video will break if you move the element,\n      // So we have to create a brand new element.\n      // If we ingested the player div, we do not need to move the media element.\n      if (!el || !(this.options_.playerElIngest || this.movingMediaElementInDOM)) {\n\n        // If the original tag is still there, clone and remove it.\n        if (el) {\n          var clone = el.cloneNode(true);\n\n          if (el.parentNode) {\n            el.parentNode.insertBefore(clone, el);\n          }\n          Html5.disposeMediaElement(el);\n          el = clone;\n        } else {\n          el = document_1.createElement('video');\n\n          // determine if native controls should be used\n          var tagAttributes = this.options_.tag && getAttributes(this.options_.tag);\n          var attributes = mergeOptions({}, tagAttributes);\n\n          if (!TOUCH_ENABLED || this.options_.nativeControlsForTouch !== true) {\n            delete attributes.controls;\n          }\n\n          setAttributes(el, assign(attributes, {\n            id: this.options_.techId,\n            class: 'vjs-tech'\n          }));\n        }\n\n        el.playerId = this.options_.playerId;\n      }\n\n      if (typeof this.options_.preload !== 'undefined') {\n        setAttribute(el, 'preload', this.options_.preload);\n      }\n\n      // Update specific tag settings, in case they were overridden\n      // `autoplay` has to be *last* so that `muted` and `playsinline` are present\n      // when iOS/Safari or other browsers attempt to autoplay.\n      var settingsAttrs = ['loop', 'muted', 'playsinline', 'autoplay'];\n\n      for (var i = 0; i < settingsAttrs.length; i++) {\n        var attr = settingsAttrs[i];\n        var value = this.options_[attr];\n\n        if (typeof value !== 'undefined') {\n          if (value) {\n            setAttribute(el, attr, attr);\n          } else {\n            removeAttribute(el, attr);\n          }\n          el[attr] = value;\n        }\n      }\n\n      return el;\n    };\n\n    /**\n     * This will be triggered if the loadstart event has already fired, before videojs was\n     * ready. Two known examples of when this can happen are:\n     * 1. If we're loading the playback object after it has started loading\n     * 2. The media is already playing the (often with autoplay on) then\n     *\n     * This function will fire another loadstart so that videojs can catchup.\n     *\n     * @fires Tech#loadstart\n     *\n     * @return {undefined}\n     *         returns nothing.\n     */\n\n\n    Html5.prototype.handleLateInit_ = function handleLateInit_(el) {\n      if (el.networkState === 0 || el.networkState === 3) {\n        // The video element hasn't started loading the source yet\n        // or didn't find a source\n        return;\n      }\n\n      if (el.readyState === 0) {\n        // NetworkState is set synchronously BUT loadstart is fired at the\n        // end of the current stack, usually before setInterval(fn, 0).\n        // So at this point we know loadstart may have already fired or is\n        // about to fire, and either way the player hasn't seen it yet.\n        // We don't want to fire loadstart prematurely here and cause a\n        // double loadstart so we'll wait and see if it happens between now\n        // and the next loop, and fire it if not.\n        // HOWEVER, we also want to make sure it fires before loadedmetadata\n        // which could also happen between now and the next loop, so we'll\n        // watch for that also.\n        var loadstartFired = false;\n        var setLoadstartFired = function setLoadstartFired() {\n          loadstartFired = true;\n        };\n\n        this.on('loadstart', setLoadstartFired);\n\n        var triggerLoadstart = function triggerLoadstart() {\n          // We did miss the original loadstart. Make sure the player\n          // sees loadstart before loadedmetadata\n          if (!loadstartFired) {\n            this.trigger('loadstart');\n          }\n        };\n\n        this.on('loadedmetadata', triggerLoadstart);\n\n        this.ready(function () {\n          this.off('loadstart', setLoadstartFired);\n          this.off('loadedmetadata', triggerLoadstart);\n\n          if (!loadstartFired) {\n            // We did miss the original native loadstart. Fire it now.\n            this.trigger('loadstart');\n          }\n        });\n\n        return;\n      }\n\n      // From here on we know that loadstart already fired and we missed it.\n      // The other readyState events aren't as much of a problem if we double\n      // them, so not going to go to as much trouble as loadstart to prevent\n      // that unless we find reason to.\n      var eventsToTrigger = ['loadstart'];\n\n      // loadedmetadata: newly equal to HAVE_METADATA (1) or greater\n      eventsToTrigger.push('loadedmetadata');\n\n      // loadeddata: newly increased to HAVE_CURRENT_DATA (2) or greater\n      if (el.readyState >= 2) {\n        eventsToTrigger.push('loadeddata');\n      }\n\n      // canplay: newly increased to HAVE_FUTURE_DATA (3) or greater\n      if (el.readyState >= 3) {\n        eventsToTrigger.push('canplay');\n      }\n\n      // canplaythrough: newly equal to HAVE_ENOUGH_DATA (4)\n      if (el.readyState >= 4) {\n        eventsToTrigger.push('canplaythrough');\n      }\n\n      // We still need to give the player time to add event listeners\n      this.ready(function () {\n        eventsToTrigger.forEach(function (type) {\n          this.trigger(type);\n        }, this);\n      });\n    };\n\n    /**\n     * Set current time for the `HTML5` tech.\n     *\n     * @param {number} seconds\n     *        Set the current time of the media to this.\n     */\n\n\n    Html5.prototype.setCurrentTime = function setCurrentTime(seconds) {\n      try {\n        this.el_.currentTime = seconds;\n      } catch (e) {\n        log$1(e, 'Video is not ready. (Video.js)');\n        // this.warning(VideoJS.warnings.videoNotReady);\n      }\n    };\n\n    /**\n     * Get the current duration of the HTML5 media element.\n     *\n     * @return {number}\n     *         The duration of the media or 0 if there is no duration.\n     */\n\n\n    Html5.prototype.duration = function duration() {\n      var _this5 = this;\n\n      // Android Chrome will report duration as Infinity for VOD HLS until after\n      // playback has started, which triggers the live display erroneously.\n      // Return NaN if playback has not started and trigger a durationupdate once\n      // the duration can be reliably known.\n      if (this.el_.duration === Infinity && IS_ANDROID && IS_CHROME && this.el_.currentTime === 0) {\n        // Wait for the first `timeupdate` with currentTime > 0 - there may be\n        // several with 0\n        var checkProgress = function checkProgress() {\n          if (_this5.el_.currentTime > 0) {\n            // Trigger durationchange for genuinely live video\n            if (_this5.el_.duration === Infinity) {\n              _this5.trigger('durationchange');\n            }\n            _this5.off('timeupdate', checkProgress);\n          }\n        };\n\n        this.on('timeupdate', checkProgress);\n        return NaN;\n      }\n      return this.el_.duration || NaN;\n    };\n\n    /**\n     * Get the current width of the HTML5 media element.\n     *\n     * @return {number}\n     *         The width of the HTML5 media element.\n     */\n\n\n    Html5.prototype.width = function width() {\n      return this.el_.offsetWidth;\n    };\n\n    /**\n     * Get the current height of the HTML5 media element.\n     *\n     * @return {number}\n     *         The height of the HTML5 media element.\n     */\n\n\n    Html5.prototype.height = function height() {\n      return this.el_.offsetHeight;\n    };\n\n    /**\n     * Proxy iOS `webkitbeginfullscreen` and `webkitendfullscreen` into\n     * `fullscreenchange` event.\n     *\n     * @private\n     * @fires fullscreenchange\n     * @listens webkitendfullscreen\n     * @listens webkitbeginfullscreen\n     * @listens webkitbeginfullscreen\n     */\n\n\n    Html5.prototype.proxyWebkitFullscreen_ = function proxyWebkitFullscreen_() {\n      var _this6 = this;\n\n      if (!('webkitDisplayingFullscreen' in this.el_)) {\n        return;\n      }\n\n      var endFn = function endFn() {\n        this.trigger('fullscreenchange', { isFullscreen: false });\n      };\n\n      var beginFn = function beginFn() {\n        if ('webkitPresentationMode' in this.el_ && this.el_.webkitPresentationMode !== 'picture-in-picture') {\n          this.one('webkitendfullscreen', endFn);\n\n          this.trigger('fullscreenchange', { isFullscreen: true });\n        }\n      };\n\n      this.on('webkitbeginfullscreen', beginFn);\n      this.on('dispose', function () {\n        _this6.off('webkitbeginfullscreen', beginFn);\n        _this6.off('webkitendfullscreen', endFn);\n      });\n    };\n\n    /**\n     * Check if fullscreen is supported on the current playback device.\n     *\n     * @return {boolean}\n     *         - True if fullscreen is supported.\n     *         - False if fullscreen is not supported.\n     */\n\n\n    Html5.prototype.supportsFullScreen = function supportsFullScreen() {\n      if (typeof this.el_.webkitEnterFullScreen === 'function') {\n        var userAgent = window_1.navigator && window_1.navigator.userAgent || '';\n\n        // Seems to be broken in Chromium/Chrome && Safari in Leopard\n        if (/Android/.test(userAgent) || !/Chrome|Mac OS X 10.5/.test(userAgent)) {\n          return true;\n        }\n      }\n      return false;\n    };\n\n    /**\n     * Request that the `HTML5` Tech enter fullscreen.\n     */\n\n\n    Html5.prototype.enterFullScreen = function enterFullScreen() {\n      var video = this.el_;\n\n      if (video.paused && video.networkState <= video.HAVE_METADATA) {\n        // attempt to prime the video element for programmatic access\n        // this isn't necessary on the desktop but shouldn't hurt\n        this.el_.play();\n\n        // playing and pausing synchronously during the transition to fullscreen\n        // can get iOS ~6.1 devices into a play/pause loop\n        this.setTimeout(function () {\n          video.pause();\n          video.webkitEnterFullScreen();\n        }, 0);\n      } else {\n        video.webkitEnterFullScreen();\n      }\n    };\n\n    /**\n     * Request that the `HTML5` Tech exit fullscreen.\n     */\n\n\n    Html5.prototype.exitFullScreen = function exitFullScreen() {\n      this.el_.webkitExitFullScreen();\n    };\n\n    /**\n     * A getter/setter for the `Html5` Tech's source object.\n     * > Note: Please use {@link Html5#setSource}\n     *\n     * @param {Tech~SourceObject} [src]\n     *        The source object you want to set on the `HTML5` techs element.\n     *\n     * @return {Tech~SourceObject|undefined}\n     *         - The current source object when a source is not passed in.\n     *         - undefined when setting\n     *\n     * @deprecated Since version 5.\n     */\n\n\n    Html5.prototype.src = function src(_src) {\n      if (_src === undefined) {\n        return this.el_.src;\n      }\n\n      // Setting src through `src` instead of `setSrc` will be deprecated\n      this.setSrc(_src);\n    };\n\n    /**\n     * Reset the tech by removing all sources and then calling\n     * {@link Html5.resetMediaElement}.\n     */\n\n\n    Html5.prototype.reset = function reset() {\n      Html5.resetMediaElement(this.el_);\n    };\n\n    /**\n     * Get the current source on the `HTML5` Tech. Falls back to returning the source from\n     * the HTML5 media element.\n     *\n     * @return {Tech~SourceObject}\n     *         The current source object from the HTML5 tech. With a fallback to the\n     *         elements source.\n     */\n\n\n    Html5.prototype.currentSrc = function currentSrc() {\n      if (this.currentSource_) {\n        return this.currentSource_.src;\n      }\n      return this.el_.currentSrc;\n    };\n\n    /**\n     * Set controls attribute for the HTML5 media Element.\n     *\n     * @param {string} val\n     *        Value to set the controls attribute to\n     */\n\n\n    Html5.prototype.setControls = function setControls(val) {\n      this.el_.controls = !!val;\n    };\n\n    /**\n     * Create and returns a remote {@link TextTrack} object.\n     *\n     * @param {string} kind\n     *        `TextTrack` kind (subtitles, captions, descriptions, chapters, or metadata)\n     *\n     * @param {string} [label]\n     *        Label to identify the text track\n     *\n     * @param {string} [language]\n     *        Two letter language abbreviation\n     *\n     * @return {TextTrack}\n     *         The TextTrack that gets created.\n     */\n\n\n    Html5.prototype.addTextTrack = function addTextTrack(kind, label, language) {\n      if (!this.featuresNativeTextTracks) {\n        return _Tech.prototype.addTextTrack.call(this, kind, label, language);\n      }\n\n      return this.el_.addTextTrack(kind, label, language);\n    };\n\n    /**\n     * Creates either native TextTrack or an emulated TextTrack depending\n     * on the value of `featuresNativeTextTracks`\n     *\n     * @param {Object} options\n     *        The object should contain the options to initialize the TextTrack with.\n     *\n     * @param {string} [options.kind]\n     *        `TextTrack` kind (subtitles, captions, descriptions, chapters, or metadata).\n     *\n     * @param {string} [options.label]\n     *        Label to identify the text track\n     *\n     * @param {string} [options.language]\n     *        Two letter language abbreviation.\n     *\n     * @param {boolean} [options.default]\n     *        Default this track to on.\n     *\n     * @param {string} [options.id]\n     *        The internal id to assign this track.\n     *\n     * @param {string} [options.src]\n     *        A source url for the track.\n     *\n     * @return {HTMLTrackElement}\n     *         The track element that gets created.\n     */\n\n\n    Html5.prototype.createRemoteTextTrack = function createRemoteTextTrack(options) {\n      if (!this.featuresNativeTextTracks) {\n        return _Tech.prototype.createRemoteTextTrack.call(this, options);\n      }\n      var htmlTrackElement = document_1.createElement('track');\n\n      if (options.kind) {\n        htmlTrackElement.kind = options.kind;\n      }\n      if (options.label) {\n        htmlTrackElement.label = options.label;\n      }\n      if (options.language || options.srclang) {\n        htmlTrackElement.srclang = options.language || options.srclang;\n      }\n      if (options.default) {\n        htmlTrackElement.default = options.default;\n      }\n      if (options.id) {\n        htmlTrackElement.id = options.id;\n      }\n      if (options.src) {\n        htmlTrackElement.src = options.src;\n      }\n\n      return htmlTrackElement;\n    };\n\n    /**\n     * Creates a remote text track object and returns an html track element.\n     *\n     * @param {Object} options The object should contain values for\n     * kind, language, label, and src (location of the WebVTT file)\n     * @param {Boolean} [manualCleanup=true] if set to false, the TextTrack will be\n     * automatically removed from the video element whenever the source changes\n     * @return {HTMLTrackElement} An Html Track Element.\n     * This can be an emulated {@link HTMLTrackElement} or a native one.\n     * @deprecated The default value of the \"manualCleanup\" parameter will default\n     * to \"false\" in upcoming versions of Video.js\n     */\n\n\n    Html5.prototype.addRemoteTextTrack = function addRemoteTextTrack(options, manualCleanup) {\n      var htmlTrackElement = _Tech.prototype.addRemoteTextTrack.call(this, options, manualCleanup);\n\n      if (this.featuresNativeTextTracks) {\n        this.el().appendChild(htmlTrackElement);\n      }\n\n      return htmlTrackElement;\n    };\n\n    /**\n     * Remove remote `TextTrack` from `TextTrackList` object\n     *\n     * @param {TextTrack} track\n     *        `TextTrack` object to remove\n     */\n\n\n    Html5.prototype.removeRemoteTextTrack = function removeRemoteTextTrack(track) {\n      _Tech.prototype.removeRemoteTextTrack.call(this, track);\n\n      if (this.featuresNativeTextTracks) {\n        var tracks = this.$$('track');\n\n        var i = tracks.length;\n\n        while (i--) {\n          if (track === tracks[i] || track === tracks[i].track) {\n            this.el().removeChild(tracks[i]);\n          }\n        }\n      }\n    };\n\n    /**\n     * Gets available media playback quality metrics as specified by the W3C's Media\n     * Playback Quality API.\n     *\n     * @see [Spec]{@link https://wicg.github.io/media-playback-quality}\n     *\n     * @return {Object}\n     *         An object with supported media playback quality metrics\n     */\n\n\n    Html5.prototype.getVideoPlaybackQuality = function getVideoPlaybackQuality() {\n      if (typeof this.el().getVideoPlaybackQuality === 'function') {\n        return this.el().getVideoPlaybackQuality();\n      }\n\n      var videoPlaybackQuality = {};\n\n      if (typeof this.el().webkitDroppedFrameCount !== 'undefined' && typeof this.el().webkitDecodedFrameCount !== 'undefined') {\n        videoPlaybackQuality.droppedVideoFrames = this.el().webkitDroppedFrameCount;\n        videoPlaybackQuality.totalVideoFrames = this.el().webkitDecodedFrameCount;\n      }\n\n      if (window_1.performance && typeof window_1.performance.now === 'function') {\n        videoPlaybackQuality.creationTime = window_1.performance.now();\n      } else if (window_1.performance && window_1.performance.timing && typeof window_1.performance.timing.navigationStart === 'number') {\n        videoPlaybackQuality.creationTime = window_1.Date.now() - window_1.performance.timing.navigationStart;\n      }\n\n      return videoPlaybackQuality;\n    };\n\n    return Html5;\n  }(Tech);\n\n  /* HTML5 Support Testing ---------------------------------------------------- */\n\n  if (isReal()) {\n\n    /**\n     * Element for testing browser HTML5 media capabilities\n     *\n     * @type {Element}\n     * @constant\n     * @private\n     */\n    Html5.TEST_VID = document_1.createElement('video');\n    var track = document_1.createElement('track');\n\n    track.kind = 'captions';\n    track.srclang = 'en';\n    track.label = 'English';\n    Html5.TEST_VID.appendChild(track);\n  }\n\n  /**\n   * Check if HTML5 media is supported by this browser/device.\n   *\n   * @return {boolean}\n   *         - True if HTML5 media is supported.\n   *         - False if HTML5 media is not supported.\n   */\n  Html5.isSupported = function () {\n    // IE with no Media Player is a LIAR! (#984)\n    try {\n      Html5.TEST_VID.volume = 0.5;\n    } catch (e) {\n      return false;\n    }\n\n    return !!(Html5.TEST_VID && Html5.TEST_VID.canPlayType);\n  };\n\n  /**\n   * Check if the tech can support the given type\n   *\n   * @param {string} type\n   *        The mimetype to check\n   * @return {string} 'probably', 'maybe', or '' (empty string)\n   */\n  Html5.canPlayType = function (type) {\n    return Html5.TEST_VID.canPlayType(type);\n  };\n\n  /**\n   * Check if the tech can support the given source\n   * @param {Object} srcObj\n   *        The source object\n   * @param {Object} options\n   *        The options passed to the tech\n   * @return {string} 'probably', 'maybe', or '' (empty string)\n   */\n  Html5.canPlaySource = function (srcObj, options) {\n    return Html5.canPlayType(srcObj.type);\n  };\n\n  /**\n   * Check if the volume can be changed in this browser/device.\n   * Volume cannot be changed in a lot of mobile devices.\n   * Specifically, it can't be changed from 1 on iOS.\n   *\n   * @return {boolean}\n   *         - True if volume can be controlled\n   *         - False otherwise\n   */\n  Html5.canControlVolume = function () {\n    // IE will error if Windows Media Player not installed #3315\n    try {\n      var volume = Html5.TEST_VID.volume;\n\n      Html5.TEST_VID.volume = volume / 2 + 0.1;\n      return volume !== Html5.TEST_VID.volume;\n    } catch (e) {\n      return false;\n    }\n  };\n\n  /**\n   * Check if the playback rate can be changed in this browser/device.\n   *\n   * @return {boolean}\n   *         - True if playback rate can be controlled\n   *         - False otherwise\n   */\n  Html5.canControlPlaybackRate = function () {\n    // Playback rate API is implemented in Android Chrome, but doesn't do anything\n    // https://github.com/videojs/video.js/issues/3180\n    if (IS_ANDROID && IS_CHROME && CHROME_VERSION < 58) {\n      return false;\n    }\n    // IE will error if Windows Media Player not installed #3315\n    try {\n      var playbackRate = Html5.TEST_VID.playbackRate;\n\n      Html5.TEST_VID.playbackRate = playbackRate / 2 + 0.1;\n      return playbackRate !== Html5.TEST_VID.playbackRate;\n    } catch (e) {\n      return false;\n    }\n  };\n\n  /**\n   * Check if we can override a video/audio elements attributes, with\n   * Object.defineProperty.\n   *\n   * @return {boolean}\n   *         - True if builtin attributes can be overridden\n   *         - False otherwise\n   */\n  Html5.canOverrideAttributes = function () {\n    // if we cannot overwrite the src/innerHTML property, there is no support\n    // iOS 7 safari for instance cannot do this.\n    try {\n      var noop = function noop() {};\n\n      Object.defineProperty(document_1.createElement('video'), 'src', { get: noop, set: noop });\n      Object.defineProperty(document_1.createElement('audio'), 'src', { get: noop, set: noop });\n      Object.defineProperty(document_1.createElement('video'), 'innerHTML', { get: noop, set: noop });\n      Object.defineProperty(document_1.createElement('audio'), 'innerHTML', { get: noop, set: noop });\n    } catch (e) {\n      return false;\n    }\n\n    return true;\n  };\n\n  /**\n   * Check to see if native `TextTrack`s are supported by this browser/device.\n   *\n   * @return {boolean}\n   *         - True if native `TextTrack`s are supported.\n   *         - False otherwise\n   */\n  Html5.supportsNativeTextTracks = function () {\n    return IS_ANY_SAFARI;\n  };\n\n  /**\n   * Check to see if native `VideoTrack`s are supported by this browser/device\n   *\n   * @return {boolean}\n   *        - True if native `VideoTrack`s are supported.\n   *        - False otherwise\n   */\n  Html5.supportsNativeVideoTracks = function () {\n    return !!(Html5.TEST_VID && Html5.TEST_VID.videoTracks);\n  };\n\n  /**\n   * Check to see if native `AudioTrack`s are supported by this browser/device\n   *\n   * @return {boolean}\n   *        - True if native `AudioTrack`s are supported.\n   *        - False otherwise\n   */\n  Html5.supportsNativeAudioTracks = function () {\n    return !!(Html5.TEST_VID && Html5.TEST_VID.audioTracks);\n  };\n\n  /**\n   * An array of events available on the Html5 tech.\n   *\n   * @private\n   * @type {Array}\n   */\n  Html5.Events = ['loadstart', 'suspend', 'abort', 'error', 'emptied', 'stalled', 'loadedmetadata', 'loadeddata', 'canplay', 'canplaythrough', 'playing', 'waiting', 'seeking', 'seeked', 'ended', 'durationchange', 'timeupdate', 'progress', 'play', 'pause', 'ratechange', 'resize', 'volumechange'];\n\n  /**\n   * Boolean indicating whether the `Tech` supports volume control.\n   *\n   * @type {boolean}\n   * @default {@link Html5.canControlVolume}\n   */\n  Html5.prototype.featuresVolumeControl = Html5.canControlVolume();\n\n  /**\n   * Boolean indicating whether the `Tech` supports changing the speed at which the media\n   * plays. Examples:\n   *   - Set player to play 2x (twice) as fast\n   *   - Set player to play 0.5x (half) as fast\n   *\n   * @type {boolean}\n   * @default {@link Html5.canControlPlaybackRate}\n   */\n  Html5.prototype.featuresPlaybackRate = Html5.canControlPlaybackRate();\n\n  /**\n   * Boolean indicating whether the `Tech` supports the `sourceset` event.\n   *\n   * @type {boolean}\n   * @default\n   */\n  Html5.prototype.featuresSourceset = Html5.canOverrideAttributes();\n\n  /**\n   * Boolean indicating whether the `HTML5` tech currently supports the media element\n   * moving in the DOM. iOS breaks if you move the media element, so this is set this to\n   * false there. Everywhere else this should be true.\n   *\n   * @type {boolean}\n   * @default\n   */\n  Html5.prototype.movingMediaElementInDOM = !IS_IOS;\n\n  // TODO: Previous comment: No longer appears to be used. Can probably be removed.\n  //       Is this true?\n  /**\n   * Boolean indicating whether the `HTML5` tech currently supports automatic media resize\n   * when going into fullscreen.\n   *\n   * @type {boolean}\n   * @default\n   */\n  Html5.prototype.featuresFullscreenResize = true;\n\n  /**\n   * Boolean indicating whether the `HTML5` tech currently supports the progress event.\n   * If this is false, manual `progress` events will be triggered instead.\n   *\n   * @type {boolean}\n   * @default\n   */\n  Html5.prototype.featuresProgressEvents = true;\n\n  /**\n   * Boolean indicating whether the `HTML5` tech currently supports the timeupdate event.\n   * If this is false, manual `timeupdate` events will be triggered instead.\n   *\n   * @default\n   */\n  Html5.prototype.featuresTimeupdateEvents = true;\n\n  /**\n   * Boolean indicating whether the `HTML5` tech currently supports native `TextTrack`s.\n   *\n   * @type {boolean}\n   * @default {@link Html5.supportsNativeTextTracks}\n   */\n  Html5.prototype.featuresNativeTextTracks = Html5.supportsNativeTextTracks();\n\n  /**\n   * Boolean indicating whether the `HTML5` tech currently supports native `VideoTrack`s.\n   *\n   * @type {boolean}\n   * @default {@link Html5.supportsNativeVideoTracks}\n   */\n  Html5.prototype.featuresNativeVideoTracks = Html5.supportsNativeVideoTracks();\n\n  /**\n   * Boolean indicating whether the `HTML5` tech currently supports native `AudioTrack`s.\n   *\n   * @type {boolean}\n   * @default {@link Html5.supportsNativeAudioTracks}\n   */\n  Html5.prototype.featuresNativeAudioTracks = Html5.supportsNativeAudioTracks();\n\n  // HTML5 Feature detection and Device Fixes --------------------------------- //\n  var canPlayType = Html5.TEST_VID && Html5.TEST_VID.constructor.prototype.canPlayType;\n  var mpegurlRE = /^application\\/(?:x-|vnd\\.apple\\.)mpegurl/i;\n\n  Html5.patchCanPlayType = function () {\n\n    // Android 4.0 and above can play HLS to some extent but it reports being unable to do so\n    // Firefox and Chrome report correctly\n    if (ANDROID_VERSION >= 4.0 && !IS_FIREFOX && !IS_CHROME) {\n      Html5.TEST_VID.constructor.prototype.canPlayType = function (type) {\n        if (type && mpegurlRE.test(type)) {\n          return 'maybe';\n        }\n        return canPlayType.call(this, type);\n      };\n    }\n  };\n\n  Html5.unpatchCanPlayType = function () {\n    var r = Html5.TEST_VID.constructor.prototype.canPlayType;\n\n    Html5.TEST_VID.constructor.prototype.canPlayType = canPlayType;\n    return r;\n  };\n\n  // by default, patch the media element\n  Html5.patchCanPlayType();\n\n  Html5.disposeMediaElement = function (el) {\n    if (!el) {\n      return;\n    }\n\n    if (el.parentNode) {\n      el.parentNode.removeChild(el);\n    }\n\n    // remove any child track or source nodes to prevent their loading\n    while (el.hasChildNodes()) {\n      el.removeChild(el.firstChild);\n    }\n\n    // remove any src reference. not setting `src=''` because that causes a warning\n    // in firefox\n    el.removeAttribute('src');\n\n    // force the media element to update its loading state by calling load()\n    // however IE on Windows 7N has a bug that throws an error so need a try/catch (#793)\n    if (typeof el.load === 'function') {\n      // wrapping in an iife so it's not deoptimized (#1060#discussion_r10324473)\n      (function () {\n        try {\n          el.load();\n        } catch (e) {\n          // not supported\n        }\n      })();\n    }\n  };\n\n  Html5.resetMediaElement = function (el) {\n    if (!el) {\n      return;\n    }\n\n    var sources = el.querySelectorAll('source');\n    var i = sources.length;\n\n    while (i--) {\n      el.removeChild(sources[i]);\n    }\n\n    // remove any src reference.\n    // not setting `src=''` because that throws an error\n    el.removeAttribute('src');\n\n    if (typeof el.load === 'function') {\n      // wrapping in an iife so it's not deoptimized (#1060#discussion_r10324473)\n      (function () {\n        try {\n          el.load();\n        } catch (e) {\n          // satisfy linter\n        }\n      })();\n    }\n  };\n\n  /* Native HTML5 element property wrapping ----------------------------------- */\n  // Wrap native boolean attributes with getters that check both property and attribute\n  // The list is as followed:\n  // muted, defaultMuted, autoplay, controls, loop, playsinline\n  [\n  /**\n   * Get the value of `muted` from the media element. `muted` indicates\n   * that the volume for the media should be set to silent. This does not actually change\n   * the `volume` attribute.\n   *\n   * @method Html5#muted\n   * @return {boolean}\n   *         - True if the value of `volume` should be ignored and the audio set to silent.\n   *         - False if the value of `volume` should be used.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-muted}\n   */\n  'muted',\n\n  /**\n   * Get the value of `defaultMuted` from the media element. `defaultMuted` indicates\n   * whether the media should start muted or not. Only changes the default state of the\n   * media. `muted` and `defaultMuted` can have different values. {@link Html5#muted} indicates the\n   * current state.\n   *\n   * @method Html5#defaultMuted\n   * @return {boolean}\n   *         - The value of `defaultMuted` from the media element.\n   *         - True indicates that the media should start muted.\n   *         - False indicates that the media should not start muted\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-defaultmuted}\n   */\n  'defaultMuted',\n\n  /**\n   * Get the value of `autoplay` from the media element. `autoplay` indicates\n   * that the media should start to play as soon as the page is ready.\n   *\n   * @method Html5#autoplay\n   * @return {boolean}\n   *         - The value of `autoplay` from the media element.\n   *         - True indicates that the media should start as soon as the page loads.\n   *         - False indicates that the media should not start as soon as the page loads.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#attr-media-autoplay}\n   */\n  'autoplay',\n\n  /**\n   * Get the value of `controls` from the media element. `controls` indicates\n   * whether the native media controls should be shown or hidden.\n   *\n   * @method Html5#controls\n   * @return {boolean}\n   *         - The value of `controls` from the media element.\n   *         - True indicates that native controls should be showing.\n   *         - False indicates that native controls should be hidden.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#attr-media-controls}\n   */\n  'controls',\n\n  /**\n   * Get the value of `loop` from the media element. `loop` indicates\n   * that the media should return to the start of the media and continue playing once\n   * it reaches the end.\n   *\n   * @method Html5#loop\n   * @return {boolean}\n   *         - The value of `loop` from the media element.\n   *         - True indicates that playback should seek back to start once\n   *           the end of a media is reached.\n   *         - False indicates that playback should not loop back to the start when the\n   *           end of the media is reached.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#attr-media-loop}\n   */\n  'loop',\n\n  /**\n   * Get the value of `playsinline` from the media element. `playsinline` indicates\n   * to the browser that non-fullscreen playback is preferred when fullscreen\n   * playback is the native default, such as in iOS Safari.\n   *\n   * @method Html5#playsinline\n   * @return {boolean}\n   *         - The value of `playsinline` from the media element.\n   *         - True indicates that the media should play inline.\n   *         - False indicates that the media should not play inline.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/#attr-video-playsinline}\n   */\n  'playsinline'].forEach(function (prop) {\n    Html5.prototype[prop] = function () {\n      return this.el_[prop] || this.el_.hasAttribute(prop);\n    };\n  });\n\n  // Wrap native boolean attributes with setters that set both property and attribute\n  // The list is as followed:\n  // setMuted, setDefaultMuted, setAutoplay, setLoop, setPlaysinline\n  // setControls is special-cased above\n  [\n  /**\n   * Set the value of `muted` on the media element. `muted` indicates that the current\n   * audio level should be silent.\n   *\n   * @method Html5#setMuted\n   * @param {boolean} muted\n   *        - True if the audio should be set to silent\n   *        - False otherwise\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-muted}\n   */\n  'muted',\n\n  /**\n   * Set the value of `defaultMuted` on the media element. `defaultMuted` indicates that the current\n   * audio level should be silent, but will only effect the muted level on intial playback..\n   *\n   * @method Html5.prototype.setDefaultMuted\n   * @param {boolean} defaultMuted\n   *        - True if the audio should be set to silent\n   *        - False otherwise\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-defaultmuted}\n   */\n  'defaultMuted',\n\n  /**\n   * Set the value of `autoplay` on the media element. `autoplay` indicates\n   * that the media should start to play as soon as the page is ready.\n   *\n   * @method Html5#setAutoplay\n   * @param {boolean} autoplay\n   *         - True indicates that the media should start as soon as the page loads.\n   *         - False indicates that the media should not start as soon as the page loads.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#attr-media-autoplay}\n   */\n  'autoplay',\n\n  /**\n   * Set the value of `loop` on the media element. `loop` indicates\n   * that the media should return to the start of the media and continue playing once\n   * it reaches the end.\n   *\n   * @method Html5#setLoop\n   * @param {boolean} loop\n   *         - True indicates that playback should seek back to start once\n   *           the end of a media is reached.\n   *         - False indicates that playback should not loop back to the start when the\n   *           end of the media is reached.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#attr-media-loop}\n   */\n  'loop',\n\n  /**\n   * Set the value of `playsinline` from the media element. `playsinline` indicates\n   * to the browser that non-fullscreen playback is preferred when fullscreen\n   * playback is the native default, such as in iOS Safari.\n   *\n   * @method Html5#setPlaysinline\n   * @param {boolean} playsinline\n   *         - True indicates that the media should play inline.\n   *         - False indicates that the media should not play inline.\n   *\n   * @see [Spec]{@link https://html.spec.whatwg.org/#attr-video-playsinline}\n   */\n  'playsinline'].forEach(function (prop) {\n    Html5.prototype['set' + toTitleCase(prop)] = function (v) {\n      this.el_[prop] = v;\n\n      if (v) {\n        this.el_.setAttribute(prop, prop);\n      } else {\n        this.el_.removeAttribute(prop);\n      }\n    };\n  });\n\n  // Wrap native properties with a getter\n  // The list is as followed\n  // paused, currentTime, buffered, volume, poster, preload, error, seeking\n  // seekable, ended, playbackRate, defaultPlaybackRate, played, networkState\n  // readyState, videoWidth, videoHeight\n  [\n  /**\n   * Get the value of `paused` from the media element. `paused` indicates whether the media element\n   * is currently paused or not.\n   *\n   * @method Html5#paused\n   * @return {boolean}\n   *         The value of `paused` from the media element.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-paused}\n   */\n  'paused',\n\n  /**\n   * Get the value of `currentTime` from the media element. `currentTime` indicates\n   * the current second that the media is at in playback.\n   *\n   * @method Html5#currentTime\n   * @return {number}\n   *         The value of `currentTime` from the media element.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-currenttime}\n   */\n  'currentTime',\n\n  /**\n   * Get the value of `buffered` from the media element. `buffered` is a `TimeRange`\n   * object that represents the parts of the media that are already downloaded and\n   * available for playback.\n   *\n   * @method Html5#buffered\n   * @return {TimeRange}\n   *         The value of `buffered` from the media element.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-buffered}\n   */\n  'buffered',\n\n  /**\n   * Get the value of `volume` from the media element. `volume` indicates\n   * the current playback volume of audio for a media. `volume` will be a value from 0\n   * (silent) to 1 (loudest and default).\n   *\n   * @method Html5#volume\n   * @return {number}\n   *         The value of `volume` from the media element. Value will be between 0-1.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-a-volume}\n   */\n  'volume',\n\n  /**\n   * Get the value of `poster` from the media element. `poster` indicates\n   * that the url of an image file that can/will be shown when no media data is available.\n   *\n   * @method Html5#poster\n   * @return {string}\n   *         The value of `poster` from the media element. Value will be a url to an\n   *         image.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#attr-video-poster}\n   */\n  'poster',\n\n  /**\n   * Get the value of `preload` from the media element. `preload` indicates\n   * what should download before the media is interacted with. It can have the following\n   * values:\n   * - none: nothing should be downloaded\n   * - metadata: poster and the first few frames of the media may be downloaded to get\n   *   media dimensions and other metadata\n   * - auto: allow the media and metadata for the media to be downloaded before\n   *    interaction\n   *\n   * @method Html5#preload\n   * @return {string}\n   *         The value of `preload` from the media element. Will be 'none', 'metadata',\n   *         or 'auto'.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#attr-media-preload}\n   */\n  'preload',\n\n  /**\n   * Get the value of the `error` from the media element. `error` indicates any\n   * MediaError that may have occurred during playback. If error returns null there is no\n   * current error.\n   *\n   * @method Html5#error\n   * @return {MediaError|null}\n   *         The value of `error` from the media element. Will be `MediaError` if there\n   *         is a current error and null otherwise.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-error}\n   */\n  'error',\n\n  /**\n   * Get the value of `seeking` from the media element. `seeking` indicates whether the\n   * media is currently seeking to a new position or not.\n   *\n   * @method Html5#seeking\n   * @return {boolean}\n   *         - The value of `seeking` from the media element.\n   *         - True indicates that the media is currently seeking to a new position.\n   *         - False indicates that the media is not seeking to a new position at this time.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-seeking}\n   */\n  'seeking',\n\n  /**\n   * Get the value of `seekable` from the media element. `seekable` returns a\n   * `TimeRange` object indicating ranges of time that can currently be `seeked` to.\n   *\n   * @method Html5#seekable\n   * @return {TimeRange}\n   *         The value of `seekable` from the media element. A `TimeRange` object\n   *         indicating the current ranges of time that can be seeked to.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-seekable}\n   */\n  'seekable',\n\n  /**\n   * Get the value of `ended` from the media element. `ended` indicates whether\n   * the media has reached the end or not.\n   *\n   * @method Html5#ended\n   * @return {boolean}\n   *         - The value of `ended` from the media element.\n   *         - True indicates that the media has ended.\n   *         - False indicates that the media has not ended.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-ended}\n   */\n  'ended',\n\n  /**\n   * Get the value of `playbackRate` from the media element. `playbackRate` indicates\n   * the rate at which the media is currently playing back. Examples:\n   *   - if playbackRate is set to 2, media will play twice as fast.\n   *   - if playbackRate is set to 0.5, media will play half as fast.\n   *\n   * @method Html5#playbackRate\n   * @return {number}\n   *         The value of `playbackRate` from the media element. A number indicating\n   *         the current playback speed of the media, where 1 is normal speed.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-playbackrate}\n   */\n  'playbackRate',\n\n  /**\n   * Get the value of `defaultPlaybackRate` from the media element. `defaultPlaybackRate` indicates\n   * the rate at which the media is currently playing back. This value will not indicate the current\n   * `playbackRate` after playback has started, use {@link Html5#playbackRate} for that.\n   *\n   * Examples:\n   *   - if defaultPlaybackRate is set to 2, media will play twice as fast.\n   *   - if defaultPlaybackRate is set to 0.5, media will play half as fast.\n   *\n   * @method Html5.prototype.defaultPlaybackRate\n   * @return {number}\n   *         The value of `defaultPlaybackRate` from the media element. A number indicating\n   *         the current playback speed of the media, where 1 is normal speed.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-playbackrate}\n   */\n  'defaultPlaybackRate',\n\n  /**\n   * Get the value of `played` from the media element. `played` returns a `TimeRange`\n   * object representing points in the media timeline that have been played.\n   *\n   * @method Html5#played\n   * @return {TimeRange}\n   *         The value of `played` from the media element. A `TimeRange` object indicating\n   *         the ranges of time that have been played.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-played}\n   */\n  'played',\n\n  /**\n   * Get the value of `networkState` from the media element. `networkState` indicates\n   * the current network state. It returns an enumeration from the following list:\n   * - 0: NETWORK_EMPTY\n   * - 1: NETWORK_IDLE\n   * - 2: NETWORK_LOADING\n   * - 3: NETWORK_NO_SOURCE\n   *\n   * @method Html5#networkState\n   * @return {number}\n   *         The value of `networkState` from the media element. This will be a number\n   *         from the list in the description.\n   *\n   * @see [Spec] {@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-networkstate}\n   */\n  'networkState',\n\n  /**\n   * Get the value of `readyState` from the media element. `readyState` indicates\n   * the current state of the media element. It returns an enumeration from the\n   * following list:\n   * - 0: HAVE_NOTHING\n   * - 1: HAVE_METADATA\n   * - 2: HAVE_CURRENT_DATA\n   * - 3: HAVE_FUTURE_DATA\n   * - 4: HAVE_ENOUGH_DATA\n   *\n   * @method Html5#readyState\n   * @return {number}\n   *         The value of `readyState` from the media element. This will be a number\n   *         from the list in the description.\n   *\n   * @see [Spec] {@link https://www.w3.org/TR/html5/embedded-content-0.html#ready-states}\n   */\n  'readyState',\n\n  /**\n   * Get the value of `videoWidth` from the video element. `videoWidth` indicates\n   * the current width of the video in css pixels.\n   *\n   * @method Html5#videoWidth\n   * @return {number}\n   *         The value of `videoWidth` from the video element. This will be a number\n   *         in css pixels.\n   *\n   * @see [Spec] {@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-video-videowidth}\n   */\n  'videoWidth',\n\n  /**\n   * Get the value of `videoHeight` from the video element. `videoHeight` indicates\n   * the current height of the video in css pixels.\n   *\n   * @method Html5#videoHeight\n   * @return {number}\n   *         The value of `videoHeight` from the video element. This will be a number\n   *         in css pixels.\n   *\n   * @see [Spec] {@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-video-videowidth}\n   */\n  'videoHeight'].forEach(function (prop) {\n    Html5.prototype[prop] = function () {\n      return this.el_[prop];\n    };\n  });\n\n  // Wrap native properties with a setter in this format:\n  // set + toTitleCase(name)\n  // The list is as follows:\n  // setVolume, setSrc, setPoster, setPreload, setPlaybackRate, setDefaultPlaybackRate\n  [\n  /**\n   * Set the value of `volume` on the media element. `volume` indicates the current\n   * audio level as a percentage in decimal form. This means that 1 is 100%, 0.5 is 50%, and\n   * so on.\n   *\n   * @method Html5#setVolume\n   * @param {number} percentAsDecimal\n   *        The volume percent as a decimal. Valid range is from 0-1.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-a-volume}\n   */\n  'volume',\n\n  /**\n   * Set the value of `src` on the media element. `src` indicates the current\n   * {@link Tech~SourceObject} for the media.\n   *\n   * @method Html5#setSrc\n   * @param {Tech~SourceObject} src\n   *        The source object to set as the current source.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-src}\n   */\n  'src',\n\n  /**\n   * Set the value of `poster` on the media element. `poster` is the url to\n   * an image file that can/will be shown when no media data is available.\n   *\n   * @method Html5#setPoster\n   * @param {string} poster\n   *        The url to an image that should be used as the `poster` for the media\n   *        element.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#attr-media-poster}\n   */\n  'poster',\n\n  /**\n   * Set the value of `preload` on the media element. `preload` indicates\n   * what should download before the media is interacted with. It can have the following\n   * values:\n   * - none: nothing should be downloaded\n   * - metadata: poster and the first few frames of the media may be downloaded to get\n   *   media dimensions and other metadata\n   * - auto: allow the media and metadata for the media to be downloaded before\n   *    interaction\n   *\n   * @method Html5#setPreload\n   * @param {string} preload\n   *         The value of `preload` to set on the media element. Must be 'none', 'metadata',\n   *         or 'auto'.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#attr-media-preload}\n   */\n  'preload',\n\n  /**\n   * Set the value of `playbackRate` on the media element. `playbackRate` indicates\n   * the rate at which the media should play back. Examples:\n   *   - if playbackRate is set to 2, media will play twice as fast.\n   *   - if playbackRate is set to 0.5, media will play half as fast.\n   *\n   * @method Html5#setPlaybackRate\n   * @return {number}\n   *         The value of `playbackRate` from the media element. A number indicating\n   *         the current playback speed of the media, where 1 is normal speed.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-playbackrate}\n   */\n  'playbackRate',\n\n  /**\n   * Set the value of `defaultPlaybackRate` on the media element. `defaultPlaybackRate` indicates\n   * the rate at which the media should play back upon initial startup. Changing this value\n   * after a video has started will do nothing. Instead you should used {@link Html5#setPlaybackRate}.\n   *\n   * Example Values:\n   *   - if playbackRate is set to 2, media will play twice as fast.\n   *   - if playbackRate is set to 0.5, media will play half as fast.\n   *\n   * @method Html5.prototype.setDefaultPlaybackRate\n   * @return {number}\n   *         The value of `defaultPlaybackRate` from the media element. A number indicating\n   *         the current playback speed of the media, where 1 is normal speed.\n   *\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-defaultplaybackrate}\n   */\n  'defaultPlaybackRate'].forEach(function (prop) {\n    Html5.prototype['set' + toTitleCase(prop)] = function (v) {\n      this.el_[prop] = v;\n    };\n  });\n\n  // wrap native functions with a function\n  // The list is as follows:\n  // pause, load, play\n  [\n  /**\n   * A wrapper around the media elements `pause` function. This will call the `HTML5`\n   * media elements `pause` function.\n   *\n   * @method Html5#pause\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-pause}\n   */\n  'pause',\n\n  /**\n   * A wrapper around the media elements `load` function. This will call the `HTML5`s\n   * media element `load` function.\n   *\n   * @method Html5#load\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-load}\n   */\n  'load',\n\n  /**\n   * A wrapper around the media elements `play` function. This will call the `HTML5`s\n   * media element `play` function.\n   *\n   * @method Html5#play\n   * @see [Spec]{@link https://www.w3.org/TR/html5/embedded-content-0.html#dom-media-play}\n   */\n  'play'].forEach(function (prop) {\n    Html5.prototype[prop] = function () {\n      return this.el_[prop]();\n    };\n  });\n\n  Tech.withSourceHandlers(Html5);\n\n  /**\n   * Native source handler for Html5, simply passes the source to the media element.\n   *\n   * @property {Tech~SourceObject} source\n   *        The source object\n   *\n   * @property {Html5} tech\n   *        The instance of the HTML5 tech.\n   */\n  Html5.nativeSourceHandler = {};\n\n  /**\n   * Check if the media element can play the given mime type.\n   *\n   * @param {string} type\n   *        The mimetype to check\n   *\n   * @return {string}\n   *         'probably', 'maybe', or '' (empty string)\n   */\n  Html5.nativeSourceHandler.canPlayType = function (type) {\n    // IE without MediaPlayer throws an error (#519)\n    try {\n      return Html5.TEST_VID.canPlayType(type);\n    } catch (e) {\n      return '';\n    }\n  };\n\n  /**\n   * Check if the media element can handle a source natively.\n   *\n   * @param {Tech~SourceObject} source\n   *         The source object\n   *\n   * @param {Object} [options]\n   *         Options to be passed to the tech.\n   *\n   * @return {string}\n   *         'probably', 'maybe', or '' (empty string).\n   */\n  Html5.nativeSourceHandler.canHandleSource = function (source, options) {\n\n    // If a type was provided we should rely on that\n    if (source.type) {\n      return Html5.nativeSourceHandler.canPlayType(source.type);\n\n      // If no type, fall back to checking 'video/[EXTENSION]'\n    } else if (source.src) {\n      var ext = getFileExtension(source.src);\n\n      return Html5.nativeSourceHandler.canPlayType('video/' + ext);\n    }\n\n    return '';\n  };\n\n  /**\n   * Pass the source to the native media element.\n   *\n   * @param {Tech~SourceObject} source\n   *        The source object\n   *\n   * @param {Html5} tech\n   *        The instance of the Html5 tech\n   *\n   * @param {Object} [options]\n   *        The options to pass to the source\n   */\n  Html5.nativeSourceHandler.handleSource = function (source, tech, options) {\n    tech.setSrc(source.src);\n  };\n\n  /**\n   * A noop for the native dispose function, as cleanup is not needed.\n   */\n  Html5.nativeSourceHandler.dispose = function () {};\n\n  // Register the native source handler\n  Html5.registerSourceHandler(Html5.nativeSourceHandler);\n\n  Tech.registerTech('Html5', Html5);\n\n  var _templateObject$2 = taggedTemplateLiteralLoose(['\\n        Using the tech directly can be dangerous. I hope you know what you\\'re doing.\\n        See https://github.com/videojs/video.js/issues/2617 for more info.\\n      '], ['\\n        Using the tech directly can be dangerous. I hope you know what you\\'re doing.\\n        See https://github.com/videojs/video.js/issues/2617 for more info.\\n      ']);\n\n  // The following tech events are simply re-triggered\n  // on the player when they happen\n  var TECH_EVENTS_RETRIGGER = [\n  /**\n   * Fired while the user agent is downloading media data.\n   *\n   * @event Player#progress\n   * @type {EventTarget~Event}\n   */\n  /**\n   * Retrigger the `progress` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechProgress_\n   * @fires Player#progress\n   * @listens Tech#progress\n   */\n  'progress',\n\n  /**\n   * Fires when the loading of an audio/video is aborted.\n   *\n   * @event Player#abort\n   * @type {EventTarget~Event}\n   */\n  /**\n   * Retrigger the `abort` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechAbort_\n   * @fires Player#abort\n   * @listens Tech#abort\n   */\n  'abort',\n\n  /**\n   * Fires when the browser is intentionally not getting media data.\n   *\n   * @event Player#suspend\n   * @type {EventTarget~Event}\n   */\n  /**\n   * Retrigger the `suspend` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechSuspend_\n   * @fires Player#suspend\n   * @listens Tech#suspend\n   */\n  'suspend',\n\n  /**\n   * Fires when the current playlist is empty.\n   *\n   * @event Player#emptied\n   * @type {EventTarget~Event}\n   */\n  /**\n   * Retrigger the `emptied` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechEmptied_\n   * @fires Player#emptied\n   * @listens Tech#emptied\n   */\n  'emptied',\n  /**\n   * Fires when the browser is trying to get media data, but data is not available.\n   *\n   * @event Player#stalled\n   * @type {EventTarget~Event}\n   */\n  /**\n   * Retrigger the `stalled` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechStalled_\n   * @fires Player#stalled\n   * @listens Tech#stalled\n   */\n  'stalled',\n\n  /**\n   * Fires when the browser has loaded meta data for the audio/video.\n   *\n   * @event Player#loadedmetadata\n   * @type {EventTarget~Event}\n   */\n  /**\n   * Retrigger the `stalled` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechLoadedmetadata_\n   * @fires Player#loadedmetadata\n   * @listens Tech#loadedmetadata\n   */\n  'loadedmetadata',\n\n  /**\n   * Fires when the browser has loaded the current frame of the audio/video.\n   *\n   * @event Player#loadeddata\n   * @type {event}\n   */\n  /**\n   * Retrigger the `loadeddata` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechLoaddeddata_\n   * @fires Player#loadeddata\n   * @listens Tech#loadeddata\n   */\n  'loadeddata',\n\n  /**\n   * Fires when the current playback position has changed.\n   *\n   * @event Player#timeupdate\n   * @type {event}\n   */\n  /**\n   * Retrigger the `timeupdate` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechTimeUpdate_\n   * @fires Player#timeupdate\n   * @listens Tech#timeupdate\n   */\n  'timeupdate',\n\n  /**\n   * Fires when the video's intrinsic dimensions change\n   *\n   * @event Player#resize\n   * @type {event}\n   */\n  /**\n   * Retrigger the `resize` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechResize_\n   * @fires Player#resize\n   * @listens Tech#resize\n   */\n  'resize',\n\n  /**\n   * Fires when the volume has been changed\n   *\n   * @event Player#volumechange\n   * @type {event}\n   */\n  /**\n   * Retrigger the `volumechange` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechVolumechange_\n   * @fires Player#volumechange\n   * @listens Tech#volumechange\n   */\n  'volumechange',\n\n  /**\n   * Fires when the text track has been changed\n   *\n   * @event Player#texttrackchange\n   * @type {event}\n   */\n  /**\n   * Retrigger the `texttrackchange` event that was triggered by the {@link Tech}.\n   *\n   * @private\n   * @method Player#handleTechTexttrackchange_\n   * @fires Player#texttrackchange\n   * @listens Tech#texttrackchange\n   */\n  'texttrackchange'];\n\n  // events to queue when playback rate is zero\n  // this is a hash for the sole purpose of mapping non-camel-cased event names\n  // to camel-cased function names\n  var TECH_EVENTS_QUEUE = {\n    canplay: 'CanPlay',\n    canplaythrough: 'CanPlayThrough',\n    playing: 'Playing',\n    seeked: 'Seeked'\n  };\n\n  /**\n   * An instance of the `Player` class is created when any of the Video.js setup methods\n   * are used to initialize a video.\n   *\n   * After an instance has been created it can be accessed globally in two ways:\n   * 1. By calling `videojs('example_video_1');`\n   * 2. By using it directly via  `videojs.players.example_video_1;`\n   *\n   * @extends Component\n   */\n\n  var Player = function (_Component) {\n    inherits(Player, _Component);\n\n    /**\n     * Create an instance of this class.\n     *\n     * @param {Element} tag\n     *        The original video DOM element used for configuring options.\n     *\n     * @param {Object} [options]\n     *        Object of option names and values.\n     *\n     * @param {Component~ReadyCallback} [ready]\n     *        Ready callback function.\n     */\n    function Player(tag, options, ready) {\n      classCallCheck(this, Player);\n\n      // Make sure tag ID exists\n      tag.id = tag.id || options.id || 'vjs_video_' + newGUID();\n\n      // Set Options\n      // The options argument overrides options set in the video tag\n      // which overrides globally set options.\n      // This latter part coincides with the load order\n      // (tag must exist before Player)\n      options = assign(Player.getTagSettings(tag), options);\n\n      // Delay the initialization of children because we need to set up\n      // player properties first, and can't use `this` before `super()`\n      options.initChildren = false;\n\n      // Same with creating the element\n      options.createEl = false;\n\n      // don't auto mixin the evented mixin\n      options.evented = false;\n\n      // we don't want the player to report touch activity on itself\n      // see enableTouchActivity in Component\n      options.reportTouchActivity = false;\n\n      // If language is not set, get the closest lang attribute\n      if (!options.language) {\n        if (typeof tag.closest === 'function') {\n          var closest = tag.closest('[lang]');\n\n          if (closest && closest.getAttribute) {\n            options.language = closest.getAttribute('lang');\n          }\n        } else {\n          var element = tag;\n\n          while (element && element.nodeType === 1) {\n            if (getAttributes(element).hasOwnProperty('lang')) {\n              options.language = element.getAttribute('lang');\n              break;\n            }\n            element = element.parentNode;\n          }\n        }\n      }\n\n      // Run base component initializing with new options\n\n      // Tracks when a tech changes the poster\n      var _this = possibleConstructorReturn(this, _Component.call(this, null, options, ready));\n\n      _this.isPosterFromTech_ = false;\n\n      // Holds callback info that gets queued when playback rate is zero\n      // and a seek is happening\n      _this.queuedCallbacks_ = [];\n\n      // Turn off API access because we're loading a new tech that might load asynchronously\n      _this.isReady_ = false;\n\n      // Init state hasStarted_\n      _this.hasStarted_ = false;\n\n      // Init state userActive_\n      _this.userActive_ = false;\n\n      // if the global option object was accidentally blown away by\n      // someone, bail early with an informative error\n      if (!_this.options_ || !_this.options_.techOrder || !_this.options_.techOrder.length) {\n        throw new Error('No techOrder specified. Did you overwrite ' + 'videojs.options instead of just changing the ' + 'properties you want to override?');\n      }\n\n      // Store the original tag used to set options\n      _this.tag = tag;\n\n      // Store the tag attributes used to restore html5 element\n      _this.tagAttributes = tag && getAttributes(tag);\n\n      // Update current language\n      _this.language(_this.options_.language);\n\n      // Update Supported Languages\n      if (options.languages) {\n        // Normalise player option languages to lowercase\n        var languagesToLower = {};\n\n        Object.getOwnPropertyNames(options.languages).forEach(function (name$$1) {\n          languagesToLower[name$$1.toLowerCase()] = options.languages[name$$1];\n        });\n        _this.languages_ = languagesToLower;\n      } else {\n        _this.languages_ = Player.prototype.options_.languages;\n      }\n\n      // Cache for video property values.\n      _this.cache_ = {};\n\n      // Set poster\n      _this.poster_ = options.poster || '';\n\n      // Set controls\n      _this.controls_ = !!options.controls;\n\n      // Set default values for lastVolume\n      _this.cache_.lastVolume = 1;\n\n      // Original tag settings stored in options\n      // now remove immediately so native controls don't flash.\n      // May be turned back on by HTML5 tech if nativeControlsForTouch is true\n      tag.controls = false;\n      tag.removeAttribute('controls');\n\n      /*\n       * Store the internal state of scrubbing\n       *\n       * @private\n       * @return {Boolean} True if the user is scrubbing\n       */\n      _this.scrubbing_ = false;\n\n      _this.el_ = _this.createEl();\n\n      // Set default value for lastPlaybackRate\n      _this.cache_.lastPlaybackRate = _this.defaultPlaybackRate();\n\n      // Make this an evented object and use `el_` as its event bus.\n      evented(_this, { eventBusKey: 'el_' });\n\n      // We also want to pass the original player options to each component and plugin\n      // as well so they don't need to reach back into the player for options later.\n      // We also need to do another copy of this.options_ so we don't end up with\n      // an infinite loop.\n      var playerOptionsCopy = mergeOptions(_this.options_);\n\n      // Load plugins\n      if (options.plugins) {\n        var plugins = options.plugins;\n\n        Object.keys(plugins).forEach(function (name$$1) {\n          if (typeof this[name$$1] === 'function') {\n            this[name$$1](plugins[name$$1]);\n          } else {\n            throw new Error('plugin \"' + name$$1 + '\" does not exist');\n          }\n        }, _this);\n      }\n\n      _this.options_.playerOptions = playerOptionsCopy;\n\n      _this.middleware_ = [];\n\n      _this.initChildren();\n\n      // Set isAudio based on whether or not an audio tag was used\n      _this.isAudio(tag.nodeName.toLowerCase() === 'audio');\n\n      // Update controls className. Can't do this when the controls are initially\n      // set because the element doesn't exist yet.\n      if (_this.controls()) {\n        _this.addClass('vjs-controls-enabled');\n      } else {\n        _this.addClass('vjs-controls-disabled');\n      }\n\n      // Set ARIA label and region role depending on player type\n      _this.el_.setAttribute('role', 'region');\n      if (_this.isAudio()) {\n        _this.el_.setAttribute('aria-label', _this.localize('Audio Player'));\n      } else {\n        _this.el_.setAttribute('aria-label', _this.localize('Video Player'));\n      }\n\n      if (_this.isAudio()) {\n        _this.addClass('vjs-audio');\n      }\n\n      if (_this.flexNotSupported_()) {\n        _this.addClass('vjs-no-flex');\n      }\n\n      // TODO: Make this smarter. Toggle user state between touching/mousing\n      // using events, since devices can have both touch and mouse events.\n      // if (browser.TOUCH_ENABLED) {\n      //   this.addClass('vjs-touch-enabled');\n      // }\n\n      // iOS Safari has broken hover handling\n      if (!IS_IOS) {\n        _this.addClass('vjs-workinghover');\n      }\n\n      // Make player easily findable by ID\n      Player.players[_this.id_] = _this;\n\n      // Add a major version class to aid css in plugins\n      var majorVersion = version.split('.')[0];\n\n      _this.addClass('vjs-v' + majorVersion);\n\n      // When the player is first initialized, trigger activity so components\n      // like the control bar show themselves if needed\n      _this.userActive(true);\n      _this.reportUserActivity();\n\n      _this.one('play', _this.listenForUserActivity_);\n      _this.on('fullscreenchange', _this.handleFullscreenChange_);\n      _this.on('stageclick', _this.handleStageClick_);\n\n      _this.changingSrc_ = false;\n      _this.playWaitingForReady_ = false;\n      _this.playOnLoadstart_ = null;\n      return _this;\n    }\n\n    /**\n     * Destroys the video player and does any necessary cleanup.\n     *\n     * This is especially helpful if you are dynamically adding and removing videos\n     * to/from the DOM.\n     *\n     * @fires Player#dispose\n     */\n\n\n    Player.prototype.dispose = function dispose() {\n      /**\n       * Called when the player is being disposed of.\n       *\n       * @event Player#dispose\n       * @type {EventTarget~Event}\n       */\n      this.trigger('dispose');\n      // prevent dispose from being called twice\n      this.off('dispose');\n\n      if (this.styleEl_ && this.styleEl_.parentNode) {\n        this.styleEl_.parentNode.removeChild(this.styleEl_);\n        this.styleEl_ = null;\n      }\n\n      // Kill reference to this player\n      Player.players[this.id_] = null;\n\n      if (this.tag && this.tag.player) {\n        this.tag.player = null;\n      }\n\n      if (this.el_ && this.el_.player) {\n        this.el_.player = null;\n      }\n\n      if (this.tech_) {\n        this.tech_.dispose();\n        this.isPosterFromTech_ = false;\n        this.poster_ = '';\n      }\n\n      if (this.playerElIngest_) {\n        this.playerElIngest_ = null;\n      }\n\n      if (this.tag) {\n        this.tag = null;\n      }\n\n      clearCacheForPlayer(this);\n\n      // the actual .el_ is removed here\n      _Component.prototype.dispose.call(this);\n    };\n\n    /**\n     * Create the `Player`'s DOM element.\n     *\n     * @return {Element}\n     *         The DOM element that gets created.\n     */\n\n\n    Player.prototype.createEl = function createEl$$1() {\n      var tag = this.tag;\n      var el = void 0;\n      var playerElIngest = this.playerElIngest_ = tag.parentNode && tag.parentNode.hasAttribute && tag.parentNode.hasAttribute('data-vjs-player');\n      var divEmbed = this.tag.tagName.toLowerCase() === 'video-js';\n\n      if (playerElIngest) {\n        el = this.el_ = tag.parentNode;\n      } else if (!divEmbed) {\n        el = this.el_ = _Component.prototype.createEl.call(this, 'div');\n      }\n\n      // Copy over all the attributes from the tag, including ID and class\n      // ID will now reference player box, not the video tag\n      var attrs = getAttributes(tag);\n\n      if (divEmbed) {\n        el = this.el_ = tag;\n        tag = this.tag = document_1.createElement('video');\n        while (el.children.length) {\n          tag.appendChild(el.firstChild);\n        }\n\n        if (!hasClass(el, 'video-js')) {\n          addClass(el, 'video-js');\n        }\n\n        el.appendChild(tag);\n\n        playerElIngest = this.playerElIngest_ = el;\n        // move properties over from our custom `video-js` element\n        // to our new `video` element. This will move things like\n        // `src` or `controls` that were set via js before the player\n        // was initialized.\n        Object.keys(el).forEach(function (k) {\n          tag[k] = el[k];\n        });\n      }\n\n      // set tabindex to -1 so we could focus on the player element\n      tag.setAttribute('tabindex', '-1');\n\n      // Remove width/height attrs from tag so CSS can make it 100% width/height\n      tag.removeAttribute('width');\n      tag.removeAttribute('height');\n\n      Object.getOwnPropertyNames(attrs).forEach(function (attr) {\n        el.setAttribute(attr, attrs[attr]);\n\n        if (divEmbed) {\n          tag.setAttribute(attr, attrs[attr]);\n        }\n      });\n\n      // Update tag id/class for use as HTML5 playback tech\n      // Might think we should do this after embedding in container so .vjs-tech class\n      // doesn't flash 100% width/height, but class only applies with .video-js parent\n      tag.playerId = tag.id;\n      tag.id += '_html5_api';\n      tag.className = 'vjs-tech';\n\n      // Make player findable on elements\n      tag.player = el.player = this;\n      // Default state of video is paused\n      this.addClass('vjs-paused');\n\n      // Add a style element in the player that we'll use to set the width/height\n      // of the player in a way that's still overrideable by CSS, just like the\n      // video element\n      if (window_1.VIDEOJS_NO_DYNAMIC_STYLE !== true) {\n        this.styleEl_ = createStyleElement('vjs-styles-dimensions');\n        var defaultsStyleEl = $('.vjs-styles-defaults');\n        var head = $('head');\n\n        head.insertBefore(this.styleEl_, defaultsStyleEl ? defaultsStyleEl.nextSibling : head.firstChild);\n      }\n\n      // Pass in the width/height/aspectRatio options which will update the style el\n      this.width(this.options_.width);\n      this.height(this.options_.height);\n      this.fluid(this.options_.fluid);\n      this.aspectRatio(this.options_.aspectRatio);\n\n      // Hide any links within the video/audio tag,\n      // because IE doesn't hide them completely from screen readers.\n      var links = tag.getElementsByTagName('a');\n\n      for (var i = 0; i < links.length; i++) {\n        var linkEl = links.item(i);\n\n        addClass(linkEl, 'vjs-hidden');\n        linkEl.setAttribute('hidden', 'hidden');\n      }\n\n      // insertElFirst seems to cause the networkState to flicker from 3 to 2, so\n      // keep track of the original for later so we can know if the source originally failed\n      tag.initNetworkState_ = tag.networkState;\n\n      // Wrap video tag in div (el/box) container\n      if (tag.parentNode && !playerElIngest) {\n        tag.parentNode.insertBefore(el, tag);\n      }\n\n      // insert the tag as the first child of the player element\n      // then manually add it to the children array so that this.addChild\n      // will work properly for other components\n      //\n      // Breaks iPhone, fixed in HTML5 setup.\n      prependTo(tag, el);\n      this.children_.unshift(tag);\n\n      // Set lang attr on player to ensure CSS :lang() in consistent with player\n      // if it's been set to something different to the doc\n      this.el_.setAttribute('lang', this.language_);\n\n      this.el_ = el;\n\n      return el;\n    };\n\n    /**\n     * A getter/setter for the `Player`'s width. Returns the player's configured value.\n     * To get the current width use `currentWidth()`.\n     *\n     * @param {number} [value]\n     *        The value to set the `Player`'s width to.\n     *\n     * @return {number}\n     *         The current width of the `Player` when getting.\n     */\n\n\n    Player.prototype.width = function width(value) {\n      return this.dimension('width', value);\n    };\n\n    /**\n     * A getter/setter for the `Player`'s height. Returns the player's configured value.\n     * To get the current height use `currentheight()`.\n     *\n     * @param {number} [value]\n     *        The value to set the `Player`'s heigth to.\n     *\n     * @return {number}\n     *         The current height of the `Player` when getting.\n     */\n\n\n    Player.prototype.height = function height(value) {\n      return this.dimension('height', value);\n    };\n\n    /**\n     * A getter/setter for the `Player`'s width & height.\n     *\n     * @param {string} dimension\n     *        This string can be:\n     *        - 'width'\n     *        - 'height'\n     *\n     * @param {number} [value]\n     *        Value for dimension specified in the first argument.\n     *\n     * @return {number}\n     *         The dimension arguments value when getting (width/height).\n     */\n\n\n    Player.prototype.dimension = function dimension(_dimension, value) {\n      var privDimension = _dimension + '_';\n\n      if (value === undefined) {\n        return this[privDimension] || 0;\n      }\n\n      if (value === '') {\n        // If an empty string is given, reset the dimension to be automatic\n        this[privDimension] = undefined;\n        this.updateStyleEl_();\n        return;\n      }\n\n      var parsedVal = parseFloat(value);\n\n      if (isNaN(parsedVal)) {\n        log$1.error('Improper value \"' + value + '\" supplied for for ' + _dimension);\n        return;\n      }\n\n      this[privDimension] = parsedVal;\n      this.updateStyleEl_();\n    };\n\n    /**\n     * A getter/setter/toggler for the vjs-fluid `className` on the `Player`.\n     *\n     * @param {boolean} [bool]\n     *        - A value of true adds the class.\n     *        - A value of false removes the class.\n     *        - No value will toggle the fluid class.\n     *\n     * @return {boolean|undefined}\n     *         - The value of fluid when getting.\n     *         - `undefined` when setting.\n     */\n\n\n    Player.prototype.fluid = function fluid(bool) {\n      if (bool === undefined) {\n        return !!this.fluid_;\n      }\n\n      this.fluid_ = !!bool;\n\n      if (bool) {\n        this.addClass('vjs-fluid');\n      } else {\n        this.removeClass('vjs-fluid');\n      }\n\n      this.updateStyleEl_();\n    };\n\n    /**\n     * Get/Set the aspect ratio\n     *\n     * @param {string} [ratio]\n     *        Aspect ratio for player\n     *\n     * @return {string|undefined}\n     *         returns the current aspect ratio when getting\n     */\n\n    /**\n     * A getter/setter for the `Player`'s aspect ratio.\n     *\n     * @param {string} [ratio]\n     *        The value to set the `Player's aspect ratio to.\n     *\n     * @return {string|undefined}\n     *         - The current aspect ratio of the `Player` when getting.\n     *         - undefined when setting\n     */\n\n\n    Player.prototype.aspectRatio = function aspectRatio(ratio) {\n      if (ratio === undefined) {\n        return this.aspectRatio_;\n      }\n\n      // Check for width:height format\n      if (!/^\\d+\\:\\d+$/.test(ratio)) {\n        throw new Error('Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.');\n      }\n      this.aspectRatio_ = ratio;\n\n      // We're assuming if you set an aspect ratio you want fluid mode,\n      // because in fixed mode you could calculate width and height yourself.\n      this.fluid(true);\n\n      this.updateStyleEl_();\n    };\n\n    /**\n     * Update styles of the `Player` element (height, width and aspect ratio).\n     *\n     * @private\n     * @listens Tech#loadedmetadata\n     */\n\n\n    Player.prototype.updateStyleEl_ = function updateStyleEl_() {\n      if (window_1.VIDEOJS_NO_DYNAMIC_STYLE === true) {\n        var _width = typeof this.width_ === 'number' ? this.width_ : this.options_.width;\n        var _height = typeof this.height_ === 'number' ? this.height_ : this.options_.height;\n        var techEl = this.tech_ && this.tech_.el();\n\n        if (techEl) {\n          if (_width >= 0) {\n            techEl.width = _width;\n          }\n          if (_height >= 0) {\n            techEl.height = _height;\n          }\n        }\n\n        return;\n      }\n\n      var width = void 0;\n      var height = void 0;\n      var aspectRatio = void 0;\n      var idClass = void 0;\n\n      // The aspect ratio is either used directly or to calculate width and height.\n      if (this.aspectRatio_ !== undefined && this.aspectRatio_ !== 'auto') {\n        // Use any aspectRatio that's been specifically set\n        aspectRatio = this.aspectRatio_;\n      } else if (this.videoWidth() > 0) {\n        // Otherwise try to get the aspect ratio from the video metadata\n        aspectRatio = this.videoWidth() + ':' + this.videoHeight();\n      } else {\n        // Or use a default. The video element's is 2:1, but 16:9 is more common.\n        aspectRatio = '16:9';\n      }\n\n      // Get the ratio as a decimal we can use to calculate dimensions\n      var ratioParts = aspectRatio.split(':');\n      var ratioMultiplier = ratioParts[1] / ratioParts[0];\n\n      if (this.width_ !== undefined) {\n        // Use any width that's been specifically set\n        width = this.width_;\n      } else if (this.height_ !== undefined) {\n        // Or calulate the width from the aspect ratio if a height has been set\n        width = this.height_ / ratioMultiplier;\n      } else {\n        // Or use the video's metadata, or use the video el's default of 300\n        width = this.videoWidth() || 300;\n      }\n\n      if (this.height_ !== undefined) {\n        // Use any height that's been specifically set\n        height = this.height_;\n      } else {\n        // Otherwise calculate the height from the ratio and the width\n        height = width * ratioMultiplier;\n      }\n\n      // Ensure the CSS class is valid by starting with an alpha character\n      if (/^[^a-zA-Z]/.test(this.id())) {\n        idClass = 'dimensions-' + this.id();\n      } else {\n        idClass = this.id() + '-dimensions';\n      }\n\n      // Ensure the right class is still on the player for the style element\n      this.addClass(idClass);\n\n      setTextContent(this.styleEl_, '\\n      .' + idClass + ' {\\n        width: ' + width + 'px;\\n        height: ' + height + 'px;\\n      }\\n\\n      .' + idClass + '.vjs-fluid {\\n        padding-top: ' + ratioMultiplier * 100 + '%;\\n      }\\n    ');\n    };\n\n    /**\n     * Load/Create an instance of playback {@link Tech} including element\n     * and API methods. Then append the `Tech` element in `Player` as a child.\n     *\n     * @param {string} techName\n     *        name of the playback technology\n     *\n     * @param {string} source\n     *        video source\n     *\n     * @private\n     */\n\n\n    Player.prototype.loadTech_ = function loadTech_(techName, source) {\n      var _this2 = this;\n\n      // Pause and remove current playback technology\n      if (this.tech_) {\n        this.unloadTech_();\n      }\n\n      var titleTechName = toTitleCase(techName);\n      var camelTechName = techName.charAt(0).toLowerCase() + techName.slice(1);\n\n      // get rid of the HTML5 video tag as soon as we are using another tech\n      if (titleTechName !== 'Html5' && this.tag) {\n        Tech.getTech('Html5').disposeMediaElement(this.tag);\n        this.tag.player = null;\n        this.tag = null;\n      }\n\n      this.techName_ = titleTechName;\n\n      // Turn off API access because we're loading a new tech that might load asynchronously\n      this.isReady_ = false;\n\n      // Grab tech-specific options from player options and add source and parent element to use.\n      var techOptions = {\n        source: source,\n        'nativeControlsForTouch': this.options_.nativeControlsForTouch,\n        'playerId': this.id(),\n        'techId': this.id() + '_' + titleTechName + '_api',\n        'autoplay': this.options_.autoplay,\n        'playsinline': this.options_.playsinline,\n        'preload': this.options_.preload,\n        'loop': this.options_.loop,\n        'muted': this.options_.muted,\n        'poster': this.poster(),\n        'language': this.language(),\n        'playerElIngest': this.playerElIngest_ || false,\n        'vtt.js': this.options_['vtt.js'],\n        'canOverridePoster': !!this.options_.techCanOverridePoster,\n        'enableSourceset': this.options_.enableSourceset\n      };\n\n      ALL.names.forEach(function (name$$1) {\n        var props = ALL[name$$1];\n\n        techOptions[props.getterName] = _this2[props.privateName];\n      });\n\n      assign(techOptions, this.options_[titleTechName]);\n      assign(techOptions, this.options_[camelTechName]);\n      assign(techOptions, this.options_[techName.toLowerCase()]);\n\n      if (this.tag) {\n        techOptions.tag = this.tag;\n      }\n\n      if (source && source.src === this.cache_.src && this.cache_.currentTime > 0) {\n        techOptions.startTime = this.cache_.currentTime;\n      }\n\n      // Initialize tech instance\n      var TechClass = Tech.getTech(techName);\n\n      if (!TechClass) {\n        throw new Error('No Tech named \\'' + titleTechName + '\\' exists! \\'' + titleTechName + '\\' should be registered using videojs.registerTech()\\'');\n      }\n\n      this.tech_ = new TechClass(techOptions);\n\n      // player.triggerReady is always async, so don't need this to be async\n      this.tech_.ready(bind(this, this.handleTechReady_), true);\n\n      textTrackConverter.jsonToTextTracks(this.textTracksJson_ || [], this.tech_);\n\n      // Listen to all HTML5-defined events and trigger them on the player\n      TECH_EVENTS_RETRIGGER.forEach(function (event) {\n        _this2.on(_this2.tech_, event, _this2['handleTech' + toTitleCase(event) + '_']);\n      });\n\n      Object.keys(TECH_EVENTS_QUEUE).forEach(function (event) {\n        _this2.on(_this2.tech_, event, function (eventObj) {\n          if (_this2.tech_.playbackRate() === 0 && _this2.tech_.seeking()) {\n            _this2.queuedCallbacks_.push({\n              callback: _this2['handleTech' + TECH_EVENTS_QUEUE[event] + '_'].bind(_this2),\n              event: eventObj\n            });\n            return;\n          }\n          _this2['handleTech' + TECH_EVENTS_QUEUE[event] + '_'](eventObj);\n        });\n      });\n\n      this.on(this.tech_, 'loadstart', this.handleTechLoadStart_);\n      this.on(this.tech_, 'sourceset', this.handleTechSourceset_);\n      this.on(this.tech_, 'waiting', this.handleTechWaiting_);\n      this.on(this.tech_, 'ended', this.handleTechEnded_);\n      this.on(this.tech_, 'seeking', this.handleTechSeeking_);\n      this.on(this.tech_, 'play', this.handleTechPlay_);\n      this.on(this.tech_, 'firstplay', this.handleTechFirstPlay_);\n      this.on(this.tech_, 'pause', this.handleTechPause_);\n      this.on(this.tech_, 'durationchange', this.handleTechDurationChange_);\n      this.on(this.tech_, 'fullscreenchange', this.handleTechFullscreenChange_);\n      this.on(this.tech_, 'error', this.handleTechError_);\n      this.on(this.tech_, 'loadedmetadata', this.updateStyleEl_);\n      this.on(this.tech_, 'posterchange', this.handleTechPosterChange_);\n      this.on(this.tech_, 'textdata', this.handleTechTextData_);\n      this.on(this.tech_, 'ratechange', this.handleTechRateChange_);\n\n      this.usingNativeControls(this.techGet_('controls'));\n\n      if (this.controls() && !this.usingNativeControls()) {\n        this.addTechControlsListeners_();\n      }\n\n      // Add the tech element in the DOM if it was not already there\n      // Make sure to not insert the original video element if using Html5\n      if (this.tech_.el().parentNode !== this.el() && (titleTechName !== 'Html5' || !this.tag)) {\n        prependTo(this.tech_.el(), this.el());\n      }\n\n      // Get rid of the original video tag reference after the first tech is loaded\n      if (this.tag) {\n        this.tag.player = null;\n        this.tag = null;\n      }\n    };\n\n    /**\n     * Unload and dispose of the current playback {@link Tech}.\n     *\n     * @private\n     */\n\n\n    Player.prototype.unloadTech_ = function unloadTech_() {\n      var _this3 = this;\n\n      // Save the current text tracks so that we can reuse the same text tracks with the next tech\n      ALL.names.forEach(function (name$$1) {\n        var props = ALL[name$$1];\n\n        _this3[props.privateName] = _this3[props.getterName]();\n      });\n      this.textTracksJson_ = textTrackConverter.textTracksToJson(this.tech_);\n\n      this.isReady_ = false;\n\n      this.tech_.dispose();\n\n      this.tech_ = false;\n\n      if (this.isPosterFromTech_) {\n        this.poster_ = '';\n        this.trigger('posterchange');\n      }\n\n      this.isPosterFromTech_ = false;\n    };\n\n    /**\n     * Return a reference to the current {@link Tech}.\n     * It will print a warning by default about the danger of using the tech directly\n     * but any argument that is passed in will silence the warning.\n     *\n     * @param {*} [safety]\n     *        Anything passed in to silence the warning\n     *\n     * @return {Tech}\n     *         The Tech\n     */\n\n\n    Player.prototype.tech = function tech(safety) {\n      if (safety === undefined) {\n        log$1.warn(tsml(_templateObject$2));\n      }\n\n      return this.tech_;\n    };\n\n    /**\n     * Set up click and touch listeners for the playback element\n     *\n     * - On desktops: a click on the video itself will toggle playback\n     * - On mobile devices: a click on the video toggles controls\n     *   which is done by toggling the user state between active and\n     *   inactive\n     * - A tap can signal that a user has become active or has become inactive\n     *   e.g. a quick tap on an iPhone movie should reveal the controls. Another\n     *   quick tap should hide them again (signaling the user is in an inactive\n     *   viewing state)\n     * - In addition to this, we still want the user to be considered inactive after\n     *   a few seconds of inactivity.\n     *\n     * > Note: the only part of iOS interaction we can't mimic with this setup\n     * is a touch and hold on the video element counting as activity in order to\n     * keep the controls showing, but that shouldn't be an issue. A touch and hold\n     * on any controls will still keep the user active\n     *\n     * @private\n     */\n\n\n    Player.prototype.addTechControlsListeners_ = function addTechControlsListeners_() {\n      // Make sure to remove all the previous listeners in case we are called multiple times.\n      this.removeTechControlsListeners_();\n\n      // Some browsers (Chrome & IE) don't trigger a click on a flash swf, but do\n      // trigger mousedown/up.\n      // http://stackoverflow.com/questions/1444562/javascript-onclick-event-over-flash-object\n      // Any touch events are set to block the mousedown event from happening\n      this.on(this.tech_, 'mousedown', this.handleTechClick_);\n\n      // If the controls were hidden we don't want that to change without a tap event\n      // so we'll check if the controls were already showing before reporting user\n      // activity\n      this.on(this.tech_, 'touchstart', this.handleTechTouchStart_);\n      this.on(this.tech_, 'touchmove', this.handleTechTouchMove_);\n      this.on(this.tech_, 'touchend', this.handleTechTouchEnd_);\n\n      // The tap listener needs to come after the touchend listener because the tap\n      // listener cancels out any reportedUserActivity when setting userActive(false)\n      this.on(this.tech_, 'tap', this.handleTechTap_);\n    };\n\n    /**\n     * Remove the listeners used for click and tap controls. This is needed for\n     * toggling to controls disabled, where a tap/touch should do nothing.\n     *\n     * @private\n     */\n\n\n    Player.prototype.removeTechControlsListeners_ = function removeTechControlsListeners_() {\n      // We don't want to just use `this.off()` because there might be other needed\n      // listeners added by techs that extend this.\n      this.off(this.tech_, 'tap', this.handleTechTap_);\n      this.off(this.tech_, 'touchstart', this.handleTechTouchStart_);\n      this.off(this.tech_, 'touchmove', this.handleTechTouchMove_);\n      this.off(this.tech_, 'touchend', this.handleTechTouchEnd_);\n      this.off(this.tech_, 'mousedown', this.handleTechClick_);\n    };\n\n    /**\n     * Player waits for the tech to be ready\n     *\n     * @private\n     */\n\n\n    Player.prototype.handleTechReady_ = function handleTechReady_() {\n      this.triggerReady();\n\n      // Keep the same volume as before\n      if (this.cache_.volume) {\n        this.techCall_('setVolume', this.cache_.volume);\n      }\n\n      // Look if the tech found a higher resolution poster while loading\n      this.handleTechPosterChange_();\n\n      // Update the duration if available\n      this.handleTechDurationChange_();\n\n      // Chrome and Safari both have issues with autoplay.\n      // In Safari (5.1.1), when we move the video element into the container div, autoplay doesn't work.\n      // In Chrome (15), if you have autoplay + a poster + no controls, the video gets hidden (but audio plays)\n      // This fixes both issues. Need to wait for API, so it updates displays correctly\n      if ((this.src() || this.currentSrc()) && this.tag && this.options_.autoplay && this.paused()) {\n        try {\n          // Chrome Fix. Fixed in Chrome v16.\n          delete this.tag.poster;\n        } catch (e) {\n          log$1('deleting tag.poster throws in some browsers', e);\n        }\n      }\n    };\n\n    /**\n     * Retrigger the `loadstart` event that was triggered by the {@link Tech}. This\n     * function will also trigger {@link Player#firstplay} if it is the first loadstart\n     * for a video.\n     *\n     * @fires Player#loadstart\n     * @fires Player#firstplay\n     * @listens Tech#loadstart\n     * @private\n     */\n\n\n    Player.prototype.handleTechLoadStart_ = function handleTechLoadStart_() {\n      // TODO: Update to use `emptied` event instead. See #1277.\n\n      this.removeClass('vjs-ended');\n      this.removeClass('vjs-seeking');\n\n      // reset the error state\n      this.error(null);\n\n      // If it's already playing we want to trigger a firstplay event now.\n      // The firstplay event relies on both the play and loadstart events\n      // which can happen in any order for a new source\n      if (!this.paused()) {\n        /**\n         * Fired when the user agent begins looking for media data\n         *\n         * @event Player#loadstart\n         * @type {EventTarget~Event}\n         */\n        this.trigger('loadstart');\n        this.trigger('firstplay');\n      } else {\n        // reset the hasStarted state\n        this.hasStarted(false);\n        this.trigger('loadstart');\n      }\n    };\n\n    /**\n     * Update the internal source caches so that we return the correct source from\n     * `src()`, `currentSource()`, and `currentSources()`.\n     *\n     * > Note: `currentSources` will not be updated if the source that is passed in exists\n     *         in the current `currentSources` cache.\n     *\n     *\n     * @param {Tech~SourceObject} srcObj\n     *        A string or object source to update our caches to.\n     */\n\n\n    Player.prototype.updateSourceCaches_ = function updateSourceCaches_() {\n      var srcObj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n\n      var src = srcObj;\n      var type = '';\n\n      if (typeof src !== 'string') {\n        src = srcObj.src;\n        type = srcObj.type;\n      }\n      // make sure all the caches are set to default values\n      // to prevent null checking\n      this.cache_.source = this.cache_.source || {};\n      this.cache_.sources = this.cache_.sources || [];\n\n      // try to get the type of the src that was passed in\n      if (src && !type) {\n        type = findMimetype(this, src);\n      }\n\n      // update `currentSource` cache always\n      this.cache_.source = { src: src, type: type };\n\n      var matchingSources = this.cache_.sources.filter(function (s) {\n        return s.src && s.src === src;\n      });\n      var sourceElSources = [];\n      var sourceEls = this.$$('source');\n      var matchingSourceEls = [];\n\n      for (var i = 0; i < sourceEls.length; i++) {\n        var sourceObj = getAttributes(sourceEls[i]);\n\n        sourceElSources.push(sourceObj);\n\n        if (sourceObj.src && sourceObj.src === src) {\n          matchingSourceEls.push(sourceObj.src);\n        }\n      }\n\n      // if we have matching source els but not matching sources\n      // the current source cache is not up to date\n      if (matchingSourceEls.length && !matchingSources.length) {\n        this.cache_.sources = sourceElSources;\n        // if we don't have matching source or source els set the\n        // sources cache to the `currentSource` cache\n      } else if (!matchingSources.length) {\n        this.cache_.sources = [this.cache_.source];\n      }\n\n      // update the tech `src` cache\n      this.cache_.src = src;\n    };\n\n    /**\n     * *EXPERIMENTAL* Fired when the source is set or changed on the {@link Tech}\n     * causing the media element to reload.\n     *\n     * It will fire for the initial source and each subsequent source.\n     * This event is a custom event from Video.js and is triggered by the {@link Tech}.\n     *\n     * The event object for this event contains a `src` property that will contain the source\n     * that was available when the event was triggered. This is generally only necessary if Video.js\n     * is switching techs while the source was being changed.\n     *\n     * It is also fired when `load` is called on the player (or media element)\n     * because the {@link https://html.spec.whatwg.org/multipage/media.html#dom-media-load|specification for `load`}\n     * says that the resource selection algorithm needs to be aborted and restarted.\n     * In this case, it is very likely that the `src` property will be set to the\n     * empty string `\"\"` to indicate we do not know what the source will be but\n     * that it is changing.\n     *\n     * *This event is currently still experimental and may change in minor releases.*\n     * __To use this, pass `enableSourceset` option to the player.__\n     *\n     * @event Player#sourceset\n     * @type {EventTarget~Event}\n     * @prop {string} src\n     *                The source url available when the `sourceset` was triggered.\n     *                It will be an empty string if we cannot know what the source is\n     *                but know that the source will change.\n     */\n    /**\n     * Retrigger the `sourceset` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#sourceset\n     * @listens Tech#sourceset\n     * @private\n     */\n\n\n    Player.prototype.handleTechSourceset_ = function handleTechSourceset_(event) {\n      var _this4 = this;\n\n      // only update the source cache when the source\n      // was not updated using the player api\n      if (!this.changingSrc_) {\n        // update the source to the intial source right away\n        // in some cases this will be empty string\n        this.updateSourceCaches_(event.src);\n\n        // if the `sourceset` `src` was an empty string\n        // wait for a `loadstart` to update the cache to `currentSrc`.\n        // If a sourceset happens before a `loadstart`, we reset the state\n        // as this function will be called again.\n        if (!event.src) {\n          var updateCache = function updateCache(e) {\n            if (e.type !== 'sourceset') {\n              _this4.updateSourceCaches_(_this4.techGet_('currentSrc'));\n            }\n\n            _this4.tech_.off(['sourceset', 'loadstart'], updateCache);\n          };\n\n          this.tech_.one(['sourceset', 'loadstart'], updateCache);\n        }\n      }\n\n      this.trigger({\n        src: event.src,\n        type: 'sourceset'\n      });\n    };\n\n    /**\n     * Add/remove the vjs-has-started class\n     *\n     * @fires Player#firstplay\n     *\n     * @param {boolean} request\n     *        - true: adds the class\n     *        - false: remove the class\n     *\n     * @return {boolean}\n     *         the boolean value of hasStarted_\n     */\n\n\n    Player.prototype.hasStarted = function hasStarted(request) {\n      if (request === undefined) {\n        // act as getter, if we have no request to change\n        return this.hasStarted_;\n      }\n\n      if (request === this.hasStarted_) {\n        return;\n      }\n\n      this.hasStarted_ = request;\n\n      if (this.hasStarted_) {\n        this.addClass('vjs-has-started');\n        this.trigger('firstplay');\n      } else {\n        this.removeClass('vjs-has-started');\n      }\n    };\n\n    /**\n     * Fired whenever the media begins or resumes playback\n     *\n     * @see [Spec]{@link https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-play}\n     * @fires Player#play\n     * @listens Tech#play\n     * @private\n     */\n\n\n    Player.prototype.handleTechPlay_ = function handleTechPlay_() {\n      this.removeClass('vjs-ended');\n      this.removeClass('vjs-paused');\n      this.addClass('vjs-playing');\n\n      // hide the poster when the user hits play\n      this.hasStarted(true);\n      /**\n       * Triggered whenever an {@link Tech#play} event happens. Indicates that\n       * playback has started or resumed.\n       *\n       * @event Player#play\n       * @type {EventTarget~Event}\n       */\n      this.trigger('play');\n    };\n\n    /**\n     * Retrigger the `ratechange` event that was triggered by the {@link Tech}.\n     *\n     * If there were any events queued while the playback rate was zero, fire\n     * those events now.\n     *\n     * @private\n     * @method Player#handleTechRateChange_\n     * @fires Player#ratechange\n     * @listens Tech#ratechange\n     */\n\n\n    Player.prototype.handleTechRateChange_ = function handleTechRateChange_() {\n      if (this.tech_.playbackRate() > 0 && this.cache_.lastPlaybackRate === 0) {\n        this.queuedCallbacks_.forEach(function (queued) {\n          return queued.callback(queued.event);\n        });\n        this.queuedCallbacks_ = [];\n      }\n      this.cache_.lastPlaybackRate = this.tech_.playbackRate();\n      /**\n       * Fires when the playing speed of the audio/video is changed\n       *\n       * @event Player#ratechange\n       * @type {event}\n       */\n      this.trigger('ratechange');\n    };\n\n    /**\n     * Retrigger the `waiting` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#waiting\n     * @listens Tech#waiting\n     * @private\n     */\n\n\n    Player.prototype.handleTechWaiting_ = function handleTechWaiting_() {\n      var _this5 = this;\n\n      this.addClass('vjs-waiting');\n      /**\n       * A readyState change on the DOM element has caused playback to stop.\n       *\n       * @event Player#waiting\n       * @type {EventTarget~Event}\n       */\n      this.trigger('waiting');\n      this.one('timeupdate', function () {\n        return _this5.removeClass('vjs-waiting');\n      });\n    };\n\n    /**\n     * Retrigger the `canplay` event that was triggered by the {@link Tech}.\n     * > Note: This is not consistent between browsers. See #1351\n     *\n     * @fires Player#canplay\n     * @listens Tech#canplay\n     * @private\n     */\n\n\n    Player.prototype.handleTechCanPlay_ = function handleTechCanPlay_() {\n      this.removeClass('vjs-waiting');\n      /**\n       * The media has a readyState of HAVE_FUTURE_DATA or greater.\n       *\n       * @event Player#canplay\n       * @type {EventTarget~Event}\n       */\n      this.trigger('canplay');\n    };\n\n    /**\n     * Retrigger the `canplaythrough` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#canplaythrough\n     * @listens Tech#canplaythrough\n     * @private\n     */\n\n\n    Player.prototype.handleTechCanPlayThrough_ = function handleTechCanPlayThrough_() {\n      this.removeClass('vjs-waiting');\n      /**\n       * The media has a readyState of HAVE_ENOUGH_DATA or greater. This means that the\n       * entire media file can be played without buffering.\n       *\n       * @event Player#canplaythrough\n       * @type {EventTarget~Event}\n       */\n      this.trigger('canplaythrough');\n    };\n\n    /**\n     * Retrigger the `playing` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#playing\n     * @listens Tech#playing\n     * @private\n     */\n\n\n    Player.prototype.handleTechPlaying_ = function handleTechPlaying_() {\n      this.removeClass('vjs-waiting');\n      /**\n       * The media is no longer blocked from playback, and has started playing.\n       *\n       * @event Player#playing\n       * @type {EventTarget~Event}\n       */\n      this.trigger('playing');\n    };\n\n    /**\n     * Retrigger the `seeking` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#seeking\n     * @listens Tech#seeking\n     * @private\n     */\n\n\n    Player.prototype.handleTechSeeking_ = function handleTechSeeking_() {\n      this.addClass('vjs-seeking');\n      /**\n       * Fired whenever the player is jumping to a new time\n       *\n       * @event Player#seeking\n       * @type {EventTarget~Event}\n       */\n      this.trigger('seeking');\n    };\n\n    /**\n     * Retrigger the `seeked` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#seeked\n     * @listens Tech#seeked\n     * @private\n     */\n\n\n    Player.prototype.handleTechSeeked_ = function handleTechSeeked_() {\n      this.removeClass('vjs-seeking');\n      /**\n       * Fired when the player has finished jumping to a new time\n       *\n       * @event Player#seeked\n       * @type {EventTarget~Event}\n       */\n      this.trigger('seeked');\n    };\n\n    /**\n     * Retrigger the `firstplay` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#firstplay\n     * @listens Tech#firstplay\n     * @deprecated As of 6.0 firstplay event is deprecated.\n     * @deprecated As of 6.0 passing the `starttime` option to the player and the firstplay event are deprecated.\n     * @private\n     */\n\n\n    Player.prototype.handleTechFirstPlay_ = function handleTechFirstPlay_() {\n      // If the first starttime attribute is specified\n      // then we will start at the given offset in seconds\n      if (this.options_.starttime) {\n        log$1.warn('Passing the `starttime` option to the player will be deprecated in 6.0');\n        this.currentTime(this.options_.starttime);\n      }\n\n      this.addClass('vjs-has-started');\n      /**\n       * Fired the first time a video is played. Not part of the HLS spec, and this is\n       * probably not the best implementation yet, so use sparingly. If you don't have a\n       * reason to prevent playback, use `myPlayer.one('play');` instead.\n       *\n       * @event Player#firstplay\n       * @deprecated As of 6.0 firstplay event is deprecated.\n       * @type {EventTarget~Event}\n       */\n      this.trigger('firstplay');\n    };\n\n    /**\n     * Retrigger the `pause` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#pause\n     * @listens Tech#pause\n     * @private\n     */\n\n\n    Player.prototype.handleTechPause_ = function handleTechPause_() {\n      this.removeClass('vjs-playing');\n      this.addClass('vjs-paused');\n      /**\n       * Fired whenever the media has been paused\n       *\n       * @event Player#pause\n       * @type {EventTarget~Event}\n       */\n      this.trigger('pause');\n    };\n\n    /**\n     * Retrigger the `ended` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#ended\n     * @listens Tech#ended\n     * @private\n     */\n\n\n    Player.prototype.handleTechEnded_ = function handleTechEnded_() {\n      this.addClass('vjs-ended');\n      if (this.options_.loop) {\n        this.currentTime(0);\n        this.play();\n      } else if (!this.paused()) {\n        this.pause();\n      }\n\n      /**\n       * Fired when the end of the media resource is reached (currentTime == duration)\n       *\n       * @event Player#ended\n       * @type {EventTarget~Event}\n       */\n      this.trigger('ended');\n    };\n\n    /**\n     * Fired when the duration of the media resource is first known or changed\n     *\n     * @listens Tech#durationchange\n     * @private\n     */\n\n\n    Player.prototype.handleTechDurationChange_ = function handleTechDurationChange_() {\n      this.duration(this.techGet_('duration'));\n    };\n\n    /**\n     * Handle a click on the media element to play/pause\n     *\n     * @param {EventTarget~Event} event\n     *        the event that caused this function to trigger\n     *\n     * @listens Tech#mousedown\n     * @private\n     */\n\n\n    Player.prototype.handleTechClick_ = function handleTechClick_(event) {\n      if (!isSingleLeftClick(event)) {\n        return;\n      }\n\n      // When controls are disabled a click should not toggle playback because\n      // the click is considered a control\n      if (!this.controls_) {\n        return;\n      }\n\n      if (this.paused()) {\n        this.play();\n      } else {\n        this.pause();\n      }\n    };\n\n    /**\n     * Handle a tap on the media element. It will toggle the user\n     * activity state, which hides and shows the controls.\n     *\n     * @listens Tech#tap\n     * @private\n     */\n\n\n    Player.prototype.handleTechTap_ = function handleTechTap_() {\n      this.userActive(!this.userActive());\n    };\n\n    /**\n     * Handle touch to start\n     *\n     * @listens Tech#touchstart\n     * @private\n     */\n\n\n    Player.prototype.handleTechTouchStart_ = function handleTechTouchStart_() {\n      this.userWasActive = this.userActive();\n    };\n\n    /**\n     * Handle touch to move\n     *\n     * @listens Tech#touchmove\n     * @private\n     */\n\n\n    Player.prototype.handleTechTouchMove_ = function handleTechTouchMove_() {\n      if (this.userWasActive) {\n        this.reportUserActivity();\n      }\n    };\n\n    /**\n     * Handle touch to end\n     *\n     * @param {EventTarget~Event} event\n     *        the touchend event that triggered\n     *        this function\n     *\n     * @listens Tech#touchend\n     * @private\n     */\n\n\n    Player.prototype.handleTechTouchEnd_ = function handleTechTouchEnd_(event) {\n      // Stop the mouse events from also happening\n      event.preventDefault();\n    };\n\n    /**\n     * Fired when the player switches in or out of fullscreen mode\n     *\n     * @private\n     * @listens Player#fullscreenchange\n     */\n\n\n    Player.prototype.handleFullscreenChange_ = function handleFullscreenChange_() {\n      if (this.isFullscreen()) {\n        this.addClass('vjs-fullscreen');\n      } else {\n        this.removeClass('vjs-fullscreen');\n      }\n    };\n\n    /**\n     * native click events on the SWF aren't triggered on IE11, Win8.1RT\n     * use stageclick events triggered from inside the SWF instead\n     *\n     * @private\n     * @listens stageclick\n     */\n\n\n    Player.prototype.handleStageClick_ = function handleStageClick_() {\n      this.reportUserActivity();\n    };\n\n    /**\n     * Handle Tech Fullscreen Change\n     *\n     * @param {EventTarget~Event} event\n     *        the fullscreenchange event that triggered this function\n     *\n     * @param {Object} data\n     *        the data that was sent with the event\n     *\n     * @private\n     * @listens Tech#fullscreenchange\n     * @fires Player#fullscreenchange\n     */\n\n\n    Player.prototype.handleTechFullscreenChange_ = function handleTechFullscreenChange_(event, data) {\n      if (data) {\n        this.isFullscreen(data.isFullscreen);\n      }\n      /**\n       * Fired when going in and out of fullscreen.\n       *\n       * @event Player#fullscreenchange\n       * @type {EventTarget~Event}\n       */\n      this.trigger('fullscreenchange');\n    };\n\n    /**\n     * Fires when an error occurred during the loading of an audio/video.\n     *\n     * @private\n     * @listens Tech#error\n     */\n\n\n    Player.prototype.handleTechError_ = function handleTechError_() {\n      var error = this.tech_.error();\n\n      this.error(error);\n    };\n\n    /**\n     * Retrigger the `textdata` event that was triggered by the {@link Tech}.\n     *\n     * @fires Player#textdata\n     * @listens Tech#textdata\n     * @private\n     */\n\n\n    Player.prototype.handleTechTextData_ = function handleTechTextData_() {\n      var data = null;\n\n      if (arguments.length > 1) {\n        data = arguments[1];\n      }\n\n      /**\n       * Fires when we get a textdata event from tech\n       *\n       * @event Player#textdata\n       * @type {EventTarget~Event}\n       */\n      this.trigger('textdata', data);\n    };\n\n    /**\n     * Get object for cached values.\n     *\n     * @return {Object}\n     *         get the current object cache\n     */\n\n\n    Player.prototype.getCache = function getCache() {\n      return this.cache_;\n    };\n\n    /**\n     * Pass values to the playback tech\n     *\n     * @param {string} [method]\n     *        the method to call\n     *\n     * @param {Object} arg\n     *        the argument to pass\n     *\n     * @private\n     */\n\n\n    Player.prototype.techCall_ = function techCall_(method, arg) {\n      // If it's not ready yet, call method when it is\n\n      this.ready(function () {\n        if (method in allowedSetters) {\n          return set$1(this.middleware_, this.tech_, method, arg);\n        } else if (method in allowedMediators) {\n          return mediate(this.middleware_, this.tech_, method, arg);\n        }\n\n        try {\n          if (this.tech_) {\n            this.tech_[method](arg);\n          }\n        } catch (e) {\n          log$1(e);\n          throw e;\n        }\n      }, true);\n    };\n\n    /**\n     * Get calls can't wait for the tech, and sometimes don't need to.\n     *\n     * @param {string} method\n     *        Tech method\n     *\n     * @return {Function|undefined}\n     *         the method or undefined\n     *\n     * @private\n     */\n\n\n    Player.prototype.techGet_ = function techGet_(method) {\n      if (!this.tech_ || !this.tech_.isReady_) {\n        return;\n      }\n\n      if (method in allowedGetters) {\n        return get$1(this.middleware_, this.tech_, method);\n      } else if (method in allowedMediators) {\n        return mediate(this.middleware_, this.tech_, method);\n      }\n\n      // Flash likes to die and reload when you hide or reposition it.\n      // In these cases the object methods go away and we get errors.\n      // When that happens we'll catch the errors and inform tech that it's not ready any more.\n      try {\n        return this.tech_[method]();\n      } catch (e) {\n\n        // When building additional tech libs, an expected method may not be defined yet\n        if (this.tech_[method] === undefined) {\n          log$1('Video.js: ' + method + ' method not defined for ' + this.techName_ + ' playback technology.', e);\n          throw e;\n        }\n\n        // When a method isn't available on the object it throws a TypeError\n        if (e.name === 'TypeError') {\n          log$1('Video.js: ' + method + ' unavailable on ' + this.techName_ + ' playback technology element.', e);\n          this.tech_.isReady_ = false;\n          throw e;\n        }\n\n        // If error unknown, just log and throw\n        log$1(e);\n        throw e;\n      }\n    };\n\n    /**\n     * Attempt to begin playback at the first opportunity.\n     *\n     * @return {Promise|undefined}\n     *         Returns a `Promise` only if the browser returns one and the player\n     *         is ready to begin playback. For some browsers and all non-ready\n     *         situations, this will return `undefined`.\n     */\n\n\n    Player.prototype.play = function play() {\n      var _this6 = this;\n\n      // If this is called while we have a play queued up on a loadstart, remove\n      // that listener to avoid getting in a potentially bad state.\n      if (this.playOnLoadstart_) {\n        this.off('loadstart', this.playOnLoadstart_);\n      }\n\n      // If the player/tech is not ready, queue up another call to `play()` for\n      // when it is. This will loop back into this method for another attempt at\n      // playback when the tech is ready.\n      if (!this.isReady_) {\n\n        // Bail out if we're already waiting for `ready`!\n        if (this.playWaitingForReady_) {\n          return;\n        }\n\n        this.playWaitingForReady_ = true;\n        this.ready(function () {\n          _this6.playWaitingForReady_ = false;\n          silencePromise(_this6.play());\n        });\n\n        // If the player/tech is ready and we have a source, we can attempt playback.\n      } else if (!this.changingSrc_ && (this.src() || this.currentSrc())) {\n        return this.techGet_('play');\n\n        // If the tech is ready, but we do not have a source, we'll need to wait\n        // for both the `ready` and a `loadstart` when the source is finally\n        // resolved by middleware and set on the player.\n        //\n        // This can happen if `play()` is called while changing sources or before\n        // one has been set on the player.\n      } else {\n\n        this.playOnLoadstart_ = function () {\n          _this6.playOnLoadstart_ = null;\n          silencePromise(_this6.play());\n        };\n\n        this.one('loadstart', this.playOnLoadstart_);\n      }\n    };\n\n    /**\n     * Pause the video playback\n     *\n     * @return {Player}\n     *         A reference to the player object this function was called on\n     */\n\n\n    Player.prototype.pause = function pause() {\n      this.techCall_('pause');\n    };\n\n    /**\n     * Check if the player is paused or has yet to play\n     *\n     * @return {boolean}\n     *         - false: if the media is currently playing\n     *         - true: if media is not currently playing\n     */\n\n\n    Player.prototype.paused = function paused() {\n      // The initial state of paused should be true (in Safari it's actually false)\n      return this.techGet_('paused') === false ? false : true;\n    };\n\n    /**\n     * Get a TimeRange object representing the current ranges of time that the user\n     * has played.\n     *\n     * @return {TimeRange}\n     *         A time range object that represents all the increments of time that have\n     *         been played.\n     */\n\n\n    Player.prototype.played = function played() {\n      return this.techGet_('played') || createTimeRanges(0, 0);\n    };\n\n    /**\n     * Returns whether or not the user is \"scrubbing\". Scrubbing is\n     * when the user has clicked the progress bar handle and is\n     * dragging it along the progress bar.\n     *\n     * @param {boolean} [isScrubbing]\n     *        whether the user is or is not scrubbing\n     *\n     * @return {boolean}\n     *         The value of scrubbing when getting\n     */\n\n\n    Player.prototype.scrubbing = function scrubbing(isScrubbing) {\n      if (typeof isScrubbing === 'undefined') {\n        return this.scrubbing_;\n      }\n      this.scrubbing_ = !!isScrubbing;\n\n      if (isScrubbing) {\n        this.addClass('vjs-scrubbing');\n      } else {\n        this.removeClass('vjs-scrubbing');\n      }\n    };\n\n    /**\n     * Get or set the current time (in seconds)\n     *\n     * @param {number|string} [seconds]\n     *        The time to seek to in seconds\n     *\n     * @return {number}\n     *         - the current time in seconds when getting\n     */\n\n\n    Player.prototype.currentTime = function currentTime(seconds) {\n      if (typeof seconds !== 'undefined') {\n        if (seconds < 0) {\n          seconds = 0;\n        }\n        this.techCall_('setCurrentTime', seconds);\n        return;\n      }\n\n      // cache last currentTime and return. default to 0 seconds\n      //\n      // Caching the currentTime is meant to prevent a massive amount of reads on the tech's\n      // currentTime when scrubbing, but may not provide much performance benefit afterall.\n      // Should be tested. Also something has to read the actual current time or the cache will\n      // never get updated.\n      this.cache_.currentTime = this.techGet_('currentTime') || 0;\n      return this.cache_.currentTime;\n    };\n\n    /**\n     * Normally gets the length in time of the video in seconds;\n     * in all but the rarest use cases an argument will NOT be passed to the method\n     *\n     * > **NOTE**: The video must have started loading before the duration can be\n     * known, and in the case of Flash, may not be known until the video starts\n     * playing.\n     *\n     * @fires Player#durationchange\n     *\n     * @param {number} [seconds]\n     *        The duration of the video to set in seconds\n     *\n     * @return {number}\n     *         - The duration of the video in seconds when getting\n     */\n\n\n    Player.prototype.duration = function duration(seconds) {\n      if (seconds === undefined) {\n        // return NaN if the duration is not known\n        return this.cache_.duration !== undefined ? this.cache_.duration : NaN;\n      }\n\n      seconds = parseFloat(seconds);\n\n      // Standardize on Infinity for signaling video is live\n      if (seconds < 0) {\n        seconds = Infinity;\n      }\n\n      if (seconds !== this.cache_.duration) {\n        // Cache the last set value for optimized scrubbing (esp. Flash)\n        this.cache_.duration = seconds;\n\n        if (seconds === Infinity) {\n          this.addClass('vjs-live');\n        } else {\n          this.removeClass('vjs-live');\n        }\n        /**\n         * @event Player#durationchange\n         * @type {EventTarget~Event}\n         */\n        this.trigger('durationchange');\n      }\n    };\n\n    /**\n     * Calculates how much time is left in the video. Not part\n     * of the native video API.\n     *\n     * @return {number}\n     *         The time remaining in seconds\n     */\n\n\n    Player.prototype.remainingTime = function remainingTime() {\n      return this.duration() - this.currentTime();\n    };\n\n    /**\n     * A remaining time function that is intented to be used when\n     * the time is to be displayed directly to the user.\n     *\n     * @return {number}\n     *         The rounded time remaining in seconds\n     */\n\n\n    Player.prototype.remainingTimeDisplay = function remainingTimeDisplay() {\n      return Math.floor(this.duration()) - Math.floor(this.currentTime());\n    };\n\n    //\n    // Kind of like an array of portions of the video that have been downloaded.\n\n    /**\n     * Get a TimeRange object with an array of the times of the video\n     * that have been downloaded. If you just want the percent of the\n     * video that's been downloaded, use bufferedPercent.\n     *\n     * @see [Buffered Spec]{@link http://dev.w3.org/html5/spec/video.html#dom-media-buffered}\n     *\n     * @return {TimeRange}\n     *         A mock TimeRange object (following HTML spec)\n     */\n\n\n    Player.prototype.buffered = function buffered() {\n      var buffered = this.techGet_('buffered');\n\n      if (!buffered || !buffered.length) {\n        buffered = createTimeRanges(0, 0);\n      }\n\n      return buffered;\n    };\n\n    /**\n     * Get the percent (as a decimal) of the video that's been downloaded.\n     * This method is not a part of the native HTML video API.\n     *\n     * @return {number}\n     *         A decimal between 0 and 1 representing the percent\n     *         that is buffered 0 being 0% and 1 being 100%\n     */\n\n\n    Player.prototype.bufferedPercent = function bufferedPercent$$1() {\n      return bufferedPercent(this.buffered(), this.duration());\n    };\n\n    /**\n     * Get the ending time of the last buffered time range\n     * This is used in the progress bar to encapsulate all time ranges.\n     *\n     * @return {number}\n     *         The end of the last buffered time range\n     */\n\n\n    Player.prototype.bufferedEnd = function bufferedEnd() {\n      var buffered = this.buffered();\n      var duration = this.duration();\n      var end = buffered.end(buffered.length - 1);\n\n      if (end > duration) {\n        end = duration;\n      }\n\n      return end;\n    };\n\n    /**\n     * Get or set the current volume of the media\n     *\n     * @param  {number} [percentAsDecimal]\n     *         The new volume as a decimal percent:\n     *         - 0 is muted/0%/off\n     *         - 1.0 is 100%/full\n     *         - 0.5 is half volume or 50%\n     *\n     * @return {number}\n     *         The current volume as a percent when getting\n     */\n\n\n    Player.prototype.volume = function volume(percentAsDecimal) {\n      var vol = void 0;\n\n      if (percentAsDecimal !== undefined) {\n        // Force value to between 0 and 1\n        vol = Math.max(0, Math.min(1, parseFloat(percentAsDecimal)));\n        this.cache_.volume = vol;\n        this.techCall_('setVolume', vol);\n\n        if (vol > 0) {\n          this.lastVolume_(vol);\n        }\n\n        return;\n      }\n\n      // Default to 1 when returning current volume.\n      vol = parseFloat(this.techGet_('volume'));\n      return isNaN(vol) ? 1 : vol;\n    };\n\n    /**\n     * Get the current muted state, or turn mute on or off\n     *\n     * @param {boolean} [muted]\n     *        - true to mute\n     *        - false to unmute\n     *\n     * @return {boolean}\n     *         - true if mute is on and getting\n     *         - false if mute is off and getting\n     */\n\n\n    Player.prototype.muted = function muted(_muted) {\n      if (_muted !== undefined) {\n        this.techCall_('setMuted', _muted);\n        return;\n      }\n      return this.techGet_('muted') || false;\n    };\n\n    /**\n     * Get the current defaultMuted state, or turn defaultMuted on or off. defaultMuted\n     * indicates the state of muted on initial playback.\n     *\n     * ```js\n     *   var myPlayer = videojs('some-player-id');\n     *\n     *   myPlayer.src(\"http://www.example.com/path/to/video.mp4\");\n     *\n     *   // get, should be false\n     *   console.log(myPlayer.defaultMuted());\n     *   // set to true\n     *   myPlayer.defaultMuted(true);\n     *   // get should be true\n     *   console.log(myPlayer.defaultMuted());\n     * ```\n     *\n     * @param {boolean} [defaultMuted]\n     *        - true to mute\n     *        - false to unmute\n     *\n     * @return {boolean|Player}\n     *         - true if defaultMuted is on and getting\n     *         - false if defaultMuted is off and getting\n     *         - A reference to the current player when setting\n     */\n\n\n    Player.prototype.defaultMuted = function defaultMuted(_defaultMuted) {\n      if (_defaultMuted !== undefined) {\n        return this.techCall_('setDefaultMuted', _defaultMuted);\n      }\n      return this.techGet_('defaultMuted') || false;\n    };\n\n    /**\n     * Get the last volume, or set it\n     *\n     * @param  {number} [percentAsDecimal]\n     *         The new last volume as a decimal percent:\n     *         - 0 is muted/0%/off\n     *         - 1.0 is 100%/full\n     *         - 0.5 is half volume or 50%\n     *\n     * @return {number}\n     *         the current value of lastVolume as a percent when getting\n     *\n     * @private\n     */\n\n\n    Player.prototype.lastVolume_ = function lastVolume_(percentAsDecimal) {\n      if (percentAsDecimal !== undefined && percentAsDecimal !== 0) {\n        this.cache_.lastVolume = percentAsDecimal;\n        return;\n      }\n      return this.cache_.lastVolume;\n    };\n\n    /**\n     * Check if current tech can support native fullscreen\n     * (e.g. with built in controls like iOS, so not our flash swf)\n     *\n     * @return {boolean}\n     *         if native fullscreen is supported\n     */\n\n\n    Player.prototype.supportsFullScreen = function supportsFullScreen() {\n      return this.techGet_('supportsFullScreen') || false;\n    };\n\n    /**\n     * Check if the player is in fullscreen mode or tell the player that it\n     * is or is not in fullscreen mode.\n     *\n     * > NOTE: As of the latest HTML5 spec, isFullscreen is no longer an official\n     * property and instead document.fullscreenElement is used. But isFullscreen is\n     * still a valuable property for internal player workings.\n     *\n     * @param  {boolean} [isFS]\n     *         Set the players current fullscreen state\n     *\n     * @return {boolean}\n     *         - true if fullscreen is on and getting\n     *         - false if fullscreen is off and getting\n     */\n\n\n    Player.prototype.isFullscreen = function isFullscreen(isFS) {\n      if (isFS !== undefined) {\n        this.isFullscreen_ = !!isFS;\n        return;\n      }\n      return !!this.isFullscreen_;\n    };\n\n    /**\n     * Increase the size of the video to full screen\n     * In some browsers, full screen is not supported natively, so it enters\n     * \"full window mode\", where the video fills the browser window.\n     * In browsers and devices that support native full screen, sometimes the\n     * browser's default controls will be shown, and not the Video.js custom skin.\n     * This includes most mobile devices (iOS, Android) and older versions of\n     * Safari.\n     *\n     * @fires Player#fullscreenchange\n     */\n\n\n    Player.prototype.requestFullscreen = function requestFullscreen() {\n      var fsApi = FullscreenApi;\n\n      this.isFullscreen(true);\n\n      if (fsApi.requestFullscreen) {\n        // the browser supports going fullscreen at the element level so we can\n        // take the controls fullscreen as well as the video\n\n        // Trigger fullscreenchange event after change\n        // We have to specifically add this each time, and remove\n        // when canceling fullscreen. Otherwise if there's multiple\n        // players on a page, they would all be reacting to the same fullscreen\n        // events\n        on(document_1, fsApi.fullscreenchange, bind(this, function documentFullscreenChange(e) {\n          this.isFullscreen(document_1[fsApi.fullscreenElement]);\n\n          // If cancelling fullscreen, remove event listener.\n          if (this.isFullscreen() === false) {\n            off(document_1, fsApi.fullscreenchange, documentFullscreenChange);\n          }\n          /**\n           * @event Player#fullscreenchange\n           * @type {EventTarget~Event}\n           */\n          this.trigger('fullscreenchange');\n        }));\n\n        this.el_[fsApi.requestFullscreen]();\n      } else if (this.tech_.supportsFullScreen()) {\n        // we can't take the video.js controls fullscreen but we can go fullscreen\n        // with native controls\n        this.techCall_('enterFullScreen');\n      } else {\n        // fullscreen isn't supported so we'll just stretch the video element to\n        // fill the viewport\n        this.enterFullWindow();\n        /**\n         * @event Player#fullscreenchange\n         * @type {EventTarget~Event}\n         */\n        this.trigger('fullscreenchange');\n      }\n    };\n\n    /**\n     * Return the video to its normal size after having been in full screen mode\n     *\n     * @fires Player#fullscreenchange\n     */\n\n\n    Player.prototype.exitFullscreen = function exitFullscreen() {\n      var fsApi = FullscreenApi;\n\n      this.isFullscreen(false);\n\n      // Check for browser element fullscreen support\n      if (fsApi.requestFullscreen) {\n        document_1[fsApi.exitFullscreen]();\n      } else if (this.tech_.supportsFullScreen()) {\n        this.techCall_('exitFullScreen');\n      } else {\n        this.exitFullWindow();\n        /**\n         * @event Player#fullscreenchange\n         * @type {EventTarget~Event}\n         */\n        this.trigger('fullscreenchange');\n      }\n    };\n\n    /**\n     * When fullscreen isn't supported we can stretch the\n     * video container to as wide as the browser will let us.\n     *\n     * @fires Player#enterFullWindow\n     */\n\n\n    Player.prototype.enterFullWindow = function enterFullWindow() {\n      this.isFullWindow = true;\n\n      // Storing original doc overflow value to return to when fullscreen is off\n      this.docOrigOverflow = document_1.documentElement.style.overflow;\n\n      // Add listener for esc key to exit fullscreen\n      on(document_1, 'keydown', bind(this, this.fullWindowOnEscKey));\n\n      // Hide any scroll bars\n      document_1.documentElement.style.overflow = 'hidden';\n\n      // Apply fullscreen styles\n      addClass(document_1.body, 'vjs-full-window');\n\n      /**\n       * @event Player#enterFullWindow\n       * @type {EventTarget~Event}\n       */\n      this.trigger('enterFullWindow');\n    };\n\n    /**\n     * Check for call to either exit full window or\n     * full screen on ESC key\n     *\n     * @param {string} event\n     *        Event to check for key press\n     */\n\n\n    Player.prototype.fullWindowOnEscKey = function fullWindowOnEscKey(event) {\n      if (event.keyCode === 27) {\n        if (this.isFullscreen() === true) {\n          this.exitFullscreen();\n        } else {\n          this.exitFullWindow();\n        }\n      }\n    };\n\n    /**\n     * Exit full window\n     *\n     * @fires Player#exitFullWindow\n     */\n\n\n    Player.prototype.exitFullWindow = function exitFullWindow() {\n      this.isFullWindow = false;\n      off(document_1, 'keydown', this.fullWindowOnEscKey);\n\n      // Unhide scroll bars.\n      document_1.documentElement.style.overflow = this.docOrigOverflow;\n\n      // Remove fullscreen styles\n      removeClass(document_1.body, 'vjs-full-window');\n\n      // Resize the box, controller, and poster to original sizes\n      // this.positionAll();\n      /**\n       * @event Player#exitFullWindow\n       * @type {EventTarget~Event}\n       */\n      this.trigger('exitFullWindow');\n    };\n\n    /**\n     * Check whether the player can play a given mimetype\n     *\n     * @see https://www.w3.org/TR/2011/WD-html5-20110113/video.html#dom-navigator-canplaytype\n     *\n     * @param {string} type\n     *        The mimetype to check\n     *\n     * @return {string}\n     *         'probably', 'maybe', or '' (empty string)\n     */\n\n\n    Player.prototype.canPlayType = function canPlayType(type) {\n      var can = void 0;\n\n      // Loop through each playback technology in the options order\n      for (var i = 0, j = this.options_.techOrder; i < j.length; i++) {\n        var techName = j[i];\n        var tech = Tech.getTech(techName);\n\n        // Support old behavior of techs being registered as components.\n        // Remove once that deprecated behavior is removed.\n        if (!tech) {\n          tech = Component.getComponent(techName);\n        }\n\n        // Check if the current tech is defined before continuing\n        if (!tech) {\n          log$1.error('The \"' + techName + '\" tech is undefined. Skipped browser support check for that tech.');\n          continue;\n        }\n\n        // Check if the browser supports this technology\n        if (tech.isSupported()) {\n          can = tech.canPlayType(type);\n\n          if (can) {\n            return can;\n          }\n        }\n      }\n\n      return '';\n    };\n\n    /**\n     * Select source based on tech-order or source-order\n     * Uses source-order selection if `options.sourceOrder` is truthy. Otherwise,\n     * defaults to tech-order selection\n     *\n     * @param {Array} sources\n     *        The sources for a media asset\n     *\n     * @return {Object|boolean}\n     *         Object of source and tech order or false\n     */\n\n\n    Player.prototype.selectSource = function selectSource(sources) {\n      var _this7 = this;\n\n      // Get only the techs specified in `techOrder` that exist and are supported by the\n      // current platform\n      var techs = this.options_.techOrder.map(function (techName) {\n        return [techName, Tech.getTech(techName)];\n      }).filter(function (_ref) {\n        var techName = _ref[0],\n            tech = _ref[1];\n\n        // Check if the current tech is defined before continuing\n        if (tech) {\n          // Check if the browser supports this technology\n          return tech.isSupported();\n        }\n\n        log$1.error('The \"' + techName + '\" tech is undefined. Skipped browser support check for that tech.');\n        return false;\n      });\n\n      // Iterate over each `innerArray` element once per `outerArray` element and execute\n      // `tester` with both. If `tester` returns a non-falsy value, exit early and return\n      // that value.\n      var findFirstPassingTechSourcePair = function findFirstPassingTechSourcePair(outerArray, innerArray, tester) {\n        var found = void 0;\n\n        outerArray.some(function (outerChoice) {\n          return innerArray.some(function (innerChoice) {\n            found = tester(outerChoice, innerChoice);\n\n            if (found) {\n              return true;\n            }\n          });\n        });\n\n        return found;\n      };\n\n      var foundSourceAndTech = void 0;\n      var flip = function flip(fn) {\n        return function (a, b) {\n          return fn(b, a);\n        };\n      };\n      var finder = function finder(_ref2, source) {\n        var techName = _ref2[0],\n            tech = _ref2[1];\n\n        if (tech.canPlaySource(source, _this7.options_[techName.toLowerCase()])) {\n          return { source: source, tech: techName };\n        }\n      };\n\n      // Depending on the truthiness of `options.sourceOrder`, we swap the order of techs and sources\n      // to select from them based on their priority.\n      if (this.options_.sourceOrder) {\n        // Source-first ordering\n        foundSourceAndTech = findFirstPassingTechSourcePair(sources, techs, flip(finder));\n      } else {\n        // Tech-first ordering\n        foundSourceAndTech = findFirstPassingTechSourcePair(techs, sources, finder);\n      }\n\n      return foundSourceAndTech || false;\n    };\n\n    /**\n     * Get or set the video source.\n     *\n     * @param {Tech~SourceObject|Tech~SourceObject[]|string} [source]\n     *        A SourceObject, an array of SourceObjects, or a string referencing\n     *        a URL to a media source. It is _highly recommended_ that an object\n     *        or array of objects is used here, so that source selection\n     *        algorithms can take the `type` into account.\n     *\n     *        If not provided, this method acts as a getter.\n     *\n     * @return {string|undefined}\n     *         If the `source` argument is missing, returns the current source\n     *         URL. Otherwise, returns nothing/undefined.\n     */\n\n\n    Player.prototype.src = function src(source) {\n      var _this8 = this;\n\n      // getter usage\n      if (typeof source === 'undefined') {\n        return this.cache_.src || '';\n      }\n      // filter out invalid sources and turn our source into\n      // an array of source objects\n      var sources = filterSource(source);\n\n      // if a source was passed in then it is invalid because\n      // it was filtered to a zero length Array. So we have to\n      // show an error\n      if (!sources.length) {\n        this.setTimeout(function () {\n          this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) });\n        }, 0);\n        return;\n      }\n\n      // intial sources\n      this.changingSrc_ = true;\n\n      this.cache_.sources = sources;\n      this.updateSourceCaches_(sources[0]);\n\n      // middlewareSource is the source after it has been changed by middleware\n      setSource(this, sources[0], function (middlewareSource, mws) {\n        _this8.middleware_ = mws;\n\n        // since sourceSet is async we have to update the cache again after we select a source since\n        // the source that is selected could be out of order from the cache update above this callback.\n        _this8.cache_.sources = sources;\n        _this8.updateSourceCaches_(middlewareSource);\n\n        var err = _this8.src_(middlewareSource);\n\n        if (err) {\n          if (sources.length > 1) {\n            return _this8.src(sources.slice(1));\n          }\n\n          _this8.changingSrc_ = false;\n\n          // We need to wrap this in a timeout to give folks a chance to add error event handlers\n          _this8.setTimeout(function () {\n            this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) });\n          }, 0);\n\n          // we could not find an appropriate tech, but let's still notify the delegate that this is it\n          // this needs a better comment about why this is needed\n          _this8.triggerReady();\n\n          return;\n        }\n\n        setTech(mws, _this8.tech_);\n      });\n    };\n\n    /**\n     * Set the source object on the tech, returns a boolean that indicates whether\n     * there is a tech that can play the source or not\n     *\n     * @param {Tech~SourceObject} source\n     *        The source object to set on the Tech\n     *\n     * @return {Boolean}\n     *         - True if there is no Tech to playback this source\n     *         - False otherwise\n     *\n     * @private\n     */\n\n\n    Player.prototype.src_ = function src_(source) {\n      var _this9 = this;\n\n      var sourceTech = this.selectSource([source]);\n\n      if (!sourceTech) {\n        return true;\n      }\n\n      if (!titleCaseEquals(sourceTech.tech, this.techName_)) {\n        this.changingSrc_ = true;\n        // load this technology with the chosen source\n        this.loadTech_(sourceTech.tech, sourceTech.source);\n        this.tech_.ready(function () {\n          _this9.changingSrc_ = false;\n        });\n        return false;\n      }\n\n      // wait until the tech is ready to set the source\n      // and set it synchronously if possible (#2326)\n      this.ready(function () {\n\n        // The setSource tech method was added with source handlers\n        // so older techs won't support it\n        // We need to check the direct prototype for the case where subclasses\n        // of the tech do not support source handlers\n        if (this.tech_.constructor.prototype.hasOwnProperty('setSource')) {\n          this.techCall_('setSource', source);\n        } else {\n          this.techCall_('src', source.src);\n        }\n\n        this.changingSrc_ = false;\n      }, true);\n\n      return false;\n    };\n\n    /**\n     * Begin loading the src data.\n     */\n\n\n    Player.prototype.load = function load() {\n      this.techCall_('load');\n    };\n\n    /**\n     * Reset the player. Loads the first tech in the techOrder,\n     * and calls `reset` on the tech`.\n     */\n\n\n    Player.prototype.reset = function reset() {\n      this.loadTech_(this.options_.techOrder[0], null);\n      this.techCall_('reset');\n    };\n\n    /**\n     * Returns all of the current source objects.\n     *\n     * @return {Tech~SourceObject[]}\n     *         The current source objects\n     */\n\n\n    Player.prototype.currentSources = function currentSources() {\n      var source = this.currentSource();\n      var sources = [];\n\n      // assume `{}` or `{ src }`\n      if (Object.keys(source).length !== 0) {\n        sources.push(source);\n      }\n\n      return this.cache_.sources || sources;\n    };\n\n    /**\n     * Returns the current source object.\n     *\n     * @return {Tech~SourceObject}\n     *         The current source object\n     */\n\n\n    Player.prototype.currentSource = function currentSource() {\n      return this.cache_.source || {};\n    };\n\n    /**\n     * Returns the fully qualified URL of the current source value e.g. http://mysite.com/video.mp4\n     * Can be used in conjunction with `currentType` to assist in rebuilding the current source object.\n     *\n     * @return {string}\n     *         The current source\n     */\n\n\n    Player.prototype.currentSrc = function currentSrc() {\n      return this.currentSource() && this.currentSource().src || '';\n    };\n\n    /**\n     * Get the current source type e.g. video/mp4\n     * This can allow you rebuild the current source object so that you could load the same\n     * source and tech later\n     *\n     * @return {string}\n     *         The source MIME type\n     */\n\n\n    Player.prototype.currentType = function currentType() {\n      return this.currentSource() && this.currentSource().type || '';\n    };\n\n    /**\n     * Get or set the preload attribute\n     *\n     * @param {boolean} [value]\n     *        - true means that we should preload\n     *        - false means that we should not preload\n     *\n     * @return {string}\n     *         The preload attribute value when getting\n     */\n\n\n    Player.prototype.preload = function preload(value) {\n      if (value !== undefined) {\n        this.techCall_('setPreload', value);\n        this.options_.preload = value;\n        return;\n      }\n      return this.techGet_('preload');\n    };\n\n    /**\n     * Get or set the autoplay attribute.\n     *\n     * @param {boolean} [value]\n     *        - true means that we should autoplay\n     *        - false means that we should not autoplay\n     *\n     * @return {string}\n     *         The current value of autoplay when getting\n     */\n\n\n    Player.prototype.autoplay = function autoplay(value) {\n      if (value !== undefined) {\n        this.techCall_('setAutoplay', value);\n        this.options_.autoplay = value;\n        return;\n      }\n      return this.techGet_('autoplay', value);\n    };\n\n    /**\n     * Set or unset the playsinline attribute.\n     * Playsinline tells the browser that non-fullscreen playback is preferred.\n     *\n     * @param {boolean} [value]\n     *        - true means that we should try to play inline by default\n     *        - false means that we should use the browser's default playback mode,\n     *          which in most cases is inline. iOS Safari is a notable exception\n     *          and plays fullscreen by default.\n     *\n     * @return {string|Player}\n     *         - the current value of playsinline\n     *         - the player when setting\n     *\n     * @see [Spec]{@link https://html.spec.whatwg.org/#attr-video-playsinline}\n     */\n\n\n    Player.prototype.playsinline = function playsinline(value) {\n      if (value !== undefined) {\n        this.techCall_('setPlaysinline', value);\n        this.options_.playsinline = value;\n        return this;\n      }\n      return this.techGet_('playsinline');\n    };\n\n    /**\n     * Get or set the loop attribute on the video element.\n     *\n     * @param {boolean} [value]\n     *        - true means that we should loop the video\n     *        - false means that we should not loop the video\n     *\n     * @return {string}\n     *         The current value of loop when getting\n     */\n\n\n    Player.prototype.loop = function loop(value) {\n      if (value !== undefined) {\n        this.techCall_('setLoop', value);\n        this.options_.loop = value;\n        return;\n      }\n      return this.techGet_('loop');\n    };\n\n    /**\n     * Get or set the poster image source url\n     *\n     * @fires Player#posterchange\n     *\n     * @param {string} [src]\n     *        Poster image source URL\n     *\n     * @return {string}\n     *         The current value of poster when getting\n     */\n\n\n    Player.prototype.poster = function poster(src) {\n      if (src === undefined) {\n        return this.poster_;\n      }\n\n      // The correct way to remove a poster is to set as an empty string\n      // other falsey values will throw errors\n      if (!src) {\n        src = '';\n      }\n\n      if (src === this.poster_) {\n        return;\n      }\n\n      // update the internal poster variable\n      this.poster_ = src;\n\n      // update the tech's poster\n      this.techCall_('setPoster', src);\n\n      this.isPosterFromTech_ = false;\n\n      // alert components that the poster has been set\n      /**\n       * This event fires when the poster image is changed on the player.\n       *\n       * @event Player#posterchange\n       * @type {EventTarget~Event}\n       */\n      this.trigger('posterchange');\n    };\n\n    /**\n     * Some techs (e.g. YouTube) can provide a poster source in an\n     * asynchronous way. We want the poster component to use this\n     * poster source so that it covers up the tech's controls.\n     * (YouTube's play button). However we only want to use this\n     * source if the player user hasn't set a poster through\n     * the normal APIs.\n     *\n     * @fires Player#posterchange\n     * @listens Tech#posterchange\n     * @private\n     */\n\n\n    Player.prototype.handleTechPosterChange_ = function handleTechPosterChange_() {\n      if ((!this.poster_ || this.options_.techCanOverridePoster) && this.tech_ && this.tech_.poster) {\n        var newPoster = this.tech_.poster() || '';\n\n        if (newPoster !== this.poster_) {\n          this.poster_ = newPoster;\n          this.isPosterFromTech_ = true;\n\n          // Let components know the poster has changed\n          this.trigger('posterchange');\n        }\n      }\n    };\n\n    /**\n     * Get or set whether or not the controls are showing.\n     *\n     * @fires Player#controlsenabled\n     *\n     * @param {boolean} [bool]\n     *        - true to turn controls on\n     *        - false to turn controls off\n     *\n     * @return {boolean}\n     *         The current value of controls when getting\n     */\n\n\n    Player.prototype.controls = function controls(bool) {\n      if (bool === undefined) {\n        return !!this.controls_;\n      }\n\n      bool = !!bool;\n\n      // Don't trigger a change event unless it actually changed\n      if (this.controls_ === bool) {\n        return;\n      }\n\n      this.controls_ = bool;\n\n      if (this.usingNativeControls()) {\n        this.techCall_('setControls', bool);\n      }\n\n      if (this.controls_) {\n        this.removeClass('vjs-controls-disabled');\n        this.addClass('vjs-controls-enabled');\n        /**\n         * @event Player#controlsenabled\n         * @type {EventTarget~Event}\n         */\n        this.trigger('controlsenabled');\n        if (!this.usingNativeControls()) {\n          this.addTechControlsListeners_();\n        }\n      } else {\n        this.removeClass('vjs-controls-enabled');\n        this.addClass('vjs-controls-disabled');\n        /**\n         * @event Player#controlsdisabled\n         * @type {EventTarget~Event}\n         */\n        this.trigger('controlsdisabled');\n        if (!this.usingNativeControls()) {\n          this.removeTechControlsListeners_();\n        }\n      }\n    };\n\n    /**\n     * Toggle native controls on/off. Native controls are the controls built into\n     * devices (e.g. default iPhone controls), Flash, or other techs\n     * (e.g. Vimeo Controls)\n     * **This should only be set by the current tech, because only the tech knows\n     * if it can support native controls**\n     *\n     * @fires Player#usingnativecontrols\n     * @fires Player#usingcustomcontrols\n     *\n     * @param {boolean} [bool]\n     *        - true to turn native controls on\n     *        - false to turn native controls off\n     *\n     * @return {boolean}\n     *         The current value of native controls when getting\n     */\n\n\n    Player.prototype.usingNativeControls = function usingNativeControls(bool) {\n      if (bool === undefined) {\n        return !!this.usingNativeControls_;\n      }\n\n      bool = !!bool;\n\n      // Don't trigger a change event unless it actually changed\n      if (this.usingNativeControls_ === bool) {\n        return;\n      }\n\n      this.usingNativeControls_ = bool;\n\n      if (this.usingNativeControls_) {\n        this.addClass('vjs-using-native-controls');\n\n        /**\n         * player is using the native device controls\n         *\n         * @event Player#usingnativecontrols\n         * @type {EventTarget~Event}\n         */\n        this.trigger('usingnativecontrols');\n      } else {\n        this.removeClass('vjs-using-native-controls');\n\n        /**\n         * player is using the custom HTML controls\n         *\n         * @event Player#usingcustomcontrols\n         * @type {EventTarget~Event}\n         */\n        this.trigger('usingcustomcontrols');\n      }\n    };\n\n    /**\n     * Set or get the current MediaError\n     *\n     * @fires Player#error\n     *\n     * @param  {MediaError|string|number} [err]\n     *         A MediaError or a string/number to be turned\n     *         into a MediaError\n     *\n     * @return {MediaError|null}\n     *         The current MediaError when getting (or null)\n     */\n\n\n    Player.prototype.error = function error(err) {\n      if (err === undefined) {\n        return this.error_ || null;\n      }\n\n      // restoring to default\n      if (err === null) {\n        this.error_ = err;\n        this.removeClass('vjs-error');\n        if (this.errorDisplay) {\n          this.errorDisplay.close();\n        }\n        return;\n      }\n\n      this.error_ = new MediaError(err);\n\n      // add the vjs-error classname to the player\n      this.addClass('vjs-error');\n\n      // log the name of the error type and any message\n      // IE11 logs \"[object object]\" and required you to expand message to see error object\n      log$1.error('(CODE:' + this.error_.code + ' ' + MediaError.errorTypes[this.error_.code] + ')', this.error_.message, this.error_);\n\n      /**\n       * @event Player#error\n       * @type {EventTarget~Event}\n       */\n      this.trigger('error');\n\n      return;\n    };\n\n    /**\n     * Report user activity\n     *\n     * @param {Object} event\n     *        Event object\n     */\n\n\n    Player.prototype.reportUserActivity = function reportUserActivity(event) {\n      this.userActivity_ = true;\n    };\n\n    /**\n     * Get/set if user is active\n     *\n     * @fires Player#useractive\n     * @fires Player#userinactive\n     *\n     * @param {boolean} [bool]\n     *        - true if the user is active\n     *        - false if the user is inactive\n     *\n     * @return {boolean}\n     *         The current value of userActive when getting\n     */\n\n\n    Player.prototype.userActive = function userActive(bool) {\n      if (bool === undefined) {\n        return this.userActive_;\n      }\n\n      bool = !!bool;\n\n      if (bool === this.userActive_) {\n        return;\n      }\n\n      this.userActive_ = bool;\n\n      if (this.userActive_) {\n        this.userActivity_ = true;\n        this.removeClass('vjs-user-inactive');\n        this.addClass('vjs-user-active');\n        /**\n         * @event Player#useractive\n         * @type {EventTarget~Event}\n         */\n        this.trigger('useractive');\n        return;\n      }\n\n      // Chrome/Safari/IE have bugs where when you change the cursor it can\n      // trigger a mousemove event. This causes an issue when you're hiding\n      // the cursor when the user is inactive, and a mousemove signals user\n      // activity. Making it impossible to go into inactive mode. Specifically\n      // this happens in fullscreen when we really need to hide the cursor.\n      //\n      // When this gets resolved in ALL browsers it can be removed\n      // https://code.google.com/p/chromium/issues/detail?id=103041\n      if (this.tech_) {\n        this.tech_.one('mousemove', function (e) {\n          e.stopPropagation();\n          e.preventDefault();\n        });\n      }\n\n      this.userActivity_ = false;\n      this.removeClass('vjs-user-active');\n      this.addClass('vjs-user-inactive');\n      /**\n       * @event Player#userinactive\n       * @type {EventTarget~Event}\n       */\n      this.trigger('userinactive');\n    };\n\n    /**\n     * Listen for user activity based on timeout value\n     *\n     * @private\n     */\n\n\n    Player.prototype.listenForUserActivity_ = function listenForUserActivity_() {\n      var mouseInProgress = void 0;\n      var lastMoveX = void 0;\n      var lastMoveY = void 0;\n      var handleActivity = bind(this, this.reportUserActivity);\n\n      var handleMouseMove = function handleMouseMove(e) {\n        // #1068 - Prevent mousemove spamming\n        // Chrome Bug: https://code.google.com/p/chromium/issues/detail?id=366970\n        if (e.screenX !== lastMoveX || e.screenY !== lastMoveY) {\n          lastMoveX = e.screenX;\n          lastMoveY = e.screenY;\n          handleActivity();\n        }\n      };\n\n      var handleMouseDown = function handleMouseDown() {\n        handleActivity();\n        // For as long as the they are touching the device or have their mouse down,\n        // we consider them active even if they're not moving their finger or mouse.\n        // So we want to continue to update that they are active\n        this.clearInterval(mouseInProgress);\n        // Setting userActivity=true now and setting the interval to the same time\n        // as the activityCheck interval (250) should ensure we never miss the\n        // next activityCheck\n        mouseInProgress = this.setInterval(handleActivity, 250);\n      };\n\n      var handleMouseUp = function handleMouseUp(event) {\n        handleActivity();\n        // Stop the interval that maintains activity if the mouse/touch is down\n        this.clearInterval(mouseInProgress);\n      };\n\n      // Any mouse movement will be considered user activity\n      this.on('mousedown', handleMouseDown);\n      this.on('mousemove', handleMouseMove);\n      this.on('mouseup', handleMouseUp);\n\n      // Listen for keyboard navigation\n      // Shouldn't need to use inProgress interval because of key repeat\n      this.on('keydown', handleActivity);\n      this.on('keyup', handleActivity);\n\n      // Run an interval every 250 milliseconds instead of stuffing everything into\n      // the mousemove/touchmove function itself, to prevent performance degradation.\n      // `this.reportUserActivity` simply sets this.userActivity_ to true, which\n      // then gets picked up by this loop\n      // http://ejohn.org/blog/learning-from-twitter/\n      var inactivityTimeout = void 0;\n\n      this.setInterval(function () {\n        // Check to see if mouse/touch activity has happened\n        if (!this.userActivity_) {\n          return;\n        }\n\n        // Reset the activity tracker\n        this.userActivity_ = false;\n\n        // If the user state was inactive, set the state to active\n        this.userActive(true);\n\n        // Clear any existing inactivity timeout to start the timer over\n        this.clearTimeout(inactivityTimeout);\n\n        var timeout = this.options_.inactivityTimeout;\n\n        if (timeout <= 0) {\n          return;\n        }\n\n        // In <timeout> milliseconds, if no more activity has occurred the\n        // user will be considered inactive\n        inactivityTimeout = this.setTimeout(function () {\n          // Protect against the case where the inactivityTimeout can trigger just\n          // before the next user activity is picked up by the activity check loop\n          // causing a flicker\n          if (!this.userActivity_) {\n            this.userActive(false);\n          }\n        }, timeout);\n      }, 250);\n    };\n\n    /**\n     * Gets or sets the current playback rate. A playback rate of\n     * 1.0 represents normal speed and 0.5 would indicate half-speed\n     * playback, for instance.\n     *\n     * @see https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-playbackrate\n     *\n     * @param {number} [rate]\n     *       New playback rate to set.\n     *\n     * @return {number}\n     *         The current playback rate when getting or 1.0\n     */\n\n\n    Player.prototype.playbackRate = function playbackRate(rate) {\n      if (rate !== undefined) {\n        // NOTE: this.cache_.lastPlaybackRate is set from the tech handler\n        // that is registered above\n        this.techCall_('setPlaybackRate', rate);\n        return;\n      }\n\n      if (this.tech_ && this.tech_.featuresPlaybackRate) {\n        return this.cache_.lastPlaybackRate || this.techGet_('playbackRate');\n      }\n      return 1.0;\n    };\n\n    /**\n     * Gets or sets the current default playback rate. A default playback rate of\n     * 1.0 represents normal speed and 0.5 would indicate half-speed playback, for instance.\n     * defaultPlaybackRate will only represent what the initial playbackRate of a video was, not\n     * not the current playbackRate.\n     *\n     * @see https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-defaultplaybackrate\n     *\n     * @param {number} [rate]\n     *       New default playback rate to set.\n     *\n     * @return {number|Player}\n     *         - The default playback rate when getting or 1.0\n     *         - the player when setting\n     */\n\n\n    Player.prototype.defaultPlaybackRate = function defaultPlaybackRate(rate) {\n      if (rate !== undefined) {\n        return this.techCall_('setDefaultPlaybackRate', rate);\n      }\n\n      if (this.tech_ && this.tech_.featuresPlaybackRate) {\n        return this.techGet_('defaultPlaybackRate');\n      }\n      return 1.0;\n    };\n\n    /**\n     * Gets or sets the audio flag\n     *\n     * @param {boolean} bool\n     *        - true signals that this is an audio player\n     *        - false signals that this is not an audio player\n     *\n     * @return {boolean}\n     *         The current value of isAudio when getting\n     */\n\n\n    Player.prototype.isAudio = function isAudio(bool) {\n      if (bool !== undefined) {\n        this.isAudio_ = !!bool;\n        return;\n      }\n\n      return !!this.isAudio_;\n    };\n\n    /**\n     * A helper method for adding a {@link TextTrack} to our\n     * {@link TextTrackList}.\n     *\n     * In addition to the W3C settings we allow adding additional info through options.\n     *\n     * @see http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#dom-media-addtexttrack\n     *\n     * @param {string} [kind]\n     *        the kind of TextTrack you are adding\n     *\n     * @param {string} [label]\n     *        the label to give the TextTrack label\n     *\n     * @param {string} [language]\n     *        the language to set on the TextTrack\n     *\n     * @return {TextTrack|undefined}\n     *         the TextTrack that was added or undefined\n     *         if there is no tech\n     */\n\n\n    Player.prototype.addTextTrack = function addTextTrack(kind, label, language) {\n      if (this.tech_) {\n        return this.tech_.addTextTrack(kind, label, language);\n      }\n    };\n\n    /**\n     * Create a remote {@link TextTrack} and an {@link HTMLTrackElement}. It will\n     * automatically removed from the video element whenever the source changes, unless\n     * manualCleanup is set to false.\n     *\n     * @param {Object} options\n     *        Options to pass to {@link HTMLTrackElement} during creation. See\n     *        {@link HTMLTrackElement} for object properties that you should use.\n     *\n     * @param {boolean} [manualCleanup=true] if set to false, the TextTrack will be\n     *\n     * @return {HtmlTrackElement}\n     *         the HTMLTrackElement that was created and added\n     *         to the HtmlTrackElementList and the remote\n     *         TextTrackList\n     *\n     * @deprecated The default value of the \"manualCleanup\" parameter will default\n     *             to \"false\" in upcoming versions of Video.js\n     */\n\n\n    Player.prototype.addRemoteTextTrack = function addRemoteTextTrack(options, manualCleanup) {\n      if (this.tech_) {\n        return this.tech_.addRemoteTextTrack(options, manualCleanup);\n      }\n    };\n\n    /**\n     * Remove a remote {@link TextTrack} from the respective\n     * {@link TextTrackList} and {@link HtmlTrackElementList}.\n     *\n     * @param {Object} track\n     *        Remote {@link TextTrack} to remove\n     *\n     * @return {undefined}\n     *         does not return anything\n     */\n\n\n    Player.prototype.removeRemoteTextTrack = function removeRemoteTextTrack() {\n      var _ref3 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref3$track = _ref3.track,\n          track = _ref3$track === undefined ? arguments[0] : _ref3$track;\n\n      // destructure the input into an object with a track argument, defaulting to arguments[0]\n      // default the whole argument to an empty object if nothing was passed in\n\n      if (this.tech_) {\n        return this.tech_.removeRemoteTextTrack(track);\n      }\n    };\n\n    /**\n     * Gets available media playback quality metrics as specified by the W3C's Media\n     * Playback Quality API.\n     *\n     * @see [Spec]{@link https://wicg.github.io/media-playback-quality}\n     *\n     * @return {Object|undefined}\n     *         An object with supported media playback quality metrics or undefined if there\n     *         is no tech or the tech does not support it.\n     */\n\n\n    Player.prototype.getVideoPlaybackQuality = function getVideoPlaybackQuality() {\n      return this.techGet_('getVideoPlaybackQuality');\n    };\n\n    /**\n     * Get video width\n     *\n     * @return {number}\n     *         current video width\n     */\n\n\n    Player.prototype.videoWidth = function videoWidth() {\n      return this.tech_ && this.tech_.videoWidth && this.tech_.videoWidth() || 0;\n    };\n\n    /**\n     * Get video height\n     *\n     * @return {number}\n     *         current video height\n     */\n\n\n    Player.prototype.videoHeight = function videoHeight() {\n      return this.tech_ && this.tech_.videoHeight && this.tech_.videoHeight() || 0;\n    };\n\n    /**\n     * The player's language code\n     * NOTE: The language should be set in the player options if you want the\n     * the controls to be built with a specific language. Changing the language\n     * later will not update controls text.\n     *\n     * @param {string} [code]\n     *        the language code to set the player to\n     *\n     * @return {string}\n     *         The current language code when getting\n     */\n\n\n    Player.prototype.language = function language(code) {\n      if (code === undefined) {\n        return this.language_;\n      }\n\n      this.language_ = String(code).toLowerCase();\n    };\n\n    /**\n     * Get the player's language dictionary\n     * Merge every time, because a newly added plugin might call videojs.addLanguage() at any time\n     * Languages specified directly in the player options have precedence\n     *\n     * @return {Array}\n     *         An array of of supported languages\n     */\n\n\n    Player.prototype.languages = function languages() {\n      return mergeOptions(Player.prototype.options_.languages, this.languages_);\n    };\n\n    /**\n     * returns a JavaScript object reperesenting the current track\n     * information. **DOES not return it as JSON**\n     *\n     * @return {Object}\n     *         Object representing the current of track info\n     */\n\n\n    Player.prototype.toJSON = function toJSON() {\n      var options = mergeOptions(this.options_);\n      var tracks = options.tracks;\n\n      options.tracks = [];\n\n      for (var i = 0; i < tracks.length; i++) {\n        var track = tracks[i];\n\n        // deep merge tracks and null out player so no circular references\n        track = mergeOptions(track);\n        track.player = undefined;\n        options.tracks[i] = track;\n      }\n\n      return options;\n    };\n\n    /**\n     * Creates a simple modal dialog (an instance of the {@link ModalDialog}\n     * component) that immediately overlays the player with arbitrary\n     * content and removes itself when closed.\n     *\n     * @param {string|Function|Element|Array|null} content\n     *        Same as {@link ModalDialog#content}'s param of the same name.\n     *        The most straight-forward usage is to provide a string or DOM\n     *        element.\n     *\n     * @param {Object} [options]\n     *        Extra options which will be passed on to the {@link ModalDialog}.\n     *\n     * @return {ModalDialog}\n     *         the {@link ModalDialog} that was created\n     */\n\n\n    Player.prototype.createModal = function createModal(content, options) {\n      var _this10 = this;\n\n      options = options || {};\n      options.content = content || '';\n\n      var modal = new ModalDialog(this, options);\n\n      this.addChild(modal);\n      modal.on('dispose', function () {\n        _this10.removeChild(modal);\n      });\n\n      modal.open();\n      return modal;\n    };\n\n    /**\n     * Gets tag settings\n     *\n     * @param {Element} tag\n     *        The player tag\n     *\n     * @return {Object}\n     *         An object containing all of the settings\n     *         for a player tag\n     */\n\n\n    Player.getTagSettings = function getTagSettings(tag) {\n      var baseOptions = {\n        sources: [],\n        tracks: []\n      };\n\n      var tagOptions = getAttributes(tag);\n      var dataSetup = tagOptions['data-setup'];\n\n      if (hasClass(tag, 'vjs-fluid')) {\n        tagOptions.fluid = true;\n      }\n\n      // Check if data-setup attr exists.\n      if (dataSetup !== null) {\n        // Parse options JSON\n        // If empty string, make it a parsable json object.\n        var _safeParseTuple = tuple(dataSetup || '{}'),\n            err = _safeParseTuple[0],\n            data = _safeParseTuple[1];\n\n        if (err) {\n          log$1.error(err);\n        }\n        assign(tagOptions, data);\n      }\n\n      assign(baseOptions, tagOptions);\n\n      // Get tag children settings\n      if (tag.hasChildNodes()) {\n        var children = tag.childNodes;\n\n        for (var i = 0, j = children.length; i < j; i++) {\n          var child = children[i];\n          // Change case needed: http://ejohn.org/blog/nodename-case-sensitivity/\n          var childName = child.nodeName.toLowerCase();\n\n          if (childName === 'source') {\n            baseOptions.sources.push(getAttributes(child));\n          } else if (childName === 'track') {\n            baseOptions.tracks.push(getAttributes(child));\n          }\n        }\n      }\n\n      return baseOptions;\n    };\n\n    /**\n     * Determine whether or not flexbox is supported\n     *\n     * @return {boolean}\n     *         - true if flexbox is supported\n     *         - false if flexbox is not supported\n     */\n\n\n    Player.prototype.flexNotSupported_ = function flexNotSupported_() {\n      var elem = document_1.createElement('i');\n\n      // Note: We don't actually use flexBasis (or flexOrder), but it's one of the more\n      // common flex features that we can rely on when checking for flex support.\n      return !('flexBasis' in elem.style || 'webkitFlexBasis' in elem.style || 'mozFlexBasis' in elem.style || 'msFlexBasis' in elem.style ||\n      // IE10-specific (2012 flex spec), available for completeness\n      'msFlexOrder' in elem.style);\n    };\n\n    return Player;\n  }(Component);\n\n  /**\n   * Get the {@link VideoTrackList}\n   * @link https://html.spec.whatwg.org/multipage/embedded-content.html#videotracklist\n   *\n   * @return {VideoTrackList}\n   *         the current video track list\n   *\n   * @method Player.prototype.videoTracks\n   */\n\n  /**\n   * Get the {@link AudioTrackList}\n   * @link https://html.spec.whatwg.org/multipage/embedded-content.html#audiotracklist\n   *\n   * @return {AudioTrackList}\n   *         the current audio track list\n   *\n   * @method Player.prototype.audioTracks\n   */\n\n  /**\n   * Get the {@link TextTrackList}\n   *\n   * @link http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#dom-media-texttracks\n   *\n   * @return {TextTrackList}\n   *         the current text track list\n   *\n   * @method Player.prototype.textTracks\n   */\n\n  /**\n   * Get the remote {@link TextTrackList}\n   *\n   * @return {TextTrackList}\n   *         The current remote text track list\n   *\n   * @method Player.prototype.remoteTextTracks\n   */\n\n  /**\n   * Get the remote {@link HtmlTrackElementList} tracks.\n   *\n   * @return {HtmlTrackElementList}\n   *         The current remote text track element list\n   *\n   * @method Player.prototype.remoteTextTrackEls\n   */\n\n  ALL.names.forEach(function (name$$1) {\n    var props = ALL[name$$1];\n\n    Player.prototype[props.getterName] = function () {\n      if (this.tech_) {\n        return this.tech_[props.getterName]();\n      }\n\n      // if we have not yet loadTech_, we create {video,audio,text}Tracks_\n      // these will be passed to the tech during loading\n      this[props.privateName] = this[props.privateName] || new props.ListClass();\n      return this[props.privateName];\n    };\n  });\n\n  /**\n   * Global player list\n   *\n   * @type {Object}\n   */\n  Player.players = {};\n\n  var navigator = window_1.navigator;\n\n  /*\n   * Player instance options, surfaced using options\n   * options = Player.prototype.options_\n   * Make changes in options, not here.\n   *\n   * @type {Object}\n   * @private\n   */\n  Player.prototype.options_ = {\n    // Default order of fallback technology\n    techOrder: Tech.defaultTechOrder_,\n\n    html5: {},\n    flash: {},\n\n    // default inactivity timeout\n    inactivityTimeout: 2000,\n\n    // default playback rates\n    playbackRates: [],\n    // Add playback rate selection by adding rates\n    // 'playbackRates': [0.5, 1, 1.5, 2],\n\n    // Included control sets\n    children: ['mediaLoader', 'posterImage', 'textTrackDisplay', 'loadingSpinner', 'bigPlayButton', 'controlBar', 'errorDisplay', 'textTrackSettings', 'resizeManager'],\n\n    language: navigator && (navigator.languages && navigator.languages[0] || navigator.userLanguage || navigator.language) || 'en',\n\n    // locales and their language translations\n    languages: {},\n\n    // Default message to show when a video cannot be played.\n    notSupportedMessage: 'No compatible source was found for this media.'\n  };\n\n  [\n  /**\n   * Returns whether or not the player is in the \"ended\" state.\n   *\n   * @return {Boolean} True if the player is in the ended state, false if not.\n   * @method Player#ended\n   */\n  'ended',\n  /**\n   * Returns whether or not the player is in the \"seeking\" state.\n   *\n   * @return {Boolean} True if the player is in the seeking state, false if not.\n   * @method Player#seeking\n   */\n  'seeking',\n  /**\n   * Returns the TimeRanges of the media that are currently available\n   * for seeking to.\n   *\n   * @return {TimeRanges} the seekable intervals of the media timeline\n   * @method Player#seekable\n   */\n  'seekable',\n  /**\n   * Returns the current state of network activity for the element, from\n   * the codes in the list below.\n   * - NETWORK_EMPTY (numeric value 0)\n   *   The element has not yet been initialised. All attributes are in\n   *   their initial states.\n   * - NETWORK_IDLE (numeric value 1)\n   *   The element's resource selection algorithm is active and has\n   *   selected a resource, but it is not actually using the network at\n   *   this time.\n   * - NETWORK_LOADING (numeric value 2)\n   *   The user agent is actively trying to download data.\n   * - NETWORK_NO_SOURCE (numeric value 3)\n   *   The element's resource selection algorithm is active, but it has\n   *   not yet found a resource to use.\n   *\n   * @see https://html.spec.whatwg.org/multipage/embedded-content.html#network-states\n   * @return {number} the current network activity state\n   * @method Player#networkState\n   */\n  'networkState',\n  /**\n   * Returns a value that expresses the current state of the element\n   * with respect to rendering the current playback position, from the\n   * codes in the list below.\n   * - HAVE_NOTHING (numeric value 0)\n   *   No information regarding the media resource is available.\n   * - HAVE_METADATA (numeric value 1)\n   *   Enough of the resource has been obtained that the duration of the\n   *   resource is available.\n   * - HAVE_CURRENT_DATA (numeric value 2)\n   *   Data for the immediate current playback position is available.\n   * - HAVE_FUTURE_DATA (numeric value 3)\n   *   Data for the immediate current playback position is available, as\n   *   well as enough data for the user agent to advance the current\n   *   playback position in the direction of playback.\n   * - HAVE_ENOUGH_DATA (numeric value 4)\n   *   The user agent estimates that enough data is available for\n   *   playback to proceed uninterrupted.\n   *\n   * @see https://html.spec.whatwg.org/multipage/embedded-content.html#dom-media-readystate\n   * @return {number} the current playback rendering state\n   * @method Player#readyState\n   */\n  'readyState'].forEach(function (fn) {\n    Player.prototype[fn] = function () {\n      return this.techGet_(fn);\n    };\n  });\n\n  TECH_EVENTS_RETRIGGER.forEach(function (event) {\n    Player.prototype['handleTech' + toTitleCase(event) + '_'] = function () {\n      return this.trigger(event);\n    };\n  });\n\n  /**\n   * Fired when the player has initial duration and dimension information\n   *\n   * @event Player#loadedmetadata\n   * @type {EventTarget~Event}\n   */\n\n  /**\n   * Fired when the player has downloaded data at the current playback position\n   *\n   * @event Player#loadeddata\n   * @type {EventTarget~Event}\n   */\n\n  /**\n   * Fired when the current playback position has changed *\n   * During playback this is fired every 15-250 milliseconds, depending on the\n   * playback technology in use.\n   *\n   * @event Player#timeupdate\n   * @type {EventTarget~Event}\n   */\n\n  /**\n   * Fired when the volume changes\n   *\n   * @event Player#volumechange\n   * @type {EventTarget~Event}\n   */\n\n  /**\n   * Reports whether or not a player has a plugin available.\n   *\n   * This does not report whether or not the plugin has ever been initialized\n   * on this player. For that, [usingPlugin]{@link Player#usingPlugin}.\n   *\n   * @method Player#hasPlugin\n   * @param  {string}  name\n   *         The name of a plugin.\n   *\n   * @return {boolean}\n   *         Whether or not this player has the requested plugin available.\n   */\n\n  /**\n   * Reports whether or not a player is using a plugin by name.\n   *\n   * For basic plugins, this only reports whether the plugin has _ever_ been\n   * initialized on this player.\n   *\n   * @method Player#usingPlugin\n   * @param  {string} name\n   *         The name of a plugin.\n   *\n   * @return {boolean}\n   *         Whether or not this player is using the requested plugin.\n   */\n\n  Component.registerComponent('Player', Player);\n\n  /**\n   * @file plugin.js\n   */\n\n  /**\n   * The base plugin name.\n   *\n   * @private\n   * @constant\n   * @type {string}\n   */\n  var BASE_PLUGIN_NAME = 'plugin';\n\n  /**\n   * The key on which a player's active plugins cache is stored.\n   *\n   * @private\n   * @constant\n   * @type     {string}\n   */\n  var PLUGIN_CACHE_KEY = 'activePlugins_';\n\n  /**\n   * Stores registered plugins in a private space.\n   *\n   * @private\n   * @type    {Object}\n   */\n  var pluginStorage = {};\n\n  /**\n   * Reports whether or not a plugin has been registered.\n   *\n   * @private\n   * @param   {string} name\n   *          The name of a plugin.\n   *\n   * @returns {boolean}\n   *          Whether or not the plugin has been registered.\n   */\n  var pluginExists = function pluginExists(name) {\n    return pluginStorage.hasOwnProperty(name);\n  };\n\n  /**\n   * Get a single registered plugin by name.\n   *\n   * @private\n   * @param   {string} name\n   *          The name of a plugin.\n   *\n   * @returns {Function|undefined}\n   *          The plugin (or undefined).\n   */\n  var getPlugin = function getPlugin(name) {\n    return pluginExists(name) ? pluginStorage[name] : undefined;\n  };\n\n  /**\n   * Marks a plugin as \"active\" on a player.\n   *\n   * Also, ensures that the player has an object for tracking active plugins.\n   *\n   * @private\n   * @param   {Player} player\n   *          A Video.js player instance.\n   *\n   * @param   {string} name\n   *          The name of a plugin.\n   */\n  var markPluginAsActive = function markPluginAsActive(player, name) {\n    player[PLUGIN_CACHE_KEY] = player[PLUGIN_CACHE_KEY] || {};\n    player[PLUGIN_CACHE_KEY][name] = true;\n  };\n\n  /**\n   * Triggers a pair of plugin setup events.\n   *\n   * @private\n   * @param  {Player} player\n   *         A Video.js player instance.\n   *\n   * @param  {Plugin~PluginEventHash} hash\n   *         A plugin event hash.\n   *\n   * @param  {Boolean} [before]\n   *         If true, prefixes the event name with \"before\". In other words,\n   *         use this to trigger \"beforepluginsetup\" instead of \"pluginsetup\".\n   */\n  var triggerSetupEvent = function triggerSetupEvent(player, hash, before) {\n    var eventName = (before ? 'before' : '') + 'pluginsetup';\n\n    player.trigger(eventName, hash);\n    player.trigger(eventName + ':' + hash.name, hash);\n  };\n\n  /**\n   * Takes a basic plugin function and returns a wrapper function which marks\n   * on the player that the plugin has been activated.\n   *\n   * @private\n   * @param   {string} name\n   *          The name of the plugin.\n   *\n   * @param   {Function} plugin\n   *          The basic plugin.\n   *\n   * @returns {Function}\n   *          A wrapper function for the given plugin.\n   */\n  var createBasicPlugin = function createBasicPlugin(name, plugin) {\n    var basicPluginWrapper = function basicPluginWrapper() {\n\n      // We trigger the \"beforepluginsetup\" and \"pluginsetup\" events on the player\n      // regardless, but we want the hash to be consistent with the hash provided\n      // for advanced plugins.\n      //\n      // The only potentially counter-intuitive thing here is the `instance` in\n      // the \"pluginsetup\" event is the value returned by the `plugin` function.\n      triggerSetupEvent(this, { name: name, plugin: plugin, instance: null }, true);\n\n      var instance = plugin.apply(this, arguments);\n\n      markPluginAsActive(this, name);\n      triggerSetupEvent(this, { name: name, plugin: plugin, instance: instance });\n\n      return instance;\n    };\n\n    Object.keys(plugin).forEach(function (prop) {\n      basicPluginWrapper[prop] = plugin[prop];\n    });\n\n    return basicPluginWrapper;\n  };\n\n  /**\n   * Takes a plugin sub-class and returns a factory function for generating\n   * instances of it.\n   *\n   * This factory function will replace itself with an instance of the requested\n   * sub-class of Plugin.\n   *\n   * @private\n   * @param   {string} name\n   *          The name of the plugin.\n   *\n   * @param   {Plugin} PluginSubClass\n   *          The advanced plugin.\n   *\n   * @returns {Function}\n   */\n  var createPluginFactory = function createPluginFactory(name, PluginSubClass) {\n\n    // Add a `name` property to the plugin prototype so that each plugin can\n    // refer to itself by name.\n    PluginSubClass.prototype.name = name;\n\n    return function () {\n      triggerSetupEvent(this, { name: name, plugin: PluginSubClass, instance: null }, true);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var instance = new (Function.prototype.bind.apply(PluginSubClass, [null].concat([this].concat(args))))();\n\n      // The plugin is replaced by a function that returns the current instance.\n      this[name] = function () {\n        return instance;\n      };\n\n      triggerSetupEvent(this, instance.getEventHash());\n\n      return instance;\n    };\n  };\n\n  /**\n   * Parent class for all advanced plugins.\n   *\n   * @mixes   module:evented~EventedMixin\n   * @mixes   module:stateful~StatefulMixin\n   * @fires   Player#beforepluginsetup\n   * @fires   Player#beforepluginsetup:$name\n   * @fires   Player#pluginsetup\n   * @fires   Player#pluginsetup:$name\n   * @listens Player#dispose\n   * @throws  {Error}\n   *          If attempting to instantiate the base {@link Plugin} class\n   *          directly instead of via a sub-class.\n   */\n\n  var Plugin = function () {\n\n    /**\n     * Creates an instance of this class.\n     *\n     * Sub-classes should call `super` to ensure plugins are properly initialized.\n     *\n     * @param {Player} player\n     *        A Video.js player instance.\n     */\n    function Plugin(player) {\n      classCallCheck(this, Plugin);\n\n      if (this.constructor === Plugin) {\n        throw new Error('Plugin must be sub-classed; not directly instantiated.');\n      }\n\n      this.player = player;\n\n      // Make this object evented, but remove the added `trigger` method so we\n      // use the prototype version instead.\n      evented(this);\n      delete this.trigger;\n\n      stateful(this, this.constructor.defaultState);\n      markPluginAsActive(player, this.name);\n\n      // Auto-bind the dispose method so we can use it as a listener and unbind\n      // it later easily.\n      this.dispose = bind(this, this.dispose);\n\n      // If the player is disposed, dispose the plugin.\n      player.on('dispose', this.dispose);\n    }\n\n    /**\n     * Get the version of the plugin that was set on <pluginName>.VERSION\n     */\n\n\n    Plugin.prototype.version = function version() {\n      return this.constructor.VERSION;\n    };\n\n    /**\n     * Each event triggered by plugins includes a hash of additional data with\n     * conventional properties.\n     *\n     * This returns that object or mutates an existing hash.\n     *\n     * @param   {Object} [hash={}]\n     *          An object to be used as event an event hash.\n     *\n     * @returns {Plugin~PluginEventHash}\n     *          An event hash object with provided properties mixed-in.\n     */\n\n\n    Plugin.prototype.getEventHash = function getEventHash() {\n      var hash = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      hash.name = this.name;\n      hash.plugin = this.constructor;\n      hash.instance = this;\n      return hash;\n    };\n\n    /**\n     * Triggers an event on the plugin object and overrides\n     * {@link module:evented~EventedMixin.trigger|EventedMixin.trigger}.\n     *\n     * @param   {string|Object} event\n     *          An event type or an object with a type property.\n     *\n     * @param   {Object} [hash={}]\n     *          Additional data hash to merge with a\n     *          {@link Plugin~PluginEventHash|PluginEventHash}.\n     *\n     * @returns {boolean}\n     *          Whether or not default was prevented.\n     */\n\n\n    Plugin.prototype.trigger = function trigger$$1(event) {\n      var hash = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      return trigger(this.eventBusEl_, event, this.getEventHash(hash));\n    };\n\n    /**\n     * Handles \"statechanged\" events on the plugin. No-op by default, override by\n     * subclassing.\n     *\n     * @abstract\n     * @param    {Event} e\n     *           An event object provided by a \"statechanged\" event.\n     *\n     * @param    {Object} e.changes\n     *           An object describing changes that occurred with the \"statechanged\"\n     *           event.\n     */\n\n\n    Plugin.prototype.handleStateChanged = function handleStateChanged(e) {};\n\n    /**\n     * Disposes a plugin.\n     *\n     * Subclasses can override this if they want, but for the sake of safety,\n     * it's probably best to subscribe the \"dispose\" event.\n     *\n     * @fires Plugin#dispose\n     */\n\n\n    Plugin.prototype.dispose = function dispose() {\n      var name = this.name,\n          player = this.player;\n\n      /**\n       * Signals that a advanced plugin is about to be disposed.\n       *\n       * @event Plugin#dispose\n       * @type  {EventTarget~Event}\n       */\n\n      this.trigger('dispose');\n      this.off();\n      player.off('dispose', this.dispose);\n\n      // Eliminate any possible sources of leaking memory by clearing up\n      // references between the player and the plugin instance and nulling out\n      // the plugin's state and replacing methods with a function that throws.\n      player[PLUGIN_CACHE_KEY][name] = false;\n      this.player = this.state = null;\n\n      // Finally, replace the plugin name on the player with a new factory\n      // function, so that the plugin is ready to be set up again.\n      player[name] = createPluginFactory(name, pluginStorage[name]);\n    };\n\n    /**\n     * Determines if a plugin is a basic plugin (i.e. not a sub-class of `Plugin`).\n     *\n     * @param   {string|Function} plugin\n     *          If a string, matches the name of a plugin. If a function, will be\n     *          tested directly.\n     *\n     * @returns {boolean}\n     *          Whether or not a plugin is a basic plugin.\n     */\n\n\n    Plugin.isBasic = function isBasic(plugin) {\n      var p = typeof plugin === 'string' ? getPlugin(plugin) : plugin;\n\n      return typeof p === 'function' && !Plugin.prototype.isPrototypeOf(p.prototype);\n    };\n\n    /**\n     * Register a Video.js plugin.\n     *\n     * @param   {string} name\n     *          The name of the plugin to be registered. Must be a string and\n     *          must not match an existing plugin or a method on the `Player`\n     *          prototype.\n     *\n     * @param   {Function} plugin\n     *          A sub-class of `Plugin` or a function for basic plugins.\n     *\n     * @returns {Function}\n     *          For advanced plugins, a factory function for that plugin. For\n     *          basic plugins, a wrapper function that initializes the plugin.\n     */\n\n\n    Plugin.registerPlugin = function registerPlugin(name, plugin) {\n      if (typeof name !== 'string') {\n        throw new Error('Illegal plugin name, \"' + name + '\", must be a string, was ' + (typeof name === 'undefined' ? 'undefined' : _typeof(name)) + '.');\n      }\n\n      if (pluginExists(name)) {\n        log$1.warn('A plugin named \"' + name + '\" already exists. You may want to avoid re-registering plugins!');\n      } else if (Player.prototype.hasOwnProperty(name)) {\n        throw new Error('Illegal plugin name, \"' + name + '\", cannot share a name with an existing player method!');\n      }\n\n      if (typeof plugin !== 'function') {\n        throw new Error('Illegal plugin for \"' + name + '\", must be a function, was ' + (typeof plugin === 'undefined' ? 'undefined' : _typeof(plugin)) + '.');\n      }\n\n      pluginStorage[name] = plugin;\n\n      // Add a player prototype method for all sub-classed plugins (but not for\n      // the base Plugin class).\n      if (name !== BASE_PLUGIN_NAME) {\n        if (Plugin.isBasic(plugin)) {\n          Player.prototype[name] = createBasicPlugin(name, plugin);\n        } else {\n          Player.prototype[name] = createPluginFactory(name, plugin);\n        }\n      }\n\n      return plugin;\n    };\n\n    /**\n     * De-register a Video.js plugin.\n     *\n     * @param {string} name\n     *        The name of the plugin to be deregistered.\n     */\n\n\n    Plugin.deregisterPlugin = function deregisterPlugin(name) {\n      if (name === BASE_PLUGIN_NAME) {\n        throw new Error('Cannot de-register base plugin.');\n      }\n      if (pluginExists(name)) {\n        delete pluginStorage[name];\n        delete Player.prototype[name];\n      }\n    };\n\n    /**\n     * Gets an object containing multiple Video.js plugins.\n     *\n     * @param   {Array} [names]\n     *          If provided, should be an array of plugin names. Defaults to _all_\n     *          plugin names.\n     *\n     * @returns {Object|undefined}\n     *          An object containing plugin(s) associated with their name(s) or\n     *          `undefined` if no matching plugins exist).\n     */\n\n\n    Plugin.getPlugins = function getPlugins() {\n      var names = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Object.keys(pluginStorage);\n\n      var result = void 0;\n\n      names.forEach(function (name) {\n        var plugin = getPlugin(name);\n\n        if (plugin) {\n          result = result || {};\n          result[name] = plugin;\n        }\n      });\n\n      return result;\n    };\n\n    /**\n     * Gets a plugin's version, if available\n     *\n     * @param   {string} name\n     *          The name of a plugin.\n     *\n     * @returns {string}\n     *          The plugin's version or an empty string.\n     */\n\n\n    Plugin.getPluginVersion = function getPluginVersion(name) {\n      var plugin = getPlugin(name);\n\n      return plugin && plugin.VERSION || '';\n    };\n\n    return Plugin;\n  }();\n\n  /**\n   * Gets a plugin by name if it exists.\n   *\n   * @static\n   * @method   getPlugin\n   * @memberOf Plugin\n   * @param    {string} name\n   *           The name of a plugin.\n   *\n   * @returns  {Function|undefined}\n   *           The plugin (or `undefined`).\n   */\n\n\n  Plugin.getPlugin = getPlugin;\n\n  /**\n   * The name of the base plugin class as it is registered.\n   *\n   * @type {string}\n   */\n  Plugin.BASE_PLUGIN_NAME = BASE_PLUGIN_NAME;\n\n  Plugin.registerPlugin(BASE_PLUGIN_NAME, Plugin);\n\n  /**\n   * Documented in player.js\n   *\n   * @ignore\n   */\n  Player.prototype.usingPlugin = function (name) {\n    return !!this[PLUGIN_CACHE_KEY] && this[PLUGIN_CACHE_KEY][name] === true;\n  };\n\n  /**\n   * Documented in player.js\n   *\n   * @ignore\n   */\n  Player.prototype.hasPlugin = function (name) {\n    return !!pluginExists(name);\n  };\n\n  /**\n   * @file extend.js\n   * @module extend\n   */\n\n  /**\n   * A combination of node inherits and babel's inherits (after transpile).\n   * Both work the same but node adds `super_` to the subClass\n   * and Bable adds the superClass as __proto__. Both seem useful.\n   *\n   * @param {Object} subClass\n   *        The class to inherit to\n   *\n   * @param {Object} superClass\n   *        The class to inherit from\n   *\n   * @private\n   */\n  var _inherits = function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function, not ' + (typeof superClass === 'undefined' ? 'undefined' : _typeof(superClass)));\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n\n    if (superClass) {\n      // node\n      subClass.super_ = superClass;\n    }\n  };\n\n  /**\n   * Function for subclassing using the same inheritance that\n   * videojs uses internally\n   *\n   * @static\n   * @const\n   *\n   * @param {Object} superClass\n   *        The class to inherit from\n   *\n   * @param {Object} [subClassMethods={}]\n   *        The class to inherit to\n   *\n   * @return {Object}\n   *         The new object with subClassMethods that inherited superClass.\n   */\n  var extendFn = function extendFn(superClass) {\n    var subClassMethods = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var subClass = function subClass() {\n      superClass.apply(this, arguments);\n    };\n\n    var methods = {};\n\n    if ((typeof subClassMethods === 'undefined' ? 'undefined' : _typeof(subClassMethods)) === 'object') {\n      if (subClassMethods.constructor !== Object.prototype.constructor) {\n        subClass = subClassMethods.constructor;\n      }\n      methods = subClassMethods;\n    } else if (typeof subClassMethods === 'function') {\n      subClass = subClassMethods;\n    }\n\n    _inherits(subClass, superClass);\n\n    // Extend subObj's prototype with functions and other properties from props\n    for (var name in methods) {\n      if (methods.hasOwnProperty(name)) {\n        subClass.prototype[name] = methods[name];\n      }\n    }\n\n    return subClass;\n  };\n\n  /**\n   * @file video.js\n   * @module videojs\n   */\n\n  /**\n   * Normalize an `id` value by trimming off a leading `#`\n   *\n   * @param   {string} id\n   *          A string, maybe with a leading `#`.\n   *\n   * @returns {string}\n   *          The string, without any leading `#`.\n   */\n  var normalizeId = function normalizeId(id) {\n    return id.indexOf('#') === 0 ? id.slice(1) : id;\n  };\n\n  /**\n   * Doubles as the main function for users to create a player instance and also\n   * the main library object.\n   * The `videojs` function can be used to initialize or retrieve a player.\n    *\n   * @param {string|Element} id\n   *        Video element or video element ID\n   *\n   * @param {Object} [options]\n   *        Optional options object for config/settings\n   *\n   * @param {Component~ReadyCallback} [ready]\n   *        Optional ready callback\n   *\n   * @return {Player}\n   *         A player instance\n   */\n  function videojs$1(id, options, ready) {\n    var player = videojs$1.getPlayer(id);\n\n    if (player) {\n      if (options) {\n        log$1.warn('Player \"' + id + '\" is already initialised. Options will not be applied.');\n      }\n      if (ready) {\n        player.ready(ready);\n      }\n      return player;\n    }\n\n    var el = typeof id === 'string' ? $('#' + normalizeId(id)) : id;\n\n    if (!isEl(el)) {\n      throw new TypeError('The element or ID supplied is not valid. (videojs)');\n    }\n\n    if (!document_1.body.contains(el)) {\n      log$1.warn('The element supplied is not included in the DOM');\n    }\n\n    options = options || {};\n\n    videojs$1.hooks('beforesetup').forEach(function (hookFunction) {\n      var opts = hookFunction(el, mergeOptions(options));\n\n      if (!isObject(opts) || Array.isArray(opts)) {\n        log$1.error('please return an object in beforesetup hooks');\n        return;\n      }\n\n      options = mergeOptions(options, opts);\n    });\n\n    // We get the current \"Player\" component here in case an integration has\n    // replaced it with a custom player.\n    var PlayerComponent = Component.getComponent('Player');\n\n    player = new PlayerComponent(el, options, ready);\n\n    videojs$1.hooks('setup').forEach(function (hookFunction) {\n      return hookFunction(player);\n    });\n\n    return player;\n  }\n\n  /**\n   * An Object that contains lifecycle hooks as keys which point to an array\n   * of functions that are run when a lifecycle is triggered\n   */\n  videojs$1.hooks_ = {};\n\n  /**\n   * Get a list of hooks for a specific lifecycle\n   * @function videojs.hooks\n   *\n   * @param {string} type\n   *        the lifecyle to get hooks from\n   *\n   * @param {Function|Function[]} [fn]\n   *        Optionally add a hook (or hooks) to the lifecycle that your are getting.\n   *\n   * @return {Array}\n   *         an array of hooks, or an empty array if there are none.\n   */\n  videojs$1.hooks = function (type, fn) {\n    videojs$1.hooks_[type] = videojs$1.hooks_[type] || [];\n    if (fn) {\n      videojs$1.hooks_[type] = videojs$1.hooks_[type].concat(fn);\n    }\n    return videojs$1.hooks_[type];\n  };\n\n  /**\n   * Add a function hook to a specific videojs lifecycle.\n   *\n   * @param {string} type\n   *        the lifecycle to hook the function to.\n   *\n   * @param {Function|Function[]}\n   *        The function or array of functions to attach.\n   */\n  videojs$1.hook = function (type, fn) {\n    videojs$1.hooks(type, fn);\n  };\n\n  /**\n   * Add a function hook that will only run once to a specific videojs lifecycle.\n   *\n   * @param {string} type\n   *        the lifecycle to hook the function to.\n   *\n   * @param {Function|Function[]}\n   *        The function or array of functions to attach.\n   */\n  videojs$1.hookOnce = function (type, fn) {\n    videojs$1.hooks(type, [].concat(fn).map(function (original) {\n      var wrapper = function wrapper() {\n        videojs$1.removeHook(type, wrapper);\n        return original.apply(undefined, arguments);\n      };\n\n      return wrapper;\n    }));\n  };\n\n  /**\n   * Remove a hook from a specific videojs lifecycle.\n   *\n   * @param {string} type\n   *        the lifecycle that the function hooked to\n   *\n   * @param {Function} fn\n   *        The hooked function to remove\n   *\n   * @return {boolean}\n   *         The function that was removed or undef\n   */\n  videojs$1.removeHook = function (type, fn) {\n    var index = videojs$1.hooks(type).indexOf(fn);\n\n    if (index <= -1) {\n      return false;\n    }\n\n    videojs$1.hooks_[type] = videojs$1.hooks_[type].slice();\n    videojs$1.hooks_[type].splice(index, 1);\n\n    return true;\n  };\n\n  // Add default styles\n  if (window_1.VIDEOJS_NO_DYNAMIC_STYLE !== true && isReal()) {\n    var style$1 = $('.vjs-styles-defaults');\n\n    if (!style$1) {\n      style$1 = createStyleElement('vjs-styles-defaults');\n      var head = $('head');\n\n      if (head) {\n        head.insertBefore(style$1, head.firstChild);\n      }\n      setTextContent(style$1, '\\n      .video-js {\\n        width: 300px;\\n        height: 150px;\\n      }\\n\\n      .vjs-fluid {\\n        padding-top: 56.25%\\n      }\\n    ');\n    }\n  }\n\n  // Run Auto-load players\n  // You have to wait at least once in case this script is loaded after your\n  // video in the DOM (weird behavior only with minified version)\n  autoSetupTimeout(1, videojs$1);\n\n  /**\n   * Current software version. Follows semver.\n   *\n   * @type {string}\n   */\n  videojs$1.VERSION = version;\n\n  /**\n   * The global options object. These are the settings that take effect\n   * if no overrides are specified when the player is created.\n   *\n   * @type {Object}\n   */\n  videojs$1.options = Player.prototype.options_;\n\n  /**\n   * Get an object with the currently created players, keyed by player ID\n   *\n   * @return {Object}\n   *         The created players\n   */\n  videojs$1.getPlayers = function () {\n    return Player.players;\n  };\n\n  /**\n   * Get a single player based on an ID or DOM element.\n   *\n   * This is useful if you want to check if an element or ID has an associated\n   * Video.js player, but not create one if it doesn't.\n   *\n   * @param   {string|Element} id\n   *          An HTML element - `<video>`, `<audio>`, or `<video-js>` -\n   *          or a string matching the `id` of such an element.\n   *\n   * @returns {Player|undefined}\n   *          A player instance or `undefined` if there is no player instance\n   *          matching the argument.\n   */\n  videojs$1.getPlayer = function (id) {\n    var players = Player.players;\n    var tag = void 0;\n\n    if (typeof id === 'string') {\n      var nId = normalizeId(id);\n      var player = players[nId];\n\n      if (player) {\n        return player;\n      }\n\n      tag = $('#' + nId);\n    } else {\n      tag = id;\n    }\n\n    if (isEl(tag)) {\n      var _tag = tag,\n          _player = _tag.player,\n          playerId = _tag.playerId;\n\n      // Element may have a `player` property referring to an already created\n      // player instance. If so, return that.\n\n      if (_player || players[playerId]) {\n        return _player || players[playerId];\n      }\n    }\n  };\n\n  /**\n   * Returns an array of all current players.\n   *\n   * @return {Array}\n   *         An array of all players. The array will be in the order that\n   *         `Object.keys` provides, which could potentially vary between\n   *         JavaScript engines.\n   *\n   */\n  videojs$1.getAllPlayers = function () {\n    return (\n\n      // Disposed players leave a key with a `null` value, so we need to make sure\n      // we filter those out.\n      Object.keys(Player.players).map(function (k) {\n        return Player.players[k];\n      }).filter(Boolean)\n    );\n  };\n\n  /**\n   * Expose players object.\n   *\n   * @memberOf videojs\n   * @property {Object} players\n   */\n  videojs$1.players = Player.players;\n\n  /**\n   * Get a component class object by name\n   *\n   * @borrows Component.getComponent as videojs.getComponent\n   */\n  videojs$1.getComponent = Component.getComponent;\n\n  /**\n   * Register a component so it can referred to by name. Used when adding to other\n   * components, either through addChild `component.addChild('myComponent')` or through\n   * default children options  `{ children: ['myComponent'] }`.\n   *\n   * > NOTE: You could also just initialize the component before adding.\n   * `component.addChild(new MyComponent());`\n   *\n   * @param {string} name\n   *        The class name of the component\n   *\n   * @param {Component} comp\n   *        The component class\n   *\n   * @return {Component}\n   *         The newly registered component\n   */\n  videojs$1.registerComponent = function (name$$1, comp) {\n    if (Tech.isTech(comp)) {\n      log$1.warn('The ' + name$$1 + ' tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)');\n    }\n\n    Component.registerComponent.call(Component, name$$1, comp);\n  };\n\n  /**\n   * Get a Tech class object by name\n   *\n   * @borrows Tech.getTech as videojs.getTech\n   */\n  videojs$1.getTech = Tech.getTech;\n\n  /**\n   * Register a Tech so it can referred to by name.\n   * This is used in the tech order for the player.\n   *\n   * @borrows Tech.registerTech as videojs.registerTech\n   */\n  videojs$1.registerTech = Tech.registerTech;\n\n  /**\n   * Register a middleware to a source type.\n   *\n   * @param {String} type A string representing a MIME type.\n   * @param {function(player):object} middleware A middleware factory that takes a player.\n   */\n  videojs$1.use = use;\n\n  /**\n   * An object that can be returned by a middleware to signify\n   * that the middleware is being terminated.\n   *\n   * @type {object}\n   * @memberOf {videojs}\n   * @property {object} middleware.TERMINATOR\n   */\n  Object.defineProperty(videojs$1, 'middleware', {\n    value: {},\n    writeable: false,\n    enumerable: true\n  });\n\n  Object.defineProperty(videojs$1.middleware, 'TERMINATOR', {\n    value: TERMINATOR,\n    writeable: false,\n    enumerable: true\n  });\n\n  /**\n   * A suite of browser and device tests from {@link browser}.\n   *\n   * @type {Object}\n   * @private\n   */\n  videojs$1.browser = browser;\n\n  /**\n   * Whether or not the browser supports touch events. Included for backward\n   * compatibility with 4.x, but deprecated. Use `videojs.browser.TOUCH_ENABLED`\n   * instead going forward.\n   *\n   * @deprecated since version 5.0\n   * @type {boolean}\n   */\n  videojs$1.TOUCH_ENABLED = TOUCH_ENABLED;\n\n  /**\n   * Subclass an existing class\n   * Mimics ES6 subclassing with the `extend` keyword\n   *\n   * @borrows extend:extendFn as videojs.extend\n   */\n  videojs$1.extend = extendFn;\n\n  /**\n   * Merge two options objects recursively\n   * Performs a deep merge like lodash.merge but **only merges plain objects**\n   * (not arrays, elements, anything else)\n   * Other values will be copied directly from the second object.\n   *\n   * @borrows merge-options:mergeOptions as videojs.mergeOptions\n   */\n  videojs$1.mergeOptions = mergeOptions;\n\n  /**\n   * Change the context (this) of a function\n   *\n   * > NOTE: as of v5.0 we require an ES5 shim, so you should use the native\n   * `function() {}.bind(newContext);` instead of this.\n   *\n   * @borrows fn:bind as videojs.bind\n   */\n  videojs$1.bind = bind;\n\n  /**\n   * Register a Video.js plugin.\n   *\n   * @borrows plugin:registerPlugin as videojs.registerPlugin\n   * @method registerPlugin\n   *\n   * @param  {string} name\n   *         The name of the plugin to be registered. Must be a string and\n   *         must not match an existing plugin or a method on the `Player`\n   *         prototype.\n   *\n   * @param  {Function} plugin\n   *         A sub-class of `Plugin` or a function for basic plugins.\n   *\n   * @return {Function}\n   *         For advanced plugins, a factory function for that plugin. For\n   *         basic plugins, a wrapper function that initializes the plugin.\n   */\n  videojs$1.registerPlugin = Plugin.registerPlugin;\n\n  /**\n   * Deprecated method to register a plugin with Video.js\n   *\n   * @deprecated\n   *        videojs.plugin() is deprecated; use videojs.registerPlugin() instead\n   *\n   * @param {string} name\n   *        The plugin name\n   *\n   * @param {Plugin|Function} plugin\n   *         The plugin sub-class or function\n   */\n  videojs$1.plugin = function (name$$1, plugin) {\n    log$1.warn('videojs.plugin() is deprecated; use videojs.registerPlugin() instead');\n    return Plugin.registerPlugin(name$$1, plugin);\n  };\n\n  /**\n   * Gets an object containing multiple Video.js plugins.\n   *\n   * @param  {Array} [names]\n   *         If provided, should be an array of plugin names. Defaults to _all_\n   *         plugin names.\n   *\n   * @return {Object|undefined}\n   *         An object containing plugin(s) associated with their name(s) or\n   *         `undefined` if no matching plugins exist).\n   */\n  videojs$1.getPlugins = Plugin.getPlugins;\n\n  /**\n   * Gets a plugin by name if it exists.\n   *\n   * @param  {string} name\n   *         The name of a plugin.\n   *\n   * @return {Function|undefined}\n   *         The plugin (or `undefined`).\n   */\n  videojs$1.getPlugin = Plugin.getPlugin;\n\n  /**\n   * Gets a plugin's version, if available\n   *\n   * @param  {string} name\n   *         The name of a plugin.\n   *\n   * @return {string}\n   *         The plugin's version or an empty string.\n   */\n  videojs$1.getPluginVersion = Plugin.getPluginVersion;\n\n  /**\n   * Adding languages so that they're available to all players.\n   * Example: `videojs.addLanguage('es', { 'Hello': 'Hola' });`\n   *\n   * @param {string} code\n   *        The language code or dictionary property\n   *\n   * @param {Object} data\n   *        The data values to be translated\n   *\n   * @return {Object}\n   *         The resulting language dictionary object\n   */\n  videojs$1.addLanguage = function (code, data) {\n    var _mergeOptions;\n\n    code = ('' + code).toLowerCase();\n\n    videojs$1.options.languages = mergeOptions(videojs$1.options.languages, (_mergeOptions = {}, _mergeOptions[code] = data, _mergeOptions));\n\n    return videojs$1.options.languages[code];\n  };\n\n  /**\n   * Log messages\n   *\n   * @borrows log:log as videojs.log\n   */\n  videojs$1.log = log$1;\n\n  /**\n   * Creates an emulated TimeRange object.\n   *\n   * @borrows time-ranges:createTimeRanges as videojs.createTimeRange\n   */\n  /**\n   * @borrows time-ranges:createTimeRanges as videojs.createTimeRanges\n   */\n  videojs$1.createTimeRange = videojs$1.createTimeRanges = createTimeRanges;\n\n  /**\n   * Format seconds as a time string, H:MM:SS or M:SS\n   * Supplying a guide (in seconds) will force a number of leading zeros\n   * to cover the length of the guide\n   *\n   * @borrows format-time:formatTime as videojs.formatTime\n   */\n  videojs$1.formatTime = formatTime;\n\n  /**\n   * Replaces format-time with a custom implementation, to be used in place of the default.\n   *\n   * @borrows format-time:setFormatTime as videojs.setFormatTime\n   *\n   * @method setFormatTime\n   *\n   * @param {Function} customFn\n   *        A custom format-time function which will be called with the current time and guide (in seconds) as arguments.\n   *        Passed fn should return a string.\n   */\n  videojs$1.setFormatTime = setFormatTime;\n\n  /**\n   * Resets format-time to the default implementation.\n   *\n   * @borrows format-time:resetFormatTime as videojs.resetFormatTime\n   *\n   * @method resetFormatTime\n   */\n  videojs$1.resetFormatTime = resetFormatTime;\n\n  /**\n   * Resolve and parse the elements of a URL\n   *\n   * @borrows url:parseUrl as videojs.parseUrl\n   *\n   */\n  videojs$1.parseUrl = parseUrl;\n\n  /**\n   * Returns whether the url passed is a cross domain request or not.\n   *\n   * @borrows url:isCrossOrigin as videojs.isCrossOrigin\n   */\n  videojs$1.isCrossOrigin = isCrossOrigin;\n\n  /**\n   * Event target class.\n   *\n   * @borrows EventTarget as videojs.EventTarget\n   */\n  videojs$1.EventTarget = EventTarget;\n\n  /**\n   * Add an event listener to element\n   * It stores the handler function in a separate cache object\n   * and adds a generic handler to the element's event,\n   * along with a unique id (guid) to the element.\n   *\n   * @borrows events:on as videojs.on\n   */\n  videojs$1.on = on;\n\n  /**\n   * Trigger a listener only once for an event\n   *\n   * @borrows events:one as videojs.one\n   */\n  videojs$1.one = one;\n\n  /**\n   * Removes event listeners from an element\n   *\n   * @borrows events:off as videojs.off\n   */\n  videojs$1.off = off;\n\n  /**\n   * Trigger an event for an element\n   *\n   * @borrows events:trigger as videojs.trigger\n   */\n  videojs$1.trigger = trigger;\n\n  /**\n   * A cross-browser XMLHttpRequest wrapper. Here's a simple example:\n   *\n   * @param {Object} options\n   *        settings for the request.\n   *\n   * @return {XMLHttpRequest|XDomainRequest}\n   *         The request object.\n   *\n   * @see https://github.com/Raynos/xhr\n   */\n  videojs$1.xhr = xhr;\n\n  /**\n   * TextTrack class\n   *\n   * @borrows TextTrack as videojs.TextTrack\n   */\n  videojs$1.TextTrack = TextTrack;\n\n  /**\n   * export the AudioTrack class so that source handlers can create\n   * AudioTracks and then add them to the players AudioTrackList\n   *\n   * @borrows AudioTrack as videojs.AudioTrack\n   */\n  videojs$1.AudioTrack = AudioTrack;\n\n  /**\n   * export the VideoTrack class so that source handlers can create\n   * VideoTracks and then add them to the players VideoTrackList\n   *\n   * @borrows VideoTrack as videojs.VideoTrack\n   */\n  videojs$1.VideoTrack = VideoTrack;\n\n  /**\n   * Determines, via duck typing, whether or not a value is a DOM element.\n   *\n   * @borrows dom:isEl as videojs.isEl\n   * @deprecated Use videojs.dom.isEl() instead\n   */\n\n  /**\n   * Determines, via duck typing, whether or not a value is a text node.\n   *\n   * @borrows dom:isTextNode as videojs.isTextNode\n   * @deprecated Use videojs.dom.isTextNode() instead\n   */\n\n  /**\n   * Creates an element and applies properties.\n   *\n   * @borrows dom:createEl as videojs.createEl\n   * @deprecated Use videojs.dom.createEl() instead\n   */\n\n  /**\n   * Check if an element has a CSS class\n   *\n   * @borrows dom:hasElClass as videojs.hasClass\n   * @deprecated Use videojs.dom.hasClass() instead\n   */\n\n  /**\n   * Add a CSS class name to an element\n   *\n   * @borrows dom:addElClass as videojs.addClass\n   * @deprecated Use videojs.dom.addClass() instead\n   */\n\n  /**\n   * Remove a CSS class name from an element\n   *\n   * @borrows dom:removeElClass as videojs.removeClass\n   * @deprecated Use videojs.dom.removeClass() instead\n   */\n\n  /**\n   * Adds or removes a CSS class name on an element depending on an optional\n   * condition or the presence/absence of the class name.\n   *\n   * @borrows dom:toggleElClass as videojs.toggleClass\n   * @deprecated Use videojs.dom.toggleClass() instead\n   */\n\n  /**\n   * Apply attributes to an HTML element.\n   *\n   * @borrows dom:setElAttributes as videojs.setAttribute\n   * @deprecated Use videojs.dom.setAttributes() instead\n   */\n\n  /**\n   * Get an element's attribute values, as defined on the HTML tag\n   * Attributes are not the same as properties. They're defined on the tag\n   * or with setAttribute (which shouldn't be used with HTML)\n   * This will return true or false for boolean attributes.\n   *\n   * @borrows dom:getElAttributes as videojs.getAttributes\n   * @deprecated Use videojs.dom.getAttributes() instead\n   */\n\n  /**\n   * Empties the contents of an element.\n   *\n   * @borrows dom:emptyEl as videojs.emptyEl\n   * @deprecated Use videojs.dom.emptyEl() instead\n   */\n\n  /**\n   * Normalizes and appends content to an element.\n   *\n   * The content for an element can be passed in multiple types and\n   * combinations, whose behavior is as follows:\n   *\n   * - String\n   *   Normalized into a text node.\n   *\n   * - Element, TextNode\n   *   Passed through.\n   *\n   * - Array\n   *   A one-dimensional array of strings, elements, nodes, or functions (which\n   *   return single strings, elements, or nodes).\n   *\n   * - Function\n   *   If the sole argument, is expected to produce a string, element,\n   *   node, or array.\n   *\n   * @borrows dom:appendContents as videojs.appendContet\n   * @deprecated Use videojs.dom.appendContent() instead\n   */\n\n  /**\n   * Normalizes and inserts content into an element; this is identical to\n   * `appendContent()`, except it empties the element first.\n   *\n   * The content for an element can be passed in multiple types and\n   * combinations, whose behavior is as follows:\n   *\n   * - String\n   *   Normalized into a text node.\n   *\n   * - Element, TextNode\n   *   Passed through.\n   *\n   * - Array\n   *   A one-dimensional array of strings, elements, nodes, or functions (which\n   *   return single strings, elements, or nodes).\n   *\n   * - Function\n   *   If the sole argument, is expected to produce a string, element,\n   *   node, or array.\n   *\n   * @borrows dom:insertContent as videojs.insertContent\n   * @deprecated Use videojs.dom.insertContent() instead\n   */\n  ['isEl', 'isTextNode', 'createEl', 'hasClass', 'addClass', 'removeClass', 'toggleClass', 'setAttributes', 'getAttributes', 'emptyEl', 'appendContent', 'insertContent'].forEach(function (k) {\n    videojs$1[k] = function () {\n      log$1.warn('videojs.' + k + '() is deprecated; use videojs.dom.' + k + '() instead');\n      return Dom[k].apply(null, arguments);\n    };\n  });\n\n  /**\n   * A safe getComputedStyle.\n   *\n   * This is because in Firefox, if the player is loaded in an iframe with `display:none`,\n   * then `getComputedStyle` returns `null`, so, we do a null-check to make sure\n   * that the player doesn't break in these cases.\n   * See https://bugzilla.mozilla.org/show_bug.cgi?id=548397 for more details.\n   *\n   * @borrows computed-style:computedStyle as videojs.computedStyle\n   */\n  videojs$1.computedStyle = computedStyle;\n\n  /**\n   * Export the Dom utilities for use in external plugins\n   * and Tech's\n   */\n  videojs$1.dom = Dom;\n\n  /**\n   * Export the Url utilities for use in external plugins\n   * and Tech's\n   */\n  videojs$1.url = Url;\n\n  var urlToolkit = createCommonjsModule(function (module, exports) {\n    // see https://tools.ietf.org/html/rfc1808\n\n    /* jshint ignore:start */\n    (function (root) {\n      /* jshint ignore:end */\n\n      var URL_REGEX = /^((?:[a-zA-Z0-9+\\-.]+:)?)(\\/\\/[^\\/\\;?#]*)?(.*?)??(;.*?)?(\\?.*?)?(#.*?)?$/;\n      var FIRST_SEGMENT_REGEX = /^([^\\/;?#]*)(.*)$/;\n      var SLASH_DOT_REGEX = /(?:\\/|^)\\.(?=\\/)/g;\n      var SLASH_DOT_DOT_REGEX = /(?:\\/|^)\\.\\.\\/(?!\\.\\.\\/).*?(?=\\/)/g;\n\n      var URLToolkit = { // jshint ignore:line\n        // If opts.alwaysNormalize is true then the path will always be normalized even when it starts with / or //\n        // E.g\n        // With opts.alwaysNormalize = false (default, spec compliant)\n        // http://a.com/b/cd + /e/f/../g => http://a.com/e/f/../g\n        // With opts.alwaysNormalize = true (not spec compliant)\n        // http://a.com/b/cd + /e/f/../g => http://a.com/e/g\n        buildAbsoluteURL: function buildAbsoluteURL(baseURL, relativeURL, opts) {\n          opts = opts || {};\n          // remove any remaining space and CRLF\n          baseURL = baseURL.trim();\n          relativeURL = relativeURL.trim();\n          if (!relativeURL) {\n            // 2a) If the embedded URL is entirely empty, it inherits the\n            // entire base URL (i.e., is set equal to the base URL)\n            // and we are done.\n            if (!opts.alwaysNormalize) {\n              return baseURL;\n            }\n            var basePartsForNormalise = URLToolkit.parseURL(baseURL);\n            if (!basePartsForNormalise) {\n              throw new Error('Error trying to parse base URL.');\n            }\n            basePartsForNormalise.path = URLToolkit.normalizePath(basePartsForNormalise.path);\n            return URLToolkit.buildURLFromParts(basePartsForNormalise);\n          }\n          var relativeParts = URLToolkit.parseURL(relativeURL);\n          if (!relativeParts) {\n            throw new Error('Error trying to parse relative URL.');\n          }\n          if (relativeParts.scheme) {\n            // 2b) If the embedded URL starts with a scheme name, it is\n            // interpreted as an absolute URL and we are done.\n            if (!opts.alwaysNormalize) {\n              return relativeURL;\n            }\n            relativeParts.path = URLToolkit.normalizePath(relativeParts.path);\n            return URLToolkit.buildURLFromParts(relativeParts);\n          }\n          var baseParts = URLToolkit.parseURL(baseURL);\n          if (!baseParts) {\n            throw new Error('Error trying to parse base URL.');\n          }\n          if (!baseParts.netLoc && baseParts.path && baseParts.path[0] !== '/') {\n            // If netLoc missing and path doesn't start with '/', assume everthing before the first '/' is the netLoc\n            // This causes 'example.com/a' to be handled as '//example.com/a' instead of '/example.com/a'\n            var pathParts = FIRST_SEGMENT_REGEX.exec(baseParts.path);\n            baseParts.netLoc = pathParts[1];\n            baseParts.path = pathParts[2];\n          }\n          if (baseParts.netLoc && !baseParts.path) {\n            baseParts.path = '/';\n          }\n          var builtParts = {\n            // 2c) Otherwise, the embedded URL inherits the scheme of\n            // the base URL.\n            scheme: baseParts.scheme,\n            netLoc: relativeParts.netLoc,\n            path: null,\n            params: relativeParts.params,\n            query: relativeParts.query,\n            fragment: relativeParts.fragment\n          };\n          if (!relativeParts.netLoc) {\n            // 3) If the embedded URL's <net_loc> is non-empty, we skip to\n            // Step 7.  Otherwise, the embedded URL inherits the <net_loc>\n            // (if any) of the base URL.\n            builtParts.netLoc = baseParts.netLoc;\n            // 4) If the embedded URL path is preceded by a slash \"/\", the\n            // path is not relative and we skip to Step 7.\n            if (relativeParts.path[0] !== '/') {\n              if (!relativeParts.path) {\n                // 5) If the embedded URL path is empty (and not preceded by a\n                // slash), then the embedded URL inherits the base URL path\n                builtParts.path = baseParts.path;\n                // 5a) if the embedded URL's <params> is non-empty, we skip to\n                // step 7; otherwise, it inherits the <params> of the base\n                // URL (if any) and\n                if (!relativeParts.params) {\n                  builtParts.params = baseParts.params;\n                  // 5b) if the embedded URL's <query> is non-empty, we skip to\n                  // step 7; otherwise, it inherits the <query> of the base\n                  // URL (if any) and we skip to step 7.\n                  if (!relativeParts.query) {\n                    builtParts.query = baseParts.query;\n                  }\n                }\n              } else {\n                // 6) The last segment of the base URL's path (anything\n                // following the rightmost slash \"/\", or the entire path if no\n                // slash is present) is removed and the embedded URL's path is\n                // appended in its place.\n                var baseURLPath = baseParts.path;\n                var newPath = baseURLPath.substring(0, baseURLPath.lastIndexOf('/') + 1) + relativeParts.path;\n                builtParts.path = URLToolkit.normalizePath(newPath);\n              }\n            }\n          }\n          if (builtParts.path === null) {\n            builtParts.path = opts.alwaysNormalize ? URLToolkit.normalizePath(relativeParts.path) : relativeParts.path;\n          }\n          return URLToolkit.buildURLFromParts(builtParts);\n        },\n        parseURL: function parseURL(url) {\n          var parts = URL_REGEX.exec(url);\n          if (!parts) {\n            return null;\n          }\n          return {\n            scheme: parts[1] || '',\n            netLoc: parts[2] || '',\n            path: parts[3] || '',\n            params: parts[4] || '',\n            query: parts[5] || '',\n            fragment: parts[6] || ''\n          };\n        },\n        normalizePath: function normalizePath(path) {\n          // The following operations are\n          // then applied, in order, to the new path:\n          // 6a) All occurrences of \"./\", where \".\" is a complete path\n          // segment, are removed.\n          // 6b) If the path ends with \".\" as a complete path segment,\n          // that \".\" is removed.\n          path = path.split('').reverse().join('').replace(SLASH_DOT_REGEX, '');\n          // 6c) All occurrences of \"<segment>/../\", where <segment> is a\n          // complete path segment not equal to \"..\", are removed.\n          // Removal of these path segments is performed iteratively,\n          // removing the leftmost matching pattern on each iteration,\n          // until no matching pattern remains.\n          // 6d) If the path ends with \"<segment>/..\", where <segment> is a\n          // complete path segment not equal to \"..\", that\n          // \"<segment>/..\" is removed.\n          while (path.length !== (path = path.replace(SLASH_DOT_DOT_REGEX, '')).length) {} // jshint ignore:line\n          return path.split('').reverse().join('');\n        },\n        buildURLFromParts: function buildURLFromParts(parts) {\n          return parts.scheme + parts.netLoc + parts.path + parts.params + parts.query + parts.fragment;\n        }\n      };\n\n      /* jshint ignore:start */\n      module.exports = URLToolkit;\n    })(commonjsGlobal);\n    /* jshint ignore:end */\n  });\n\n  var classCallCheck$1 = function classCallCheck$$1(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  var _extends$1 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  var inherits$1 = function inherits$$1(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === \"undefined\" ? \"undefined\" : _typeof(superClass)));\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  var possibleConstructorReturn$1 = function possibleConstructorReturn$$1(self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && ((typeof call === \"undefined\" ? \"undefined\" : _typeof(call)) === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  /**\n   * @file stream.js\n   */\n  /**\n   * A lightweight readable stream implemention that handles event dispatching.\n   *\n   * @class Stream\n   */\n  var Stream = function () {\n    function Stream() {\n      classCallCheck$1(this, Stream);\n\n      this.listeners = {};\n    }\n\n    /**\n     * Add a listener for a specified event type.\n     *\n     * @param {String} type the event name\n     * @param {Function} listener the callback to be invoked when an event of\n     * the specified type occurs\n     */\n\n    Stream.prototype.on = function on(type, listener) {\n      if (!this.listeners[type]) {\n        this.listeners[type] = [];\n      }\n      this.listeners[type].push(listener);\n    };\n\n    /**\n     * Remove a listener for a specified event type.\n     *\n     * @param {String} type the event name\n     * @param {Function} listener  a function previously registered for this\n     * type of event through `on`\n     * @return {Boolean} if we could turn it off or not\n     */\n\n    Stream.prototype.off = function off(type, listener) {\n      if (!this.listeners[type]) {\n        return false;\n      }\n\n      var index = this.listeners[type].indexOf(listener);\n\n      this.listeners[type].splice(index, 1);\n      return index > -1;\n    };\n\n    /**\n     * Trigger an event of the specified type on this stream. Any additional\n     * arguments to this function are passed as parameters to event listeners.\n     *\n     * @param {String} type the event name\n     */\n\n    Stream.prototype.trigger = function trigger(type) {\n      var callbacks = this.listeners[type];\n      var i = void 0;\n      var length = void 0;\n      var args = void 0;\n\n      if (!callbacks) {\n        return;\n      }\n      // Slicing the arguments on every invocation of this method\n      // can add a significant amount of overhead. Avoid the\n      // intermediate object creation for the common case of a\n      // single callback argument\n      if (arguments.length === 2) {\n        length = callbacks.length;\n        for (i = 0; i < length; ++i) {\n          callbacks[i].call(this, arguments[1]);\n        }\n      } else {\n        args = Array.prototype.slice.call(arguments, 1);\n        length = callbacks.length;\n        for (i = 0; i < length; ++i) {\n          callbacks[i].apply(this, args);\n        }\n      }\n    };\n\n    /**\n     * Destroys the stream and cleans up.\n     */\n\n    Stream.prototype.dispose = function dispose() {\n      this.listeners = {};\n    };\n    /**\n     * Forwards all `data` events on this stream to the destination stream. The\n     * destination stream should provide a method `push` to receive the data\n     * events as they arrive.\n     *\n     * @param {Stream} destination the stream that will receive all `data` events\n     * @see http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options\n     */\n\n    Stream.prototype.pipe = function pipe(destination) {\n      this.on('data', function (data) {\n        destination.push(data);\n      });\n    };\n\n    return Stream;\n  }();\n\n  /**\n   * @file m3u8/line-stream.js\n   */\n  /**\n   * A stream that buffers string input and generates a `data` event for each\n   * line.\n   *\n   * @class LineStream\n   * @extends Stream\n   */\n\n  var LineStream = function (_Stream) {\n    inherits$1(LineStream, _Stream);\n\n    function LineStream() {\n      classCallCheck$1(this, LineStream);\n\n      var _this = possibleConstructorReturn$1(this, _Stream.call(this));\n\n      _this.buffer = '';\n      return _this;\n    }\n\n    /**\n     * Add new data to be parsed.\n     *\n     * @param {String} data the text to process\n     */\n\n    LineStream.prototype.push = function push(data) {\n      var nextNewline = void 0;\n\n      this.buffer += data;\n      nextNewline = this.buffer.indexOf('\\n');\n\n      for (; nextNewline > -1; nextNewline = this.buffer.indexOf('\\n')) {\n        this.trigger('data', this.buffer.substring(0, nextNewline));\n        this.buffer = this.buffer.substring(nextNewline + 1);\n      }\n    };\n\n    return LineStream;\n  }(Stream);\n\n  /**\n   * @file m3u8/parse-stream.js\n   */\n  /**\n   * \"forgiving\" attribute list psuedo-grammar:\n   * attributes -> keyvalue (',' keyvalue)*\n   * keyvalue   -> key '=' value\n   * key        -> [^=]*\n   * value      -> '\"' [^\"]* '\"' | [^,]*\n   */\n  var attributeSeparator = function attributeSeparator() {\n    var key = '[^=]*';\n    var value = '\"[^\"]*\"|[^,]*';\n    var keyvalue = '(?:' + key + ')=(?:' + value + ')';\n\n    return new RegExp('(?:^|,)(' + keyvalue + ')');\n  };\n\n  /**\n   * Parse attributes from a line given the seperator\n   *\n   * @param {String} attributes the attibute line to parse\n   */\n  var parseAttributes = function parseAttributes(attributes) {\n    // split the string using attributes as the separator\n    var attrs = attributes.split(attributeSeparator());\n    var result = {};\n    var i = attrs.length;\n    var attr = void 0;\n\n    while (i--) {\n      // filter out unmatched portions of the string\n      if (attrs[i] === '') {\n        continue;\n      }\n\n      // split the key and value\n      attr = /([^=]*)=(.*)/.exec(attrs[i]).slice(1);\n      // trim whitespace and remove optional quotes around the value\n      attr[0] = attr[0].replace(/^\\s+|\\s+$/g, '');\n      attr[1] = attr[1].replace(/^\\s+|\\s+$/g, '');\n      attr[1] = attr[1].replace(/^['\"](.*)['\"]$/g, '$1');\n      result[attr[0]] = attr[1];\n    }\n    return result;\n  };\n\n  /**\n   * A line-level M3U8 parser event stream. It expects to receive input one\n   * line at a time and performs a context-free parse of its contents. A stream\n   * interpretation of a manifest can be useful if the manifest is expected to\n   * be too large to fit comfortably into memory or the entirety of the input\n   * is not immediately available. Otherwise, it's probably much easier to work\n   * with a regular `Parser` object.\n   *\n   * Produces `data` events with an object that captures the parser's\n   * interpretation of the input. That object has a property `tag` that is one\n   * of `uri`, `comment`, or `tag`. URIs only have a single additional\n   * property, `line`, which captures the entirety of the input without\n   * interpretation. Comments similarly have a single additional property\n   * `text` which is the input without the leading `#`.\n   *\n   * Tags always have a property `tagType` which is the lower-cased version of\n   * the M3U8 directive without the `#EXT` or `#EXT-X-` prefix. For instance,\n   * `#EXT-X-MEDIA-SEQUENCE` becomes `media-sequence` when parsed. Unrecognized\n   * tags are given the tag type `unknown` and a single additional property\n   * `data` with the remainder of the input.\n   *\n   * @class ParseStream\n   * @extends Stream\n   */\n\n  var ParseStream = function (_Stream) {\n    inherits$1(ParseStream, _Stream);\n\n    function ParseStream() {\n      classCallCheck$1(this, ParseStream);\n\n      var _this = possibleConstructorReturn$1(this, _Stream.call(this));\n\n      _this.customParsers = [];\n      return _this;\n    }\n\n    /**\n     * Parses an additional line of input.\n     *\n     * @param {String} line a single line of an M3U8 file to parse\n     */\n\n    ParseStream.prototype.push = function push(line) {\n      var match = void 0;\n      var event = void 0;\n\n      // strip whitespace\n      line = line.replace(/^[\\u0000\\s]+|[\\u0000\\s]+$/g, '');\n      if (line.length === 0) {\n        // ignore empty lines\n        return;\n      }\n\n      // URIs\n      if (line[0] !== '#') {\n        this.trigger('data', {\n          type: 'uri',\n          uri: line\n        });\n        return;\n      }\n\n      for (var i = 0; i < this.customParsers.length; i++) {\n        if (this.customParsers[i].call(this, line)) {\n          return;\n        }\n      }\n\n      // Comments\n      if (line.indexOf('#EXT') !== 0) {\n        this.trigger('data', {\n          type: 'comment',\n          text: line.slice(1)\n        });\n        return;\n      }\n\n      // strip off any carriage returns here so the regex matching\n      // doesn't have to account for them.\n      line = line.replace('\\r', '');\n\n      // Tags\n      match = /^#EXTM3U/.exec(line);\n      if (match) {\n        this.trigger('data', {\n          type: 'tag',\n          tagType: 'm3u'\n        });\n        return;\n      }\n      match = /^#EXTINF:?([0-9\\.]*)?,?(.*)?$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'inf'\n        };\n        if (match[1]) {\n          event.duration = parseFloat(match[1]);\n        }\n        if (match[2]) {\n          event.title = match[2];\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'targetduration'\n        };\n        if (match[1]) {\n          event.duration = parseInt(match[1], 10);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'totalduration'\n        };\n        if (match[1]) {\n          event.duration = parseInt(match[1], 10);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-VERSION:?([0-9.]*)?/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'version'\n        };\n        if (match[1]) {\n          event.version = parseInt(match[1], 10);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-MEDIA-SEQUENCE:?(\\-?[0-9.]*)?/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'media-sequence'\n        };\n        if (match[1]) {\n          event.number = parseInt(match[1], 10);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-DISCONTINUITY-SEQUENCE:?(\\-?[0-9.]*)?/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'discontinuity-sequence'\n        };\n        if (match[1]) {\n          event.number = parseInt(match[1], 10);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'playlist-type'\n        };\n        if (match[1]) {\n          event.playlistType = match[1];\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'byterange'\n        };\n        if (match[1]) {\n          event.length = parseInt(match[1], 10);\n        }\n        if (match[2]) {\n          event.offset = parseInt(match[2], 10);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'allow-cache'\n        };\n        if (match[1]) {\n          event.allowed = !/NO/.test(match[1]);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-MAP:?(.*)$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'map'\n        };\n\n        if (match[1]) {\n          var attributes = parseAttributes(match[1]);\n\n          if (attributes.URI) {\n            event.uri = attributes.URI;\n          }\n          if (attributes.BYTERANGE) {\n            var _attributes$BYTERANGE = attributes.BYTERANGE.split('@'),\n                length = _attributes$BYTERANGE[0],\n                offset = _attributes$BYTERANGE[1];\n\n            event.byterange = {};\n            if (length) {\n              event.byterange.length = parseInt(length, 10);\n            }\n            if (offset) {\n              event.byterange.offset = parseInt(offset, 10);\n            }\n          }\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-STREAM-INF:?(.*)$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'stream-inf'\n        };\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n\n          if (event.attributes.RESOLUTION) {\n            var split = event.attributes.RESOLUTION.split('x');\n            var resolution = {};\n\n            if (split[0]) {\n              resolution.width = parseInt(split[0], 10);\n            }\n            if (split[1]) {\n              resolution.height = parseInt(split[1], 10);\n            }\n            event.attributes.RESOLUTION = resolution;\n          }\n          if (event.attributes.BANDWIDTH) {\n            event.attributes.BANDWIDTH = parseInt(event.attributes.BANDWIDTH, 10);\n          }\n          if (event.attributes['PROGRAM-ID']) {\n            event.attributes['PROGRAM-ID'] = parseInt(event.attributes['PROGRAM-ID'], 10);\n          }\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-MEDIA:?(.*)$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'media'\n        };\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-ENDLIST/.exec(line);\n      if (match) {\n        this.trigger('data', {\n          type: 'tag',\n          tagType: 'endlist'\n        });\n        return;\n      }\n      match = /^#EXT-X-DISCONTINUITY/.exec(line);\n      if (match) {\n        this.trigger('data', {\n          type: 'tag',\n          tagType: 'discontinuity'\n        });\n        return;\n      }\n      match = /^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'program-date-time'\n        };\n        if (match[1]) {\n          event.dateTimeString = match[1];\n          event.dateTimeObject = new Date(match[1]);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-KEY:?(.*)$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'key'\n        };\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n          // parse the IV string into a Uint32Array\n          if (event.attributes.IV) {\n            if (event.attributes.IV.substring(0, 2).toLowerCase() === '0x') {\n              event.attributes.IV = event.attributes.IV.substring(2);\n            }\n\n            event.attributes.IV = event.attributes.IV.match(/.{8}/g);\n            event.attributes.IV[0] = parseInt(event.attributes.IV[0], 16);\n            event.attributes.IV[1] = parseInt(event.attributes.IV[1], 16);\n            event.attributes.IV[2] = parseInt(event.attributes.IV[2], 16);\n            event.attributes.IV[3] = parseInt(event.attributes.IV[3], 16);\n            event.attributes.IV = new Uint32Array(event.attributes.IV);\n          }\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-START:?(.*)$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'start'\n        };\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n\n          event.attributes['TIME-OFFSET'] = parseFloat(event.attributes['TIME-OFFSET']);\n          event.attributes.PRECISE = /YES/.test(event.attributes.PRECISE);\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'cue-out-cont'\n        };\n        if (match[1]) {\n          event.data = match[1];\n        } else {\n          event.data = '';\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-CUE-OUT:?(.*)?$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'cue-out'\n        };\n        if (match[1]) {\n          event.data = match[1];\n        } else {\n          event.data = '';\n        }\n        this.trigger('data', event);\n        return;\n      }\n      match = /^#EXT-X-CUE-IN:?(.*)?$/.exec(line);\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'cue-in'\n        };\n        if (match[1]) {\n          event.data = match[1];\n        } else {\n          event.data = '';\n        }\n        this.trigger('data', event);\n        return;\n      }\n\n      // unknown tag type\n      this.trigger('data', {\n        type: 'tag',\n        data: line.slice(4)\n      });\n    };\n\n    /**\n     * Add a parser for custom headers\n     *\n     * @param {Object}   options              a map of options for the added parser\n     * @param {RegExp}   options.expression   a regular expression to match the custom header\n     * @param {string}   options.customType   the custom type to register to the output\n     * @param {Function} [options.dataParser] function to parse the line into an object\n     * @param {boolean}  [options.segment]    should tag data be attached to the segment object\n     */\n\n    ParseStream.prototype.addParser = function addParser(_ref) {\n      var _this2 = this;\n\n      var expression = _ref.expression,\n          customType = _ref.customType,\n          dataParser = _ref.dataParser,\n          segment = _ref.segment;\n\n      if (typeof dataParser !== 'function') {\n        dataParser = function dataParser(line) {\n          return line;\n        };\n      }\n      this.customParsers.push(function (line) {\n        var match = expression.exec(line);\n\n        if (match) {\n          _this2.trigger('data', {\n            type: 'custom',\n            data: dataParser(line),\n            customType: customType,\n            segment: segment\n          });\n          return true;\n        }\n      });\n    };\n\n    return ParseStream;\n  }(Stream);\n\n  /**\n   * @file m3u8/parser.js\n   */\n  /**\n   * A parser for M3U8 files. The current interpretation of the input is\n   * exposed as a property `manifest` on parser objects. It's just two lines to\n   * create and parse a manifest once you have the contents available as a string:\n   *\n   * ```js\n   * var parser = new m3u8.Parser();\n   * parser.push(xhr.responseText);\n   * ```\n   *\n   * New input can later be applied to update the manifest object by calling\n   * `push` again.\n   *\n   * The parser attempts to create a usable manifest object even if the\n   * underlying input is somewhat nonsensical. It emits `info` and `warning`\n   * events during the parse if it encounters input that seems invalid or\n   * requires some property of the manifest object to be defaulted.\n   *\n   * @class Parser\n   * @extends Stream\n   */\n\n  var Parser = function (_Stream) {\n    inherits$1(Parser, _Stream);\n\n    function Parser() {\n      classCallCheck$1(this, Parser);\n\n      var _this = possibleConstructorReturn$1(this, _Stream.call(this));\n\n      _this.lineStream = new LineStream();\n      _this.parseStream = new ParseStream();\n      _this.lineStream.pipe(_this.parseStream);\n\n      /* eslint-disable consistent-this */\n      var self = _this;\n      /* eslint-enable consistent-this */\n      var uris = [];\n      var currentUri = {};\n      // if specified, the active EXT-X-MAP definition\n      var currentMap = void 0;\n      // if specified, the active decryption key\n      var _key = void 0;\n      var noop = function noop() {};\n      var defaultMediaGroups = {\n        'AUDIO': {},\n        'VIDEO': {},\n        'CLOSED-CAPTIONS': {},\n        'SUBTITLES': {}\n      };\n      // group segments into numbered timelines delineated by discontinuities\n      var currentTimeline = 0;\n\n      // the manifest is empty until the parse stream begins delivering data\n      _this.manifest = {\n        allowCache: true,\n        discontinuityStarts: [],\n        segments: []\n      };\n\n      // update the manifest with the m3u8 entry from the parse stream\n      _this.parseStream.on('data', function (entry) {\n        var mediaGroup = void 0;\n        var rendition = void 0;\n\n        ({\n          tag: function tag() {\n            // switch based on the tag type\n            (({\n              'allow-cache': function allowCache() {\n                this.manifest.allowCache = entry.allowed;\n                if (!('allowed' in entry)) {\n                  this.trigger('info', {\n                    message: 'defaulting allowCache to YES'\n                  });\n                  this.manifest.allowCache = true;\n                }\n              },\n              byterange: function byterange() {\n                var byterange = {};\n\n                if ('length' in entry) {\n                  currentUri.byterange = byterange;\n                  byterange.length = entry.length;\n\n                  if (!('offset' in entry)) {\n                    this.trigger('info', {\n                      message: 'defaulting offset to zero'\n                    });\n                    entry.offset = 0;\n                  }\n                }\n                if ('offset' in entry) {\n                  currentUri.byterange = byterange;\n                  byterange.offset = entry.offset;\n                }\n              },\n              endlist: function endlist() {\n                this.manifest.endList = true;\n              },\n              inf: function inf() {\n                if (!('mediaSequence' in this.manifest)) {\n                  this.manifest.mediaSequence = 0;\n                  this.trigger('info', {\n                    message: 'defaulting media sequence to zero'\n                  });\n                }\n                if (!('discontinuitySequence' in this.manifest)) {\n                  this.manifest.discontinuitySequence = 0;\n                  this.trigger('info', {\n                    message: 'defaulting discontinuity sequence to zero'\n                  });\n                }\n                if (entry.duration > 0) {\n                  currentUri.duration = entry.duration;\n                }\n\n                if (entry.duration === 0) {\n                  currentUri.duration = 0.01;\n                  this.trigger('info', {\n                    message: 'updating zero segment duration to a small value'\n                  });\n                }\n\n                this.manifest.segments = uris;\n              },\n              key: function key() {\n                if (!entry.attributes) {\n                  this.trigger('warn', {\n                    message: 'ignoring key declaration without attribute list'\n                  });\n                  return;\n                }\n                // clear the active encryption key\n                if (entry.attributes.METHOD === 'NONE') {\n                  _key = null;\n                  return;\n                }\n                if (!entry.attributes.URI) {\n                  this.trigger('warn', {\n                    message: 'ignoring key declaration without URI'\n                  });\n                  return;\n                }\n                if (!entry.attributes.METHOD) {\n                  this.trigger('warn', {\n                    message: 'defaulting key method to AES-128'\n                  });\n                }\n\n                // setup an encryption key for upcoming segments\n                _key = {\n                  method: entry.attributes.METHOD || 'AES-128',\n                  uri: entry.attributes.URI\n                };\n\n                if (typeof entry.attributes.IV !== 'undefined') {\n                  _key.iv = entry.attributes.IV;\n                }\n              },\n              'media-sequence': function mediaSequence() {\n                if (!isFinite(entry.number)) {\n                  this.trigger('warn', {\n                    message: 'ignoring invalid media sequence: ' + entry.number\n                  });\n                  return;\n                }\n                this.manifest.mediaSequence = entry.number;\n              },\n              'discontinuity-sequence': function discontinuitySequence() {\n                if (!isFinite(entry.number)) {\n                  this.trigger('warn', {\n                    message: 'ignoring invalid discontinuity sequence: ' + entry.number\n                  });\n                  return;\n                }\n                this.manifest.discontinuitySequence = entry.number;\n                currentTimeline = entry.number;\n              },\n              'playlist-type': function playlistType() {\n                if (!/VOD|EVENT/.test(entry.playlistType)) {\n                  this.trigger('warn', {\n                    message: 'ignoring unknown playlist type: ' + entry.playlist\n                  });\n                  return;\n                }\n                this.manifest.playlistType = entry.playlistType;\n              },\n              map: function map() {\n                currentMap = {};\n                if (entry.uri) {\n                  currentMap.uri = entry.uri;\n                }\n                if (entry.byterange) {\n                  currentMap.byterange = entry.byterange;\n                }\n              },\n              'stream-inf': function streamInf() {\n                this.manifest.playlists = uris;\n                this.manifest.mediaGroups = this.manifest.mediaGroups || defaultMediaGroups;\n\n                if (!entry.attributes) {\n                  this.trigger('warn', {\n                    message: 'ignoring empty stream-inf attributes'\n                  });\n                  return;\n                }\n\n                if (!currentUri.attributes) {\n                  currentUri.attributes = {};\n                }\n                _extends$1(currentUri.attributes, entry.attributes);\n              },\n              media: function media() {\n                this.manifest.mediaGroups = this.manifest.mediaGroups || defaultMediaGroups;\n\n                if (!(entry.attributes && entry.attributes.TYPE && entry.attributes['GROUP-ID'] && entry.attributes.NAME)) {\n                  this.trigger('warn', {\n                    message: 'ignoring incomplete or missing media group'\n                  });\n                  return;\n                }\n\n                // find the media group, creating defaults as necessary\n                var mediaGroupType = this.manifest.mediaGroups[entry.attributes.TYPE];\n\n                mediaGroupType[entry.attributes['GROUP-ID']] = mediaGroupType[entry.attributes['GROUP-ID']] || {};\n                mediaGroup = mediaGroupType[entry.attributes['GROUP-ID']];\n\n                // collect the rendition metadata\n                rendition = {\n                  'default': /yes/i.test(entry.attributes.DEFAULT)\n                };\n                if (rendition['default']) {\n                  rendition.autoselect = true;\n                } else {\n                  rendition.autoselect = /yes/i.test(entry.attributes.AUTOSELECT);\n                }\n                if (entry.attributes.LANGUAGE) {\n                  rendition.language = entry.attributes.LANGUAGE;\n                }\n                if (entry.attributes.URI) {\n                  rendition.uri = entry.attributes.URI;\n                }\n                if (entry.attributes['INSTREAM-ID']) {\n                  rendition.instreamId = entry.attributes['INSTREAM-ID'];\n                }\n                if (entry.attributes.CHARACTERISTICS) {\n                  rendition.characteristics = entry.attributes.CHARACTERISTICS;\n                }\n                if (entry.attributes.FORCED) {\n                  rendition.forced = /yes/i.test(entry.attributes.FORCED);\n                }\n\n                // insert the new rendition\n                mediaGroup[entry.attributes.NAME] = rendition;\n              },\n              discontinuity: function discontinuity() {\n                currentTimeline += 1;\n                currentUri.discontinuity = true;\n                this.manifest.discontinuityStarts.push(uris.length);\n              },\n              'program-date-time': function programDateTime() {\n                if (typeof this.manifest.dateTimeString === 'undefined') {\n                  // PROGRAM-DATE-TIME is a media-segment tag, but for backwards\n                  // compatibility, we add the first occurence of the PROGRAM-DATE-TIME tag\n                  // to the manifest object\n                  // TODO: Consider removing this in future major version\n                  this.manifest.dateTimeString = entry.dateTimeString;\n                  this.manifest.dateTimeObject = entry.dateTimeObject;\n                }\n\n                currentUri.dateTimeString = entry.dateTimeString;\n                currentUri.dateTimeObject = entry.dateTimeObject;\n              },\n              targetduration: function targetduration() {\n                if (!isFinite(entry.duration) || entry.duration < 0) {\n                  this.trigger('warn', {\n                    message: 'ignoring invalid target duration: ' + entry.duration\n                  });\n                  return;\n                }\n                this.manifest.targetDuration = entry.duration;\n              },\n              totalduration: function totalduration() {\n                if (!isFinite(entry.duration) || entry.duration < 0) {\n                  this.trigger('warn', {\n                    message: 'ignoring invalid total duration: ' + entry.duration\n                  });\n                  return;\n                }\n                this.manifest.totalDuration = entry.duration;\n              },\n              start: function start() {\n                if (!entry.attributes || isNaN(entry.attributes['TIME-OFFSET'])) {\n                  this.trigger('warn', {\n                    message: 'ignoring start declaration without appropriate attribute list'\n                  });\n                  return;\n                }\n                this.manifest.start = {\n                  timeOffset: entry.attributes['TIME-OFFSET'],\n                  precise: entry.attributes.PRECISE\n                };\n              },\n              'cue-out': function cueOut() {\n                currentUri.cueOut = entry.data;\n              },\n              'cue-out-cont': function cueOutCont() {\n                currentUri.cueOutCont = entry.data;\n              },\n              'cue-in': function cueIn() {\n                currentUri.cueIn = entry.data;\n              }\n            })[entry.tagType] || noop).call(self);\n          },\n          uri: function uri() {\n            currentUri.uri = entry.uri;\n            uris.push(currentUri);\n\n            // if no explicit duration was declared, use the target duration\n            if (this.manifest.targetDuration && !('duration' in currentUri)) {\n              this.trigger('warn', {\n                message: 'defaulting segment duration to the target duration'\n              });\n              currentUri.duration = this.manifest.targetDuration;\n            }\n            // annotate with encryption information, if necessary\n            if (_key) {\n              currentUri.key = _key;\n            }\n            currentUri.timeline = currentTimeline;\n            // annotate with initialization segment information, if necessary\n            if (currentMap) {\n              currentUri.map = currentMap;\n            }\n\n            // prepare for the next URI\n            currentUri = {};\n          },\n          comment: function comment() {\n            // comments are not important for playback\n          },\n          custom: function custom() {\n            // if this is segment-level data attach the output to the segment\n            if (entry.segment) {\n              currentUri.custom = currentUri.custom || {};\n              currentUri.custom[entry.customType] = entry.data;\n              // if this is manifest-level data attach to the top level manifest object\n            } else {\n              this.manifest.custom = this.manifest.custom || {};\n              this.manifest.custom[entry.customType] = entry.data;\n            }\n          }\n        })[entry.type].call(self);\n      });\n      return _this;\n    }\n\n    /**\n     * Parse the input string and update the manifest object.\n     *\n     * @param {String} chunk a potentially incomplete portion of the manifest\n     */\n\n    Parser.prototype.push = function push(chunk) {\n      this.lineStream.push(chunk);\n    };\n\n    /**\n     * Flush any remaining input. This can be handy if the last line of an M3U8\n     * manifest did not contain a trailing newline but the file has been\n     * completely received.\n     */\n\n    Parser.prototype.end = function end() {\n      // flush any buffered input\n      this.lineStream.push('\\n');\n    };\n    /**\n     * Add an additional parser for non-standard tags\n     *\n     * @param {Object}   options              a map of options for the added parser\n     * @param {RegExp}   options.expression   a regular expression to match the custom header\n     * @param {string}   options.type         the type to register to the output\n     * @param {Function} [options.dataParser] function to parse the line into an object\n     * @param {boolean}  [options.segment]    should tag data be attached to the segment object\n     */\n\n    Parser.prototype.addParser = function addParser(options) {\n      this.parseStream.addParser(options);\n    };\n\n    return Parser;\n  }(Stream);\n\n  /**\n   * mpd-parser\n   * @version 0.6.0\n   * @copyright 2018 Brightcove, Inc\n   * @license Apache-2.0\n   */\n\n  var formatAudioPlaylist = function formatAudioPlaylist(_ref) {\n    var _attributes;\n\n    var attributes = _ref.attributes,\n        segments = _ref.segments;\n\n    var playlist = {\n      attributes: (_attributes = {\n        NAME: attributes.id,\n        BANDWIDTH: attributes.bandwidth,\n        CODECS: attributes.codecs\n      }, _attributes['PROGRAM-ID'] = 1, _attributes),\n      uri: '',\n      endList: (attributes.type || 'static') === 'static',\n      timeline: attributes.periodIndex,\n      resolvedUri: '',\n      targetDuration: attributes.duration,\n      segments: segments,\n      mediaSequence: segments.length ? segments[0].number : 1\n    };\n\n    if (attributes.contentProtection) {\n      playlist.contentProtection = attributes.contentProtection;\n    }\n\n    return playlist;\n  };\n\n  var formatVttPlaylist = function formatVttPlaylist(_ref2) {\n    var _attributes2;\n\n    var attributes = _ref2.attributes,\n        segments = _ref2.segments;\n\n    if (typeof segments === 'undefined') {\n      // vtt tracks may use single file in BaseURL\n      segments = [{\n        uri: attributes.baseUrl,\n        timeline: attributes.periodIndex,\n        resolvedUri: attributes.baseUrl || '',\n        duration: attributes.sourceDuration,\n        number: 0\n      }];\n      // targetDuration should be the same duration as the only segment\n      attributes.duration = attributes.sourceDuration;\n    }\n    return {\n      attributes: (_attributes2 = {\n        NAME: attributes.id,\n        BANDWIDTH: attributes.bandwidth\n      }, _attributes2['PROGRAM-ID'] = 1, _attributes2),\n      uri: '',\n      endList: (attributes.type || 'static') === 'static',\n      timeline: attributes.periodIndex,\n      resolvedUri: attributes.baseUrl || '',\n      targetDuration: attributes.duration,\n      segments: segments,\n      mediaSequence: segments.length ? segments[0].number : 1\n    };\n  };\n\n  var organizeAudioPlaylists = function organizeAudioPlaylists(playlists) {\n    return playlists.reduce(function (a, playlist) {\n      var role = playlist.attributes.role && playlist.attributes.role.value || 'main';\n      var language = playlist.attributes.lang || '';\n\n      var label = 'main';\n\n      if (language) {\n        label = playlist.attributes.lang + ' (' + role + ')';\n      }\n\n      // skip if we already have the highest quality audio for a language\n      if (a[label] && a[label].playlists[0].attributes.BANDWIDTH > playlist.attributes.bandwidth) {\n        return a;\n      }\n\n      a[label] = {\n        language: language,\n        autoselect: true,\n        default: role === 'main',\n        playlists: [formatAudioPlaylist(playlist)],\n        uri: ''\n      };\n\n      return a;\n    }, {});\n  };\n\n  var organizeVttPlaylists = function organizeVttPlaylists(playlists) {\n    return playlists.reduce(function (a, playlist) {\n      var label = playlist.attributes.lang || 'text';\n\n      // skip if we already have subtitles\n      if (a[label]) {\n        return a;\n      }\n\n      a[label] = {\n        language: label,\n        default: false,\n        autoselect: false,\n        playlists: [formatVttPlaylist(playlist)],\n        uri: ''\n      };\n\n      return a;\n    }, {});\n  };\n\n  var formatVideoPlaylist = function formatVideoPlaylist(_ref3) {\n    var _attributes3;\n\n    var attributes = _ref3.attributes,\n        segments = _ref3.segments;\n\n    var playlist = {\n      attributes: (_attributes3 = {\n        NAME: attributes.id,\n        AUDIO: 'audio',\n        SUBTITLES: 'subs',\n        RESOLUTION: {\n          width: attributes.width,\n          height: attributes.height\n        },\n        CODECS: attributes.codecs,\n        BANDWIDTH: attributes.bandwidth\n      }, _attributes3['PROGRAM-ID'] = 1, _attributes3),\n      uri: '',\n      endList: (attributes.type || 'static') === 'static',\n      timeline: attributes.periodIndex,\n      resolvedUri: '',\n      targetDuration: attributes.duration,\n      segments: segments,\n      mediaSequence: segments.length ? segments[0].number : 1\n    };\n\n    if (attributes.contentProtection) {\n      playlist.contentProtection = attributes.contentProtection;\n    }\n\n    return playlist;\n  };\n\n  var toM3u8 = function toM3u8(dashPlaylists) {\n    var _mediaGroups;\n\n    if (!dashPlaylists.length) {\n      return {};\n    }\n\n    // grab all master attributes\n    var _dashPlaylists$0$attr = dashPlaylists[0].attributes,\n        duration = _dashPlaylists$0$attr.sourceDuration,\n        _dashPlaylists$0$attr2 = _dashPlaylists$0$attr.minimumUpdatePeriod,\n        minimumUpdatePeriod = _dashPlaylists$0$attr2 === undefined ? 0 : _dashPlaylists$0$attr2;\n\n\n    var videoOnly = function videoOnly(_ref4) {\n      var attributes = _ref4.attributes;\n      return attributes.mimeType === 'video/mp4' || attributes.contentType === 'video';\n    };\n    var audioOnly = function audioOnly(_ref5) {\n      var attributes = _ref5.attributes;\n      return attributes.mimeType === 'audio/mp4' || attributes.contentType === 'audio';\n    };\n    var vttOnly = function vttOnly(_ref6) {\n      var attributes = _ref6.attributes;\n      return attributes.mimeType === 'text/vtt' || attributes.contentType === 'text';\n    };\n\n    var videoPlaylists = dashPlaylists.filter(videoOnly).map(formatVideoPlaylist);\n    var audioPlaylists = dashPlaylists.filter(audioOnly);\n    var vttPlaylists = dashPlaylists.filter(vttOnly);\n\n    var master = {\n      allowCache: true,\n      discontinuityStarts: [],\n      segments: [],\n      endList: true,\n      mediaGroups: (_mediaGroups = {\n        AUDIO: {},\n        VIDEO: {}\n      }, _mediaGroups['CLOSED-CAPTIONS'] = {}, _mediaGroups.SUBTITLES = {}, _mediaGroups),\n      uri: '',\n      duration: duration,\n      playlists: videoPlaylists,\n      minimumUpdatePeriod: minimumUpdatePeriod * 1000\n    };\n\n    if (audioPlaylists.length) {\n      master.mediaGroups.AUDIO.audio = organizeAudioPlaylists(audioPlaylists);\n    }\n\n    if (vttPlaylists.length) {\n      master.mediaGroups.SUBTITLES.subs = organizeVttPlaylists(vttPlaylists);\n    }\n\n    return master;\n  };\n\n  var isObject$1 = function isObject(obj) {\n    return !!obj && (typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object';\n  };\n\n  var merge = function merge() {\n    for (var _len = arguments.length, objects = Array(_len), _key = 0; _key < _len; _key++) {\n      objects[_key] = arguments[_key];\n    }\n\n    return objects.reduce(function (result, source) {\n\n      Object.keys(source).forEach(function (key) {\n\n        if (Array.isArray(result[key]) && Array.isArray(source[key])) {\n          result[key] = result[key].concat(source[key]);\n        } else if (isObject$1(result[key]) && isObject$1(source[key])) {\n          result[key] = merge(result[key], source[key]);\n        } else {\n          result[key] = source[key];\n        }\n      });\n      return result;\n    }, {});\n  };\n\n  var resolveUrl = function resolveUrl(baseUrl, relativeUrl) {\n    // return early if we don't need to resolve\n    if (/^[a-z]+:/i.test(relativeUrl)) {\n      return relativeUrl;\n    }\n\n    // if the base URL is relative then combine with the current location\n    if (!/\\/\\//i.test(baseUrl)) {\n      baseUrl = urlToolkit.buildAbsoluteURL(window_1.location.href, baseUrl);\n    }\n\n    return urlToolkit.buildAbsoluteURL(baseUrl, relativeUrl);\n  };\n\n  /**\n   * @typedef {Object} SingleUri\n   * @property {string} uri - relative location of segment\n   * @property {string} resolvedUri - resolved location of segment\n   * @property {Object} byterange - Object containing information on how to make byte range\n   *   requests following byte-range-spec per RFC2616.\n   * @property {String} byterange.length - length of range request\n   * @property {String} byterange.offset - byte offset of range request\n   *\n   * @see https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.1\n   */\n\n  /**\n   * Converts a URLType node (5.3.9.2.3 Table 13) to a segment object\n   * that conforms to how m3u8-parser is structured\n   *\n   * @see https://github.com/videojs/m3u8-parser\n   *\n   * @param {string} baseUrl - baseUrl provided by <BaseUrl> nodes\n   * @param {string} source - source url for segment\n   * @param {string} range - optional range used for range calls, follows\n   * @return {SingleUri} full segment information transformed into a format similar\n   *   to m3u8-parser\n   */\n  var urlTypeToSegment = function urlTypeToSegment(_ref7) {\n    var _ref7$baseUrl = _ref7.baseUrl,\n        baseUrl = _ref7$baseUrl === undefined ? '' : _ref7$baseUrl,\n        _ref7$source = _ref7.source,\n        source = _ref7$source === undefined ? '' : _ref7$source,\n        _ref7$range = _ref7.range,\n        range = _ref7$range === undefined ? '' : _ref7$range;\n\n    var init = {\n      uri: source,\n      resolvedUri: resolveUrl(baseUrl || '', source)\n    };\n\n    if (range) {\n      var ranges = range.split('-');\n      var startRange = parseInt(ranges[0], 10);\n      var endRange = parseInt(ranges[1], 10);\n\n      init.byterange = {\n        length: endRange - startRange,\n        offset: startRange\n      };\n    }\n\n    return init;\n  };\n\n  /**\n   * Calculates the R (repetition) value for a live stream (for the final segment\n   * in a manifest where the r value is negative 1)\n   *\n   * @param {Object} attributes\n   *        Object containing all inherited attributes from parent elements with attribute\n   *        names as keys\n   * @param {number} time\n   *        current time (typically the total time up until the final segment)\n   * @param {number} duration\n   *        duration property for the given <S />\n   *\n   * @return {number}\n   *        R value to reach the end of the given period\n   */\n  var getLiveRValue = function getLiveRValue(attributes, time, duration) {\n    var NOW = attributes.NOW,\n        clientOffset = attributes.clientOffset,\n        availabilityStartTime = attributes.availabilityStartTime,\n        _attributes$timescale = attributes.timescale,\n        timescale = _attributes$timescale === undefined ? 1 : _attributes$timescale,\n        _attributes$start = attributes.start,\n        start = _attributes$start === undefined ? 0 : _attributes$start,\n        _attributes$minimumUp = attributes.minimumUpdatePeriod,\n        minimumUpdatePeriod = _attributes$minimumUp === undefined ? 0 : _attributes$minimumUp;\n\n    var now = (NOW + clientOffset) / 1000;\n    var periodStartWC = availabilityStartTime + start;\n    var periodEndWC = now + minimumUpdatePeriod;\n    var periodDuration = periodEndWC - periodStartWC;\n\n    return Math.ceil((periodDuration * timescale - time) / duration);\n  };\n\n  /**\n   * Uses information provided by SegmentTemplate.SegmentTimeline to determine segment\n   * timing and duration\n   *\n   * @param {Object} attributes\n   *        Object containing all inherited attributes from parent elements with attribute\n   *        names as keys\n   * @param {Object[]} segmentTimeline\n   *        List of objects representing the attributes of each S element contained within\n   *\n   * @return {{number: number, duration: number, time: number, timeline: number}[]}\n   *         List of Objects with segment timing and duration info\n   */\n  var parseByTimeline = function parseByTimeline(attributes, segmentTimeline) {\n    var _attributes$type = attributes.type,\n        type = _attributes$type === undefined ? 'static' : _attributes$type,\n        _attributes$minimumUp2 = attributes.minimumUpdatePeriod,\n        minimumUpdatePeriod = _attributes$minimumUp2 === undefined ? 0 : _attributes$minimumUp2,\n        _attributes$media = attributes.media,\n        media = _attributes$media === undefined ? '' : _attributes$media,\n        sourceDuration = attributes.sourceDuration,\n        _attributes$timescale2 = attributes.timescale,\n        timescale = _attributes$timescale2 === undefined ? 1 : _attributes$timescale2,\n        _attributes$startNumb = attributes.startNumber,\n        startNumber = _attributes$startNumb === undefined ? 1 : _attributes$startNumb,\n        timeline = attributes.periodIndex;\n\n    var segments = [];\n    var time = -1;\n\n    for (var sIndex = 0; sIndex < segmentTimeline.length; sIndex++) {\n      var S = segmentTimeline[sIndex];\n      var duration = S.d;\n      var repeat = S.r || 0;\n      var segmentTime = S.t || 0;\n\n      if (time < 0) {\n        // first segment\n        time = segmentTime;\n      }\n\n      if (segmentTime && segmentTime > time) {\n        // discontinuity\n\n        // TODO: How to handle this type of discontinuity\n        // timeline++ here would treat it like HLS discontuity and content would\n        // get appended without gap\n        // E.G.\n        //  <S t=\"0\" d=\"1\" />\n        //  <S d=\"1\" />\n        //  <S d=\"1\" />\n        //  <S t=\"5\" d=\"1\" />\n        // would have $Time$ values of [0, 1, 2, 5]\n        // should this be appened at time positions [0, 1, 2, 3],(#EXT-X-DISCONTINUITY)\n        // or [0, 1, 2, gap, gap, 5]? (#EXT-X-GAP)\n        // does the value of sourceDuration consider this when calculating arbitrary\n        // negative @r repeat value?\n        // E.G. Same elements as above with this added at the end\n        //  <S d=\"1\" r=\"-1\" />\n        //  with a sourceDuration of 10\n        // Would the 2 gaps be included in the time duration calculations resulting in\n        // 8 segments with $Time$ values of [0, 1, 2, 5, 6, 7, 8, 9] or 10 segments\n        // with $Time$ values of [0, 1, 2, 5, 6, 7, 8, 9, 10, 11] ?\n\n        time = segmentTime;\n      }\n\n      var count = void 0;\n\n      if (repeat < 0) {\n        var nextS = sIndex + 1;\n\n        if (nextS === segmentTimeline.length) {\n          // last segment\n          if (type === 'dynamic' && minimumUpdatePeriod > 0 && media.indexOf('$Number$') > 0) {\n            count = getLiveRValue(attributes, time, duration);\n          } else {\n            // TODO: This may be incorrect depending on conclusion of TODO above\n            count = (sourceDuration * timescale - time) / duration;\n          }\n        } else {\n          count = (segmentTimeline[nextS].t - time) / duration;\n        }\n      } else {\n        count = repeat + 1;\n      }\n\n      var end = startNumber + segments.length + count;\n      var number = startNumber + segments.length;\n\n      while (number < end) {\n        segments.push({ number: number, duration: duration / timescale, time: time, timeline: timeline });\n        time += duration;\n        number++;\n      }\n    }\n\n    return segments;\n  };\n\n  var range = function range(start, end) {\n    var result = [];\n\n    for (var i = start; i < end; i++) {\n      result.push(i);\n    }\n\n    return result;\n  };\n\n  var flatten = function flatten(lists) {\n    return lists.reduce(function (x, y) {\n      return x.concat(y);\n    }, []);\n  };\n\n  var from = function from(list) {\n    if (!list.length) {\n      return [];\n    }\n\n    var result = [];\n\n    for (var i = 0; i < list.length; i++) {\n      result.push(list[i]);\n    }\n\n    return result;\n  };\n\n  /**\n   * Functions for calculating the range of available segments in static and dynamic\n   * manifests.\n   */\n  var segmentRange = {\n    /**\n     * Returns the entire range of available segments for a static MPD\n     *\n     * @param {Object} attributes\n     *        Inheritied MPD attributes\n     * @return {{ start: number, end: number }}\n     *         The start and end numbers for available segments\n     */\n    static: function _static(attributes) {\n      var duration = attributes.duration,\n          _attributes$timescale3 = attributes.timescale,\n          timescale = _attributes$timescale3 === undefined ? 1 : _attributes$timescale3,\n          sourceDuration = attributes.sourceDuration;\n\n\n      return {\n        start: 0,\n        end: Math.ceil(sourceDuration / (duration / timescale))\n      };\n    },\n\n\n    /**\n     * Returns the current live window range of available segments for a dynamic MPD\n     *\n     * @param {Object} attributes\n     *        Inheritied MPD attributes\n     * @return {{ start: number, end: number }}\n     *         The start and end numbers for available segments\n     */\n    dynamic: function dynamic(attributes) {\n      var NOW = attributes.NOW,\n          clientOffset = attributes.clientOffset,\n          availabilityStartTime = attributes.availabilityStartTime,\n          _attributes$timescale4 = attributes.timescale,\n          timescale = _attributes$timescale4 === undefined ? 1 : _attributes$timescale4,\n          duration = attributes.duration,\n          _attributes$start2 = attributes.start,\n          start = _attributes$start2 === undefined ? 0 : _attributes$start2,\n          _attributes$minimumUp3 = attributes.minimumUpdatePeriod,\n          minimumUpdatePeriod = _attributes$minimumUp3 === undefined ? 0 : _attributes$minimumUp3,\n          _attributes$timeShift = attributes.timeShiftBufferDepth,\n          timeShiftBufferDepth = _attributes$timeShift === undefined ? Infinity : _attributes$timeShift;\n\n      var now = (NOW + clientOffset) / 1000;\n      var periodStartWC = availabilityStartTime + start;\n      var periodEndWC = now + minimumUpdatePeriod;\n      var periodDuration = periodEndWC - periodStartWC;\n      var segmentCount = Math.ceil(periodDuration * timescale / duration);\n      var availableStart = Math.floor((now - periodStartWC - timeShiftBufferDepth) * timescale / duration);\n      var availableEnd = Math.floor((now - periodStartWC) * timescale / duration);\n\n      return {\n        start: Math.max(0, availableStart),\n        end: Math.min(segmentCount, availableEnd)\n      };\n    }\n  };\n\n  /**\n   * Maps a range of numbers to objects with information needed to build the corresponding\n   * segment list\n   *\n   * @name toSegmentsCallback\n   * @function\n   * @param {number} number\n   *        Number of the segment\n   * @param {number} index\n   *        Index of the number in the range list\n   * @return {{ number: Number, duration: Number, timeline: Number, time: Number }}\n   *         Object with segment timing and duration info\n   */\n\n  /**\n   * Returns a callback for Array.prototype.map for mapping a range of numbers to\n   * information needed to build the segment list.\n   *\n   * @param {Object} attributes\n   *        Inherited MPD attributes\n   * @return {toSegmentsCallback}\n   *         Callback map function\n   */\n  var toSegments = function toSegments(attributes) {\n    return function (number, index) {\n      var duration = attributes.duration,\n          _attributes$timescale5 = attributes.timescale,\n          timescale = _attributes$timescale5 === undefined ? 1 : _attributes$timescale5,\n          periodIndex = attributes.periodIndex,\n          _attributes$startNumb2 = attributes.startNumber,\n          startNumber = _attributes$startNumb2 === undefined ? 1 : _attributes$startNumb2;\n\n\n      return {\n        number: startNumber + number,\n        duration: duration / timescale,\n        timeline: periodIndex,\n        time: index * duration\n      };\n    };\n  };\n\n  /**\n   * Returns a list of objects containing segment timing and duration info used for\n   * building the list of segments. This uses the @duration attribute specified\n   * in the MPD manifest to derive the range of segments.\n   *\n   * @param {Object} attributes\n   *        Inherited MPD attributes\n   * @return {{number: number, duration: number, time: number, timeline: number}[]}\n   *         List of Objects with segment timing and duration info\n   */\n  var parseByDuration = function parseByDuration(attributes) {\n    var _attributes$type2 = attributes.type,\n        type = _attributes$type2 === undefined ? 'static' : _attributes$type2,\n        duration = attributes.duration,\n        _attributes$timescale6 = attributes.timescale,\n        timescale = _attributes$timescale6 === undefined ? 1 : _attributes$timescale6,\n        sourceDuration = attributes.sourceDuration;\n\n    var _segmentRange$type = segmentRange[type](attributes),\n        start = _segmentRange$type.start,\n        end = _segmentRange$type.end;\n\n    var segments = range(start, end).map(toSegments(attributes));\n\n    if (type === 'static') {\n      var index = segments.length - 1;\n\n      // final segment may be less than full segment duration\n      segments[index].duration = sourceDuration - duration / timescale * index;\n    }\n\n    return segments;\n  };\n\n  var identifierPattern = /\\$([A-z]*)(?:(%0)([0-9]+)d)?\\$/g;\n\n  /**\n   * Replaces template identifiers with corresponding values. To be used as the callback\n   * for String.prototype.replace\n   *\n   * @name replaceCallback\n   * @function\n   * @param {string} match\n   *        Entire match of identifier\n   * @param {string} identifier\n   *        Name of matched identifier\n   * @param {string} format\n   *        Format tag string. Its presence indicates that padding is expected\n   * @param {string} width\n   *        Desired length of the replaced value. Values less than this width shall be left\n   *        zero padded\n   * @return {string}\n   *         Replacement for the matched identifier\n   */\n\n  /**\n   * Returns a function to be used as a callback for String.prototype.replace to replace\n   * template identifiers\n   *\n   * @param {Obect} values\n   *        Object containing values that shall be used to replace known identifiers\n   * @param {number} values.RepresentationID\n   *        Value of the Representation@id attribute\n   * @param {number} values.Number\n   *        Number of the corresponding segment\n   * @param {number} values.Bandwidth\n   *        Value of the Representation@bandwidth attribute.\n   * @param {number} values.Time\n   *        Timestamp value of the corresponding segment\n   * @return {replaceCallback}\n   *         Callback to be used with String.prototype.replace to replace identifiers\n   */\n  var identifierReplacement = function identifierReplacement(values) {\n    return function (match, identifier, format, width) {\n      if (match === '$$') {\n        // escape sequence\n        return '$';\n      }\n\n      if (typeof values[identifier] === 'undefined') {\n        return match;\n      }\n\n      var value = '' + values[identifier];\n\n      if (identifier === 'RepresentationID') {\n        // Format tag shall not be present with RepresentationID\n        return value;\n      }\n\n      if (!format) {\n        width = 1;\n      } else {\n        width = parseInt(width, 10);\n      }\n\n      if (value.length >= width) {\n        return value;\n      }\n\n      return '' + new Array(width - value.length + 1).join('0') + value;\n    };\n  };\n\n  /**\n   * Constructs a segment url from a template string\n   *\n   * @param {string} url\n   *        Template string to construct url from\n   * @param {Obect} values\n   *        Object containing values that shall be used to replace known identifiers\n   * @param {number} values.RepresentationID\n   *        Value of the Representation@id attribute\n   * @param {number} values.Number\n   *        Number of the corresponding segment\n   * @param {number} values.Bandwidth\n   *        Value of the Representation@bandwidth attribute.\n   * @param {number} values.Time\n   *        Timestamp value of the corresponding segment\n   * @return {string}\n   *         Segment url with identifiers replaced\n   */\n  var constructTemplateUrl = function constructTemplateUrl(url, values) {\n    return url.replace(identifierPattern, identifierReplacement(values));\n  };\n\n  /**\n   * Generates a list of objects containing timing and duration information about each\n   * segment needed to generate segment uris and the complete segment object\n   *\n   * @param {Object} attributes\n   *        Object containing all inherited attributes from parent elements with attribute\n   *        names as keys\n   * @param {Object[]|undefined} segmentTimeline\n   *        List of objects representing the attributes of each S element contained within\n   *        the SegmentTimeline element\n   * @return {{number: number, duration: number, time: number, timeline: number}[]}\n   *         List of Objects with segment timing and duration info\n   */\n  var parseTemplateInfo = function parseTemplateInfo(attributes, segmentTimeline) {\n    if (!attributes.duration && !segmentTimeline) {\n      // if neither @duration or SegmentTimeline are present, then there shall be exactly\n      // one media segment\n      return [{\n        number: attributes.startNumber || 1,\n        duration: attributes.sourceDuration,\n        time: 0,\n        timeline: attributes.periodIndex\n      }];\n    }\n\n    if (attributes.duration) {\n      return parseByDuration(attributes);\n    }\n\n    return parseByTimeline(attributes, segmentTimeline);\n  };\n\n  /**\n   * Generates a list of segments using information provided by the SegmentTemplate element\n   *\n   * @param {Object} attributes\n   *        Object containing all inherited attributes from parent elements with attribute\n   *        names as keys\n   * @param {Object[]|undefined} segmentTimeline\n   *        List of objects representing the attributes of each S element contained within\n   *        the SegmentTimeline element\n   * @return {Object[]}\n   *         List of segment objects\n   */\n  var segmentsFromTemplate = function segmentsFromTemplate(attributes, segmentTimeline) {\n    var templateValues = {\n      RepresentationID: attributes.id,\n      Bandwidth: attributes.bandwidth || 0\n    };\n\n    var _attributes$initializ = attributes.initialization,\n        initialization = _attributes$initializ === undefined ? { sourceURL: '', range: '' } : _attributes$initializ;\n\n\n    var mapSegment = urlTypeToSegment({\n      baseUrl: attributes.baseUrl,\n      source: constructTemplateUrl(initialization.sourceURL, templateValues),\n      range: initialization.range\n    });\n\n    var segments = parseTemplateInfo(attributes, segmentTimeline);\n\n    return segments.map(function (segment) {\n      templateValues.Number = segment.number;\n      templateValues.Time = segment.time;\n\n      var uri = constructTemplateUrl(attributes.media || '', templateValues);\n\n      return {\n        uri: uri,\n        timeline: segment.timeline,\n        duration: segment.duration,\n        resolvedUri: resolveUrl(attributes.baseUrl || '', uri),\n        map: mapSegment,\n        number: segment.number\n      };\n    });\n  };\n\n  var errors = {\n    INVALID_NUMBER_OF_PERIOD: 'INVALID_NUMBER_OF_PERIOD',\n    DASH_EMPTY_MANIFEST: 'DASH_EMPTY_MANIFEST',\n    DASH_INVALID_XML: 'DASH_INVALID_XML',\n    NO_BASE_URL: 'NO_BASE_URL',\n    MISSING_SEGMENT_INFORMATION: 'MISSING_SEGMENT_INFORMATION',\n    SEGMENT_TIME_UNSPECIFIED: 'SEGMENT_TIME_UNSPECIFIED',\n    UNSUPPORTED_UTC_TIMING_SCHEME: 'UNSUPPORTED_UTC_TIMING_SCHEME'\n  };\n\n  /**\n   * Converts a <SegmentUrl> (of type URLType from the DASH spec 5.3.9.2 Table 14)\n   * to an object that matches the output of a segment in videojs/mpd-parser\n   *\n   * @param {Object} attributes\n   *   Object containing all inherited attributes from parent elements with attribute\n   *   names as keys\n   * @param {Object} segmentUrl\n   *   <SegmentURL> node to translate into a segment object\n   * @return {Object} translated segment object\n   */\n  var SegmentURLToSegmentObject = function SegmentURLToSegmentObject(attributes, segmentUrl) {\n    var baseUrl = attributes.baseUrl,\n        _attributes$initializ2 = attributes.initialization,\n        initialization = _attributes$initializ2 === undefined ? {} : _attributes$initializ2;\n\n\n    var initSegment = urlTypeToSegment({\n      baseUrl: baseUrl,\n      source: initialization.sourceURL,\n      range: initialization.range\n    });\n\n    var segment = urlTypeToSegment({\n      baseUrl: baseUrl,\n      source: segmentUrl.media,\n      range: segmentUrl.mediaRange\n    });\n\n    segment.map = initSegment;\n\n    return segment;\n  };\n\n  /**\n   * Generates a list of segments using information provided by the SegmentList element\n   * SegmentList (DASH SPEC Section 5.3.9.3.2) contains a set of <SegmentURL> nodes.  Each\n   * node should be translated into segment.\n   *\n   * @param {Object} attributes\n   *   Object containing all inherited attributes from parent elements with attribute\n   *   names as keys\n   * @param {Object[]|undefined} segmentTimeline\n   *        List of objects representing the attributes of each S element contained within\n   *        the SegmentTimeline element\n   * @return {Object.<Array>} list of segments\n   */\n  var segmentsFromList = function segmentsFromList(attributes, segmentTimeline) {\n    var duration = attributes.duration,\n        _attributes$segmentUr = attributes.segmentUrls,\n        segmentUrls = _attributes$segmentUr === undefined ? [] : _attributes$segmentUr;\n\n    // Per spec (5.3.9.2.1) no way to determine segment duration OR\n    // if both SegmentTimeline and @duration are defined, it is outside of spec.\n\n    if (!duration && !segmentTimeline || duration && segmentTimeline) {\n      throw new Error(errors.SEGMENT_TIME_UNSPECIFIED);\n    }\n\n    var segmentUrlMap = segmentUrls.map(function (segmentUrlObject) {\n      return SegmentURLToSegmentObject(attributes, segmentUrlObject);\n    });\n    var segmentTimeInfo = void 0;\n\n    if (duration) {\n      segmentTimeInfo = parseByDuration(attributes);\n    }\n\n    if (segmentTimeline) {\n      segmentTimeInfo = parseByTimeline(attributes, segmentTimeline);\n    }\n\n    var segments = segmentTimeInfo.map(function (segmentTime, index) {\n      if (segmentUrlMap[index]) {\n        var segment = segmentUrlMap[index];\n\n        segment.timeline = segmentTime.timeline;\n        segment.duration = segmentTime.duration;\n        segment.number = segmentTime.number;\n        return segment;\n      }\n      // Since we're mapping we should get rid of any blank segments (in case\n      // the given SegmentTimeline is handling for more elements than we have\n      // SegmentURLs for).\n    }).filter(function (segment) {\n      return segment;\n    });\n\n    return segments;\n  };\n\n  /**\n   * Translates SegmentBase into a set of segments.\n   * (DASH SPEC Section 5.3.9.3.2) contains a set of <SegmentURL> nodes.  Each\n   * node should be translated into segment.\n   *\n   * @param {Object} attributes\n   *   Object containing all inherited attributes from parent elements with attribute\n   *   names as keys\n   * @return {Object.<Array>} list of segments\n   */\n  var segmentsFromBase = function segmentsFromBase(attributes) {\n    var baseUrl = attributes.baseUrl,\n        _attributes$initializ3 = attributes.initialization,\n        initialization = _attributes$initializ3 === undefined ? {} : _attributes$initializ3,\n        sourceDuration = attributes.sourceDuration,\n        _attributes$timescale7 = attributes.timescale,\n        timescale = _attributes$timescale7 === undefined ? 1 : _attributes$timescale7,\n        _attributes$indexRang = attributes.indexRange,\n        indexRange = _attributes$indexRang === undefined ? '' : _attributes$indexRang,\n        duration = attributes.duration;\n\n    // base url is required for SegmentBase to work, per spec (Section 5.3.9.2.1)\n\n    if (!baseUrl) {\n      throw new Error(errors.NO_BASE_URL);\n    }\n\n    var initSegment = urlTypeToSegment({\n      baseUrl: baseUrl,\n      source: initialization.sourceURL,\n      range: initialization.range\n    });\n    var segment = urlTypeToSegment({ baseUrl: baseUrl, source: baseUrl, range: indexRange });\n\n    segment.map = initSegment;\n\n    // If there is a duration, use it, otherwise use the given duration of the source\n    // (since SegmentBase is only for one total segment)\n    if (duration) {\n      var segmentTimeInfo = parseByDuration(attributes);\n\n      if (segmentTimeInfo.length) {\n        segment.duration = segmentTimeInfo[0].duration;\n        segment.timeline = segmentTimeInfo[0].timeline;\n      }\n    } else if (sourceDuration) {\n      segment.duration = sourceDuration / timescale;\n      segment.timeline = 0;\n    }\n\n    // This is used for mediaSequence\n    segment.number = 0;\n\n    return [segment];\n  };\n\n  var generateSegments = function generateSegments(_ref8) {\n    var attributes = _ref8.attributes,\n        segmentInfo = _ref8.segmentInfo;\n\n    var segmentAttributes = void 0;\n    var segmentsFn = void 0;\n\n    if (segmentInfo.template) {\n      segmentsFn = segmentsFromTemplate;\n      segmentAttributes = merge(attributes, segmentInfo.template);\n    } else if (segmentInfo.base) {\n      segmentsFn = segmentsFromBase;\n      segmentAttributes = merge(attributes, segmentInfo.base);\n    } else if (segmentInfo.list) {\n      segmentsFn = segmentsFromList;\n      segmentAttributes = merge(attributes, segmentInfo.list);\n    }\n\n    if (!segmentsFn) {\n      return { attributes: attributes };\n    }\n\n    var segments = segmentsFn(segmentAttributes, segmentInfo.timeline);\n\n    // The @duration attribute will be used to determin the playlist's targetDuration which\n    // must be in seconds. Since we've generated the segment list, we no longer need\n    // @duration to be in @timescale units, so we can convert it here.\n    if (segmentAttributes.duration) {\n      var _segmentAttributes = segmentAttributes,\n          duration = _segmentAttributes.duration,\n          _segmentAttributes$ti = _segmentAttributes.timescale,\n          timescale = _segmentAttributes$ti === undefined ? 1 : _segmentAttributes$ti;\n\n\n      segmentAttributes.duration = duration / timescale;\n    } else if (segments.length) {\n      // if there is no @duration attribute, use the largest segment duration as\n      // as target duration\n      segmentAttributes.duration = segments.reduce(function (max, segment) {\n        return Math.max(max, Math.ceil(segment.duration));\n      }, 0);\n    } else {\n      segmentAttributes.duration = 0;\n    }\n\n    return {\n      attributes: segmentAttributes,\n      segments: segments\n    };\n  };\n\n  var toPlaylists = function toPlaylists(representations) {\n    return representations.map(generateSegments);\n  };\n\n  var findChildren = function findChildren(element, name) {\n    return from(element.childNodes).filter(function (_ref9) {\n      var tagName = _ref9.tagName;\n      return tagName === name;\n    });\n  };\n\n  var getContent = function getContent(element) {\n    return element.textContent.trim();\n  };\n\n  var parseDuration = function parseDuration(str) {\n    var SECONDS_IN_YEAR = 365 * 24 * 60 * 60;\n    var SECONDS_IN_MONTH = 30 * 24 * 60 * 60;\n    var SECONDS_IN_DAY = 24 * 60 * 60;\n    var SECONDS_IN_HOUR = 60 * 60;\n    var SECONDS_IN_MIN = 60;\n\n    // P10Y10M10DT10H10M10.1S\n    var durationRegex = /P(?:(\\d*)Y)?(?:(\\d*)M)?(?:(\\d*)D)?(?:T(?:(\\d*)H)?(?:(\\d*)M)?(?:([\\d.]*)S)?)?/;\n    var match = durationRegex.exec(str);\n\n    if (!match) {\n      return 0;\n    }\n\n    var _match$slice = match.slice(1),\n        year = _match$slice[0],\n        month = _match$slice[1],\n        day = _match$slice[2],\n        hour = _match$slice[3],\n        minute = _match$slice[4],\n        second = _match$slice[5];\n\n    return parseFloat(year || 0) * SECONDS_IN_YEAR + parseFloat(month || 0) * SECONDS_IN_MONTH + parseFloat(day || 0) * SECONDS_IN_DAY + parseFloat(hour || 0) * SECONDS_IN_HOUR + parseFloat(minute || 0) * SECONDS_IN_MIN + parseFloat(second || 0);\n  };\n\n  var parseDate = function parseDate(str) {\n    // Date format without timezone according to ISO 8601\n    // YYY-MM-DDThh:mm:ss.ssssss\n    var dateRegex = /^\\d+-\\d+-\\d+T\\d+:\\d+:\\d+(\\.\\d+)?$/;\n\n    // If the date string does not specifiy a timezone, we must specifiy UTC. This is\n    // expressed by ending with 'Z'\n    if (dateRegex.test(str)) {\n      str += 'Z';\n    }\n\n    return Date.parse(str);\n  };\n\n  // TODO: maybe order these in some way that makes it easy to find specific attributes\n  var parsers = {\n    /**\n     * Specifies the duration of the entire Media Presentation. Format is a duration string\n     * as specified in ISO 8601\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The duration in seconds\n     */\n    mediaPresentationDuration: function mediaPresentationDuration(value) {\n      return parseDuration(value);\n    },\n\n\n    /**\n     * Specifies the Segment availability start time for all Segments referred to in this\n     * MPD. For a dynamic manifest, it specifies the anchor for the earliest availability\n     * time. Format is a date string as specified in ISO 8601\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The date as seconds from unix epoch\n     */\n    availabilityStartTime: function availabilityStartTime(value) {\n      return parseDate(value) / 1000;\n    },\n\n\n    /**\n     * Specifies the smallest period between potential changes to the MPD. Format is a\n     * duration string as specified in ISO 8601\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The duration in seconds\n     */\n    minimumUpdatePeriod: function minimumUpdatePeriod(value) {\n      return parseDuration(value);\n    },\n\n\n    /**\n     * Specifies the duration of the smallest time shifting buffer for any Representation\n     * in the MPD. Format is a duration string as specified in ISO 8601\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The duration in seconds\n     */\n    timeShiftBufferDepth: function timeShiftBufferDepth(value) {\n      return parseDuration(value);\n    },\n\n\n    /**\n     * Specifies the PeriodStart time of the Period relative to the availabilityStarttime.\n     * Format is a duration string as specified in ISO 8601\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The duration in seconds\n     */\n    start: function start(value) {\n      return parseDuration(value);\n    },\n\n\n    /**\n     * Specifies the width of the visual presentation\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The parsed width\n     */\n    width: function width(value) {\n      return parseInt(value, 10);\n    },\n\n\n    /**\n     * Specifies the height of the visual presentation\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The parsed height\n     */\n    height: function height(value) {\n      return parseInt(value, 10);\n    },\n\n\n    /**\n     * Specifies the bitrate of the representation\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The parsed bandwidth\n     */\n    bandwidth: function bandwidth(value) {\n      return parseInt(value, 10);\n    },\n\n\n    /**\n     * Specifies the number of the first Media Segment in this Representation in the Period\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The parsed number\n     */\n    startNumber: function startNumber(value) {\n      return parseInt(value, 10);\n    },\n\n\n    /**\n     * Specifies the timescale in units per seconds\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The aprsed timescale\n     */\n    timescale: function timescale(value) {\n      return parseInt(value, 10);\n    },\n\n\n    /**\n     * Specifies the constant approximate Segment duration\n     * NOTE: The <Period> element also contains an @duration attribute. This duration\n     *       specifies the duration of the Period. This attribute is currently not\n     *       supported by the rest of the parser, however we still check for it to prevent\n     *       errors.\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The parsed duration\n     */\n    duration: function duration(value) {\n      var parsedValue = parseInt(value, 10);\n\n      if (isNaN(parsedValue)) {\n        return parseDuration(value);\n      }\n\n      return parsedValue;\n    },\n\n\n    /**\n     * Specifies the Segment duration, in units of the value of the @timescale.\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The parsed duration\n     */\n    d: function d(value) {\n      return parseInt(value, 10);\n    },\n\n\n    /**\n     * Specifies the MPD start time, in @timescale units, the first Segment in the series\n     * starts relative to the beginning of the Period\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The parsed time\n     */\n    t: function t(value) {\n      return parseInt(value, 10);\n    },\n\n\n    /**\n     * Specifies the repeat count of the number of following contiguous Segments with the\n     * same duration expressed by the value of @d\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {number}\n     *         The parsed number\n     */\n    r: function r(value) {\n      return parseInt(value, 10);\n    },\n\n\n    /**\n     * Default parser for all other attributes. Acts as a no-op and just returns the value\n     * as a string\n     *\n     * @param {string} value\n     *        value of attribute as a string\n     * @return {string}\n     *         Unparsed value\n     */\n    DEFAULT: function DEFAULT(value) {\n      return value;\n    }\n  };\n\n  /**\n   * Gets all the attributes and values of the provided node, parses attributes with known\n   * types, and returns an object with attribute names mapped to values.\n   *\n   * @param {Node} el\n   *        The node to parse attributes from\n   * @return {Object}\n   *         Object with all attributes of el parsed\n   */\n  var parseAttributes$1 = function parseAttributes(el) {\n    if (!(el && el.attributes)) {\n      return {};\n    }\n\n    return from(el.attributes).reduce(function (a, e) {\n      var parseFn = parsers[e.name] || parsers.DEFAULT;\n\n      a[e.name] = parseFn(e.value);\n\n      return a;\n    }, {});\n  };\n\n  function decodeB64ToUint8Array(b64Text) {\n    var decodedString = window_1.atob(b64Text);\n    var array = new Uint8Array(decodedString.length);\n\n    for (var i = 0; i < decodedString.length; i++) {\n      array[i] = decodedString.charCodeAt(i);\n    }\n    return array;\n  }\n\n  var keySystemsMap = {\n    'urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b': 'org.w3.clearkey',\n    'urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed': 'com.widevine.alpha',\n    'urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95': 'com.microsoft.playready',\n    'urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb': 'com.adobe.primetime'\n  };\n\n  /**\n   * Builds a list of urls that is the product of the reference urls and BaseURL values\n   *\n   * @param {string[]} referenceUrls\n   *        List of reference urls to resolve to\n   * @param {Node[]} baseUrlElements\n   *        List of BaseURL nodes from the mpd\n   * @return {string[]}\n   *         List of resolved urls\n   */\n  var buildBaseUrls = function buildBaseUrls(referenceUrls, baseUrlElements) {\n    if (!baseUrlElements.length) {\n      return referenceUrls;\n    }\n\n    return flatten(referenceUrls.map(function (reference) {\n      return baseUrlElements.map(function (baseUrlElement) {\n        return resolveUrl(reference, getContent(baseUrlElement));\n      });\n    }));\n  };\n\n  /**\n   * Contains all Segment information for its containing AdaptationSet\n   *\n   * @typedef {Object} SegmentInformation\n   * @property {Object|undefined} template\n   *           Contains the attributes for the SegmentTemplate node\n   * @property {Object[]|undefined} timeline\n   *           Contains a list of atrributes for each S node within the SegmentTimeline node\n   * @property {Object|undefined} list\n   *           Contains the attributes for the SegmentList node\n   * @property {Object|undefined} base\n   *           Contains the attributes for the SegmentBase node\n   */\n\n  /**\n   * Returns all available Segment information contained within the AdaptationSet node\n   *\n   * @param {Node} adaptationSet\n   *        The AdaptationSet node to get Segment information from\n   * @return {SegmentInformation}\n   *         The Segment information contained within the provided AdaptationSet\n   */\n  var getSegmentInformation = function getSegmentInformation(adaptationSet) {\n    var segmentTemplate = findChildren(adaptationSet, 'SegmentTemplate')[0];\n    var segmentList = findChildren(adaptationSet, 'SegmentList')[0];\n    var segmentUrls = segmentList && findChildren(segmentList, 'SegmentURL').map(function (s) {\n      return merge({ tag: 'SegmentURL' }, parseAttributes$1(s));\n    });\n    var segmentBase = findChildren(adaptationSet, 'SegmentBase')[0];\n    var segmentTimelineParentNode = segmentList || segmentTemplate;\n    var segmentTimeline = segmentTimelineParentNode && findChildren(segmentTimelineParentNode, 'SegmentTimeline')[0];\n    var segmentInitializationParentNode = segmentList || segmentBase || segmentTemplate;\n    var segmentInitialization = segmentInitializationParentNode && findChildren(segmentInitializationParentNode, 'Initialization')[0];\n\n    // SegmentTemplate is handled slightly differently, since it can have both\n    // @initialization and an <Initialization> node.  @initialization can be templated,\n    // while the node can have a url and range specified.  If the <SegmentTemplate> has\n    // both @initialization and an <Initialization> subelement we opt to override with\n    // the node, as this interaction is not defined in the spec.\n    var template = segmentTemplate && parseAttributes$1(segmentTemplate);\n\n    if (template && segmentInitialization) {\n      template.initialization = segmentInitialization && parseAttributes$1(segmentInitialization);\n    } else if (template && template.initialization) {\n      // If it is @initialization we convert it to an object since this is the format that\n      // later functions will rely on for the initialization segment.  This is only valid\n      // for <SegmentTemplate>\n      template.initialization = { sourceURL: template.initialization };\n    }\n\n    var segmentInfo = {\n      template: template,\n      timeline: segmentTimeline && findChildren(segmentTimeline, 'S').map(function (s) {\n        return parseAttributes$1(s);\n      }),\n      list: segmentList && merge(parseAttributes$1(segmentList), {\n        segmentUrls: segmentUrls,\n        initialization: parseAttributes$1(segmentInitialization)\n      }),\n      base: segmentBase && merge(parseAttributes$1(segmentBase), {\n        initialization: parseAttributes$1(segmentInitialization)\n      })\n    };\n\n    Object.keys(segmentInfo).forEach(function (key) {\n      if (!segmentInfo[key]) {\n        delete segmentInfo[key];\n      }\n    });\n\n    return segmentInfo;\n  };\n\n  /**\n   * Contains Segment information and attributes needed to construct a Playlist object\n   * from a Representation\n   *\n   * @typedef {Object} RepresentationInformation\n   * @property {SegmentInformation} segmentInfo\n   *           Segment information for this Representation\n   * @property {Object} attributes\n   *           Inherited attributes for this Representation\n   */\n\n  /**\n   * Maps a Representation node to an object containing Segment information and attributes\n   *\n   * @name inheritBaseUrlsCallback\n   * @function\n   * @param {Node} representation\n   *        Representation node from the mpd\n   * @return {RepresentationInformation}\n   *         Representation information needed to construct a Playlist object\n   */\n\n  /**\n   * Returns a callback for Array.prototype.map for mapping Representation nodes to\n   * Segment information and attributes using inherited BaseURL nodes.\n   *\n   * @param {Object} adaptationSetAttributes\n   *        Contains attributes inherited by the AdaptationSet\n   * @param {string[]} adaptationSetBaseUrls\n   *        Contains list of resolved base urls inherited by the AdaptationSet\n   * @param {SegmentInformation} adaptationSetSegmentInfo\n   *        Contains Segment information for the AdaptationSet\n   * @return {inheritBaseUrlsCallback}\n   *         Callback map function\n   */\n  var inheritBaseUrls = function inheritBaseUrls(adaptationSetAttributes, adaptationSetBaseUrls, adaptationSetSegmentInfo) {\n    return function (representation) {\n      var repBaseUrlElements = findChildren(representation, 'BaseURL');\n      var repBaseUrls = buildBaseUrls(adaptationSetBaseUrls, repBaseUrlElements);\n      var attributes = merge(adaptationSetAttributes, parseAttributes$1(representation));\n      var representationSegmentInfo = getSegmentInformation(representation);\n\n      return repBaseUrls.map(function (baseUrl) {\n        return {\n          segmentInfo: merge(adaptationSetSegmentInfo, representationSegmentInfo),\n          attributes: merge(attributes, { baseUrl: baseUrl })\n        };\n      });\n    };\n  };\n\n  /**\n   * Tranforms a series of content protection nodes to\n   * an object containing pssh data by key system\n   *\n   * @param {Node[]} contentProtectionNodes\n   *        Content protection nodes\n   * @return {Object}\n   *        Object containing pssh data by key system\n   */\n  var generateKeySystemInformation = function generateKeySystemInformation(contentProtectionNodes) {\n    return contentProtectionNodes.reduce(function (acc, node) {\n      var attributes = parseAttributes$1(node);\n      var keySystem = keySystemsMap[attributes.schemeIdUri];\n\n      if (keySystem) {\n        acc[keySystem] = { attributes: attributes };\n\n        var psshNode = findChildren(node, 'cenc:pssh')[0];\n\n        if (psshNode) {\n          var pssh = getContent(psshNode);\n          var psshBuffer = pssh && decodeB64ToUint8Array(pssh);\n\n          acc[keySystem].pssh = psshBuffer;\n        }\n      }\n\n      return acc;\n    }, {});\n  };\n\n  /**\n   * Maps an AdaptationSet node to a list of Representation information objects\n   *\n   * @name toRepresentationsCallback\n   * @function\n   * @param {Node} adaptationSet\n   *        AdaptationSet node from the mpd\n   * @return {RepresentationInformation[]}\n   *         List of objects containing Representaion information\n   */\n\n  /**\n   * Returns a callback for Array.prototype.map for mapping AdaptationSet nodes to a list of\n   * Representation information objects\n   *\n   * @param {Object} periodAttributes\n   *        Contains attributes inherited by the Period\n   * @param {string[]} periodBaseUrls\n   *        Contains list of resolved base urls inherited by the Period\n   * @param {string[]} periodSegmentInfo\n   *        Contains Segment Information at the period level\n   * @return {toRepresentationsCallback}\n   *         Callback map function\n   */\n  var toRepresentations = function toRepresentations(periodAttributes, periodBaseUrls, periodSegmentInfo) {\n    return function (adaptationSet) {\n      var adaptationSetAttributes = parseAttributes$1(adaptationSet);\n      var adaptationSetBaseUrls = buildBaseUrls(periodBaseUrls, findChildren(adaptationSet, 'BaseURL'));\n      var role = findChildren(adaptationSet, 'Role')[0];\n      var roleAttributes = { role: parseAttributes$1(role) };\n\n      var attrs = merge(periodAttributes, adaptationSetAttributes, roleAttributes);\n\n      var contentProtection = generateKeySystemInformation(findChildren(adaptationSet, 'ContentProtection'));\n\n      if (Object.keys(contentProtection).length) {\n        attrs = merge(attrs, { contentProtection: contentProtection });\n      }\n\n      var segmentInfo = getSegmentInformation(adaptationSet);\n      var representations = findChildren(adaptationSet, 'Representation');\n      var adaptationSetSegmentInfo = merge(periodSegmentInfo, segmentInfo);\n\n      return flatten(representations.map(inheritBaseUrls(attrs, adaptationSetBaseUrls, adaptationSetSegmentInfo)));\n    };\n  };\n\n  /**\n   * Maps an Period node to a list of Representation inforamtion objects for all\n   * AdaptationSet nodes contained within the Period\n   *\n   * @name toAdaptationSetsCallback\n   * @function\n   * @param {Node} period\n   *        Period node from the mpd\n   * @param {number} periodIndex\n   *        Index of the Period within the mpd\n   * @return {RepresentationInformation[]}\n   *         List of objects containing Representaion information\n   */\n\n  /**\n   * Returns a callback for Array.prototype.map for mapping Period nodes to a list of\n   * Representation information objects\n   *\n   * @param {Object} mpdAttributes\n   *        Contains attributes inherited by the mpd\n   * @param {string[]} mpdBaseUrls\n   *        Contains list of resolved base urls inherited by the mpd\n   * @return {toAdaptationSetsCallback}\n   *         Callback map function\n   */\n  var toAdaptationSets = function toAdaptationSets(mpdAttributes, mpdBaseUrls) {\n    return function (period, periodIndex) {\n      var periodBaseUrls = buildBaseUrls(mpdBaseUrls, findChildren(period, 'BaseURL'));\n      var periodAtt = parseAttributes$1(period);\n      var periodAttributes = merge(mpdAttributes, periodAtt, { periodIndex: periodIndex });\n      var adaptationSets = findChildren(period, 'AdaptationSet');\n      var periodSegmentInfo = getSegmentInformation(period);\n\n      return flatten(adaptationSets.map(toRepresentations(periodAttributes, periodBaseUrls, periodSegmentInfo)));\n    };\n  };\n\n  /**\n   * Traverses the mpd xml tree to generate a list of Representation information objects\n   * that have inherited attributes from parent nodes\n   *\n   * @param {Node} mpd\n   *        The root node of the mpd\n   * @param {Object} options\n   *        Available options for inheritAttributes\n   * @param {string} options.manifestUri\n   *        The uri source of the mpd\n   * @param {number} options.NOW\n   *        Current time per DASH IOP.  Default is current time in ms since epoch\n   * @param {number} options.clientOffset\n   *        Client time difference from NOW (in milliseconds)\n   * @return {RepresentationInformation[]}\n   *         List of objects containing Representation information\n   */\n  var inheritAttributes = function inheritAttributes(mpd) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var _options$manifestUri = options.manifestUri,\n        manifestUri = _options$manifestUri === undefined ? '' : _options$manifestUri,\n        _options$NOW = options.NOW,\n        NOW = _options$NOW === undefined ? Date.now() : _options$NOW,\n        _options$clientOffset = options.clientOffset,\n        clientOffset = _options$clientOffset === undefined ? 0 : _options$clientOffset;\n\n    var periods = findChildren(mpd, 'Period');\n\n    if (periods.length !== 1) {\n      // TODO add support for multiperiod\n      throw new Error(errors.INVALID_NUMBER_OF_PERIOD);\n    }\n\n    var mpdAttributes = parseAttributes$1(mpd);\n    var mpdBaseUrls = buildBaseUrls([manifestUri], findChildren(mpd, 'BaseURL'));\n\n    mpdAttributes.sourceDuration = mpdAttributes.mediaPresentationDuration || 0;\n    mpdAttributes.NOW = NOW;\n    mpdAttributes.clientOffset = clientOffset;\n\n    return flatten(periods.map(toAdaptationSets(mpdAttributes, mpdBaseUrls)));\n  };\n\n  var stringToMpdXml = function stringToMpdXml(manifestString) {\n    if (manifestString === '') {\n      throw new Error(errors.DASH_EMPTY_MANIFEST);\n    }\n\n    var parser = new window_1.DOMParser();\n    var xml = parser.parseFromString(manifestString, 'application/xml');\n    var mpd = xml && xml.documentElement.tagName === 'MPD' ? xml.documentElement : null;\n\n    if (!mpd || mpd && mpd.getElementsByTagName('parsererror').length > 0) {\n      throw new Error(errors.DASH_INVALID_XML);\n    }\n\n    return mpd;\n  };\n\n  /**\n   * Parses the manifest for a UTCTiming node, returning the nodes attributes if found\n   *\n   * @param {string} mpd\n   *        XML string of the MPD manifest\n   * @return {Object|null}\n   *         Attributes of UTCTiming node specified in the manifest. Null if none found\n   */\n  var parseUTCTimingScheme = function parseUTCTimingScheme(mpd) {\n    var UTCTimingNode = findChildren(mpd, 'UTCTiming')[0];\n\n    if (!UTCTimingNode) {\n      return null;\n    }\n\n    var attributes = parseAttributes$1(UTCTimingNode);\n\n    switch (attributes.schemeIdUri) {\n      case 'urn:mpeg:dash:utc:http-head:2014':\n      case 'urn:mpeg:dash:utc:http-head:2012':\n        attributes.method = 'HEAD';\n        break;\n      case 'urn:mpeg:dash:utc:http-xsdate:2014':\n      case 'urn:mpeg:dash:utc:http-iso:2014':\n      case 'urn:mpeg:dash:utc:http-xsdate:2012':\n      case 'urn:mpeg:dash:utc:http-iso:2012':\n        attributes.method = 'GET';\n        break;\n      case 'urn:mpeg:dash:utc:direct:2014':\n      case 'urn:mpeg:dash:utc:direct:2012':\n        attributes.method = 'DIRECT';\n        attributes.value = Date.parse(attributes.value);\n        break;\n      case 'urn:mpeg:dash:utc:http-ntp:2014':\n      case 'urn:mpeg:dash:utc:ntp:2014':\n      case 'urn:mpeg:dash:utc:sntp:2014':\n      default:\n        throw new Error(errors.UNSUPPORTED_UTC_TIMING_SCHEME);\n    }\n\n    return attributes;\n  };\n\n  var parse = function parse(manifestString, options) {\n    return toM3u8(toPlaylists(inheritAttributes(stringToMpdXml(manifestString), options)));\n  };\n\n  /**\n   * Parses the manifest for a UTCTiming node, returning the nodes attributes if found\n   *\n   * @param {string} manifestString\n   *        XML string of the MPD manifest\n   * @return {Object|null}\n   *         Attributes of UTCTiming node specified in the manifest. Null if none found\n   */\n  var parseUTCTiming = function parseUTCTiming(manifestString) {\n    return parseUTCTimingScheme(stringToMpdXml(manifestString));\n  };\n\n  var toUnsigned = function toUnsigned(value) {\n    return value >>> 0;\n  };\n\n  var bin = {\n    toUnsigned: toUnsigned\n  };\n  var bin_1 = bin.toUnsigned;\n\n  var bin$1 = /*#__PURE__*/Object.freeze({\n    default: bin,\n    __moduleExports: bin,\n    toUnsigned: bin_1\n  });\n\n  var require$$0$1 = ( bin$1 && bin ) || bin$1;\n\n  var toUnsigned$1 = require$$0$1.toUnsigned;\n  var _findBox, parseType, timescale, startTime;\n\n  // Find the data for a box specified by its path\n  _findBox = function findBox(data, path) {\n    var results = [],\n        i,\n        size,\n        type,\n        end,\n        subresults;\n\n    if (!path.length) {\n      // short-circuit the search for empty paths\n      return null;\n    }\n\n    for (i = 0; i < data.byteLength;) {\n      size = toUnsigned$1(data[i] << 24 | data[i + 1] << 16 | data[i + 2] << 8 | data[i + 3]);\n\n      type = parseType(data.subarray(i + 4, i + 8));\n\n      end = size > 1 ? i + size : data.byteLength;\n\n      if (type === path[0]) {\n        if (path.length === 1) {\n          // this is the end of the path and we've found the box we were\n          // looking for\n          results.push(data.subarray(i + 8, end));\n        } else {\n          // recursively search for the next box along the path\n          subresults = _findBox(data.subarray(i + 8, end), path.slice(1));\n          if (subresults.length) {\n            results = results.concat(subresults);\n          }\n        }\n      }\n      i = end;\n    }\n\n    // we've finished searching all of data\n    return results;\n  };\n\n  /**\n   * Returns the string representation of an ASCII encoded four byte buffer.\n   * @param buffer {Uint8Array} a four-byte buffer to translate\n   * @return {string} the corresponding string\n   */\n  parseType = function parseType(buffer) {\n    var result = '';\n    result += String.fromCharCode(buffer[0]);\n    result += String.fromCharCode(buffer[1]);\n    result += String.fromCharCode(buffer[2]);\n    result += String.fromCharCode(buffer[3]);\n    return result;\n  };\n\n  /**\n   * Parses an MP4 initialization segment and extracts the timescale\n   * values for any declared tracks. Timescale values indicate the\n   * number of clock ticks per second to assume for time-based values\n   * elsewhere in the MP4.\n   *\n   * To determine the start time of an MP4, you need two pieces of\n   * information: the timescale unit and the earliest base media decode\n   * time. Multiple timescales can be specified within an MP4 but the\n   * base media decode time is always expressed in the timescale from\n   * the media header box for the track:\n   * ```\n   * moov > trak > mdia > mdhd.timescale\n   * ```\n   * @param init {Uint8Array} the bytes of the init segment\n   * @return {object} a hash of track ids to timescale values or null if\n   * the init segment is malformed.\n   */\n  timescale = function timescale(init) {\n    var result = {},\n        traks = _findBox(init, ['moov', 'trak']);\n\n    // mdhd timescale\n    return traks.reduce(function (result, trak) {\n      var tkhd, version, index, id, mdhd;\n\n      tkhd = _findBox(trak, ['tkhd'])[0];\n      if (!tkhd) {\n        return null;\n      }\n      version = tkhd[0];\n      index = version === 0 ? 12 : 20;\n      id = toUnsigned$1(tkhd[index] << 24 | tkhd[index + 1] << 16 | tkhd[index + 2] << 8 | tkhd[index + 3]);\n\n      mdhd = _findBox(trak, ['mdia', 'mdhd'])[0];\n      if (!mdhd) {\n        return null;\n      }\n      version = mdhd[0];\n      index = version === 0 ? 12 : 20;\n      result[id] = toUnsigned$1(mdhd[index] << 24 | mdhd[index + 1] << 16 | mdhd[index + 2] << 8 | mdhd[index + 3]);\n      return result;\n    }, result);\n  };\n\n  /**\n   * Determine the base media decode start time, in seconds, for an MP4\n   * fragment. If multiple fragments are specified, the earliest time is\n   * returned.\n   *\n   * The base media decode time can be parsed from track fragment\n   * metadata:\n   * ```\n   * moof > traf > tfdt.baseMediaDecodeTime\n   * ```\n   * It requires the timescale value from the mdhd to interpret.\n   *\n   * @param timescale {object} a hash of track ids to timescale values.\n   * @return {number} the earliest base media decode start time for the\n   * fragment, in seconds\n   */\n  startTime = function startTime(timescale, fragment) {\n    var trafs, baseTimes, result;\n\n    // we need info from two childrend of each track fragment box\n    trafs = _findBox(fragment, ['moof', 'traf']);\n\n    // determine the start times for each track\n    baseTimes = [].concat.apply([], trafs.map(function (traf) {\n      return _findBox(traf, ['tfhd']).map(function (tfhd) {\n        var id, scale, baseTime;\n\n        // get the track id from the tfhd\n        id = toUnsigned$1(tfhd[4] << 24 | tfhd[5] << 16 | tfhd[6] << 8 | tfhd[7]);\n        // assume a 90kHz clock if no timescale was specified\n        scale = timescale[id] || 90e3;\n\n        // get the base media decode time from the tfdt\n        baseTime = _findBox(traf, ['tfdt']).map(function (tfdt) {\n          var version, result;\n\n          version = tfdt[0];\n          result = toUnsigned$1(tfdt[4] << 24 | tfdt[5] << 16 | tfdt[6] << 8 | tfdt[7]);\n          if (version === 1) {\n            result *= Math.pow(2, 32);\n            result += toUnsigned$1(tfdt[8] << 24 | tfdt[9] << 16 | tfdt[10] << 8 | tfdt[11]);\n          }\n          return result;\n        })[0];\n        baseTime = baseTime || Infinity;\n\n        // convert base time to seconds\n        return baseTime / scale;\n      });\n    }));\n\n    // return the minimum\n    result = Math.min.apply(null, baseTimes);\n    return isFinite(result) ? result : 0;\n  };\n\n  var probe = {\n    parseType: parseType,\n    timescale: timescale,\n    startTime: startTime\n  };\n\n  var streamTypes = {\n    H264_STREAM_TYPE: 0x1B,\n    ADTS_STREAM_TYPE: 0x0F,\n    METADATA_STREAM_TYPE: 0x15\n  };\n  var streamTypes_1 = streamTypes.H264_STREAM_TYPE;\n  var streamTypes_2 = streamTypes.ADTS_STREAM_TYPE;\n  var streamTypes_3 = streamTypes.METADATA_STREAM_TYPE;\n\n  var streamTypes$1 = /*#__PURE__*/Object.freeze({\n    default: streamTypes,\n    __moduleExports: streamTypes,\n    H264_STREAM_TYPE: streamTypes_1,\n    ADTS_STREAM_TYPE: streamTypes_2,\n    METADATA_STREAM_TYPE: streamTypes_3\n  });\n\n  /**\n   * mux.js\n   *\n   * Copyright (c) 2014 Brightcove\n   * All rights reserved.\n   *\n   * A lightweight readable stream implemention that handles event dispatching.\n   * Objects that inherit from streams should call init in their constructors.\n   */\n\n  var Stream$1 = function Stream() {\n    this.init = function () {\n      var listeners = {};\n      /**\n       * Add a listener for a specified event type.\n       * @param type {string} the event name\n       * @param listener {function} the callback to be invoked when an event of\n       * the specified type occurs\n       */\n      this.on = function (type, listener) {\n        if (!listeners[type]) {\n          listeners[type] = [];\n        }\n        listeners[type] = listeners[type].concat(listener);\n      };\n      /**\n       * Remove a listener for a specified event type.\n       * @param type {string} the event name\n       * @param listener {function} a function previously registered for this\n       * type of event through `on`\n       */\n      this.off = function (type, listener) {\n        var index;\n        if (!listeners[type]) {\n          return false;\n        }\n        index = listeners[type].indexOf(listener);\n        listeners[type] = listeners[type].slice();\n        listeners[type].splice(index, 1);\n        return index > -1;\n      };\n      /**\n       * Trigger an event of the specified type on this stream. Any additional\n       * arguments to this function are passed as parameters to event listeners.\n       * @param type {string} the event name\n       */\n      this.trigger = function (type) {\n        var callbacks, i, length, args;\n        callbacks = listeners[type];\n        if (!callbacks) {\n          return;\n        }\n        // Slicing the arguments on every invocation of this method\n        // can add a significant amount of overhead. Avoid the\n        // intermediate object creation for the common case of a\n        // single callback argument\n        if (arguments.length === 2) {\n          length = callbacks.length;\n          for (i = 0; i < length; ++i) {\n            callbacks[i].call(this, arguments[1]);\n          }\n        } else {\n          args = [];\n          i = arguments.length;\n          for (i = 1; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n          }\n          length = callbacks.length;\n          for (i = 0; i < length; ++i) {\n            callbacks[i].apply(this, args);\n          }\n        }\n      };\n      /**\n       * Destroys the stream and cleans up.\n       */\n      this.dispose = function () {\n        listeners = {};\n      };\n    };\n  };\n\n  /**\n   * Forwards all `data` events on this stream to the destination stream. The\n   * destination stream should provide a method `push` to receive the data\n   * events as they arrive.\n   * @param destination {stream} the stream that will receive all `data` events\n   * @param autoFlush {boolean} if false, we will not call `flush` on the destination\n   *                            when the current stream emits a 'done' event\n   * @see http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options\n   */\n  Stream$1.prototype.pipe = function (destination) {\n    this.on('data', function (data) {\n      destination.push(data);\n    });\n\n    this.on('done', function (flushSource) {\n      destination.flush(flushSource);\n    });\n\n    return destination;\n  };\n\n  // Default stream functions that are expected to be overridden to perform\n  // actual work. These are provided by the prototype as a sort of no-op\n  // implementation so that we don't have to check for their existence in the\n  // `pipe` function above.\n  Stream$1.prototype.push = function (data) {\n    this.trigger('data', data);\n  };\n\n  Stream$1.prototype.flush = function (flushSource) {\n    this.trigger('done', flushSource);\n  };\n\n  var stream = Stream$1;\n\n  var stream$1 = /*#__PURE__*/Object.freeze({\n    default: stream,\n    __moduleExports: stream\n  });\n\n  var Stream$2 = ( stream$1 && stream ) || stream$1;\n\n  var MAX_TS = 8589934592;\n\n  var RO_THRESH = 4294967296;\n\n  var handleRollover = function handleRollover(value, reference) {\n    var direction = 1;\n\n    if (value > reference) {\n      // If the current timestamp value is greater than our reference timestamp and we detect a\n      // timestamp rollover, this means the roll over is happening in the opposite direction.\n      // Example scenario: Enter a long stream/video just after a rollover occurred. The reference\n      // point will be set to a small number, e.g. 1. The user then seeks backwards over the\n      // rollover point. In loading this segment, the timestamp values will be very large,\n      // e.g. 2^33 - 1. Since this comes before the data we loaded previously, we want to adjust\n      // the time stamp to be `value - 2^33`.\n      direction = -1;\n    }\n\n    // Note: A seek forwards or back that is greater than the RO_THRESH (2^32, ~13 hours) will\n    // cause an incorrect adjustment.\n    while (Math.abs(reference - value) > RO_THRESH) {\n      value += direction * MAX_TS;\n    }\n\n    return value;\n  };\n\n  var TimestampRolloverStream = function TimestampRolloverStream(type) {\n    var lastDTS, referenceDTS;\n\n    TimestampRolloverStream.prototype.init.call(this);\n\n    this.type_ = type;\n\n    this.push = function (data) {\n      if (data.type !== this.type_) {\n        return;\n      }\n\n      if (referenceDTS === undefined) {\n        referenceDTS = data.dts;\n      }\n\n      data.dts = handleRollover(data.dts, referenceDTS);\n      data.pts = handleRollover(data.pts, referenceDTS);\n\n      lastDTS = data.dts;\n\n      this.trigger('data', data);\n    };\n\n    this.flush = function () {\n      referenceDTS = lastDTS;\n      this.trigger('done');\n    };\n\n    this.discontinuity = function () {\n      referenceDTS = void 0;\n      lastDTS = void 0;\n    };\n  };\n\n  TimestampRolloverStream.prototype = new Stream$2();\n\n  var timestampRolloverStream = {\n    TimestampRolloverStream: TimestampRolloverStream,\n    handleRollover: handleRollover\n  };\n  var timestampRolloverStream_1 = timestampRolloverStream.TimestampRolloverStream;\n  var timestampRolloverStream_2 = timestampRolloverStream.handleRollover;\n\n  var timestampRolloverStream$1 = /*#__PURE__*/Object.freeze({\n    default: timestampRolloverStream,\n    __moduleExports: timestampRolloverStream,\n    TimestampRolloverStream: timestampRolloverStream_1,\n    handleRollover: timestampRolloverStream_2\n  });\n\n  var StreamTypes = ( streamTypes$1 && streamTypes ) || streamTypes$1;\n\n  var parsePid = function parsePid(packet) {\n    var pid = packet[1] & 0x1f;\n    pid <<= 8;\n    pid |= packet[2];\n    return pid;\n  };\n\n  var parsePayloadUnitStartIndicator = function parsePayloadUnitStartIndicator(packet) {\n    return !!(packet[1] & 0x40);\n  };\n\n  var parseAdaptionField = function parseAdaptionField(packet) {\n    var offset = 0;\n    // if an adaption field is present, its length is specified by the\n    // fifth byte of the TS packet header. The adaptation field is\n    // used to add stuffing to PES packets that don't fill a complete\n    // TS packet, and to specify some forms of timing and control data\n    // that we do not currently use.\n    if ((packet[3] & 0x30) >>> 4 > 0x01) {\n      offset += packet[4] + 1;\n    }\n    return offset;\n  };\n\n  var parseType$1 = function parseType(packet, pmtPid) {\n    var pid = parsePid(packet);\n    if (pid === 0) {\n      return 'pat';\n    } else if (pid === pmtPid) {\n      return 'pmt';\n    } else if (pmtPid) {\n      return 'pes';\n    }\n    return null;\n  };\n\n  var parsePat = function parsePat(packet) {\n    var pusi = parsePayloadUnitStartIndicator(packet);\n    var offset = 4 + parseAdaptionField(packet);\n\n    if (pusi) {\n      offset += packet[offset] + 1;\n    }\n\n    return (packet[offset + 10] & 0x1f) << 8 | packet[offset + 11];\n  };\n\n  var parsePmt = function parsePmt(packet) {\n    var programMapTable = {};\n    var pusi = parsePayloadUnitStartIndicator(packet);\n    var payloadOffset = 4 + parseAdaptionField(packet);\n\n    if (pusi) {\n      payloadOffset += packet[payloadOffset] + 1;\n    }\n\n    // PMTs can be sent ahead of the time when they should actually\n    // take effect. We don't believe this should ever be the case\n    // for HLS but we'll ignore \"forward\" PMT declarations if we see\n    // them. Future PMT declarations have the current_next_indicator\n    // set to zero.\n    if (!(packet[payloadOffset + 5] & 0x01)) {\n      return;\n    }\n\n    var sectionLength, tableEnd, programInfoLength;\n    // the mapping table ends at the end of the current section\n    sectionLength = (packet[payloadOffset + 1] & 0x0f) << 8 | packet[payloadOffset + 2];\n    tableEnd = 3 + sectionLength - 4;\n\n    // to determine where the table is, we have to figure out how\n    // long the program info descriptors are\n    programInfoLength = (packet[payloadOffset + 10] & 0x0f) << 8 | packet[payloadOffset + 11];\n\n    // advance the offset to the first entry in the mapping table\n    var offset = 12 + programInfoLength;\n    while (offset < tableEnd) {\n      var i = payloadOffset + offset;\n      // add an entry that maps the elementary_pid to the stream_type\n      programMapTable[(packet[i + 1] & 0x1F) << 8 | packet[i + 2]] = packet[i];\n\n      // move to the next table entry\n      // skip past the elementary stream descriptors, if present\n      offset += ((packet[i + 3] & 0x0F) << 8 | packet[i + 4]) + 5;\n    }\n    return programMapTable;\n  };\n\n  var parsePesType = function parsePesType(packet, programMapTable) {\n    var pid = parsePid(packet);\n    var type = programMapTable[pid];\n    switch (type) {\n      case StreamTypes.H264_STREAM_TYPE:\n        return 'video';\n      case StreamTypes.ADTS_STREAM_TYPE:\n        return 'audio';\n      case StreamTypes.METADATA_STREAM_TYPE:\n        return 'timed-metadata';\n      default:\n        return null;\n    }\n  };\n\n  var parsePesTime = function parsePesTime(packet) {\n    var pusi = parsePayloadUnitStartIndicator(packet);\n    if (!pusi) {\n      return null;\n    }\n\n    var offset = 4 + parseAdaptionField(packet);\n\n    if (offset >= packet.byteLength) {\n      // From the H 222.0 MPEG-TS spec\n      // \"For transport stream packets carrying PES packets, stuffing is needed when there\n      //  is insufficient PES packet data to completely fill the transport stream packet\n      //  payload bytes. Stuffing is accomplished by defining an adaptation field longer than\n      //  the sum of the lengths of the data elements in it, so that the payload bytes\n      //  remaining after the adaptation field exactly accommodates the available PES packet\n      //  data.\"\n      //\n      // If the offset is >= the length of the packet, then the packet contains no data\n      // and instead is just adaption field stuffing bytes\n      return null;\n    }\n\n    var pes = null;\n    var ptsDtsFlags;\n\n    // PES packets may be annotated with a PTS value, or a PTS value\n    // and a DTS value. Determine what combination of values is\n    // available to work with.\n    ptsDtsFlags = packet[offset + 7];\n\n    // PTS and DTS are normally stored as a 33-bit number.  Javascript\n    // performs all bitwise operations on 32-bit integers but javascript\n    // supports a much greater range (52-bits) of integer using standard\n    // mathematical operations.\n    // We construct a 31-bit value using bitwise operators over the 31\n    // most significant bits and then multiply by 4 (equal to a left-shift\n    // of 2) before we add the final 2 least significant bits of the\n    // timestamp (equal to an OR.)\n    if (ptsDtsFlags & 0xC0) {\n      pes = {};\n      // the PTS and DTS are not written out directly. For information\n      // on how they are encoded, see\n      // http://dvd.sourceforge.net/dvdinfo/pes-hdr.html\n      pes.pts = (packet[offset + 9] & 0x0E) << 27 | (packet[offset + 10] & 0xFF) << 20 | (packet[offset + 11] & 0xFE) << 12 | (packet[offset + 12] & 0xFF) << 5 | (packet[offset + 13] & 0xFE) >>> 3;\n      pes.pts *= 4; // Left shift by 2\n      pes.pts += (packet[offset + 13] & 0x06) >>> 1; // OR by the two LSBs\n      pes.dts = pes.pts;\n      if (ptsDtsFlags & 0x40) {\n        pes.dts = (packet[offset + 14] & 0x0E) << 27 | (packet[offset + 15] & 0xFF) << 20 | (packet[offset + 16] & 0xFE) << 12 | (packet[offset + 17] & 0xFF) << 5 | (packet[offset + 18] & 0xFE) >>> 3;\n        pes.dts *= 4; // Left shift by 2\n        pes.dts += (packet[offset + 18] & 0x06) >>> 1; // OR by the two LSBs\n      }\n    }\n    return pes;\n  };\n\n  var parseNalUnitType = function parseNalUnitType(type) {\n    switch (type) {\n      case 0x05:\n        return 'slice_layer_without_partitioning_rbsp_idr';\n      case 0x06:\n        return 'sei_rbsp';\n      case 0x07:\n        return 'seq_parameter_set_rbsp';\n      case 0x08:\n        return 'pic_parameter_set_rbsp';\n      case 0x09:\n        return 'access_unit_delimiter_rbsp';\n      default:\n        return null;\n    }\n  };\n\n  var videoPacketContainsKeyFrame = function videoPacketContainsKeyFrame(packet) {\n    var offset = 4 + parseAdaptionField(packet);\n    var frameBuffer = packet.subarray(offset);\n    var frameI = 0;\n    var frameSyncPoint = 0;\n    var foundKeyFrame = false;\n    var nalType;\n\n    // advance the sync point to a NAL start, if necessary\n    for (; frameSyncPoint < frameBuffer.byteLength - 3; frameSyncPoint++) {\n      if (frameBuffer[frameSyncPoint + 2] === 1) {\n        // the sync point is properly aligned\n        frameI = frameSyncPoint + 5;\n        break;\n      }\n    }\n\n    while (frameI < frameBuffer.byteLength) {\n      // look at the current byte to determine if we've hit the end of\n      // a NAL unit boundary\n      switch (frameBuffer[frameI]) {\n        case 0:\n          // skip past non-sync sequences\n          if (frameBuffer[frameI - 1] !== 0) {\n            frameI += 2;\n            break;\n          } else if (frameBuffer[frameI - 2] !== 0) {\n            frameI++;\n            break;\n          }\n\n          if (frameSyncPoint + 3 !== frameI - 2) {\n            nalType = parseNalUnitType(frameBuffer[frameSyncPoint + 3] & 0x1f);\n            if (nalType === 'slice_layer_without_partitioning_rbsp_idr') {\n              foundKeyFrame = true;\n            }\n          }\n\n          // drop trailing zeroes\n          do {\n            frameI++;\n          } while (frameBuffer[frameI] !== 1 && frameI < frameBuffer.length);\n          frameSyncPoint = frameI - 2;\n          frameI += 3;\n          break;\n        case 1:\n          // skip past non-sync sequences\n          if (frameBuffer[frameI - 1] !== 0 || frameBuffer[frameI - 2] !== 0) {\n            frameI += 3;\n            break;\n          }\n\n          nalType = parseNalUnitType(frameBuffer[frameSyncPoint + 3] & 0x1f);\n          if (nalType === 'slice_layer_without_partitioning_rbsp_idr') {\n            foundKeyFrame = true;\n          }\n          frameSyncPoint = frameI - 2;\n          frameI += 3;\n          break;\n        default:\n          // the current byte isn't a one or zero, so it cannot be part\n          // of a sync sequence\n          frameI += 3;\n          break;\n      }\n    }\n    frameBuffer = frameBuffer.subarray(frameSyncPoint);\n    frameI -= frameSyncPoint;\n    frameSyncPoint = 0;\n    // parse the final nal\n    if (frameBuffer && frameBuffer.byteLength > 3) {\n      nalType = parseNalUnitType(frameBuffer[frameSyncPoint + 3] & 0x1f);\n      if (nalType === 'slice_layer_without_partitioning_rbsp_idr') {\n        foundKeyFrame = true;\n      }\n    }\n\n    return foundKeyFrame;\n  };\n\n  var probe$1 = {\n    parseType: parseType$1,\n    parsePat: parsePat,\n    parsePmt: parsePmt,\n    parsePayloadUnitStartIndicator: parsePayloadUnitStartIndicator,\n    parsePesType: parsePesType,\n    parsePesTime: parsePesTime,\n    videoPacketContainsKeyFrame: videoPacketContainsKeyFrame\n  };\n  var probe_1$1 = probe$1.parseType;\n  var probe_2$1 = probe$1.parsePat;\n  var probe_3$1 = probe$1.parsePmt;\n  var probe_4 = probe$1.parsePayloadUnitStartIndicator;\n  var probe_5 = probe$1.parsePesType;\n  var probe_6 = probe$1.parsePesTime;\n  var probe_7 = probe$1.videoPacketContainsKeyFrame;\n\n  var probe$2 = /*#__PURE__*/Object.freeze({\n    default: probe$1,\n    __moduleExports: probe$1,\n    parseType: probe_1$1,\n    parsePat: probe_2$1,\n    parsePmt: probe_3$1,\n    parsePayloadUnitStartIndicator: probe_4,\n    parsePesType: probe_5,\n    parsePesTime: probe_6,\n    videoPacketContainsKeyFrame: probe_7\n  });\n\n  /**\n   * mux.js\n   *\n   * Copyright (c) 2016 Brightcove\n   * All rights reserved.\n   *\n   * Utilities to detect basic properties and metadata about Aac data.\n   */\n\n  var ADTS_SAMPLING_FREQUENCIES = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\n\n  var parseSyncSafeInteger = function parseSyncSafeInteger(data) {\n    return data[0] << 21 | data[1] << 14 | data[2] << 7 | data[3];\n  };\n\n  // return a percent-encoded representation of the specified byte range\n  // @see http://en.wikipedia.org/wiki/Percent-encoding\n  var percentEncode = function percentEncode(bytes, start, end) {\n    var i,\n        result = '';\n    for (i = start; i < end; i++) {\n      result += '%' + ('00' + bytes[i].toString(16)).slice(-2);\n    }\n    return result;\n  };\n\n  // return the string representation of the specified byte range,\n  // interpreted as ISO-8859-1.\n  var parseIso88591 = function parseIso88591(bytes, start, end) {\n    return unescape(percentEncode(bytes, start, end)); // jshint ignore:line\n  };\n\n  var parseId3TagSize = function parseId3TagSize(header, byteIndex) {\n    var returnSize = header[byteIndex + 6] << 21 | header[byteIndex + 7] << 14 | header[byteIndex + 8] << 7 | header[byteIndex + 9],\n        flags = header[byteIndex + 5],\n        footerPresent = (flags & 16) >> 4;\n\n    if (footerPresent) {\n      return returnSize + 20;\n    }\n    return returnSize + 10;\n  };\n\n  var parseAdtsSize = function parseAdtsSize(header, byteIndex) {\n    var lowThree = (header[byteIndex + 5] & 0xE0) >> 5,\n        middle = header[byteIndex + 4] << 3,\n        highTwo = header[byteIndex + 3] & 0x3 << 11;\n\n    return highTwo | middle | lowThree;\n  };\n\n  var parseType$2 = function parseType(header, byteIndex) {\n    if (header[byteIndex] === 'I'.charCodeAt(0) && header[byteIndex + 1] === 'D'.charCodeAt(0) && header[byteIndex + 2] === '3'.charCodeAt(0)) {\n      return 'timed-metadata';\n    } else if (header[byteIndex] & 0xff === 0xff && (header[byteIndex + 1] & 0xf0) === 0xf0) {\n      return 'audio';\n    }\n    return null;\n  };\n\n  var parseSampleRate = function parseSampleRate(packet) {\n    var i = 0;\n\n    while (i + 5 < packet.length) {\n      if (packet[i] !== 0xFF || (packet[i + 1] & 0xF6) !== 0xF0) {\n        // If a valid header was not found,  jump one forward and attempt to\n        // find a valid ADTS header starting at the next byte\n        i++;\n        continue;\n      }\n      return ADTS_SAMPLING_FREQUENCIES[(packet[i + 2] & 0x3c) >>> 2];\n    }\n\n    return null;\n  };\n\n  var parseAacTimestamp = function parseAacTimestamp(packet) {\n    var frameStart, frameSize, frame, frameHeader;\n\n    // find the start of the first frame and the end of the tag\n    frameStart = 10;\n    if (packet[5] & 0x40) {\n      // advance the frame start past the extended header\n      frameStart += 4; // header size field\n      frameStart += parseSyncSafeInteger(packet.subarray(10, 14));\n    }\n\n    // parse one or more ID3 frames\n    // http://id3.org/id3v2.3.0#ID3v2_frame_overview\n    do {\n      // determine the number of bytes in this frame\n      frameSize = parseSyncSafeInteger(packet.subarray(frameStart + 4, frameStart + 8));\n      if (frameSize < 1) {\n        return null;\n      }\n      frameHeader = String.fromCharCode(packet[frameStart], packet[frameStart + 1], packet[frameStart + 2], packet[frameStart + 3]);\n\n      if (frameHeader === 'PRIV') {\n        frame = packet.subarray(frameStart + 10, frameStart + frameSize + 10);\n\n        for (var i = 0; i < frame.byteLength; i++) {\n          if (frame[i] === 0) {\n            var owner = parseIso88591(frame, 0, i);\n            if (owner === 'com.apple.streaming.transportStreamTimestamp') {\n              var d = frame.subarray(i + 1);\n              var size = (d[3] & 0x01) << 30 | d[4] << 22 | d[5] << 14 | d[6] << 6 | d[7] >>> 2;\n              size *= 4;\n              size += d[7] & 0x03;\n\n              return size;\n            }\n            break;\n          }\n        }\n      }\n\n      frameStart += 10; // advance past the frame header\n      frameStart += frameSize; // advance past the frame body\n    } while (frameStart < packet.byteLength);\n    return null;\n  };\n\n  var probe$3 = {\n    parseId3TagSize: parseId3TagSize,\n    parseAdtsSize: parseAdtsSize,\n    parseType: parseType$2,\n    parseSampleRate: parseSampleRate,\n    parseAacTimestamp: parseAacTimestamp\n  };\n  var probe_1$2 = probe$3.parseId3TagSize;\n  var probe_2$2 = probe$3.parseAdtsSize;\n  var probe_3$2 = probe$3.parseType;\n  var probe_4$1 = probe$3.parseSampleRate;\n  var probe_5$1 = probe$3.parseAacTimestamp;\n\n  var probe$4 = /*#__PURE__*/Object.freeze({\n    default: probe$3,\n    __moduleExports: probe$3,\n    parseId3TagSize: probe_1$2,\n    parseAdtsSize: probe_2$2,\n    parseType: probe_3$2,\n    parseSampleRate: probe_4$1,\n    parseAacTimestamp: probe_5$1\n  });\n\n  var require$$0$2 = ( timestampRolloverStream$1 && timestampRolloverStream ) || timestampRolloverStream$1;\n\n  var require$$1$1 = ( probe$2 && probe$1 ) || probe$2;\n\n  var require$$2$1 = ( probe$4 && probe$3 ) || probe$4;\n\n  var handleRollover$1 = require$$0$2.handleRollover;\n  var probe$5 = {};\n  probe$5.ts = require$$1$1;\n  probe$5.aac = require$$2$1;\n\n  var PES_TIMESCALE = 90000,\n      MP2T_PACKET_LENGTH = 188,\n      // bytes\n  SYNC_BYTE = 0x47;\n\n  var isLikelyAacData = function isLikelyAacData(data) {\n    if (data[0] === 'I'.charCodeAt(0) && data[1] === 'D'.charCodeAt(0) && data[2] === '3'.charCodeAt(0)) {\n      return true;\n    }\n    return false;\n  };\n\n  /**\n   * walks through segment data looking for pat and pmt packets to parse out\n   * program map table information\n   */\n  var parsePsi_ = function parsePsi_(bytes, pmt) {\n    var startIndex = 0,\n        endIndex = MP2T_PACKET_LENGTH,\n        packet,\n        type;\n\n    while (endIndex < bytes.byteLength) {\n      // Look for a pair of start and end sync bytes in the data..\n      if (bytes[startIndex] === SYNC_BYTE && bytes[endIndex] === SYNC_BYTE) {\n        // We found a packet\n        packet = bytes.subarray(startIndex, endIndex);\n        type = probe$5.ts.parseType(packet, pmt.pid);\n\n        switch (type) {\n          case 'pat':\n            if (!pmt.pid) {\n              pmt.pid = probe$5.ts.parsePat(packet);\n            }\n            break;\n          case 'pmt':\n            if (!pmt.table) {\n              pmt.table = probe$5.ts.parsePmt(packet);\n            }\n            break;\n          default:\n            break;\n        }\n\n        // Found the pat and pmt, we can stop walking the segment\n        if (pmt.pid && pmt.table) {\n          return;\n        }\n\n        startIndex += MP2T_PACKET_LENGTH;\n        endIndex += MP2T_PACKET_LENGTH;\n        continue;\n      }\n\n      // If we get here, we have somehow become de-synchronized and we need to step\n      // forward one byte at a time until we find a pair of sync bytes that denote\n      // a packet\n      startIndex++;\n      endIndex++;\n    }\n  };\n\n  /**\n   * walks through the segment data from the start and end to get timing information\n   * for the first and last audio pes packets\n   */\n  var parseAudioPes_ = function parseAudioPes_(bytes, pmt, result) {\n    var startIndex = 0,\n        endIndex = MP2T_PACKET_LENGTH,\n        packet,\n        type,\n        pesType,\n        pusi,\n        parsed;\n\n    var endLoop = false;\n\n    // Start walking from start of segment to get first audio packet\n    while (endIndex < bytes.byteLength) {\n      // Look for a pair of start and end sync bytes in the data..\n      if (bytes[startIndex] === SYNC_BYTE && bytes[endIndex] === SYNC_BYTE) {\n        // We found a packet\n        packet = bytes.subarray(startIndex, endIndex);\n        type = probe$5.ts.parseType(packet, pmt.pid);\n\n        switch (type) {\n          case 'pes':\n            pesType = probe$5.ts.parsePesType(packet, pmt.table);\n            pusi = probe$5.ts.parsePayloadUnitStartIndicator(packet);\n            if (pesType === 'audio' && pusi) {\n              parsed = probe$5.ts.parsePesTime(packet);\n              if (parsed) {\n                parsed.type = 'audio';\n                result.audio.push(parsed);\n                endLoop = true;\n              }\n            }\n            break;\n          default:\n            break;\n        }\n\n        if (endLoop) {\n          break;\n        }\n\n        startIndex += MP2T_PACKET_LENGTH;\n        endIndex += MP2T_PACKET_LENGTH;\n        continue;\n      }\n\n      // If we get here, we have somehow become de-synchronized and we need to step\n      // forward one byte at a time until we find a pair of sync bytes that denote\n      // a packet\n      startIndex++;\n      endIndex++;\n    }\n\n    // Start walking from end of segment to get last audio packet\n    endIndex = bytes.byteLength;\n    startIndex = endIndex - MP2T_PACKET_LENGTH;\n    endLoop = false;\n    while (startIndex >= 0) {\n      // Look for a pair of start and end sync bytes in the data..\n      if (bytes[startIndex] === SYNC_BYTE && bytes[endIndex] === SYNC_BYTE) {\n        // We found a packet\n        packet = bytes.subarray(startIndex, endIndex);\n        type = probe$5.ts.parseType(packet, pmt.pid);\n\n        switch (type) {\n          case 'pes':\n            pesType = probe$5.ts.parsePesType(packet, pmt.table);\n            pusi = probe$5.ts.parsePayloadUnitStartIndicator(packet);\n            if (pesType === 'audio' && pusi) {\n              parsed = probe$5.ts.parsePesTime(packet);\n              if (parsed) {\n                parsed.type = 'audio';\n                result.audio.push(parsed);\n                endLoop = true;\n              }\n            }\n            break;\n          default:\n            break;\n        }\n\n        if (endLoop) {\n          break;\n        }\n\n        startIndex -= MP2T_PACKET_LENGTH;\n        endIndex -= MP2T_PACKET_LENGTH;\n        continue;\n      }\n\n      // If we get here, we have somehow become de-synchronized and we need to step\n      // forward one byte at a time until we find a pair of sync bytes that denote\n      // a packet\n      startIndex--;\n      endIndex--;\n    }\n  };\n\n  /**\n   * walks through the segment data from the start and end to get timing information\n   * for the first and last video pes packets as well as timing information for the first\n   * key frame.\n   */\n  var parseVideoPes_ = function parseVideoPes_(bytes, pmt, result) {\n    var startIndex = 0,\n        endIndex = MP2T_PACKET_LENGTH,\n        packet,\n        type,\n        pesType,\n        pusi,\n        parsed,\n        frame,\n        i,\n        pes;\n\n    var endLoop = false;\n\n    var currentFrame = {\n      data: [],\n      size: 0\n    };\n\n    // Start walking from start of segment to get first video packet\n    while (endIndex < bytes.byteLength) {\n      // Look for a pair of start and end sync bytes in the data..\n      if (bytes[startIndex] === SYNC_BYTE && bytes[endIndex] === SYNC_BYTE) {\n        // We found a packet\n        packet = bytes.subarray(startIndex, endIndex);\n        type = probe$5.ts.parseType(packet, pmt.pid);\n\n        switch (type) {\n          case 'pes':\n            pesType = probe$5.ts.parsePesType(packet, pmt.table);\n            pusi = probe$5.ts.parsePayloadUnitStartIndicator(packet);\n            if (pesType === 'video') {\n              if (pusi && !endLoop) {\n                parsed = probe$5.ts.parsePesTime(packet);\n                if (parsed) {\n                  parsed.type = 'video';\n                  result.video.push(parsed);\n                  endLoop = true;\n                }\n              }\n              if (!result.firstKeyFrame) {\n                if (pusi) {\n                  if (currentFrame.size !== 0) {\n                    frame = new Uint8Array(currentFrame.size);\n                    i = 0;\n                    while (currentFrame.data.length) {\n                      pes = currentFrame.data.shift();\n                      frame.set(pes, i);\n                      i += pes.byteLength;\n                    }\n                    if (probe$5.ts.videoPacketContainsKeyFrame(frame)) {\n                      result.firstKeyFrame = probe$5.ts.parsePesTime(frame);\n                      result.firstKeyFrame.type = 'video';\n                    }\n                    currentFrame.size = 0;\n                  }\n                }\n                currentFrame.data.push(packet);\n                currentFrame.size += packet.byteLength;\n              }\n            }\n            break;\n          default:\n            break;\n        }\n\n        if (endLoop && result.firstKeyFrame) {\n          break;\n        }\n\n        startIndex += MP2T_PACKET_LENGTH;\n        endIndex += MP2T_PACKET_LENGTH;\n        continue;\n      }\n\n      // If we get here, we have somehow become de-synchronized and we need to step\n      // forward one byte at a time until we find a pair of sync bytes that denote\n      // a packet\n      startIndex++;\n      endIndex++;\n    }\n\n    // Start walking from end of segment to get last video packet\n    endIndex = bytes.byteLength;\n    startIndex = endIndex - MP2T_PACKET_LENGTH;\n    endLoop = false;\n    while (startIndex >= 0) {\n      // Look for a pair of start and end sync bytes in the data..\n      if (bytes[startIndex] === SYNC_BYTE && bytes[endIndex] === SYNC_BYTE) {\n        // We found a packet\n        packet = bytes.subarray(startIndex, endIndex);\n        type = probe$5.ts.parseType(packet, pmt.pid);\n\n        switch (type) {\n          case 'pes':\n            pesType = probe$5.ts.parsePesType(packet, pmt.table);\n            pusi = probe$5.ts.parsePayloadUnitStartIndicator(packet);\n            if (pesType === 'video' && pusi) {\n              parsed = probe$5.ts.parsePesTime(packet);\n              if (parsed) {\n                parsed.type = 'video';\n                result.video.push(parsed);\n                endLoop = true;\n              }\n            }\n            break;\n          default:\n            break;\n        }\n\n        if (endLoop) {\n          break;\n        }\n\n        startIndex -= MP2T_PACKET_LENGTH;\n        endIndex -= MP2T_PACKET_LENGTH;\n        continue;\n      }\n\n      // If we get here, we have somehow become de-synchronized and we need to step\n      // forward one byte at a time until we find a pair of sync bytes that denote\n      // a packet\n      startIndex--;\n      endIndex--;\n    }\n  };\n\n  /**\n   * Adjusts the timestamp information for the segment to account for\n   * rollover and convert to seconds based on pes packet timescale (90khz clock)\n   */\n  var adjustTimestamp_ = function adjustTimestamp_(segmentInfo, baseTimestamp) {\n    if (segmentInfo.audio && segmentInfo.audio.length) {\n      var audioBaseTimestamp = baseTimestamp;\n      if (typeof audioBaseTimestamp === 'undefined') {\n        audioBaseTimestamp = segmentInfo.audio[0].dts;\n      }\n      segmentInfo.audio.forEach(function (info) {\n        info.dts = handleRollover$1(info.dts, audioBaseTimestamp);\n        info.pts = handleRollover$1(info.pts, audioBaseTimestamp);\n        // time in seconds\n        info.dtsTime = info.dts / PES_TIMESCALE;\n        info.ptsTime = info.pts / PES_TIMESCALE;\n      });\n    }\n\n    if (segmentInfo.video && segmentInfo.video.length) {\n      var videoBaseTimestamp = baseTimestamp;\n      if (typeof videoBaseTimestamp === 'undefined') {\n        videoBaseTimestamp = segmentInfo.video[0].dts;\n      }\n      segmentInfo.video.forEach(function (info) {\n        info.dts = handleRollover$1(info.dts, videoBaseTimestamp);\n        info.pts = handleRollover$1(info.pts, videoBaseTimestamp);\n        // time in seconds\n        info.dtsTime = info.dts / PES_TIMESCALE;\n        info.ptsTime = info.pts / PES_TIMESCALE;\n      });\n      if (segmentInfo.firstKeyFrame) {\n        var frame = segmentInfo.firstKeyFrame;\n        frame.dts = handleRollover$1(frame.dts, videoBaseTimestamp);\n        frame.pts = handleRollover$1(frame.pts, videoBaseTimestamp);\n        // time in seconds\n        frame.dtsTime = frame.dts / PES_TIMESCALE;\n        frame.ptsTime = frame.dts / PES_TIMESCALE;\n      }\n    }\n  };\n\n  /**\n   * inspects the aac data stream for start and end time information\n   */\n  var inspectAac_ = function inspectAac_(bytes) {\n    var endLoop = false,\n        audioCount = 0,\n        sampleRate = null,\n        timestamp = null,\n        frameSize = 0,\n        byteIndex = 0,\n        packet;\n\n    while (bytes.length - byteIndex >= 3) {\n      var type = probe$5.aac.parseType(bytes, byteIndex);\n      switch (type) {\n        case 'timed-metadata':\n          // Exit early because we don't have enough to parse\n          // the ID3 tag header\n          if (bytes.length - byteIndex < 10) {\n            endLoop = true;\n            break;\n          }\n\n          frameSize = probe$5.aac.parseId3TagSize(bytes, byteIndex);\n\n          // Exit early if we don't have enough in the buffer\n          // to emit a full packet\n          if (frameSize > bytes.length) {\n            endLoop = true;\n            break;\n          }\n          if (timestamp === null) {\n            packet = bytes.subarray(byteIndex, byteIndex + frameSize);\n            timestamp = probe$5.aac.parseAacTimestamp(packet);\n          }\n          byteIndex += frameSize;\n          break;\n        case 'audio':\n          // Exit early because we don't have enough to parse\n          // the ADTS frame header\n          if (bytes.length - byteIndex < 7) {\n            endLoop = true;\n            break;\n          }\n\n          frameSize = probe$5.aac.parseAdtsSize(bytes, byteIndex);\n\n          // Exit early if we don't have enough in the buffer\n          // to emit a full packet\n          if (frameSize > bytes.length) {\n            endLoop = true;\n            break;\n          }\n          if (sampleRate === null) {\n            packet = bytes.subarray(byteIndex, byteIndex + frameSize);\n            sampleRate = probe$5.aac.parseSampleRate(packet);\n          }\n          audioCount++;\n          byteIndex += frameSize;\n          break;\n        default:\n          byteIndex++;\n          break;\n      }\n      if (endLoop) {\n        return null;\n      }\n    }\n    if (sampleRate === null || timestamp === null) {\n      return null;\n    }\n\n    var audioTimescale = PES_TIMESCALE / sampleRate;\n\n    var result = {\n      audio: [{\n        type: 'audio',\n        dts: timestamp,\n        pts: timestamp\n      }, {\n        type: 'audio',\n        dts: timestamp + audioCount * 1024 * audioTimescale,\n        pts: timestamp + audioCount * 1024 * audioTimescale\n      }]\n    };\n\n    return result;\n  };\n\n  /**\n   * inspects the transport stream segment data for start and end time information\n   * of the audio and video tracks (when present) as well as the first key frame's\n   * start time.\n   */\n  var inspectTs_ = function inspectTs_(bytes) {\n    var pmt = {\n      pid: null,\n      table: null\n    };\n\n    var result = {};\n\n    parsePsi_(bytes, pmt);\n\n    for (var pid in pmt.table) {\n      if (pmt.table.hasOwnProperty(pid)) {\n        var type = pmt.table[pid];\n        switch (type) {\n          case StreamTypes.H264_STREAM_TYPE:\n            result.video = [];\n            parseVideoPes_(bytes, pmt, result);\n            if (result.video.length === 0) {\n              delete result.video;\n            }\n            break;\n          case StreamTypes.ADTS_STREAM_TYPE:\n            result.audio = [];\n            parseAudioPes_(bytes, pmt, result);\n            if (result.audio.length === 0) {\n              delete result.audio;\n            }\n            break;\n          default:\n            break;\n        }\n      }\n    }\n    return result;\n  };\n\n  /**\n   * Inspects segment byte data and returns an object with start and end timing information\n   *\n   * @param {Uint8Array} bytes The segment byte data\n   * @param {Number} baseTimestamp Relative reference timestamp used when adjusting frame\n   *  timestamps for rollover. This value must be in 90khz clock.\n   * @return {Object} Object containing start and end frame timing info of segment.\n   */\n  var inspect = function inspect(bytes, baseTimestamp) {\n    var isAacData = isLikelyAacData(bytes);\n\n    var result;\n\n    if (isAacData) {\n      result = inspectAac_(bytes);\n    } else {\n      result = inspectTs_(bytes);\n    }\n\n    if (!result || !result.audio && !result.video) {\n      return null;\n    }\n\n    adjustTimestamp_(result, baseTimestamp);\n\n    return result;\n  };\n\n  var tsInspector = {\n    inspect: inspect\n  };\n\n  /*\n   * pkcs7.pad\n   * https://github.com/brightcove/pkcs7\n   *\n   * Copyright (c) 2014 Brightcove\n   * Licensed under the apache2 license.\n   */\n\n  /**\n   * Returns the subarray of a Uint8Array without PKCS#7 padding.\n   * @param padded {Uint8Array} unencrypted bytes that have been padded\n   * @return {Uint8Array} the unpadded bytes\n   * @see http://tools.ietf.org/html/rfc5652\n   */\n  function unpad(padded) {\n    return padded.subarray(0, padded.byteLength - padded[padded.byteLength - 1]);\n  }\n\n  var classCallCheck$2 = function classCallCheck$$1(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  var createClass$1 = function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  }();\n\n  var inherits$2 = function inherits$$1(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === \"undefined\" ? \"undefined\" : _typeof(superClass)));\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  var possibleConstructorReturn$2 = function possibleConstructorReturn$$1(self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && ((typeof call === \"undefined\" ? \"undefined\" : _typeof(call)) === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  /**\n   * @file aes.js\n   *\n   * This file contains an adaptation of the AES decryption algorithm\n   * from the Standford Javascript Cryptography Library. That work is\n   * covered by the following copyright and permissions notice:\n   *\n   * Copyright 2009-2010 Emily Stark, Mike Hamburg, Dan Boneh.\n   * All rights reserved.\n   *\n   * Redistribution and use in source and binary forms, with or without\n   * modification, are permitted provided that the following conditions are\n   * met:\n   *\n   * 1. Redistributions of source code must retain the above copyright\n   *    notice, this list of conditions and the following disclaimer.\n   *\n   * 2. Redistributions in binary form must reproduce the above\n   *    copyright notice, this list of conditions and the following\n   *    disclaimer in the documentation and/or other materials provided\n   *    with the distribution.\n   *\n   * THIS SOFTWARE IS PROVIDED BY THE AUTHORS ``AS IS'' AND ANY EXPRESS OR\n   * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n   * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n   * DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR CONTRIBUTORS BE\n   * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n   * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n   * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR\n   * BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n   * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n   * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN\n   * IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n   *\n   * The views and conclusions contained in the software and documentation\n   * are those of the authors and should not be interpreted as representing\n   * official policies, either expressed or implied, of the authors.\n   */\n\n  /**\n   * Expand the S-box tables.\n   *\n   * @private\n   */\n  var precompute = function precompute() {\n    var tables = [[[], [], [], [], []], [[], [], [], [], []]];\n    var encTable = tables[0];\n    var decTable = tables[1];\n    var sbox = encTable[4];\n    var sboxInv = decTable[4];\n    var i = void 0;\n    var x = void 0;\n    var xInv = void 0;\n    var d = [];\n    var th = [];\n    var x2 = void 0;\n    var x4 = void 0;\n    var x8 = void 0;\n    var s = void 0;\n    var tEnc = void 0;\n    var tDec = void 0;\n\n    // Compute double and third tables\n    for (i = 0; i < 256; i++) {\n      th[(d[i] = i << 1 ^ (i >> 7) * 283) ^ i] = i;\n    }\n\n    for (x = xInv = 0; !sbox[x]; x ^= x2 || 1, xInv = th[xInv] || 1) {\n      // Compute sbox\n      s = xInv ^ xInv << 1 ^ xInv << 2 ^ xInv << 3 ^ xInv << 4;\n      s = s >> 8 ^ s & 255 ^ 99;\n      sbox[x] = s;\n      sboxInv[s] = x;\n\n      // Compute MixColumns\n      x8 = d[x4 = d[x2 = d[x]]];\n      tDec = x8 * 0x1010101 ^ x4 * 0x10001 ^ x2 * 0x101 ^ x * 0x1010100;\n      tEnc = d[s] * 0x101 ^ s * 0x1010100;\n\n      for (i = 0; i < 4; i++) {\n        encTable[i][x] = tEnc = tEnc << 24 ^ tEnc >>> 8;\n        decTable[i][s] = tDec = tDec << 24 ^ tDec >>> 8;\n      }\n    }\n\n    // Compactify. Considerable speedup on Firefox.\n    for (i = 0; i < 5; i++) {\n      encTable[i] = encTable[i].slice(0);\n      decTable[i] = decTable[i].slice(0);\n    }\n    return tables;\n  };\n  var aesTables = null;\n\n  /**\n   * Schedule out an AES key for both encryption and decryption. This\n   * is a low-level class. Use a cipher mode to do bulk encryption.\n   *\n   * @class AES\n   * @param key {Array} The key as an array of 4, 6 or 8 words.\n   */\n\n  var AES = function () {\n    function AES(key) {\n      classCallCheck$2(this, AES);\n\n      /**\n       * The expanded S-box and inverse S-box tables. These will be computed\n       * on the client so that we don't have to send them down the wire.\n       *\n       * There are two tables, _tables[0] is for encryption and\n       * _tables[1] is for decryption.\n       *\n       * The first 4 sub-tables are the expanded S-box with MixColumns. The\n       * last (_tables[01][4]) is the S-box itself.\n       *\n       * @private\n       */\n      // if we have yet to precompute the S-box tables\n      // do so now\n      if (!aesTables) {\n        aesTables = precompute();\n      }\n      // then make a copy of that object for use\n      this._tables = [[aesTables[0][0].slice(), aesTables[0][1].slice(), aesTables[0][2].slice(), aesTables[0][3].slice(), aesTables[0][4].slice()], [aesTables[1][0].slice(), aesTables[1][1].slice(), aesTables[1][2].slice(), aesTables[1][3].slice(), aesTables[1][4].slice()]];\n      var i = void 0;\n      var j = void 0;\n      var tmp = void 0;\n      var encKey = void 0;\n      var decKey = void 0;\n      var sbox = this._tables[0][4];\n      var decTable = this._tables[1];\n      var keyLen = key.length;\n      var rcon = 1;\n\n      if (keyLen !== 4 && keyLen !== 6 && keyLen !== 8) {\n        throw new Error('Invalid aes key size');\n      }\n\n      encKey = key.slice(0);\n      decKey = [];\n      this._key = [encKey, decKey];\n\n      // schedule encryption keys\n      for (i = keyLen; i < 4 * keyLen + 28; i++) {\n        tmp = encKey[i - 1];\n\n        // apply sbox\n        if (i % keyLen === 0 || keyLen === 8 && i % keyLen === 4) {\n          tmp = sbox[tmp >>> 24] << 24 ^ sbox[tmp >> 16 & 255] << 16 ^ sbox[tmp >> 8 & 255] << 8 ^ sbox[tmp & 255];\n\n          // shift rows and add rcon\n          if (i % keyLen === 0) {\n            tmp = tmp << 8 ^ tmp >>> 24 ^ rcon << 24;\n            rcon = rcon << 1 ^ (rcon >> 7) * 283;\n          }\n        }\n\n        encKey[i] = encKey[i - keyLen] ^ tmp;\n      }\n\n      // schedule decryption keys\n      for (j = 0; i; j++, i--) {\n        tmp = encKey[j & 3 ? i : i - 4];\n        if (i <= 4 || j < 4) {\n          decKey[j] = tmp;\n        } else {\n          decKey[j] = decTable[0][sbox[tmp >>> 24]] ^ decTable[1][sbox[tmp >> 16 & 255]] ^ decTable[2][sbox[tmp >> 8 & 255]] ^ decTable[3][sbox[tmp & 255]];\n        }\n      }\n    }\n\n    /**\n     * Decrypt 16 bytes, specified as four 32-bit words.\n     *\n     * @param {Number} encrypted0 the first word to decrypt\n     * @param {Number} encrypted1 the second word to decrypt\n     * @param {Number} encrypted2 the third word to decrypt\n     * @param {Number} encrypted3 the fourth word to decrypt\n     * @param {Int32Array} out the array to write the decrypted words\n     * into\n     * @param {Number} offset the offset into the output array to start\n     * writing results\n     * @return {Array} The plaintext.\n     */\n\n    AES.prototype.decrypt = function decrypt(encrypted0, encrypted1, encrypted2, encrypted3, out, offset) {\n      var key = this._key[1];\n      // state variables a,b,c,d are loaded with pre-whitened data\n      var a = encrypted0 ^ key[0];\n      var b = encrypted3 ^ key[1];\n      var c = encrypted2 ^ key[2];\n      var d = encrypted1 ^ key[3];\n      var a2 = void 0;\n      var b2 = void 0;\n      var c2 = void 0;\n\n      // key.length === 2 ?\n      var nInnerRounds = key.length / 4 - 2;\n      var i = void 0;\n      var kIndex = 4;\n      var table = this._tables[1];\n\n      // load up the tables\n      var table0 = table[0];\n      var table1 = table[1];\n      var table2 = table[2];\n      var table3 = table[3];\n      var sbox = table[4];\n\n      // Inner rounds. Cribbed from OpenSSL.\n      for (i = 0; i < nInnerRounds; i++) {\n        a2 = table0[a >>> 24] ^ table1[b >> 16 & 255] ^ table2[c >> 8 & 255] ^ table3[d & 255] ^ key[kIndex];\n        b2 = table0[b >>> 24] ^ table1[c >> 16 & 255] ^ table2[d >> 8 & 255] ^ table3[a & 255] ^ key[kIndex + 1];\n        c2 = table0[c >>> 24] ^ table1[d >> 16 & 255] ^ table2[a >> 8 & 255] ^ table3[b & 255] ^ key[kIndex + 2];\n        d = table0[d >>> 24] ^ table1[a >> 16 & 255] ^ table2[b >> 8 & 255] ^ table3[c & 255] ^ key[kIndex + 3];\n        kIndex += 4;\n        a = a2;b = b2;c = c2;\n      }\n\n      // Last round.\n      for (i = 0; i < 4; i++) {\n        out[(3 & -i) + offset] = sbox[a >>> 24] << 24 ^ sbox[b >> 16 & 255] << 16 ^ sbox[c >> 8 & 255] << 8 ^ sbox[d & 255] ^ key[kIndex++];\n        a2 = a;a = b;b = c;c = d;d = a2;\n      }\n    };\n\n    return AES;\n  }();\n\n  /**\n   * @file stream.js\n   */\n  /**\n   * A lightweight readable stream implemention that handles event dispatching.\n   *\n   * @class Stream\n   */\n  var Stream$3 = function () {\n    function Stream() {\n      classCallCheck$2(this, Stream);\n\n      this.listeners = {};\n    }\n\n    /**\n     * Add a listener for a specified event type.\n     *\n     * @param {String} type the event name\n     * @param {Function} listener the callback to be invoked when an event of\n     * the specified type occurs\n     */\n\n    Stream.prototype.on = function on(type, listener) {\n      if (!this.listeners[type]) {\n        this.listeners[type] = [];\n      }\n      this.listeners[type].push(listener);\n    };\n\n    /**\n     * Remove a listener for a specified event type.\n     *\n     * @param {String} type the event name\n     * @param {Function} listener  a function previously registered for this\n     * type of event through `on`\n     * @return {Boolean} if we could turn it off or not\n     */\n\n    Stream.prototype.off = function off(type, listener) {\n      if (!this.listeners[type]) {\n        return false;\n      }\n\n      var index = this.listeners[type].indexOf(listener);\n\n      this.listeners[type].splice(index, 1);\n      return index > -1;\n    };\n\n    /**\n     * Trigger an event of the specified type on this stream. Any additional\n     * arguments to this function are passed as parameters to event listeners.\n     *\n     * @param {String} type the event name\n     */\n\n    Stream.prototype.trigger = function trigger(type) {\n      var callbacks = this.listeners[type];\n\n      if (!callbacks) {\n        return;\n      }\n\n      // Slicing the arguments on every invocation of this method\n      // can add a significant amount of overhead. Avoid the\n      // intermediate object creation for the common case of a\n      // single callback argument\n      if (arguments.length === 2) {\n        var length = callbacks.length;\n\n        for (var i = 0; i < length; ++i) {\n          callbacks[i].call(this, arguments[1]);\n        }\n      } else {\n        var args = Array.prototype.slice.call(arguments, 1);\n        var _length = callbacks.length;\n\n        for (var _i = 0; _i < _length; ++_i) {\n          callbacks[_i].apply(this, args);\n        }\n      }\n    };\n\n    /**\n     * Destroys the stream and cleans up.\n     */\n\n    Stream.prototype.dispose = function dispose() {\n      this.listeners = {};\n    };\n    /**\n     * Forwards all `data` events on this stream to the destination stream. The\n     * destination stream should provide a method `push` to receive the data\n     * events as they arrive.\n     *\n     * @param {Stream} destination the stream that will receive all `data` events\n     * @see http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options\n     */\n\n    Stream.prototype.pipe = function pipe(destination) {\n      this.on('data', function (data) {\n        destination.push(data);\n      });\n    };\n\n    return Stream;\n  }();\n\n  /**\n   * @file async-stream.js\n   */\n  /**\n   * A wrapper around the Stream class to use setTiemout\n   * and run stream \"jobs\" Asynchronously\n   *\n   * @class AsyncStream\n   * @extends Stream\n   */\n\n  var AsyncStream = function (_Stream) {\n    inherits$2(AsyncStream, _Stream);\n\n    function AsyncStream() {\n      classCallCheck$2(this, AsyncStream);\n\n      var _this = possibleConstructorReturn$2(this, _Stream.call(this, Stream$3));\n\n      _this.jobs = [];\n      _this.delay = 1;\n      _this.timeout_ = null;\n      return _this;\n    }\n\n    /**\n     * process an async job\n     *\n     * @private\n     */\n\n    AsyncStream.prototype.processJob_ = function processJob_() {\n      this.jobs.shift()();\n      if (this.jobs.length) {\n        this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay);\n      } else {\n        this.timeout_ = null;\n      }\n    };\n\n    /**\n     * push a job into the stream\n     *\n     * @param {Function} job the job to push into the stream\n     */\n\n    AsyncStream.prototype.push = function push(job) {\n      this.jobs.push(job);\n      if (!this.timeout_) {\n        this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay);\n      }\n    };\n\n    return AsyncStream;\n  }(Stream$3);\n\n  /**\n   * @file decrypter.js\n   *\n   * An asynchronous implementation of AES-128 CBC decryption with\n   * PKCS#7 padding.\n   */\n\n  /**\n   * Convert network-order (big-endian) bytes into their little-endian\n   * representation.\n   */\n  var ntoh = function ntoh(word) {\n    return word << 24 | (word & 0xff00) << 8 | (word & 0xff0000) >> 8 | word >>> 24;\n  };\n\n  /**\n   * Decrypt bytes using AES-128 with CBC and PKCS#7 padding.\n   *\n   * @param {Uint8Array} encrypted the encrypted bytes\n   * @param {Uint32Array} key the bytes of the decryption key\n   * @param {Uint32Array} initVector the initialization vector (IV) to\n   * use for the first round of CBC.\n   * @return {Uint8Array} the decrypted bytes\n   *\n   * @see http://en.wikipedia.org/wiki/Advanced_Encryption_Standard\n   * @see http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_.28CBC.29\n   * @see https://tools.ietf.org/html/rfc2315\n   */\n  var decrypt = function decrypt(encrypted, key, initVector) {\n    // word-level access to the encrypted bytes\n    var encrypted32 = new Int32Array(encrypted.buffer, encrypted.byteOffset, encrypted.byteLength >> 2);\n\n    var decipher = new AES(Array.prototype.slice.call(key));\n\n    // byte and word-level access for the decrypted output\n    var decrypted = new Uint8Array(encrypted.byteLength);\n    var decrypted32 = new Int32Array(decrypted.buffer);\n\n    // temporary variables for working with the IV, encrypted, and\n    // decrypted data\n    var init0 = void 0;\n    var init1 = void 0;\n    var init2 = void 0;\n    var init3 = void 0;\n    var encrypted0 = void 0;\n    var encrypted1 = void 0;\n    var encrypted2 = void 0;\n    var encrypted3 = void 0;\n\n    // iteration variable\n    var wordIx = void 0;\n\n    // pull out the words of the IV to ensure we don't modify the\n    // passed-in reference and easier access\n    init0 = initVector[0];\n    init1 = initVector[1];\n    init2 = initVector[2];\n    init3 = initVector[3];\n\n    // decrypt four word sequences, applying cipher-block chaining (CBC)\n    // to each decrypted block\n    for (wordIx = 0; wordIx < encrypted32.length; wordIx += 4) {\n      // convert big-endian (network order) words into little-endian\n      // (javascript order)\n      encrypted0 = ntoh(encrypted32[wordIx]);\n      encrypted1 = ntoh(encrypted32[wordIx + 1]);\n      encrypted2 = ntoh(encrypted32[wordIx + 2]);\n      encrypted3 = ntoh(encrypted32[wordIx + 3]);\n\n      // decrypt the block\n      decipher.decrypt(encrypted0, encrypted1, encrypted2, encrypted3, decrypted32, wordIx);\n\n      // XOR with the IV, and restore network byte-order to obtain the\n      // plaintext\n      decrypted32[wordIx] = ntoh(decrypted32[wordIx] ^ init0);\n      decrypted32[wordIx + 1] = ntoh(decrypted32[wordIx + 1] ^ init1);\n      decrypted32[wordIx + 2] = ntoh(decrypted32[wordIx + 2] ^ init2);\n      decrypted32[wordIx + 3] = ntoh(decrypted32[wordIx + 3] ^ init3);\n\n      // setup the IV for the next round\n      init0 = encrypted0;\n      init1 = encrypted1;\n      init2 = encrypted2;\n      init3 = encrypted3;\n    }\n\n    return decrypted;\n  };\n\n  /**\n   * The `Decrypter` class that manages decryption of AES\n   * data through `AsyncStream` objects and the `decrypt`\n   * function\n   *\n   * @param {Uint8Array} encrypted the encrypted bytes\n   * @param {Uint32Array} key the bytes of the decryption key\n   * @param {Uint32Array} initVector the initialization vector (IV) to\n   * @param {Function} done the function to run when done\n   * @class Decrypter\n   */\n\n  var Decrypter = function () {\n    function Decrypter(encrypted, key, initVector, done) {\n      classCallCheck$2(this, Decrypter);\n\n      var step = Decrypter.STEP;\n      var encrypted32 = new Int32Array(encrypted.buffer);\n      var decrypted = new Uint8Array(encrypted.byteLength);\n      var i = 0;\n\n      this.asyncStream_ = new AsyncStream();\n\n      // split up the encryption job and do the individual chunks asynchronously\n      this.asyncStream_.push(this.decryptChunk_(encrypted32.subarray(i, i + step), key, initVector, decrypted));\n      for (i = step; i < encrypted32.length; i += step) {\n        initVector = new Uint32Array([ntoh(encrypted32[i - 4]), ntoh(encrypted32[i - 3]), ntoh(encrypted32[i - 2]), ntoh(encrypted32[i - 1])]);\n        this.asyncStream_.push(this.decryptChunk_(encrypted32.subarray(i, i + step), key, initVector, decrypted));\n      }\n      // invoke the done() callback when everything is finished\n      this.asyncStream_.push(function () {\n        // remove pkcs#7 padding from the decrypted bytes\n        done(null, unpad(decrypted));\n      });\n    }\n\n    /**\n     * a getter for step the maximum number of bytes to process at one time\n     *\n     * @return {Number} the value of step 32000\n     */\n\n    /**\n     * @private\n     */\n    Decrypter.prototype.decryptChunk_ = function decryptChunk_(encrypted, key, initVector, decrypted) {\n      return function () {\n        var bytes = decrypt(encrypted, key, initVector);\n\n        decrypted.set(bytes, encrypted.byteOffset);\n      };\n    };\n\n    createClass$1(Decrypter, null, [{\n      key: 'STEP',\n      get: function get$$1() {\n        // 4 * 8000;\n        return 32000;\n      }\n    }]);\n    return Decrypter;\n  }();\n\n  /**\n   * @videojs/http-streaming\n   * @version 1.0.0\n   * @copyright 2018 Brightcove, Inc\n   * @license Apache-2.0\n   */\n\n  /**\n   * @file resolve-url.js\n   */\n\n  var resolveUrl$1 = function resolveUrl(baseURL, relativeURL) {\n    // return early if we don't need to resolve\n    if (/^[a-z]+:/i.test(relativeURL)) {\n      return relativeURL;\n    }\n\n    // if the base URL is relative then combine with the current location\n    if (!/\\/\\//i.test(baseURL)) {\n      baseURL = urlToolkit.buildAbsoluteURL(window_1.location.href, baseURL);\n    }\n\n    return urlToolkit.buildAbsoluteURL(baseURL, relativeURL);\n  };\n\n  /**\n   * @file playlist-loader.js\n   *\n   * A state machine that manages the loading, caching, and updating of\n   * M3U8 playlists.\n   *\n   */\n\n  var mergeOptions$1 = videojs$1.mergeOptions,\n      EventTarget$1 = videojs$1.EventTarget,\n      log$2 = videojs$1.log;\n\n  /**\n   * Loops through all supported media groups in master and calls the provided\n   * callback for each group\n   *\n   * @param {Object} master\n   *        The parsed master manifest object\n   * @param {Function} callback\n   *        Callback to call for each media group\n   */\n\n  var forEachMediaGroup = function forEachMediaGroup(master, callback) {\n    ['AUDIO', 'SUBTITLES'].forEach(function (mediaType) {\n      for (var groupKey in master.mediaGroups[mediaType]) {\n        for (var labelKey in master.mediaGroups[mediaType][groupKey]) {\n          var mediaProperties = master.mediaGroups[mediaType][groupKey][labelKey];\n\n          callback(mediaProperties, mediaType, groupKey, labelKey);\n        }\n      }\n    });\n  };\n\n  /**\n    * Returns a new array of segments that is the result of merging\n    * properties from an older list of segments onto an updated\n    * list. No properties on the updated playlist will be overridden.\n    *\n    * @param {Array} original the outdated list of segments\n    * @param {Array} update the updated list of segments\n    * @param {Number=} offset the index of the first update\n    * segment in the original segment list. For non-live playlists,\n    * this should always be zero and does not need to be\n    * specified. For live playlists, it should be the difference\n    * between the media sequence numbers in the original and updated\n    * playlists.\n    * @return a list of merged segment objects\n    */\n  var updateSegments = function updateSegments(original, update, offset) {\n    var result = update.slice();\n\n    offset = offset || 0;\n    var length = Math.min(original.length, update.length + offset);\n\n    for (var i = offset; i < length; i++) {\n      result[i - offset] = mergeOptions$1(original[i], result[i - offset]);\n    }\n    return result;\n  };\n\n  var resolveSegmentUris = function resolveSegmentUris(segment, baseUri) {\n    if (!segment.resolvedUri) {\n      segment.resolvedUri = resolveUrl$1(baseUri, segment.uri);\n    }\n    if (segment.key && !segment.key.resolvedUri) {\n      segment.key.resolvedUri = resolveUrl$1(baseUri, segment.key.uri);\n    }\n    if (segment.map && !segment.map.resolvedUri) {\n      segment.map.resolvedUri = resolveUrl$1(baseUri, segment.map.uri);\n    }\n  };\n\n  /**\n    * Returns a new master playlist that is the result of merging an\n    * updated media playlist into the original version. If the\n    * updated media playlist does not match any of the playlist\n    * entries in the original master playlist, null is returned.\n    *\n    * @param {Object} master a parsed master M3U8 object\n    * @param {Object} media a parsed media M3U8 object\n    * @return {Object} a new object that represents the original\n    * master playlist with the updated media playlist merged in, or\n    * null if the merge produced no change.\n    */\n  var updateMaster = function updateMaster(master, media) {\n    var result = mergeOptions$1(master, {});\n    var playlist = result.playlists[media.uri];\n\n    if (!playlist) {\n      return null;\n    }\n\n    // consider the playlist unchanged if the number of segments is equal and the media\n    // sequence number is unchanged\n    if (playlist.segments && media.segments && playlist.segments.length === media.segments.length && playlist.mediaSequence === media.mediaSequence) {\n      return null;\n    }\n\n    var mergedPlaylist = mergeOptions$1(playlist, media);\n\n    // if the update could overlap existing segment information, merge the two segment lists\n    if (playlist.segments) {\n      mergedPlaylist.segments = updateSegments(playlist.segments, media.segments, media.mediaSequence - playlist.mediaSequence);\n    }\n\n    // resolve any segment URIs to prevent us from having to do it later\n    mergedPlaylist.segments.forEach(function (segment) {\n      resolveSegmentUris(segment, mergedPlaylist.resolvedUri);\n    });\n\n    // TODO Right now in the playlists array there are two references to each playlist, one\n    // that is referenced by index, and one by URI. The index reference may no longer be\n    // necessary.\n    for (var i = 0; i < result.playlists.length; i++) {\n      if (result.playlists[i].uri === media.uri) {\n        result.playlists[i] = mergedPlaylist;\n      }\n    }\n    result.playlists[media.uri] = mergedPlaylist;\n\n    return result;\n  };\n\n  var setupMediaPlaylists = function setupMediaPlaylists(master) {\n    // setup by-URI lookups and resolve media playlist URIs\n    var i = master.playlists.length;\n\n    while (i--) {\n      var playlist = master.playlists[i];\n\n      master.playlists[playlist.uri] = playlist;\n      playlist.resolvedUri = resolveUrl$1(master.uri, playlist.uri);\n      playlist.id = i;\n\n      if (!playlist.attributes) {\n        // Although the spec states an #EXT-X-STREAM-INF tag MUST have a\n        // BANDWIDTH attribute, we can play the stream without it. This means a poorly\n        // formatted master playlist may not have an attribute list. An attributes\n        // property is added here to prevent undefined references when we encounter\n        // this scenario.\n        playlist.attributes = {};\n\n        log$2.warn('Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.');\n      }\n    }\n  };\n\n  var resolveMediaGroupUris = function resolveMediaGroupUris(master) {\n    forEachMediaGroup(master, function (properties) {\n      if (properties.uri) {\n        properties.resolvedUri = resolveUrl$1(master.uri, properties.uri);\n      }\n    });\n  };\n\n  /**\n   * Calculates the time to wait before refreshing a live playlist\n   *\n   * @param {Object} media\n   *        The current media\n   * @param {Boolean} update\n   *        True if there were any updates from the last refresh, false otherwise\n   * @return {Number}\n   *         The time in ms to wait before refreshing the live playlist\n   */\n  var refreshDelay = function refreshDelay(media, update) {\n    var lastSegment = media.segments[media.segments.length - 1];\n    var delay = void 0;\n\n    if (update && lastSegment && lastSegment.duration) {\n      delay = lastSegment.duration * 1000;\n    } else {\n      // if the playlist is unchanged since the last reload or last segment duration\n      // cannot be determined, try again after half the target duration\n      delay = (media.targetDuration || 10) * 500;\n    }\n    return delay;\n  };\n\n  /**\n   * Load a playlist from a remote location\n   *\n   * @class PlaylistLoader\n   * @extends Stream\n   * @param {String} srcUrl the url to start with\n   * @param {Boolean} withCredentials the withCredentials xhr option\n   * @constructor\n   */\n\n  var PlaylistLoader = function (_EventTarget) {\n    inherits(PlaylistLoader, _EventTarget);\n\n    function PlaylistLoader(srcUrl, hls, withCredentials) {\n      classCallCheck(this, PlaylistLoader);\n\n      var _this2 = possibleConstructorReturn(this, _EventTarget.call(this));\n\n      _this2.srcUrl = srcUrl;\n      _this2.hls_ = hls;\n      _this2.withCredentials = withCredentials;\n\n      if (!_this2.srcUrl) {\n        throw new Error('A non-empty playlist URL is required');\n      }\n\n      // initialize the loader state\n      _this2.state = 'HAVE_NOTHING';\n\n      // live playlist staleness timeout\n      _this2.on('mediaupdatetimeout', function () {\n        if (_this2.state !== 'HAVE_METADATA') {\n          // only refresh the media playlist if no other activity is going on\n          return;\n        }\n\n        _this2.state = 'HAVE_CURRENT_METADATA';\n\n        _this2.request = _this2.hls_.xhr({\n          uri: resolveUrl$1(_this2.master.uri, _this2.media().uri),\n          withCredentials: _this2.withCredentials\n        }, function (error, req) {\n          // disposed\n          if (!_this2.request) {\n            return;\n          }\n\n          if (error) {\n            return _this2.playlistRequestError(_this2.request, _this2.media().uri, 'HAVE_METADATA');\n          }\n\n          _this2.haveMetadata(_this2.request, _this2.media().uri);\n        });\n      });\n      return _this2;\n    }\n\n    PlaylistLoader.prototype.playlistRequestError = function playlistRequestError(xhr, url, startingState) {\n      // any in-flight request is now finished\n      this.request = null;\n\n      if (startingState) {\n        this.state = startingState;\n      }\n\n      this.error = {\n        playlist: this.master.playlists[url],\n        status: xhr.status,\n        message: 'HLS playlist request error at URL: ' + url,\n        responseText: xhr.responseText,\n        code: xhr.status >= 500 ? 4 : 2\n      };\n\n      this.trigger('error');\n    };\n\n    // update the playlist loader's state in response to a new or\n    // updated playlist.\n\n\n    PlaylistLoader.prototype.haveMetadata = function haveMetadata(xhr, url) {\n      var _this3 = this;\n\n      // any in-flight request is now finished\n      this.request = null;\n      this.state = 'HAVE_METADATA';\n\n      var parser = new Parser();\n\n      parser.push(xhr.responseText);\n      parser.end();\n      parser.manifest.uri = url;\n      // m3u8-parser does not attach an attributes property to media playlists so make\n      // sure that the property is attached to avoid undefined reference errors\n      parser.manifest.attributes = parser.manifest.attributes || {};\n\n      // merge this playlist into the master\n      var update = updateMaster(this.master, parser.manifest);\n\n      this.targetDuration = parser.manifest.targetDuration;\n\n      if (update) {\n        this.master = update;\n        this.media_ = this.master.playlists[parser.manifest.uri];\n      } else {\n        this.trigger('playlistunchanged');\n      }\n\n      // refresh live playlists after a target duration passes\n      if (!this.media().endList) {\n        window_1.clearTimeout(this.mediaUpdateTimeout);\n        this.mediaUpdateTimeout = window_1.setTimeout(function () {\n          _this3.trigger('mediaupdatetimeout');\n        }, refreshDelay(this.media(), !!update));\n      }\n\n      this.trigger('loadedplaylist');\n    };\n\n    /**\n     * Abort any outstanding work and clean up.\n     */\n\n\n    PlaylistLoader.prototype.dispose = function dispose() {\n      this.stopRequest();\n      window_1.clearTimeout(this.mediaUpdateTimeout);\n    };\n\n    PlaylistLoader.prototype.stopRequest = function stopRequest() {\n      if (this.request) {\n        var oldRequest = this.request;\n\n        this.request = null;\n        oldRequest.onreadystatechange = null;\n        oldRequest.abort();\n      }\n    };\n\n    /**\n     * When called without any arguments, returns the currently\n     * active media playlist. When called with a single argument,\n     * triggers the playlist loader to asynchronously switch to the\n     * specified media playlist. Calling this method while the\n     * loader is in the HAVE_NOTHING causes an error to be emitted\n     * but otherwise has no effect.\n     *\n     * @param {Object=} playlist the parsed media playlist\n     * object to switch to\n     * @return {Playlist} the current loaded media\n     */\n\n\n    PlaylistLoader.prototype.media = function media(playlist) {\n      var _this4 = this;\n\n      // getter\n      if (!playlist) {\n        return this.media_;\n      }\n\n      // setter\n      if (this.state === 'HAVE_NOTHING') {\n        throw new Error('Cannot switch media playlist from ' + this.state);\n      }\n\n      var startingState = this.state;\n\n      // find the playlist object if the target playlist has been\n      // specified by URI\n      if (typeof playlist === 'string') {\n        if (!this.master.playlists[playlist]) {\n          throw new Error('Unknown playlist URI: ' + playlist);\n        }\n        playlist = this.master.playlists[playlist];\n      }\n\n      var mediaChange = !this.media_ || playlist.uri !== this.media_.uri;\n\n      // switch to fully loaded playlists immediately\n      if (this.master.playlists[playlist.uri].endList) {\n        // abort outstanding playlist requests\n        if (this.request) {\n          this.request.onreadystatechange = null;\n          this.request.abort();\n          this.request = null;\n        }\n        this.state = 'HAVE_METADATA';\n        this.media_ = playlist;\n\n        // trigger media change if the active media has been updated\n        if (mediaChange) {\n          this.trigger('mediachanging');\n          this.trigger('mediachange');\n        }\n        return;\n      }\n\n      // switching to the active playlist is a no-op\n      if (!mediaChange) {\n        return;\n      }\n\n      this.state = 'SWITCHING_MEDIA';\n\n      // there is already an outstanding playlist request\n      if (this.request) {\n        if (resolveUrl$1(this.master.uri, playlist.uri) === this.request.url) {\n          // requesting to switch to the same playlist multiple times\n          // has no effect after the first\n          return;\n        }\n        this.request.onreadystatechange = null;\n        this.request.abort();\n        this.request = null;\n      }\n\n      // request the new playlist\n      if (this.media_) {\n        this.trigger('mediachanging');\n      }\n\n      this.request = this.hls_.xhr({\n        uri: resolveUrl$1(this.master.uri, playlist.uri),\n        withCredentials: this.withCredentials\n      }, function (error, req) {\n        // disposed\n        if (!_this4.request) {\n          return;\n        }\n\n        if (error) {\n          return _this4.playlistRequestError(_this4.request, playlist.uri, startingState);\n        }\n\n        _this4.haveMetadata(req, playlist.uri);\n\n        // fire loadedmetadata the first time a media playlist is loaded\n        if (startingState === 'HAVE_MASTER') {\n          _this4.trigger('loadedmetadata');\n        } else {\n          _this4.trigger('mediachange');\n        }\n      });\n    };\n\n    /**\n     * pause loading of the playlist\n     */\n\n\n    PlaylistLoader.prototype.pause = function pause() {\n      this.stopRequest();\n      window_1.clearTimeout(this.mediaUpdateTimeout);\n      if (this.state === 'HAVE_NOTHING') {\n        // If we pause the loader before any data has been retrieved, its as if we never\n        // started, so reset to an unstarted state.\n        this.started = false;\n      }\n      // Need to restore state now that no activity is happening\n      if (this.state === 'SWITCHING_MEDIA') {\n        // if the loader was in the process of switching media, it should either return to\n        // HAVE_MASTER or HAVE_METADATA depending on if the loader has loaded a media\n        // playlist yet. This is determined by the existence of loader.media_\n        if (this.media_) {\n          this.state = 'HAVE_METADATA';\n        } else {\n          this.state = 'HAVE_MASTER';\n        }\n      } else if (this.state === 'HAVE_CURRENT_METADATA') {\n        this.state = 'HAVE_METADATA';\n      }\n    };\n\n    /**\n     * start loading of the playlist\n     */\n\n\n    PlaylistLoader.prototype.load = function load(isFinalRendition) {\n      var _this5 = this;\n\n      window_1.clearTimeout(this.mediaUpdateTimeout);\n\n      var media = this.media();\n\n      if (isFinalRendition) {\n        var delay = media ? media.targetDuration / 2 * 1000 : 5 * 1000;\n\n        this.mediaUpdateTimeout = window_1.setTimeout(function () {\n          return _this5.load();\n        }, delay);\n        return;\n      }\n\n      if (!this.started) {\n        this.start();\n        return;\n      }\n\n      if (media && !media.endList) {\n        this.trigger('mediaupdatetimeout');\n      } else {\n        this.trigger('loadedplaylist');\n      }\n    };\n\n    /**\n     * start loading of the playlist\n     */\n\n\n    PlaylistLoader.prototype.start = function start() {\n      var _this6 = this;\n\n      this.started = true;\n\n      // request the specified URL\n      this.request = this.hls_.xhr({\n        uri: this.srcUrl,\n        withCredentials: this.withCredentials\n      }, function (error, req) {\n        // disposed\n        if (!_this6.request) {\n          return;\n        }\n\n        // clear the loader's request reference\n        _this6.request = null;\n\n        if (error) {\n          _this6.error = {\n            status: req.status,\n            message: 'HLS playlist request error at URL: ' + _this6.srcUrl,\n            responseText: req.responseText,\n            // MEDIA_ERR_NETWORK\n            code: 2\n          };\n          if (_this6.state === 'HAVE_NOTHING') {\n            _this6.started = false;\n          }\n          return _this6.trigger('error');\n        }\n\n        var parser = new Parser();\n\n        parser.push(req.responseText);\n        parser.end();\n\n        _this6.state = 'HAVE_MASTER';\n\n        parser.manifest.uri = _this6.srcUrl;\n\n        // loaded a master playlist\n        if (parser.manifest.playlists) {\n          _this6.master = parser.manifest;\n\n          setupMediaPlaylists(_this6.master);\n          resolveMediaGroupUris(_this6.master);\n\n          _this6.trigger('loadedplaylist');\n          if (!_this6.request) {\n            // no media playlist was specifically selected so start\n            // from the first listed one\n            _this6.media(parser.manifest.playlists[0]);\n          }\n          return;\n        }\n\n        // loaded a media playlist\n        // infer a master playlist if none was previously requested\n        _this6.master = {\n          mediaGroups: {\n            'AUDIO': {},\n            'VIDEO': {},\n            'CLOSED-CAPTIONS': {},\n            'SUBTITLES': {}\n          },\n          uri: window_1.location.href,\n          playlists: [{\n            uri: _this6.srcUrl,\n            id: 0\n          }]\n        };\n        _this6.master.playlists[_this6.srcUrl] = _this6.master.playlists[0];\n        _this6.master.playlists[0].resolvedUri = _this6.srcUrl;\n        // m3u8-parser does not attach an attributes property to media playlists so make\n        // sure that the property is attached to avoid undefined reference errors\n        _this6.master.playlists[0].attributes = _this6.master.playlists[0].attributes || {};\n        _this6.haveMetadata(req, _this6.srcUrl);\n        return _this6.trigger('loadedmetadata');\n      });\n    };\n\n    return PlaylistLoader;\n  }(EventTarget$1);\n\n  /**\n   * @file playlist.js\n   *\n   * Playlist related utilities.\n   */\n\n  var createTimeRange = videojs$1.createTimeRange;\n\n  /**\n   * walk backward until we find a duration we can use\n   * or return a failure\n   *\n   * @param {Playlist} playlist the playlist to walk through\n   * @param {Number} endSequence the mediaSequence to stop walking on\n   */\n\n  var backwardDuration = function backwardDuration(playlist, endSequence) {\n    var result = 0;\n    var i = endSequence - playlist.mediaSequence;\n    // if a start time is available for segment immediately following\n    // the interval, use it\n    var segment = playlist.segments[i];\n\n    // Walk backward until we find the latest segment with timeline\n    // information that is earlier than endSequence\n    if (segment) {\n      if (typeof segment.start !== 'undefined') {\n        return { result: segment.start, precise: true };\n      }\n      if (typeof segment.end !== 'undefined') {\n        return {\n          result: segment.end - segment.duration,\n          precise: true\n        };\n      }\n    }\n    while (i--) {\n      segment = playlist.segments[i];\n      if (typeof segment.end !== 'undefined') {\n        return { result: result + segment.end, precise: true };\n      }\n\n      result += segment.duration;\n\n      if (typeof segment.start !== 'undefined') {\n        return { result: result + segment.start, precise: true };\n      }\n    }\n    return { result: result, precise: false };\n  };\n\n  /**\n   * walk forward until we find a duration we can use\n   * or return a failure\n   *\n   * @param {Playlist} playlist the playlist to walk through\n   * @param {Number} endSequence the mediaSequence to stop walking on\n   */\n  var forwardDuration = function forwardDuration(playlist, endSequence) {\n    var result = 0;\n    var segment = void 0;\n    var i = endSequence - playlist.mediaSequence;\n    // Walk forward until we find the earliest segment with timeline\n    // information\n\n    for (; i < playlist.segments.length; i++) {\n      segment = playlist.segments[i];\n      if (typeof segment.start !== 'undefined') {\n        return {\n          result: segment.start - result,\n          precise: true\n        };\n      }\n\n      result += segment.duration;\n\n      if (typeof segment.end !== 'undefined') {\n        return {\n          result: segment.end - result,\n          precise: true\n        };\n      }\n    }\n    // indicate we didn't find a useful duration estimate\n    return { result: -1, precise: false };\n  };\n\n  /**\n    * Calculate the media duration from the segments associated with a\n    * playlist. The duration of a subinterval of the available segments\n    * may be calculated by specifying an end index.\n    *\n    * @param {Object} playlist a media playlist object\n    * @param {Number=} endSequence an exclusive upper boundary\n    * for the playlist.  Defaults to playlist length.\n    * @param {Number} expired the amount of time that has dropped\n    * off the front of the playlist in a live scenario\n    * @return {Number} the duration between the first available segment\n    * and end index.\n    */\n  var intervalDuration = function intervalDuration(playlist, endSequence, expired) {\n    var backward = void 0;\n    var forward = void 0;\n\n    if (typeof endSequence === 'undefined') {\n      endSequence = playlist.mediaSequence + playlist.segments.length;\n    }\n\n    if (endSequence < playlist.mediaSequence) {\n      return 0;\n    }\n\n    // do a backward walk to estimate the duration\n    backward = backwardDuration(playlist, endSequence);\n    if (backward.precise) {\n      // if we were able to base our duration estimate on timing\n      // information provided directly from the Media Source, return\n      // it\n      return backward.result;\n    }\n\n    // walk forward to see if a precise duration estimate can be made\n    // that way\n    forward = forwardDuration(playlist, endSequence);\n    if (forward.precise) {\n      // we found a segment that has been buffered and so it's\n      // position is known precisely\n      return forward.result;\n    }\n\n    // return the less-precise, playlist-based duration estimate\n    return backward.result + expired;\n  };\n\n  /**\n    * Calculates the duration of a playlist. If a start and end index\n    * are specified, the duration will be for the subset of the media\n    * timeline between those two indices. The total duration for live\n    * playlists is always Infinity.\n    *\n    * @param {Object} playlist a media playlist object\n    * @param {Number=} endSequence an exclusive upper\n    * boundary for the playlist. Defaults to the playlist media\n    * sequence number plus its length.\n    * @param {Number=} expired the amount of time that has\n    * dropped off the front of the playlist in a live scenario\n    * @return {Number} the duration between the start index and end\n    * index.\n    */\n  var duration = function duration(playlist, endSequence, expired) {\n    if (!playlist) {\n      return 0;\n    }\n\n    if (typeof expired !== 'number') {\n      expired = 0;\n    }\n\n    // if a slice of the total duration is not requested, use\n    // playlist-level duration indicators when they're present\n    if (typeof endSequence === 'undefined') {\n      // if present, use the duration specified in the playlist\n      if (playlist.totalDuration) {\n        return playlist.totalDuration;\n      }\n\n      // duration should be Infinity for live playlists\n      if (!playlist.endList) {\n        return window_1.Infinity;\n      }\n    }\n\n    // calculate the total duration based on the segment durations\n    return intervalDuration(playlist, endSequence, expired);\n  };\n\n  /**\n    * Calculate the time between two indexes in the current playlist\n    * neight the start- nor the end-index need to be within the current\n    * playlist in which case, the targetDuration of the playlist is used\n    * to approximate the durations of the segments\n    *\n    * @param {Object} playlist a media playlist object\n    * @param {Number} startIndex\n    * @param {Number} endIndex\n    * @return {Number} the number of seconds between startIndex and endIndex\n    */\n  var sumDurations = function sumDurations(playlist, startIndex, endIndex) {\n    var durations = 0;\n\n    if (startIndex > endIndex) {\n      var _ref = [endIndex, startIndex];\n      startIndex = _ref[0];\n      endIndex = _ref[1];\n    }\n\n    if (startIndex < 0) {\n      for (var i = startIndex; i < Math.min(0, endIndex); i++) {\n        durations += playlist.targetDuration;\n      }\n      startIndex = 0;\n    }\n\n    for (var _i2 = startIndex; _i2 < endIndex; _i2++) {\n      durations += playlist.segments[_i2].duration;\n    }\n\n    return durations;\n  };\n\n  /**\n   * Determines the media index of the segment corresponding to the safe edge of the live\n   * window which is the duration of the last segment plus 2 target durations from the end\n   * of the playlist.\n   *\n   * @param {Object} playlist\n   *        a media playlist object\n   * @return {Number}\n   *         The media index of the segment at the safe live point. 0 if there is no \"safe\"\n   *         point.\n   * @function safeLiveIndex\n   */\n  var safeLiveIndex = function safeLiveIndex(playlist) {\n    if (!playlist.segments.length) {\n      return 0;\n    }\n\n    var i = playlist.segments.length - 1;\n    var distanceFromEnd = playlist.segments[i].duration || playlist.targetDuration;\n    var safeDistance = distanceFromEnd + playlist.targetDuration * 2;\n\n    while (i--) {\n      distanceFromEnd += playlist.segments[i].duration;\n\n      if (distanceFromEnd >= safeDistance) {\n        break;\n      }\n    }\n\n    return Math.max(0, i);\n  };\n\n  /**\n   * Calculates the playlist end time\n   *\n   * @param {Object} playlist a media playlist object\n   * @param {Number=} expired the amount of time that has\n   *                  dropped off the front of the playlist in a live scenario\n   * @param {Boolean|false} useSafeLiveEnd a boolean value indicating whether or not the\n   *                        playlist end calculation should consider the safe live end\n   *                        (truncate the playlist end by three segments). This is normally\n   *                        used for calculating the end of the playlist's seekable range.\n   * @returns {Number} the end time of playlist\n   * @function playlistEnd\n   */\n  var playlistEnd = function playlistEnd(playlist, expired, useSafeLiveEnd) {\n    if (!playlist || !playlist.segments) {\n      return null;\n    }\n    if (playlist.endList) {\n      return duration(playlist);\n    }\n\n    if (expired === null) {\n      return null;\n    }\n\n    expired = expired || 0;\n\n    var endSequence = useSafeLiveEnd ? safeLiveIndex(playlist) : playlist.segments.length;\n\n    return intervalDuration(playlist, playlist.mediaSequence + endSequence, expired);\n  };\n\n  /**\n    * Calculates the interval of time that is currently seekable in a\n    * playlist. The returned time ranges are relative to the earliest\n    * moment in the specified playlist that is still available. A full\n    * seekable implementation for live streams would need to offset\n    * these values by the duration of content that has expired from the\n    * stream.\n    *\n    * @param {Object} playlist a media playlist object\n    * dropped off the front of the playlist in a live scenario\n    * @param {Number=} expired the amount of time that has\n    * dropped off the front of the playlist in a live scenario\n    * @return {TimeRanges} the periods of time that are valid targets\n    * for seeking\n    */\n  var seekable = function seekable(playlist, expired) {\n    var useSafeLiveEnd = true;\n    var seekableStart = expired || 0;\n    var seekableEnd = playlistEnd(playlist, expired, useSafeLiveEnd);\n\n    if (seekableEnd === null) {\n      return createTimeRange();\n    }\n    return createTimeRange(seekableStart, seekableEnd);\n  };\n\n  var isWholeNumber = function isWholeNumber(num) {\n    return num - Math.floor(num) === 0;\n  };\n\n  var roundSignificantDigit = function roundSignificantDigit(increment, num) {\n    // If we have a whole number, just add 1 to it\n    if (isWholeNumber(num)) {\n      return num + increment * 0.1;\n    }\n\n    var numDecimalDigits = num.toString().split('.')[1].length;\n\n    for (var i = 1; i <= numDecimalDigits; i++) {\n      var scale = Math.pow(10, i);\n      var temp = num * scale;\n\n      if (isWholeNumber(temp) || i === numDecimalDigits) {\n        return (temp + increment) / scale;\n      }\n    }\n  };\n\n  var ceilLeastSignificantDigit = roundSignificantDigit.bind(null, 1);\n  var floorLeastSignificantDigit = roundSignificantDigit.bind(null, -1);\n\n  /**\n   * Determine the index and estimated starting time of the segment that\n   * contains a specified playback position in a media playlist.\n   *\n   * @param {Object} playlist the media playlist to query\n   * @param {Number} currentTime The number of seconds since the earliest\n   * possible position to determine the containing segment for\n   * @param {Number} startIndex\n   * @param {Number} startTime\n   * @return {Object}\n   */\n  var getMediaInfoForTime = function getMediaInfoForTime(playlist, currentTime, startIndex, startTime) {\n    var i = void 0;\n    var segment = void 0;\n    var numSegments = playlist.segments.length;\n\n    var time = currentTime - startTime;\n\n    if (time < 0) {\n      // Walk backward from startIndex in the playlist, adding durations\n      // until we find a segment that contains `time` and return it\n      if (startIndex > 0) {\n        for (i = startIndex - 1; i >= 0; i--) {\n          segment = playlist.segments[i];\n          time += floorLeastSignificantDigit(segment.duration);\n          if (time > 0) {\n            return {\n              mediaIndex: i,\n              startTime: startTime - sumDurations(playlist, startIndex, i)\n            };\n          }\n        }\n      }\n      // We were unable to find a good segment within the playlist\n      // so select the first segment\n      return {\n        mediaIndex: 0,\n        startTime: currentTime\n      };\n    }\n\n    // When startIndex is negative, we first walk forward to first segment\n    // adding target durations. If we \"run out of time\" before getting to\n    // the first segment, return the first segment\n    if (startIndex < 0) {\n      for (i = startIndex; i < 0; i++) {\n        time -= playlist.targetDuration;\n        if (time < 0) {\n          return {\n            mediaIndex: 0,\n            startTime: currentTime\n          };\n        }\n      }\n      startIndex = 0;\n    }\n\n    // Walk forward from startIndex in the playlist, subtracting durations\n    // until we find a segment that contains `time` and return it\n    for (i = startIndex; i < numSegments; i++) {\n      segment = playlist.segments[i];\n      time -= ceilLeastSignificantDigit(segment.duration);\n      if (time < 0) {\n        return {\n          mediaIndex: i,\n          startTime: startTime + sumDurations(playlist, startIndex, i)\n        };\n      }\n    }\n\n    // We are out of possible candidates so load the last one...\n    return {\n      mediaIndex: numSegments - 1,\n      startTime: currentTime\n    };\n  };\n\n  /**\n   * Check whether the playlist is blacklisted or not.\n   *\n   * @param {Object} playlist the media playlist object\n   * @return {boolean} whether the playlist is blacklisted or not\n   * @function isBlacklisted\n   */\n  var isBlacklisted = function isBlacklisted(playlist) {\n    return playlist.excludeUntil && playlist.excludeUntil > Date.now();\n  };\n\n  /**\n   * Check whether the playlist is compatible with current playback configuration or has\n   * been blacklisted permanently for being incompatible.\n   *\n   * @param {Object} playlist the media playlist object\n   * @return {boolean} whether the playlist is incompatible or not\n   * @function isIncompatible\n   */\n  var isIncompatible = function isIncompatible(playlist) {\n    return playlist.excludeUntil && playlist.excludeUntil === Infinity;\n  };\n\n  /**\n   * Check whether the playlist is enabled or not.\n   *\n   * @param {Object} playlist the media playlist object\n   * @return {boolean} whether the playlist is enabled or not\n   * @function isEnabled\n   */\n  var isEnabled = function isEnabled(playlist) {\n    var blacklisted = isBlacklisted(playlist);\n\n    return !playlist.disabled && !blacklisted;\n  };\n\n  /**\n   * Check whether the playlist has been manually disabled through the representations api.\n   *\n   * @param {Object} playlist the media playlist object\n   * @return {boolean} whether the playlist is disabled manually or not\n   * @function isDisabled\n   */\n  var isDisabled = function isDisabled(playlist) {\n    return playlist.disabled;\n  };\n\n  /**\n   * Returns whether the current playlist is an AES encrypted HLS stream\n   *\n   * @return {Boolean} true if it's an AES encrypted HLS stream\n   */\n  var isAes = function isAes(media) {\n    for (var i = 0; i < media.segments.length; i++) {\n      if (media.segments[i].key) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n   * Returns whether the current playlist contains fMP4\n   *\n   * @return {Boolean} true if the playlist contains fMP4\n   */\n  var isFmp4 = function isFmp4(media) {\n    for (var i = 0; i < media.segments.length; i++) {\n      if (media.segments[i].map) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  /**\n   * Checks if the playlist has a value for the specified attribute\n   *\n   * @param {String} attr\n   *        Attribute to check for\n   * @param {Object} playlist\n   *        The media playlist object\n   * @return {Boolean}\n   *         Whether the playlist contains a value for the attribute or not\n   * @function hasAttribute\n   */\n  var hasAttribute = function hasAttribute(attr, playlist) {\n    return playlist.attributes && playlist.attributes[attr];\n  };\n\n  /**\n   * Estimates the time required to complete a segment download from the specified playlist\n   *\n   * @param {Number} segmentDuration\n   *        Duration of requested segment\n   * @param {Number} bandwidth\n   *        Current measured bandwidth of the player\n   * @param {Object} playlist\n   *        The media playlist object\n   * @param {Number=} bytesReceived\n   *        Number of bytes already received for the request. Defaults to 0\n   * @return {Number|NaN}\n   *         The estimated time to request the segment. NaN if bandwidth information for\n   *         the given playlist is unavailable\n   * @function estimateSegmentRequestTime\n   */\n  var estimateSegmentRequestTime = function estimateSegmentRequestTime(segmentDuration, bandwidth, playlist) {\n    var bytesReceived = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\n    if (!hasAttribute('BANDWIDTH', playlist)) {\n      return NaN;\n    }\n\n    var size = segmentDuration * playlist.attributes.BANDWIDTH;\n\n    return (size - bytesReceived * 8) / bandwidth;\n  };\n\n  /*\n   * Returns whether the current playlist is the lowest rendition\n   *\n   * @return {Boolean} true if on lowest rendition\n   */\n  var isLowestEnabledRendition = function isLowestEnabledRendition(master, media) {\n    if (master.playlists.length === 1) {\n      return true;\n    }\n\n    var currentBandwidth = media.attributes.BANDWIDTH || Number.MAX_VALUE;\n\n    return master.playlists.filter(function (playlist) {\n      if (!isEnabled(playlist)) {\n        return false;\n      }\n\n      return (playlist.attributes.BANDWIDTH || 0) < currentBandwidth;\n    }).length === 0;\n  };\n\n  // exports\n  var Playlist = {\n    duration: duration,\n    seekable: seekable,\n    safeLiveIndex: safeLiveIndex,\n    getMediaInfoForTime: getMediaInfoForTime,\n    isEnabled: isEnabled,\n    isDisabled: isDisabled,\n    isBlacklisted: isBlacklisted,\n    isIncompatible: isIncompatible,\n    playlistEnd: playlistEnd,\n    isAes: isAes,\n    isFmp4: isFmp4,\n    hasAttribute: hasAttribute,\n    estimateSegmentRequestTime: estimateSegmentRequestTime,\n    isLowestEnabledRendition: isLowestEnabledRendition\n  };\n\n  /**\n   * @file xhr.js\n   */\n\n  var videojsXHR = videojs$1.xhr,\n      mergeOptions$1$1 = videojs$1.mergeOptions;\n\n\n  var xhrFactory = function xhrFactory() {\n    var xhr = function XhrFunction(options, callback) {\n      // Add a default timeout for all hls requests\n      options = mergeOptions$1$1({\n        timeout: 45e3\n      }, options);\n\n      // Allow an optional user-specified function to modify the option\n      // object before we construct the xhr request\n      var beforeRequest = XhrFunction.beforeRequest || videojs$1.Hls.xhr.beforeRequest;\n\n      if (beforeRequest && typeof beforeRequest === 'function') {\n        var newOptions = beforeRequest(options);\n\n        if (newOptions) {\n          options = newOptions;\n        }\n      }\n\n      var request = videojsXHR(options, function (error, response) {\n        var reqResponse = request.response;\n\n        if (!error && reqResponse) {\n          request.responseTime = Date.now();\n          request.roundTripTime = request.responseTime - request.requestTime;\n          request.bytesReceived = reqResponse.byteLength || reqResponse.length;\n          if (!request.bandwidth) {\n            request.bandwidth = Math.floor(request.bytesReceived / request.roundTripTime * 8 * 1000);\n          }\n        }\n\n        if (response.headers) {\n          request.responseHeaders = response.headers;\n        }\n\n        // videojs.xhr now uses a specific code on the error\n        // object to signal that a request has timed out instead\n        // of setting a boolean on the request object\n        if (error && error.code === 'ETIMEDOUT') {\n          request.timedout = true;\n        }\n\n        // videojs.xhr no longer considers status codes outside of 200 and 0\n        // (for file uris) to be errors, but the old XHR did, so emulate that\n        // behavior. Status 206 may be used in response to byterange requests.\n        if (!error && !request.aborted && response.statusCode !== 200 && response.statusCode !== 206 && response.statusCode !== 0) {\n          error = new Error('XHR Failed with a response of: ' + (request && (reqResponse || request.responseText)));\n        }\n\n        callback(error, request);\n      });\n      var originalAbort = request.abort;\n\n      request.abort = function () {\n        request.aborted = true;\n        return originalAbort.apply(request, arguments);\n      };\n      request.uri = options.uri;\n      request.requestTime = Date.now();\n      return request;\n    };\n\n    return xhr;\n  };\n\n  /**\n   * @file bin-utils.js\n   */\n\n  /**\n   * convert a TimeRange to text\n   *\n   * @param {TimeRange} range the timerange to use for conversion\n   * @param {Number} i the iterator on the range to convert\n   */\n  var textRange = function textRange(range, i) {\n    return range.start(i) + '-' + range.end(i);\n  };\n\n  /**\n   * format a number as hex string\n   *\n   * @param {Number} e The number\n   * @param {Number} i the iterator\n   */\n  var formatHexString = function formatHexString(e, i) {\n    var value = e.toString(16);\n\n    return '00'.substring(0, 2 - value.length) + value + (i % 2 ? ' ' : '');\n  };\n  var formatAsciiString = function formatAsciiString(e) {\n    if (e >= 0x20 && e < 0x7e) {\n      return String.fromCharCode(e);\n    }\n    return '.';\n  };\n\n  /**\n   * Creates an object for sending to a web worker modifying properties that are TypedArrays\n   * into a new object with seperated properties for the buffer, byteOffset, and byteLength.\n   *\n   * @param {Object} message\n   *        Object of properties and values to send to the web worker\n   * @return {Object}\n   *         Modified message with TypedArray values expanded\n   * @function createTransferableMessage\n   */\n  var createTransferableMessage = function createTransferableMessage(message) {\n    var transferable = {};\n\n    Object.keys(message).forEach(function (key) {\n      var value = message[key];\n\n      if (ArrayBuffer.isView(value)) {\n        transferable[key] = {\n          bytes: value.buffer,\n          byteOffset: value.byteOffset,\n          byteLength: value.byteLength\n        };\n      } else {\n        transferable[key] = value;\n      }\n    });\n\n    return transferable;\n  };\n\n  /**\n   * Returns a unique string identifier for a media initialization\n   * segment.\n   */\n  var initSegmentId = function initSegmentId(initSegment) {\n    var byterange = initSegment.byterange || {\n      length: Infinity,\n      offset: 0\n    };\n\n    return [byterange.length, byterange.offset, initSegment.resolvedUri].join(',');\n  };\n\n  /**\n   * utils to help dump binary data to the console\n   */\n  var hexDump = function hexDump(data) {\n    var bytes = Array.prototype.slice.call(data);\n    var step = 16;\n    var result = '';\n    var hex = void 0;\n    var ascii = void 0;\n\n    for (var j = 0; j < bytes.length / step; j++) {\n      hex = bytes.slice(j * step, j * step + step).map(formatHexString).join('');\n      ascii = bytes.slice(j * step, j * step + step).map(formatAsciiString).join('');\n      result += hex + ' ' + ascii + '\\n';\n    }\n\n    return result;\n  };\n\n  var tagDump = function tagDump(_ref2) {\n    var bytes = _ref2.bytes;\n    return hexDump(bytes);\n  };\n\n  var textRanges = function textRanges(ranges) {\n    var result = '';\n    var i = void 0;\n\n    for (i = 0; i < ranges.length; i++) {\n      result += textRange(ranges, i) + ' ';\n    }\n    return result;\n  };\n\n  var utils = /*#__PURE__*/Object.freeze({\n    createTransferableMessage: createTransferableMessage,\n    initSegmentId: initSegmentId,\n    hexDump: hexDump,\n    tagDump: tagDump,\n    textRanges: textRanges\n  });\n\n  /**\n   * ranges\n   *\n   * Utilities for working with TimeRanges.\n   *\n   */\n\n  // Fudge factor to account for TimeRanges rounding\n  var TIME_FUDGE_FACTOR = 1 / 30;\n  // Comparisons between time values such as current time and the end of the buffered range\n  // can be misleading because of precision differences or when the current media has poorly\n  // aligned audio and video, which can cause values to be slightly off from what you would\n  // expect. This value is what we consider to be safe to use in such comparisons to account\n  // for these scenarios.\n  var SAFE_TIME_DELTA = TIME_FUDGE_FACTOR * 3;\n  var filterRanges = function filterRanges(timeRanges, predicate) {\n    var results = [];\n    var i = void 0;\n\n    if (timeRanges && timeRanges.length) {\n      // Search for ranges that match the predicate\n      for (i = 0; i < timeRanges.length; i++) {\n        if (predicate(timeRanges.start(i), timeRanges.end(i))) {\n          results.push([timeRanges.start(i), timeRanges.end(i)]);\n        }\n      }\n    }\n\n    return videojs$1.createTimeRanges(results);\n  };\n\n  /**\n   * Attempts to find the buffered TimeRange that contains the specified\n   * time.\n   * @param {TimeRanges} buffered - the TimeRanges object to query\n   * @param {number} time  - the time to filter on.\n   * @returns {TimeRanges} a new TimeRanges object\n   */\n  var findRange = function findRange(buffered, time) {\n    return filterRanges(buffered, function (start, end) {\n      return start - TIME_FUDGE_FACTOR <= time && end + TIME_FUDGE_FACTOR >= time;\n    });\n  };\n\n  /**\n   * Returns the TimeRanges that begin later than the specified time.\n   * @param {TimeRanges} timeRanges - the TimeRanges object to query\n   * @param {number} time - the time to filter on.\n   * @returns {TimeRanges} a new TimeRanges object.\n   */\n  var findNextRange = function findNextRange(timeRanges, time) {\n    return filterRanges(timeRanges, function (start) {\n      return start - TIME_FUDGE_FACTOR >= time;\n    });\n  };\n\n  /**\n   * Returns gaps within a list of TimeRanges\n   * @param {TimeRanges} buffered - the TimeRanges object\n   * @return {TimeRanges} a TimeRanges object of gaps\n   */\n  var findGaps = function findGaps(buffered) {\n    if (buffered.length < 2) {\n      return videojs$1.createTimeRanges();\n    }\n\n    var ranges = [];\n\n    for (var i = 1; i < buffered.length; i++) {\n      var start = buffered.end(i - 1);\n      var end = buffered.start(i);\n\n      ranges.push([start, end]);\n    }\n\n    return videojs$1.createTimeRanges(ranges);\n  };\n\n  /**\n   * Gets a human readable string for a TimeRange\n   *\n   * @param {TimeRange} range\n   * @returns {String} a human readable string\n   */\n  var printableRange = function printableRange(range) {\n    var strArr = [];\n\n    if (!range || !range.length) {\n      return '';\n    }\n\n    for (var i = 0; i < range.length; i++) {\n      strArr.push(range.start(i) + ' => ' + range.end(i));\n    }\n\n    return strArr.join(', ');\n  };\n\n  /**\n   * Calculates the amount of time left in seconds until the player hits the end of the\n   * buffer and causes a rebuffer\n   *\n   * @param {TimeRange} buffered\n   *        The state of the buffer\n   * @param {Numnber} currentTime\n   *        The current time of the player\n   * @param {Number} playbackRate\n   *        The current playback rate of the player. Defaults to 1.\n   * @return {Number}\n   *         Time until the player has to start rebuffering in seconds.\n   * @function timeUntilRebuffer\n   */\n  var timeUntilRebuffer = function timeUntilRebuffer(buffered, currentTime) {\n    var playbackRate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n    var bufferedEnd = buffered.length ? buffered.end(buffered.length - 1) : 0;\n\n    return (bufferedEnd - currentTime) / playbackRate;\n  };\n\n  /**\n   * Converts a TimeRanges object into an array representation\n   * @param {TimeRanges} timeRanges\n   * @returns {Array}\n   */\n  var timeRangesToArray = function timeRangesToArray(timeRanges) {\n    var timeRangesList = [];\n\n    for (var i = 0; i < timeRanges.length; i++) {\n      timeRangesList.push({\n        start: timeRanges.start(i),\n        end: timeRanges.end(i)\n      });\n    }\n\n    return timeRangesList;\n  };\n\n  /**\n   * @file create-text-tracks-if-necessary.js\n   */\n\n  /**\n   * Create text tracks on video.js if they exist on a segment.\n   *\n   * @param {Object} sourceBuffer the VSB or FSB\n   * @param {Object} mediaSource the HTML media source\n   * @param {Object} segment the segment that may contain the text track\n   * @private\n   */\n  var createTextTracksIfNecessary = function createTextTracksIfNecessary(sourceBuffer, mediaSource, segment) {\n    var player = mediaSource.player_;\n\n    // create an in-band caption track if one is present in the segment\n    if (segment.captions && segment.captions.length) {\n      if (!sourceBuffer.inbandTextTracks_) {\n        sourceBuffer.inbandTextTracks_ = {};\n      }\n\n      for (var trackId in segment.captionStreams) {\n        if (!sourceBuffer.inbandTextTracks_[trackId]) {\n          player.tech_.trigger({ type: 'usage', name: 'hls-608' });\n          var track = player.textTracks().getTrackById(trackId);\n\n          if (track) {\n            // Resuse an existing track with a CC# id because this was\n            // very likely created by videojs-contrib-hls from information\n            // in the m3u8 for us to use\n            sourceBuffer.inbandTextTracks_[trackId] = track;\n          } else {\n            // Otherwise, create a track with the default `CC#` label and\n            // without a language\n            sourceBuffer.inbandTextTracks_[trackId] = player.addRemoteTextTrack({\n              kind: 'captions',\n              id: trackId,\n              label: trackId\n            }, false).track;\n          }\n        }\n      }\n    }\n\n    if (segment.metadata && segment.metadata.length && !sourceBuffer.metadataTrack_) {\n      sourceBuffer.metadataTrack_ = player.addRemoteTextTrack({\n        kind: 'metadata',\n        label: 'Timed Metadata'\n      }, false).track;\n      sourceBuffer.metadataTrack_.inBandMetadataTrackDispatchType = segment.metadata.dispatchType;\n    }\n  };\n\n  /**\n   * @file remove-cues-from-track.js\n   */\n\n  /**\n   * Remove cues from a track on video.js.\n   *\n   * @param {Double} start start of where we should remove the cue\n   * @param {Double} end end of where the we should remove the cue\n   * @param {Object} track the text track to remove the cues from\n   * @private\n   */\n  var removeCuesFromTrack = function removeCuesFromTrack(start, end, track) {\n    var i = void 0;\n    var cue = void 0;\n\n    if (!track) {\n      return;\n    }\n\n    if (!track.cues) {\n      return;\n    }\n\n    i = track.cues.length;\n\n    while (i--) {\n      cue = track.cues[i];\n\n      // Remove any overlapping cue\n      if (cue.startTime <= end && cue.endTime >= start) {\n        track.removeCue(cue);\n      }\n    }\n  };\n\n  /**\n   * @file add-text-track-data.js\n   */\n  /**\n   * Define properties on a cue for backwards compatability,\n   * but warn the user that the way that they are using it\n   * is depricated and will be removed at a later date.\n   *\n   * @param {Cue} cue the cue to add the properties on\n   * @private\n   */\n  var deprecateOldCue = function deprecateOldCue(cue) {\n    Object.defineProperties(cue.frame, {\n      id: {\n        get: function get$$1() {\n          videojs$1.log.warn('cue.frame.id is deprecated. Use cue.value.key instead.');\n          return cue.value.key;\n        }\n      },\n      value: {\n        get: function get$$1() {\n          videojs$1.log.warn('cue.frame.value is deprecated. Use cue.value.data instead.');\n          return cue.value.data;\n        }\n      },\n      privateData: {\n        get: function get$$1() {\n          videojs$1.log.warn('cue.frame.privateData is deprecated. Use cue.value.data instead.');\n          return cue.value.data;\n        }\n      }\n    });\n  };\n\n  var durationOfVideo = function durationOfVideo(duration) {\n    var dur = void 0;\n\n    if (isNaN(duration) || Math.abs(duration) === Infinity) {\n      dur = Number.MAX_VALUE;\n    } else {\n      dur = duration;\n    }\n    return dur;\n  };\n  /**\n   * Add text track data to a source handler given the captions and\n   * metadata from the buffer.\n   *\n   * @param {Object} sourceHandler the virtual source buffer\n   * @param {Array} captionArray an array of caption data\n   * @param {Array} metadataArray an array of meta data\n   * @private\n   */\n  var addTextTrackData = function addTextTrackData(sourceHandler, captionArray, metadataArray) {\n    var Cue = window_1.WebKitDataCue || window_1.VTTCue;\n\n    if (captionArray) {\n      captionArray.forEach(function (caption) {\n        var track = caption.stream;\n\n        this.inbandTextTracks_[track].addCue(new Cue(caption.startTime + this.timestampOffset, caption.endTime + this.timestampOffset, caption.text));\n      }, sourceHandler);\n    }\n\n    if (metadataArray) {\n      var videoDuration = durationOfVideo(sourceHandler.mediaSource_.duration);\n\n      metadataArray.forEach(function (metadata) {\n        var time = metadata.cueTime + this.timestampOffset;\n\n        metadata.frames.forEach(function (frame) {\n          var cue = new Cue(time, time, frame.value || frame.url || frame.data || '');\n\n          cue.frame = frame;\n          cue.value = frame;\n          deprecateOldCue(cue);\n\n          this.metadataTrack_.addCue(cue);\n        }, this);\n      }, sourceHandler);\n\n      // Updating the metadeta cues so that\n      // the endTime of each cue is the startTime of the next cue\n      // the endTime of last cue is the duration of the video\n      if (sourceHandler.metadataTrack_ && sourceHandler.metadataTrack_.cues && sourceHandler.metadataTrack_.cues.length) {\n        var cues = sourceHandler.metadataTrack_.cues;\n        var cuesArray = [];\n\n        // Create a copy of the TextTrackCueList...\n        // ...disregarding cues with a falsey value\n        for (var i = 0; i < cues.length; i++) {\n          if (cues[i]) {\n            cuesArray.push(cues[i]);\n          }\n        }\n\n        // Group cues by their startTime value\n        var cuesGroupedByStartTime = cuesArray.reduce(function (obj, cue) {\n          var timeSlot = obj[cue.startTime] || [];\n\n          timeSlot.push(cue);\n          obj[cue.startTime] = timeSlot;\n\n          return obj;\n        }, {});\n\n        // Sort startTimes by ascending order\n        var sortedStartTimes = Object.keys(cuesGroupedByStartTime).sort(function (a, b) {\n          return Number(a) - Number(b);\n        });\n\n        // Map each cue group's endTime to the next group's startTime\n        sortedStartTimes.forEach(function (startTime, idx) {\n          var cueGroup = cuesGroupedByStartTime[startTime];\n          var nextTime = Number(sortedStartTimes[idx + 1]) || videoDuration;\n\n          // Map each cue's endTime the next group's startTime\n          cueGroup.forEach(function (cue) {\n            cue.endTime = nextTime;\n          });\n        });\n      }\n    }\n  };\n\n  var win$1 = typeof window !== 'undefined' ? window : {},\n      TARGET = typeof Symbol === 'undefined' ? '__target' : Symbol(),\n      SCRIPT_TYPE = 'application/javascript',\n      BlobBuilder = win$1.BlobBuilder || win$1.WebKitBlobBuilder || win$1.MozBlobBuilder || win$1.MSBlobBuilder,\n      URL = win$1.URL || win$1.webkitURL || URL && URL.msURL,\n      Worker = win$1.Worker;\n\n  /**\n   * Returns a wrapper around Web Worker code that is constructible.\n   *\n   * @function shimWorker\n   *\n   * @param { String }    filename    The name of the file\n   * @param { Function }  fn          Function wrapping the code of the worker\n   */\n  function shimWorker(filename, fn) {\n    return function ShimWorker(forceFallback) {\n      var o = this;\n\n      if (!fn) {\n        return new Worker(filename);\n      } else if (Worker && !forceFallback) {\n        // Convert the function's inner code to a string to construct the worker\n        var source = fn.toString().replace(/^function.+?{/, '').slice(0, -1),\n            objURL = createSourceObject(source);\n\n        this[TARGET] = new Worker(objURL);\n        wrapTerminate(this[TARGET], objURL);\n        return this[TARGET];\n      } else {\n        var selfShim = {\n          postMessage: function postMessage(m) {\n            if (o.onmessage) {\n              setTimeout(function () {\n                o.onmessage({ data: m, target: selfShim });\n              });\n            }\n          }\n        };\n\n        fn.call(selfShim);\n        this.postMessage = function (m) {\n          setTimeout(function () {\n            selfShim.onmessage({ data: m, target: o });\n          });\n        };\n        this.isThisThread = true;\n      }\n    };\n  }\n  // Test Worker capabilities\n  if (Worker) {\n    var testWorker,\n        objURL = createSourceObject('self.onmessage = function () {}'),\n        testArray = new Uint8Array(1);\n\n    try {\n      testWorker = new Worker(objURL);\n\n      // Native browser on some Samsung devices throws for transferables, let's detect it\n      testWorker.postMessage(testArray, [testArray.buffer]);\n    } catch (e) {\n      Worker = null;\n    } finally {\n      URL.revokeObjectURL(objURL);\n      if (testWorker) {\n        testWorker.terminate();\n      }\n    }\n  }\n\n  function createSourceObject(str) {\n    try {\n      return URL.createObjectURL(new Blob([str], { type: SCRIPT_TYPE }));\n    } catch (e) {\n      var blob = new BlobBuilder();\n      blob.append(str);\n      return URL.createObjectURL(blob.getBlob(type));\n    }\n  }\n\n  function wrapTerminate(worker, objURL) {\n    if (!worker || !objURL) return;\n    var term = worker.terminate;\n    worker.objURL = objURL;\n    worker.terminate = function () {\n      if (worker.objURL) URL.revokeObjectURL(worker.objURL);\n      term.call(worker);\n    };\n  }\n\n  var TransmuxWorker = new shimWorker(\"./transmuxer-worker.worker.js\", function (window, document$$1) {\n    var self = this;\n    var transmuxerWorker = function () {\n\n      var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n      var win;\n\n      if (typeof window !== \"undefined\") {\n        win = window;\n      } else if (typeof commonjsGlobal !== \"undefined\") {\n        win = commonjsGlobal;\n      } else if (typeof self !== \"undefined\") {\n        win = self;\n      } else {\n        win = {};\n      }\n\n      var window_1$$1 = win;\n\n      /**\n       * mux.js\n       *\n       * Copyright (c) 2015 Brightcove\n       * All rights reserved.\n       *\n       * Functions that generate fragmented MP4s suitable for use with Media\n       * Source Extensions.\n       */\n\n      var UINT32_MAX = Math.pow(2, 32) - 1;\n\n      var box, dinf, esds, ftyp, mdat, mfhd, minf, moof, moov, mvex, mvhd, trak, tkhd, mdia, mdhd, hdlr, sdtp, stbl, stsd, traf, trex, trun, types, MAJOR_BRAND, MINOR_VERSION, AVC1_BRAND, VIDEO_HDLR, AUDIO_HDLR, HDLR_TYPES, VMHD, SMHD, DREF, STCO, STSC, STSZ, STTS;\n\n      // pre-calculate constants\n      (function () {\n        var i;\n        types = {\n          avc1: [], // codingname\n          avcC: [],\n          btrt: [],\n          dinf: [],\n          dref: [],\n          esds: [],\n          ftyp: [],\n          hdlr: [],\n          mdat: [],\n          mdhd: [],\n          mdia: [],\n          mfhd: [],\n          minf: [],\n          moof: [],\n          moov: [],\n          mp4a: [], // codingname\n          mvex: [],\n          mvhd: [],\n          sdtp: [],\n          smhd: [],\n          stbl: [],\n          stco: [],\n          stsc: [],\n          stsd: [],\n          stsz: [],\n          stts: [],\n          styp: [],\n          tfdt: [],\n          tfhd: [],\n          traf: [],\n          trak: [],\n          trun: [],\n          trex: [],\n          tkhd: [],\n          vmhd: []\n        };\n\n        // In environments where Uint8Array is undefined (e.g., IE8), skip set up so that we\n        // don't throw an error\n        if (typeof Uint8Array === 'undefined') {\n          return;\n        }\n\n        for (i in types) {\n          if (types.hasOwnProperty(i)) {\n            types[i] = [i.charCodeAt(0), i.charCodeAt(1), i.charCodeAt(2), i.charCodeAt(3)];\n          }\n        }\n\n        MAJOR_BRAND = new Uint8Array(['i'.charCodeAt(0), 's'.charCodeAt(0), 'o'.charCodeAt(0), 'm'.charCodeAt(0)]);\n        AVC1_BRAND = new Uint8Array(['a'.charCodeAt(0), 'v'.charCodeAt(0), 'c'.charCodeAt(0), '1'.charCodeAt(0)]);\n        MINOR_VERSION = new Uint8Array([0, 0, 0, 1]);\n        VIDEO_HDLR = new Uint8Array([0x00, // version 0\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x00, // pre_defined\n        0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x56, 0x69, 0x64, 0x65, 0x6f, 0x48, 0x61, 0x6e, 0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'VideoHandler'\n        ]);\n        AUDIO_HDLR = new Uint8Array([0x00, // version 0\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x00, // pre_defined\n        0x73, 0x6f, 0x75, 0x6e, // handler_type: 'soun'\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x53, 0x6f, 0x75, 0x6e, 0x64, 0x48, 0x61, 0x6e, 0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'SoundHandler'\n        ]);\n        HDLR_TYPES = {\n          video: VIDEO_HDLR,\n          audio: AUDIO_HDLR\n        };\n        DREF = new Uint8Array([0x00, // version 0\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x01, // entry_count\n        0x00, 0x00, 0x00, 0x0c, // entry_size\n        0x75, 0x72, 0x6c, 0x20, // 'url' type\n        0x00, // version 0\n        0x00, 0x00, 0x01 // entry_flags\n        ]);\n        SMHD = new Uint8Array([0x00, // version\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, // balance, 0 means centered\n        0x00, 0x00 // reserved\n        ]);\n        STCO = new Uint8Array([0x00, // version\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x00 // entry_count\n        ]);\n        STSC = STCO;\n        STSZ = new Uint8Array([0x00, // version\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x00, // sample_size\n        0x00, 0x00, 0x00, 0x00 // sample_count\n        ]);\n        STTS = STCO;\n        VMHD = new Uint8Array([0x00, // version\n        0x00, 0x00, 0x01, // flags\n        0x00, 0x00, // graphicsmode\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00 // opcolor\n        ]);\n      })();\n\n      box = function box(type) {\n        var payload = [],\n            size = 0,\n            i,\n            result,\n            view;\n\n        for (i = 1; i < arguments.length; i++) {\n          payload.push(arguments[i]);\n        }\n\n        i = payload.length;\n\n        // calculate the total size we need to allocate\n        while (i--) {\n          size += payload[i].byteLength;\n        }\n        result = new Uint8Array(size + 8);\n        view = new DataView(result.buffer, result.byteOffset, result.byteLength);\n        view.setUint32(0, result.byteLength);\n        result.set(type, 4);\n\n        // copy the payload into the result\n        for (i = 0, size = 8; i < payload.length; i++) {\n          result.set(payload[i], size);\n          size += payload[i].byteLength;\n        }\n        return result;\n      };\n\n      dinf = function dinf() {\n        return box(types.dinf, box(types.dref, DREF));\n      };\n\n      esds = function esds(track) {\n        return box(types.esds, new Uint8Array([0x00, // version\n        0x00, 0x00, 0x00, // flags\n\n        // ES_Descriptor\n        0x03, // tag, ES_DescrTag\n        0x19, // length\n        0x00, 0x00, // ES_ID\n        0x00, // streamDependenceFlag, URL_flag, reserved, streamPriority\n\n        // DecoderConfigDescriptor\n        0x04, // tag, DecoderConfigDescrTag\n        0x11, // length\n        0x40, // object type\n        0x15, // streamType\n        0x00, 0x06, 0x00, // bufferSizeDB\n        0x00, 0x00, 0xda, 0xc0, // maxBitrate\n        0x00, 0x00, 0xda, 0xc0, // avgBitrate\n\n        // DecoderSpecificInfo\n        0x05, // tag, DecoderSpecificInfoTag\n        0x02, // length\n        // ISO/IEC 14496-3, AudioSpecificConfig\n        // for samplingFrequencyIndex see ISO/IEC 13818-7:2006, 8.1.3.2.2, Table 35\n        track.audioobjecttype << 3 | track.samplingfrequencyindex >>> 1, track.samplingfrequencyindex << 7 | track.channelcount << 3, 0x06, 0x01, 0x02 // GASpecificConfig\n        ]));\n      };\n\n      ftyp = function ftyp() {\n        return box(types.ftyp, MAJOR_BRAND, MINOR_VERSION, MAJOR_BRAND, AVC1_BRAND);\n      };\n\n      hdlr = function hdlr(type) {\n        return box(types.hdlr, HDLR_TYPES[type]);\n      };\n      mdat = function mdat(data) {\n        return box(types.mdat, data);\n      };\n      mdhd = function mdhd(track) {\n        var result = new Uint8Array([0x00, // version 0\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x02, // creation_time\n        0x00, 0x00, 0x00, 0x03, // modification_time\n        0x00, 0x01, 0x5f, 0x90, // timescale, 90,000 \"ticks\" per second\n\n        track.duration >>> 24 & 0xFF, track.duration >>> 16 & 0xFF, track.duration >>> 8 & 0xFF, track.duration & 0xFF, // duration\n        0x55, 0xc4, // 'und' language (undetermined)\n        0x00, 0x00]);\n\n        // Use the sample rate from the track metadata, when it is\n        // defined. The sample rate can be parsed out of an ADTS header, for\n        // instance.\n        if (track.samplerate) {\n          result[12] = track.samplerate >>> 24 & 0xFF;\n          result[13] = track.samplerate >>> 16 & 0xFF;\n          result[14] = track.samplerate >>> 8 & 0xFF;\n          result[15] = track.samplerate & 0xFF;\n        }\n\n        return box(types.mdhd, result);\n      };\n      mdia = function mdia(track) {\n        return box(types.mdia, mdhd(track), hdlr(track.type), minf(track));\n      };\n      mfhd = function mfhd(sequenceNumber) {\n        return box(types.mfhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // flags\n        (sequenceNumber & 0xFF000000) >> 24, (sequenceNumber & 0xFF0000) >> 16, (sequenceNumber & 0xFF00) >> 8, sequenceNumber & 0xFF // sequence_number\n        ]));\n      };\n      minf = function minf(track) {\n        return box(types.minf, track.type === 'video' ? box(types.vmhd, VMHD) : box(types.smhd, SMHD), dinf(), stbl(track));\n      };\n      moof = function moof(sequenceNumber, tracks) {\n        var trackFragments = [],\n            i = tracks.length;\n        // build traf boxes for each track fragment\n        while (i--) {\n          trackFragments[i] = traf(tracks[i]);\n        }\n        return box.apply(null, [types.moof, mfhd(sequenceNumber)].concat(trackFragments));\n      };\n      /**\n       * Returns a movie box.\n       * @param tracks {array} the tracks associated with this movie\n       * @see ISO/IEC 14496-12:2012(E), section 8.2.1\n       */\n      moov = function moov(tracks) {\n        var i = tracks.length,\n            boxes = [];\n\n        while (i--) {\n          boxes[i] = trak(tracks[i]);\n        }\n\n        return box.apply(null, [types.moov, mvhd(0xffffffff)].concat(boxes).concat(mvex(tracks)));\n      };\n      mvex = function mvex(tracks) {\n        var i = tracks.length,\n            boxes = [];\n\n        while (i--) {\n          boxes[i] = trex(tracks[i]);\n        }\n        return box.apply(null, [types.mvex].concat(boxes));\n      };\n      mvhd = function mvhd(duration) {\n        var bytes = new Uint8Array([0x00, // version 0\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x01, // creation_time\n        0x00, 0x00, 0x00, 0x02, // modification_time\n        0x00, 0x01, 0x5f, 0x90, // timescale, 90,000 \"ticks\" per second\n        (duration & 0xFF000000) >> 24, (duration & 0xFF0000) >> 16, (duration & 0xFF00) >> 8, duration & 0xFF, // duration\n        0x00, 0x01, 0x00, 0x00, // 1.0 rate\n        0x01, 0x00, // 1.0 volume\n        0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // pre_defined\n        0xff, 0xff, 0xff, 0xff // next_track_ID\n        ]);\n        return box(types.mvhd, bytes);\n      };\n\n      sdtp = function sdtp(track) {\n        var samples = track.samples || [],\n            bytes = new Uint8Array(4 + samples.length),\n            flags,\n            i;\n\n        // leave the full box header (4 bytes) all zero\n\n        // write the sample table\n        for (i = 0; i < samples.length; i++) {\n          flags = samples[i].flags;\n\n          bytes[i + 4] = flags.dependsOn << 4 | flags.isDependedOn << 2 | flags.hasRedundancy;\n        }\n\n        return box(types.sdtp, bytes);\n      };\n\n      stbl = function stbl(track) {\n        return box(types.stbl, stsd(track), box(types.stts, STTS), box(types.stsc, STSC), box(types.stsz, STSZ), box(types.stco, STCO));\n      };\n\n      (function () {\n        var videoSample, audioSample;\n\n        stsd = function stsd(track) {\n\n          return box(types.stsd, new Uint8Array([0x00, // version 0\n          0x00, 0x00, 0x00, // flags\n          0x00, 0x00, 0x00, 0x01]), track.type === 'video' ? videoSample(track) : audioSample(track));\n        };\n\n        videoSample = function videoSample(track) {\n          var sps = track.sps || [],\n              pps = track.pps || [],\n              sequenceParameterSets = [],\n              pictureParameterSets = [],\n              i;\n\n          // assemble the SPSs\n          for (i = 0; i < sps.length; i++) {\n            sequenceParameterSets.push((sps[i].byteLength & 0xFF00) >>> 8);\n            sequenceParameterSets.push(sps[i].byteLength & 0xFF); // sequenceParameterSetLength\n            sequenceParameterSets = sequenceParameterSets.concat(Array.prototype.slice.call(sps[i])); // SPS\n          }\n\n          // assemble the PPSs\n          for (i = 0; i < pps.length; i++) {\n            pictureParameterSets.push((pps[i].byteLength & 0xFF00) >>> 8);\n            pictureParameterSets.push(pps[i].byteLength & 0xFF);\n            pictureParameterSets = pictureParameterSets.concat(Array.prototype.slice.call(pps[i]));\n          }\n\n          return box(types.avc1, new Uint8Array([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // reserved\n          0x00, 0x01, // data_reference_index\n          0x00, 0x00, // pre_defined\n          0x00, 0x00, // reserved\n          0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // pre_defined\n          (track.width & 0xff00) >> 8, track.width & 0xff, // width\n          (track.height & 0xff00) >> 8, track.height & 0xff, // height\n          0x00, 0x48, 0x00, 0x00, // horizresolution\n          0x00, 0x48, 0x00, 0x00, // vertresolution\n          0x00, 0x00, 0x00, 0x00, // reserved\n          0x00, 0x01, // frame_count\n          0x13, 0x76, 0x69, 0x64, 0x65, 0x6f, 0x6a, 0x73, 0x2d, 0x63, 0x6f, 0x6e, 0x74, 0x72, 0x69, 0x62, 0x2d, 0x68, 0x6c, 0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // compressorname\n          0x00, 0x18, // depth = 24\n          0x11, 0x11 // pre_defined = -1\n          ]), box(types.avcC, new Uint8Array([0x01, // configurationVersion\n          track.profileIdc, // AVCProfileIndication\n          track.profileCompatibility, // profile_compatibility\n          track.levelIdc, // AVCLevelIndication\n          0xff // lengthSizeMinusOne, hard-coded to 4 bytes\n          ].concat([sps.length // numOfSequenceParameterSets\n          ]).concat(sequenceParameterSets).concat([pps.length // numOfPictureParameterSets\n          ]).concat(pictureParameterSets))), // \"PPS\"\n          box(types.btrt, new Uint8Array([0x00, 0x1c, 0x9c, 0x80, // bufferSizeDB\n          0x00, 0x2d, 0xc6, 0xc0, // maxBitrate\n          0x00, 0x2d, 0xc6, 0xc0])) // avgBitrate\n          );\n        };\n\n        audioSample = function audioSample(track) {\n          return box(types.mp4a, new Uint8Array([\n\n          // SampleEntry, ISO/IEC 14496-12\n          0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // reserved\n          0x00, 0x01, // data_reference_index\n\n          // AudioSampleEntry, ISO/IEC 14496-12\n          0x00, 0x00, 0x00, 0x00, // reserved\n          0x00, 0x00, 0x00, 0x00, // reserved\n          (track.channelcount & 0xff00) >> 8, track.channelcount & 0xff, // channelcount\n\n          (track.samplesize & 0xff00) >> 8, track.samplesize & 0xff, // samplesize\n          0x00, 0x00, // pre_defined\n          0x00, 0x00, // reserved\n\n          (track.samplerate & 0xff00) >> 8, track.samplerate & 0xff, 0x00, 0x00 // samplerate, 16.16\n\n          // MP4AudioSampleEntry, ISO/IEC 14496-14\n          ]), esds(track));\n        };\n      })();\n\n      tkhd = function tkhd(track) {\n        var result = new Uint8Array([0x00, // version 0\n        0x00, 0x00, 0x07, // flags\n        0x00, 0x00, 0x00, 0x00, // creation_time\n        0x00, 0x00, 0x00, 0x00, // modification_time\n        (track.id & 0xFF000000) >> 24, (track.id & 0xFF0000) >> 16, (track.id & 0xFF00) >> 8, track.id & 0xFF, // track_ID\n        0x00, 0x00, 0x00, 0x00, // reserved\n        (track.duration & 0xFF000000) >> 24, (track.duration & 0xFF0000) >> 16, (track.duration & 0xFF00) >> 8, track.duration & 0xFF, // duration\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, // layer\n        0x00, 0x00, // alternate_group\n        0x01, 0x00, // non-audio track volume\n        0x00, 0x00, // reserved\n        0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n        (track.width & 0xFF00) >> 8, track.width & 0xFF, 0x00, 0x00, // width\n        (track.height & 0xFF00) >> 8, track.height & 0xFF, 0x00, 0x00 // height\n        ]);\n\n        return box(types.tkhd, result);\n      };\n\n      /**\n       * Generate a track fragment (traf) box. A traf box collects metadata\n       * about tracks in a movie fragment (moof) box.\n       */\n      traf = function traf(track) {\n        var trackFragmentHeader, trackFragmentDecodeTime, trackFragmentRun, sampleDependencyTable, dataOffset, upperWordBaseMediaDecodeTime, lowerWordBaseMediaDecodeTime;\n\n        trackFragmentHeader = box(types.tfhd, new Uint8Array([0x00, // version 0\n        0x00, 0x00, 0x3a, // flags\n        (track.id & 0xFF000000) >> 24, (track.id & 0xFF0000) >> 16, (track.id & 0xFF00) >> 8, track.id & 0xFF, // track_ID\n        0x00, 0x00, 0x00, 0x01, // sample_description_index\n        0x00, 0x00, 0x00, 0x00, // default_sample_duration\n        0x00, 0x00, 0x00, 0x00, // default_sample_size\n        0x00, 0x00, 0x00, 0x00 // default_sample_flags\n        ]));\n\n        upperWordBaseMediaDecodeTime = Math.floor(track.baseMediaDecodeTime / (UINT32_MAX + 1));\n        lowerWordBaseMediaDecodeTime = Math.floor(track.baseMediaDecodeTime % (UINT32_MAX + 1));\n\n        trackFragmentDecodeTime = box(types.tfdt, new Uint8Array([0x01, // version 1\n        0x00, 0x00, 0x00, // flags\n        // baseMediaDecodeTime\n        upperWordBaseMediaDecodeTime >>> 24 & 0xFF, upperWordBaseMediaDecodeTime >>> 16 & 0xFF, upperWordBaseMediaDecodeTime >>> 8 & 0xFF, upperWordBaseMediaDecodeTime & 0xFF, lowerWordBaseMediaDecodeTime >>> 24 & 0xFF, lowerWordBaseMediaDecodeTime >>> 16 & 0xFF, lowerWordBaseMediaDecodeTime >>> 8 & 0xFF, lowerWordBaseMediaDecodeTime & 0xFF]));\n\n        // the data offset specifies the number of bytes from the start of\n        // the containing moof to the first payload byte of the associated\n        // mdat\n        dataOffset = 32 + // tfhd\n        20 + // tfdt\n        8 + // traf header\n        16 + // mfhd\n        8 + // moof header\n        8; // mdat header\n\n        // audio tracks require less metadata\n        if (track.type === 'audio') {\n          trackFragmentRun = trun(track, dataOffset);\n          return box(types.traf, trackFragmentHeader, trackFragmentDecodeTime, trackFragmentRun);\n        }\n\n        // video tracks should contain an independent and disposable samples\n        // box (sdtp)\n        // generate one and adjust offsets to match\n        sampleDependencyTable = sdtp(track);\n        trackFragmentRun = trun(track, sampleDependencyTable.length + dataOffset);\n        return box(types.traf, trackFragmentHeader, trackFragmentDecodeTime, trackFragmentRun, sampleDependencyTable);\n      };\n\n      /**\n       * Generate a track box.\n       * @param track {object} a track definition\n       * @return {Uint8Array} the track box\n       */\n      trak = function trak(track) {\n        track.duration = track.duration || 0xffffffff;\n        return box(types.trak, tkhd(track), mdia(track));\n      };\n\n      trex = function trex(track) {\n        var result = new Uint8Array([0x00, // version 0\n        0x00, 0x00, 0x00, // flags\n        (track.id & 0xFF000000) >> 24, (track.id & 0xFF0000) >> 16, (track.id & 0xFF00) >> 8, track.id & 0xFF, // track_ID\n        0x00, 0x00, 0x00, 0x01, // default_sample_description_index\n        0x00, 0x00, 0x00, 0x00, // default_sample_duration\n        0x00, 0x00, 0x00, 0x00, // default_sample_size\n        0x00, 0x01, 0x00, 0x01 // default_sample_flags\n        ]);\n        // the last two bytes of default_sample_flags is the sample\n        // degradation priority, a hint about the importance of this sample\n        // relative to others. Lower the degradation priority for all sample\n        // types other than video.\n        if (track.type !== 'video') {\n          result[result.length - 1] = 0x00;\n        }\n\n        return box(types.trex, result);\n      };\n\n      (function () {\n        var audioTrun, videoTrun, trunHeader;\n\n        // This method assumes all samples are uniform. That is, if a\n        // duration is present for the first sample, it will be present for\n        // all subsequent samples.\n        // see ISO/IEC 14496-12:2012, Section 8.8.8.1\n        trunHeader = function trunHeader(samples, offset) {\n          var durationPresent = 0,\n              sizePresent = 0,\n              flagsPresent = 0,\n              compositionTimeOffset = 0;\n\n          // trun flag constants\n          if (samples.length) {\n            if (samples[0].duration !== undefined) {\n              durationPresent = 0x1;\n            }\n            if (samples[0].size !== undefined) {\n              sizePresent = 0x2;\n            }\n            if (samples[0].flags !== undefined) {\n              flagsPresent = 0x4;\n            }\n            if (samples[0].compositionTimeOffset !== undefined) {\n              compositionTimeOffset = 0x8;\n            }\n          }\n\n          return [0x00, // version 0\n          0x00, durationPresent | sizePresent | flagsPresent | compositionTimeOffset, 0x01, // flags\n          (samples.length & 0xFF000000) >>> 24, (samples.length & 0xFF0000) >>> 16, (samples.length & 0xFF00) >>> 8, samples.length & 0xFF, // sample_count\n          (offset & 0xFF000000) >>> 24, (offset & 0xFF0000) >>> 16, (offset & 0xFF00) >>> 8, offset & 0xFF // data_offset\n          ];\n        };\n\n        videoTrun = function videoTrun(track, offset) {\n          var bytes, samples, sample, i;\n\n          samples = track.samples || [];\n          offset += 8 + 12 + 16 * samples.length;\n\n          bytes = trunHeader(samples, offset);\n\n          for (i = 0; i < samples.length; i++) {\n            sample = samples[i];\n            bytes = bytes.concat([(sample.duration & 0xFF000000) >>> 24, (sample.duration & 0xFF0000) >>> 16, (sample.duration & 0xFF00) >>> 8, sample.duration & 0xFF, // sample_duration\n            (sample.size & 0xFF000000) >>> 24, (sample.size & 0xFF0000) >>> 16, (sample.size & 0xFF00) >>> 8, sample.size & 0xFF, // sample_size\n            sample.flags.isLeading << 2 | sample.flags.dependsOn, sample.flags.isDependedOn << 6 | sample.flags.hasRedundancy << 4 | sample.flags.paddingValue << 1 | sample.flags.isNonSyncSample, sample.flags.degradationPriority & 0xF0 << 8, sample.flags.degradationPriority & 0x0F, // sample_flags\n            (sample.compositionTimeOffset & 0xFF000000) >>> 24, (sample.compositionTimeOffset & 0xFF0000) >>> 16, (sample.compositionTimeOffset & 0xFF00) >>> 8, sample.compositionTimeOffset & 0xFF // sample_composition_time_offset\n            ]);\n          }\n          return box(types.trun, new Uint8Array(bytes));\n        };\n\n        audioTrun = function audioTrun(track, offset) {\n          var bytes, samples, sample, i;\n\n          samples = track.samples || [];\n          offset += 8 + 12 + 8 * samples.length;\n\n          bytes = trunHeader(samples, offset);\n\n          for (i = 0; i < samples.length; i++) {\n            sample = samples[i];\n            bytes = bytes.concat([(sample.duration & 0xFF000000) >>> 24, (sample.duration & 0xFF0000) >>> 16, (sample.duration & 0xFF00) >>> 8, sample.duration & 0xFF, // sample_duration\n            (sample.size & 0xFF000000) >>> 24, (sample.size & 0xFF0000) >>> 16, (sample.size & 0xFF00) >>> 8, sample.size & 0xFF]); // sample_size\n          }\n\n          return box(types.trun, new Uint8Array(bytes));\n        };\n\n        trun = function trun(track, offset) {\n          if (track.type === 'audio') {\n            return audioTrun(track, offset);\n          }\n\n          return videoTrun(track, offset);\n        };\n      })();\n\n      var mp4Generator = {\n        ftyp: ftyp,\n        mdat: mdat,\n        moof: moof,\n        moov: moov,\n        initSegment: function initSegment(tracks) {\n          var fileType = ftyp(),\n              movie = moov(tracks),\n              result;\n\n          result = new Uint8Array(fileType.byteLength + movie.byteLength);\n          result.set(fileType);\n          result.set(movie, fileType.byteLength);\n          return result;\n        }\n      };\n\n      /**\n       * mux.js\n       *\n       * Copyright (c) 2014 Brightcove\n       * All rights reserved.\n       *\n       * A lightweight readable stream implemention that handles event dispatching.\n       * Objects that inherit from streams should call init in their constructors.\n       */\n\n      var Stream = function Stream() {\n        this.init = function () {\n          var listeners = {};\n          /**\n           * Add a listener for a specified event type.\n           * @param type {string} the event name\n           * @param listener {function} the callback to be invoked when an event of\n           * the specified type occurs\n           */\n          this.on = function (type, listener) {\n            if (!listeners[type]) {\n              listeners[type] = [];\n            }\n            listeners[type] = listeners[type].concat(listener);\n          };\n          /**\n           * Remove a listener for a specified event type.\n           * @param type {string} the event name\n           * @param listener {function} a function previously registered for this\n           * type of event through `on`\n           */\n          this.off = function (type, listener) {\n            var index;\n            if (!listeners[type]) {\n              return false;\n            }\n            index = listeners[type].indexOf(listener);\n            listeners[type] = listeners[type].slice();\n            listeners[type].splice(index, 1);\n            return index > -1;\n          };\n          /**\n           * Trigger an event of the specified type on this stream. Any additional\n           * arguments to this function are passed as parameters to event listeners.\n           * @param type {string} the event name\n           */\n          this.trigger = function (type) {\n            var callbacks, i, length, args;\n            callbacks = listeners[type];\n            if (!callbacks) {\n              return;\n            }\n            // Slicing the arguments on every invocation of this method\n            // can add a significant amount of overhead. Avoid the\n            // intermediate object creation for the common case of a\n            // single callback argument\n            if (arguments.length === 2) {\n              length = callbacks.length;\n              for (i = 0; i < length; ++i) {\n                callbacks[i].call(this, arguments[1]);\n              }\n            } else {\n              args = [];\n              i = arguments.length;\n              for (i = 1; i < arguments.length; ++i) {\n                args.push(arguments[i]);\n              }\n              length = callbacks.length;\n              for (i = 0; i < length; ++i) {\n                callbacks[i].apply(this, args);\n              }\n            }\n          };\n          /**\n           * Destroys the stream and cleans up.\n           */\n          this.dispose = function () {\n            listeners = {};\n          };\n        };\n      };\n\n      /**\n       * Forwards all `data` events on this stream to the destination stream. The\n       * destination stream should provide a method `push` to receive the data\n       * events as they arrive.\n       * @param destination {stream} the stream that will receive all `data` events\n       * @param autoFlush {boolean} if false, we will not call `flush` on the destination\n       *                            when the current stream emits a 'done' event\n       * @see http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options\n       */\n      Stream.prototype.pipe = function (destination) {\n        this.on('data', function (data) {\n          destination.push(data);\n        });\n\n        this.on('done', function (flushSource) {\n          destination.flush(flushSource);\n        });\n\n        return destination;\n      };\n\n      // Default stream functions that are expected to be overridden to perform\n      // actual work. These are provided by the prototype as a sort of no-op\n      // implementation so that we don't have to check for their existence in the\n      // `pipe` function above.\n      Stream.prototype.push = function (data) {\n        this.trigger('data', data);\n      };\n\n      Stream.prototype.flush = function (flushSource) {\n        this.trigger('done', flushSource);\n      };\n\n      var stream = Stream;\n\n      // -----------------\n      // Link To Transport\n      // -----------------\n\n      // Supplemental enhancement information (SEI) NAL units have a\n      // payload type field to indicate how they are to be\n      // interpreted. CEAS-708 caption content is always transmitted with\n      // payload type 0x04.\n      var USER_DATA_REGISTERED_ITU_T_T35 = 4,\n          RBSP_TRAILING_BITS = 128;\n\n      /**\n        * Parse a supplemental enhancement information (SEI) NAL unit.\n        * Stops parsing once a message of type ITU T T35 has been found.\n        *\n        * @param bytes {Uint8Array} the bytes of a SEI NAL unit\n        * @return {object} the parsed SEI payload\n        * @see Rec. ITU-T H.264, 7.3.2.3.1\n        */\n      var parseSei = function parseSei(bytes) {\n        var i = 0,\n            result = {\n          payloadType: -1,\n          payloadSize: 0\n        },\n            payloadType = 0,\n            payloadSize = 0;\n\n        // go through the sei_rbsp parsing each each individual sei_message\n        while (i < bytes.byteLength) {\n          // stop once we have hit the end of the sei_rbsp\n          if (bytes[i] === RBSP_TRAILING_BITS) {\n            break;\n          }\n\n          // Parse payload type\n          while (bytes[i] === 0xFF) {\n            payloadType += 255;\n            i++;\n          }\n          payloadType += bytes[i++];\n\n          // Parse payload size\n          while (bytes[i] === 0xFF) {\n            payloadSize += 255;\n            i++;\n          }\n          payloadSize += bytes[i++];\n\n          // this sei_message is a 608/708 caption so save it and break\n          // there can only ever be one caption message in a frame's sei\n          if (!result.payload && payloadType === USER_DATA_REGISTERED_ITU_T_T35) {\n            result.payloadType = payloadType;\n            result.payloadSize = payloadSize;\n            result.payload = bytes.subarray(i, i + payloadSize);\n            break;\n          }\n\n          // skip the payload and parse the next message\n          i += payloadSize;\n          payloadType = 0;\n          payloadSize = 0;\n        }\n\n        return result;\n      };\n\n      // see ANSI/SCTE 128-1 (2013), section 8.1\n      var parseUserData = function parseUserData(sei) {\n        // itu_t_t35_contry_code must be 181 (United States) for\n        // captions\n        if (sei.payload[0] !== 181) {\n          return null;\n        }\n\n        // itu_t_t35_provider_code should be 49 (ATSC) for captions\n        if ((sei.payload[1] << 8 | sei.payload[2]) !== 49) {\n          return null;\n        }\n\n        // the user_identifier should be \"GA94\" to indicate ATSC1 data\n        if (String.fromCharCode(sei.payload[3], sei.payload[4], sei.payload[5], sei.payload[6]) !== 'GA94') {\n          return null;\n        }\n\n        // finally, user_data_type_code should be 0x03 for caption data\n        if (sei.payload[7] !== 0x03) {\n          return null;\n        }\n\n        // return the user_data_type_structure and strip the trailing\n        // marker bits\n        return sei.payload.subarray(8, sei.payload.length - 1);\n      };\n\n      // see CEA-708-D, section 4.4\n      var parseCaptionPackets = function parseCaptionPackets(pts, userData) {\n        var results = [],\n            i,\n            count,\n            offset,\n            data;\n\n        // if this is just filler, return immediately\n        if (!(userData[0] & 0x40)) {\n          return results;\n        }\n\n        // parse out the cc_data_1 and cc_data_2 fields\n        count = userData[0] & 0x1f;\n        for (i = 0; i < count; i++) {\n          offset = i * 3;\n          data = {\n            type: userData[offset + 2] & 0x03,\n            pts: pts\n          };\n\n          // capture cc data when cc_valid is 1\n          if (userData[offset + 2] & 0x04) {\n            data.ccData = userData[offset + 3] << 8 | userData[offset + 4];\n            results.push(data);\n          }\n        }\n        return results;\n      };\n\n      var CaptionStream = function CaptionStream() {\n\n        CaptionStream.prototype.init.call(this);\n\n        this.captionPackets_ = [];\n\n        this.ccStreams_ = [new Cea608Stream(0, 0), // eslint-disable-line no-use-before-define\n        new Cea608Stream(0, 1), // eslint-disable-line no-use-before-define\n        new Cea608Stream(1, 0), // eslint-disable-line no-use-before-define\n        new Cea608Stream(1, 1) // eslint-disable-line no-use-before-define\n        ];\n\n        this.reset();\n\n        // forward data and done events from CCs to this CaptionStream\n        this.ccStreams_.forEach(function (cc) {\n          cc.on('data', this.trigger.bind(this, 'data'));\n          cc.on('done', this.trigger.bind(this, 'done'));\n        }, this);\n      };\n\n      CaptionStream.prototype = new stream();\n      CaptionStream.prototype.push = function (event) {\n        var sei, userData;\n\n        // only examine SEI NALs\n        if (event.nalUnitType !== 'sei_rbsp') {\n          return;\n        }\n\n        // parse the sei\n        sei = parseSei(event.escapedRBSP);\n\n        // ignore everything but user_data_registered_itu_t_t35\n        if (sei.payloadType !== USER_DATA_REGISTERED_ITU_T_T35) {\n          return;\n        }\n\n        // parse out the user data payload\n        userData = parseUserData(sei);\n\n        // ignore unrecognized userData\n        if (!userData) {\n          return;\n        }\n\n        // Sometimes, the same segment # will be downloaded twice. To stop the\n        // caption data from being processed twice, we track the latest dts we've\n        // received and ignore everything with a dts before that. However, since\n        // data for a specific dts can be split across packets on either side of\n        // a segment boundary, we need to make sure we *don't* ignore the packets\n        // from the *next* segment that have dts === this.latestDts_. By constantly\n        // tracking the number of packets received with dts === this.latestDts_, we\n        // know how many should be ignored once we start receiving duplicates.\n        if (event.dts < this.latestDts_) {\n          // We've started getting older data, so set the flag.\n          this.ignoreNextEqualDts_ = true;\n          return;\n        } else if (event.dts === this.latestDts_ && this.ignoreNextEqualDts_) {\n          this.numSameDts_--;\n          if (!this.numSameDts_) {\n            // We've received the last duplicate packet, time to start processing again\n            this.ignoreNextEqualDts_ = false;\n          }\n          return;\n        }\n\n        // parse out CC data packets and save them for later\n        this.captionPackets_ = this.captionPackets_.concat(parseCaptionPackets(event.pts, userData));\n        if (this.latestDts_ !== event.dts) {\n          this.numSameDts_ = 0;\n        }\n        this.numSameDts_++;\n        this.latestDts_ = event.dts;\n      };\n\n      CaptionStream.prototype.flush = function () {\n        // make sure we actually parsed captions before proceeding\n        if (!this.captionPackets_.length) {\n          this.ccStreams_.forEach(function (cc) {\n            cc.flush();\n          }, this);\n          return;\n        }\n\n        // In Chrome, the Array#sort function is not stable so add a\n        // presortIndex that we can use to ensure we get a stable-sort\n        this.captionPackets_.forEach(function (elem, idx) {\n          elem.presortIndex = idx;\n        });\n\n        // sort caption byte-pairs based on their PTS values\n        this.captionPackets_.sort(function (a, b) {\n          if (a.pts === b.pts) {\n            return a.presortIndex - b.presortIndex;\n          }\n          return a.pts - b.pts;\n        });\n\n        this.captionPackets_.forEach(function (packet) {\n          if (packet.type < 2) {\n            // Dispatch packet to the right Cea608Stream\n            this.dispatchCea608Packet(packet);\n          }\n          // this is where an 'else' would go for a dispatching packets\n          // to a theoretical Cea708Stream that handles SERVICEn data\n        }, this);\n\n        this.captionPackets_.length = 0;\n        this.ccStreams_.forEach(function (cc) {\n          cc.flush();\n        }, this);\n        return;\n      };\n\n      CaptionStream.prototype.reset = function () {\n        this.latestDts_ = null;\n        this.ignoreNextEqualDts_ = false;\n        this.numSameDts_ = 0;\n        this.activeCea608Channel_ = [null, null];\n        this.ccStreams_.forEach(function (ccStream) {\n          ccStream.reset();\n        });\n      };\n\n      CaptionStream.prototype.dispatchCea608Packet = function (packet) {\n        // NOTE: packet.type is the CEA608 field\n        if (this.setsChannel1Active(packet)) {\n          this.activeCea608Channel_[packet.type] = 0;\n        } else if (this.setsChannel2Active(packet)) {\n          this.activeCea608Channel_[packet.type] = 1;\n        }\n        if (this.activeCea608Channel_[packet.type] === null) {\n          // If we haven't received anything to set the active channel, discard the\n          // data; we don't want jumbled captions\n          return;\n        }\n        this.ccStreams_[(packet.type << 1) + this.activeCea608Channel_[packet.type]].push(packet);\n      };\n\n      CaptionStream.prototype.setsChannel1Active = function (packet) {\n        return (packet.ccData & 0x7800) === 0x1000;\n      };\n      CaptionStream.prototype.setsChannel2Active = function (packet) {\n        return (packet.ccData & 0x7800) === 0x1800;\n      };\n\n      // ----------------------\n      // Session to Application\n      // ----------------------\n\n      var CHARACTER_TRANSLATION = {\n        0x2a: 0xe1, // \n        0x5c: 0xe9, // \n        0x5e: 0xed, // \n        0x5f: 0xf3, // \n        0x60: 0xfa, // \n        0x7b: 0xe7, // \n        0x7c: 0xf7, // \n        0x7d: 0xd1, // \n        0x7e: 0xf1, // \n        0x7f: 0x2588, // \n        0x0130: 0xae, // \n        0x0131: 0xb0, // \n        0x0132: 0xbd, // \n        0x0133: 0xbf, // \n        0x0134: 0x2122, // \n        0x0135: 0xa2, // \n        0x0136: 0xa3, // \n        0x0137: 0x266a, // \n        0x0138: 0xe0, // \n        0x0139: 0xa0, //\n        0x013a: 0xe8, // \n        0x013b: 0xe2, // \n        0x013c: 0xea, // \n        0x013d: 0xee, // \n        0x013e: 0xf4, // \n        0x013f: 0xfb, // \n        0x0220: 0xc1, // \n        0x0221: 0xc9, // \n        0x0222: 0xd3, // \n        0x0223: 0xda, // \n        0x0224: 0xdc, // \n        0x0225: 0xfc, // \n        0x0226: 0x2018, // \n        0x0227: 0xa1, // \n        0x0228: 0x2a, // *\n        0x0229: 0x27, // '\n        0x022a: 0x2014, // \n        0x022b: 0xa9, // \n        0x022c: 0x2120, // \n        0x022d: 0x2022, // \n        0x022e: 0x201c, // \n        0x022f: 0x201d, // \n        0x0230: 0xc0, // \n        0x0231: 0xc2, // \n        0x0232: 0xc7, // \n        0x0233: 0xc8, // \n        0x0234: 0xca, // \n        0x0235: 0xcb, // \n        0x0236: 0xeb, // \n        0x0237: 0xce, // \n        0x0238: 0xcf, // \n        0x0239: 0xef, // \n        0x023a: 0xd4, // \n        0x023b: 0xd9, // \n        0x023c: 0xf9, // \n        0x023d: 0xdb, // \n        0x023e: 0xab, // \n        0x023f: 0xbb, // \n        0x0320: 0xc3, // \n        0x0321: 0xe3, // \n        0x0322: 0xcd, // \n        0x0323: 0xcc, // \n        0x0324: 0xec, // \n        0x0325: 0xd2, // \n        0x0326: 0xf2, // \n        0x0327: 0xd5, // \n        0x0328: 0xf5, // \n        0x0329: 0x7b, // {\n        0x032a: 0x7d, // }\n        0x032b: 0x5c, // \\\n        0x032c: 0x5e, // ^\n        0x032d: 0x5f, // _\n        0x032e: 0x7c, // |\n        0x032f: 0x7e, // ~\n        0x0330: 0xc4, // \n        0x0331: 0xe4, // \n        0x0332: 0xd6, // \n        0x0333: 0xf6, // \n        0x0334: 0xdf, // \n        0x0335: 0xa5, // \n        0x0336: 0xa4, // \n        0x0337: 0x2502, // \n        0x0338: 0xc5, // \n        0x0339: 0xe5, // \n        0x033a: 0xd8, // \n        0x033b: 0xf8, // \n        0x033c: 0x250c, // \n        0x033d: 0x2510, // \n        0x033e: 0x2514, // \n        0x033f: 0x2518 // \n      };\n\n      var getCharFromCode = function getCharFromCode(code) {\n        if (code === null) {\n          return '';\n        }\n        code = CHARACTER_TRANSLATION[code] || code;\n        return String.fromCharCode(code);\n      };\n\n      // the index of the last row in a CEA-608 display buffer\n      var BOTTOM_ROW = 14;\n\n      // This array is used for mapping PACs -> row #, since there's no way of\n      // getting it through bit logic.\n      var ROWS = [0x1100, 0x1120, 0x1200, 0x1220, 0x1500, 0x1520, 0x1600, 0x1620, 0x1700, 0x1720, 0x1000, 0x1300, 0x1320, 0x1400, 0x1420];\n\n      // CEA-608 captions are rendered onto a 34x15 matrix of character\n      // cells. The \"bottom\" row is the last element in the outer array.\n      var createDisplayBuffer = function createDisplayBuffer() {\n        var result = [],\n            i = BOTTOM_ROW + 1;\n        while (i--) {\n          result.push('');\n        }\n        return result;\n      };\n\n      var Cea608Stream = function Cea608Stream(field, dataChannel) {\n        Cea608Stream.prototype.init.call(this);\n\n        this.field_ = field || 0;\n        this.dataChannel_ = dataChannel || 0;\n\n        this.name_ = 'CC' + ((this.field_ << 1 | this.dataChannel_) + 1);\n\n        this.setConstants();\n        this.reset();\n\n        this.push = function (packet) {\n          var data, swap, char0, char1, text;\n          // remove the parity bits\n          data = packet.ccData & 0x7f7f;\n\n          // ignore duplicate control codes; the spec demands they're sent twice\n          if (data === this.lastControlCode_) {\n            this.lastControlCode_ = null;\n            return;\n          }\n\n          // Store control codes\n          if ((data & 0xf000) === 0x1000) {\n            this.lastControlCode_ = data;\n          } else if (data !== this.PADDING_) {\n            this.lastControlCode_ = null;\n          }\n\n          char0 = data >>> 8;\n          char1 = data & 0xff;\n\n          if (data === this.PADDING_) {\n            return;\n          } else if (data === this.RESUME_CAPTION_LOADING_) {\n            this.mode_ = 'popOn';\n          } else if (data === this.END_OF_CAPTION_) {\n            this.clearFormatting(packet.pts);\n            // if a caption was being displayed, it's gone now\n            this.flushDisplayed(packet.pts);\n\n            // flip memory\n            swap = this.displayed_;\n            this.displayed_ = this.nonDisplayed_;\n            this.nonDisplayed_ = swap;\n\n            // start measuring the time to display the caption\n            this.startPts_ = packet.pts;\n          } else if (data === this.ROLL_UP_2_ROWS_) {\n            this.topRow_ = BOTTOM_ROW - 1;\n            this.mode_ = 'rollUp';\n          } else if (data === this.ROLL_UP_3_ROWS_) {\n            this.topRow_ = BOTTOM_ROW - 2;\n            this.mode_ = 'rollUp';\n          } else if (data === this.ROLL_UP_4_ROWS_) {\n            this.topRow_ = BOTTOM_ROW - 3;\n            this.mode_ = 'rollUp';\n          } else if (data === this.CARRIAGE_RETURN_) {\n            this.clearFormatting(packet.pts);\n            this.flushDisplayed(packet.pts);\n            this.shiftRowsUp_();\n            this.startPts_ = packet.pts;\n          } else if (data === this.BACKSPACE_) {\n            if (this.mode_ === 'popOn') {\n              this.nonDisplayed_[BOTTOM_ROW] = this.nonDisplayed_[BOTTOM_ROW].slice(0, -1);\n            } else {\n              this.displayed_[BOTTOM_ROW] = this.displayed_[BOTTOM_ROW].slice(0, -1);\n            }\n          } else if (data === this.ERASE_DISPLAYED_MEMORY_) {\n            this.flushDisplayed(packet.pts);\n            this.displayed_ = createDisplayBuffer();\n          } else if (data === this.ERASE_NON_DISPLAYED_MEMORY_) {\n            this.nonDisplayed_ = createDisplayBuffer();\n          } else if (data === this.RESUME_DIRECT_CAPTIONING_) {\n            this.mode_ = 'paintOn';\n\n            // Append special characters to caption text\n          } else if (this.isSpecialCharacter(char0, char1)) {\n            // Bitmask char0 so that we can apply character transformations\n            // regardless of field and data channel.\n            // Then byte-shift to the left and OR with char1 so we can pass the\n            // entire character code to `getCharFromCode`.\n            char0 = (char0 & 0x03) << 8;\n            text = getCharFromCode(char0 | char1);\n            this[this.mode_](packet.pts, text);\n            this.column_++;\n\n            // Append extended characters to caption text\n          } else if (this.isExtCharacter(char0, char1)) {\n            // Extended characters always follow their \"non-extended\" equivalents.\n            // IE if a \"\" is desired, you'll always receive \"e\"; non-compliant\n            // decoders are supposed to drop the \"\", while compliant decoders\n            // backspace the \"e\" and insert \"\".\n\n            // Delete the previous character\n            if (this.mode_ === 'popOn') {\n              this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1);\n            } else {\n              this.displayed_[BOTTOM_ROW] = this.displayed_[BOTTOM_ROW].slice(0, -1);\n            }\n\n            // Bitmask char0 so that we can apply character transformations\n            // regardless of field and data channel.\n            // Then byte-shift to the left and OR with char1 so we can pass the\n            // entire character code to `getCharFromCode`.\n            char0 = (char0 & 0x03) << 8;\n            text = getCharFromCode(char0 | char1);\n            this[this.mode_](packet.pts, text);\n            this.column_++;\n\n            // Process mid-row codes\n          } else if (this.isMidRowCode(char0, char1)) {\n            // Attributes are not additive, so clear all formatting\n            this.clearFormatting(packet.pts);\n\n            // According to the standard, mid-row codes\n            // should be replaced with spaces, so add one now\n            this[this.mode_](packet.pts, ' ');\n            this.column_++;\n\n            if ((char1 & 0xe) === 0xe) {\n              this.addFormatting(packet.pts, ['i']);\n            }\n\n            if ((char1 & 0x1) === 0x1) {\n              this.addFormatting(packet.pts, ['u']);\n            }\n\n            // Detect offset control codes and adjust cursor\n          } else if (this.isOffsetControlCode(char0, char1)) {\n            // Cursor position is set by indent PAC (see below) in 4-column\n            // increments, with an additional offset code of 1-3 to reach any\n            // of the 32 columns specified by CEA-608. So all we need to do\n            // here is increment the column cursor by the given offset.\n            this.column_ += char1 & 0x03;\n\n            // Detect PACs (Preamble Address Codes)\n          } else if (this.isPAC(char0, char1)) {\n\n            // There's no logic for PAC -> row mapping, so we have to just\n            // find the row code in an array and use its index :(\n            var row = ROWS.indexOf(data & 0x1f20);\n\n            if (row !== this.row_) {\n              // formatting is only persistent for current row\n              this.clearFormatting(packet.pts);\n              this.row_ = row;\n            }\n            // All PACs can apply underline, so detect and apply\n            // (All odd-numbered second bytes set underline)\n            if (char1 & 0x1 && this.formatting_.indexOf('u') === -1) {\n              this.addFormatting(packet.pts, ['u']);\n            }\n\n            if ((data & 0x10) === 0x10) {\n              // We've got an indent level code. Each successive even number\n              // increments the column cursor by 4, so we can get the desired\n              // column position by bit-shifting to the right (to get n/2)\n              // and multiplying by 4.\n              this.column_ = ((data & 0xe) >> 1) * 4;\n            }\n\n            if (this.isColorPAC(char1)) {\n              // it's a color code, though we only support white, which\n              // can be either normal or italicized. white italics can be\n              // either 0x4e or 0x6e depending on the row, so we just\n              // bitwise-and with 0xe to see if italics should be turned on\n              if ((char1 & 0xe) === 0xe) {\n                this.addFormatting(packet.pts, ['i']);\n              }\n            }\n\n            // We have a normal character in char0, and possibly one in char1\n          } else if (this.isNormalChar(char0)) {\n            if (char1 === 0x00) {\n              char1 = null;\n            }\n            text = getCharFromCode(char0);\n            text += getCharFromCode(char1);\n            this[this.mode_](packet.pts, text);\n            this.column_ += text.length;\n          } // finish data processing\n        };\n      };\n      Cea608Stream.prototype = new stream();\n      // Trigger a cue point that captures the current state of the\n      // display buffer\n      Cea608Stream.prototype.flushDisplayed = function (pts) {\n        var content = this.displayed_\n        // remove spaces from the start and end of the string\n        .map(function (row) {\n          return row.trim();\n        })\n        // combine all text rows to display in one cue\n        .join('\\n')\n        // and remove blank rows from the start and end, but not the middle\n        .replace(/^\\n+|\\n+$/g, '');\n\n        if (content.length) {\n          this.trigger('data', {\n            startPts: this.startPts_,\n            endPts: pts,\n            text: content,\n            stream: this.name_\n          });\n        }\n      };\n\n      /**\n       * Zero out the data, used for startup and on seek\n       */\n      Cea608Stream.prototype.reset = function () {\n        this.mode_ = 'popOn';\n        // When in roll-up mode, the index of the last row that will\n        // actually display captions. If a caption is shifted to a row\n        // with a lower index than this, it is cleared from the display\n        // buffer\n        this.topRow_ = 0;\n        this.startPts_ = 0;\n        this.displayed_ = createDisplayBuffer();\n        this.nonDisplayed_ = createDisplayBuffer();\n        this.lastControlCode_ = null;\n\n        // Track row and column for proper line-breaking and spacing\n        this.column_ = 0;\n        this.row_ = BOTTOM_ROW;\n\n        // This variable holds currently-applied formatting\n        this.formatting_ = [];\n      };\n\n      /**\n       * Sets up control code and related constants for this instance\n       */\n      Cea608Stream.prototype.setConstants = function () {\n        // The following attributes have these uses:\n        // ext_ :    char0 for mid-row codes, and the base for extended\n        //           chars (ext_+0, ext_+1, and ext_+2 are char0s for\n        //           extended codes)\n        // control_: char0 for control codes, except byte-shifted to the\n        //           left so that we can do this.control_ | CONTROL_CODE\n        // offset_:  char0 for tab offset codes\n        //\n        // It's also worth noting that control codes, and _only_ control codes,\n        // differ between field 1 and field2. Field 2 control codes are always\n        // their field 1 value plus 1. That's why there's the \"| field\" on the\n        // control value.\n        if (this.dataChannel_ === 0) {\n          this.BASE_ = 0x10;\n          this.EXT_ = 0x11;\n          this.CONTROL_ = (0x14 | this.field_) << 8;\n          this.OFFSET_ = 0x17;\n        } else if (this.dataChannel_ === 1) {\n          this.BASE_ = 0x18;\n          this.EXT_ = 0x19;\n          this.CONTROL_ = (0x1c | this.field_) << 8;\n          this.OFFSET_ = 0x1f;\n        }\n\n        // Constants for the LSByte command codes recognized by Cea608Stream. This\n        // list is not exhaustive. For a more comprehensive listing and semantics see\n        // http://www.gpo.gov/fdsys/pkg/CFR-2010-title47-vol1/pdf/CFR-2010-title47-vol1-sec15-119.pdf\n        // Padding\n        this.PADDING_ = 0x0000;\n        // Pop-on Mode\n        this.RESUME_CAPTION_LOADING_ = this.CONTROL_ | 0x20;\n        this.END_OF_CAPTION_ = this.CONTROL_ | 0x2f;\n        // Roll-up Mode\n        this.ROLL_UP_2_ROWS_ = this.CONTROL_ | 0x25;\n        this.ROLL_UP_3_ROWS_ = this.CONTROL_ | 0x26;\n        this.ROLL_UP_4_ROWS_ = this.CONTROL_ | 0x27;\n        this.CARRIAGE_RETURN_ = this.CONTROL_ | 0x2d;\n        // paint-on mode (not supported)\n        this.RESUME_DIRECT_CAPTIONING_ = this.CONTROL_ | 0x29;\n        // Erasure\n        this.BACKSPACE_ = this.CONTROL_ | 0x21;\n        this.ERASE_DISPLAYED_MEMORY_ = this.CONTROL_ | 0x2c;\n        this.ERASE_NON_DISPLAYED_MEMORY_ = this.CONTROL_ | 0x2e;\n      };\n\n      /**\n       * Detects if the 2-byte packet data is a special character\n       *\n       * Special characters have a second byte in the range 0x30 to 0x3f,\n       * with the first byte being 0x11 (for data channel 1) or 0x19 (for\n       * data channel 2).\n       *\n       * @param  {Integer} char0 The first byte\n       * @param  {Integer} char1 The second byte\n       * @return {Boolean}       Whether the 2 bytes are an special character\n       */\n      Cea608Stream.prototype.isSpecialCharacter = function (char0, char1) {\n        return char0 === this.EXT_ && char1 >= 0x30 && char1 <= 0x3f;\n      };\n\n      /**\n       * Detects if the 2-byte packet data is an extended character\n       *\n       * Extended characters have a second byte in the range 0x20 to 0x3f,\n       * with the first byte being 0x12 or 0x13 (for data channel 1) or\n       * 0x1a or 0x1b (for data channel 2).\n       *\n       * @param  {Integer} char0 The first byte\n       * @param  {Integer} char1 The second byte\n       * @return {Boolean}       Whether the 2 bytes are an extended character\n       */\n      Cea608Stream.prototype.isExtCharacter = function (char0, char1) {\n        return (char0 === this.EXT_ + 1 || char0 === this.EXT_ + 2) && char1 >= 0x20 && char1 <= 0x3f;\n      };\n\n      /**\n       * Detects if the 2-byte packet is a mid-row code\n       *\n       * Mid-row codes have a second byte in the range 0x20 to 0x2f, with\n       * the first byte being 0x11 (for data channel 1) or 0x19 (for data\n       * channel 2).\n       *\n       * @param  {Integer} char0 The first byte\n       * @param  {Integer} char1 The second byte\n       * @return {Boolean}       Whether the 2 bytes are a mid-row code\n       */\n      Cea608Stream.prototype.isMidRowCode = function (char0, char1) {\n        return char0 === this.EXT_ && char1 >= 0x20 && char1 <= 0x2f;\n      };\n\n      /**\n       * Detects if the 2-byte packet is an offset control code\n       *\n       * Offset control codes have a second byte in the range 0x21 to 0x23,\n       * with the first byte being 0x17 (for data channel 1) or 0x1f (for\n       * data channel 2).\n       *\n       * @param  {Integer} char0 The first byte\n       * @param  {Integer} char1 The second byte\n       * @return {Boolean}       Whether the 2 bytes are an offset control code\n       */\n      Cea608Stream.prototype.isOffsetControlCode = function (char0, char1) {\n        return char0 === this.OFFSET_ && char1 >= 0x21 && char1 <= 0x23;\n      };\n\n      /**\n       * Detects if the 2-byte packet is a Preamble Address Code\n       *\n       * PACs have a first byte in the range 0x10 to 0x17 (for data channel 1)\n       * or 0x18 to 0x1f (for data channel 2), with the second byte in the\n       * range 0x40 to 0x7f.\n       *\n       * @param  {Integer} char0 The first byte\n       * @param  {Integer} char1 The second byte\n       * @return {Boolean}       Whether the 2 bytes are a PAC\n       */\n      Cea608Stream.prototype.isPAC = function (char0, char1) {\n        return char0 >= this.BASE_ && char0 < this.BASE_ + 8 && char1 >= 0x40 && char1 <= 0x7f;\n      };\n\n      /**\n       * Detects if a packet's second byte is in the range of a PAC color code\n       *\n       * PAC color codes have the second byte be in the range 0x40 to 0x4f, or\n       * 0x60 to 0x6f.\n       *\n       * @param  {Integer} char1 The second byte\n       * @return {Boolean}       Whether the byte is a color PAC\n       */\n      Cea608Stream.prototype.isColorPAC = function (char1) {\n        return char1 >= 0x40 && char1 <= 0x4f || char1 >= 0x60 && char1 <= 0x7f;\n      };\n\n      /**\n       * Detects if a single byte is in the range of a normal character\n       *\n       * Normal text bytes are in the range 0x20 to 0x7f.\n       *\n       * @param  {Integer} char  The byte\n       * @return {Boolean}       Whether the byte is a normal character\n       */\n      Cea608Stream.prototype.isNormalChar = function (char) {\n        return char >= 0x20 && char <= 0x7f;\n      };\n\n      // Adds the opening HTML tag for the passed character to the caption text,\n      // and keeps track of it for later closing\n      Cea608Stream.prototype.addFormatting = function (pts, format) {\n        this.formatting_ = this.formatting_.concat(format);\n        var text = format.reduce(function (text, format) {\n          return text + '<' + format + '>';\n        }, '');\n        this[this.mode_](pts, text);\n      };\n\n      // Adds HTML closing tags for current formatting to caption text and\n      // clears remembered formatting\n      Cea608Stream.prototype.clearFormatting = function (pts) {\n        if (!this.formatting_.length) {\n          return;\n        }\n        var text = this.formatting_.reverse().reduce(function (text, format) {\n          return text + '</' + format + '>';\n        }, '');\n        this.formatting_ = [];\n        this[this.mode_](pts, text);\n      };\n\n      // Mode Implementations\n      Cea608Stream.prototype.popOn = function (pts, text) {\n        var baseRow = this.nonDisplayed_[this.row_];\n\n        // buffer characters\n        baseRow += text;\n        this.nonDisplayed_[this.row_] = baseRow;\n      };\n\n      Cea608Stream.prototype.rollUp = function (pts, text) {\n        var baseRow = this.displayed_[BOTTOM_ROW];\n\n        baseRow += text;\n        this.displayed_[BOTTOM_ROW] = baseRow;\n      };\n\n      Cea608Stream.prototype.shiftRowsUp_ = function () {\n        var i;\n        // clear out inactive rows\n        for (i = 0; i < this.topRow_; i++) {\n          this.displayed_[i] = '';\n        }\n        // shift displayed rows up\n        for (i = this.topRow_; i < BOTTOM_ROW; i++) {\n          this.displayed_[i] = this.displayed_[i + 1];\n        }\n        // clear out the bottom row\n        this.displayed_[BOTTOM_ROW] = '';\n      };\n\n      // paintOn mode is not implemented\n      Cea608Stream.prototype.paintOn = function () {};\n\n      // exports\n      var captionStream = {\n        CaptionStream: CaptionStream,\n        Cea608Stream: Cea608Stream\n      };\n\n      var streamTypes = {\n        H264_STREAM_TYPE: 0x1B,\n        ADTS_STREAM_TYPE: 0x0F,\n        METADATA_STREAM_TYPE: 0x15\n      };\n\n      var MAX_TS = 8589934592;\n\n      var RO_THRESH = 4294967296;\n\n      var handleRollover = function handleRollover(value, reference) {\n        var direction = 1;\n\n        if (value > reference) {\n          // If the current timestamp value is greater than our reference timestamp and we detect a\n          // timestamp rollover, this means the roll over is happening in the opposite direction.\n          // Example scenario: Enter a long stream/video just after a rollover occurred. The reference\n          // point will be set to a small number, e.g. 1. The user then seeks backwards over the\n          // rollover point. In loading this segment, the timestamp values will be very large,\n          // e.g. 2^33 - 1. Since this comes before the data we loaded previously, we want to adjust\n          // the time stamp to be `value - 2^33`.\n          direction = -1;\n        }\n\n        // Note: A seek forwards or back that is greater than the RO_THRESH (2^32, ~13 hours) will\n        // cause an incorrect adjustment.\n        while (Math.abs(reference - value) > RO_THRESH) {\n          value += direction * MAX_TS;\n        }\n\n        return value;\n      };\n\n      var TimestampRolloverStream = function TimestampRolloverStream(type) {\n        var lastDTS, referenceDTS;\n\n        TimestampRolloverStream.prototype.init.call(this);\n\n        this.type_ = type;\n\n        this.push = function (data) {\n          if (data.type !== this.type_) {\n            return;\n          }\n\n          if (referenceDTS === undefined) {\n            referenceDTS = data.dts;\n          }\n\n          data.dts = handleRollover(data.dts, referenceDTS);\n          data.pts = handleRollover(data.pts, referenceDTS);\n\n          lastDTS = data.dts;\n\n          this.trigger('data', data);\n        };\n\n        this.flush = function () {\n          referenceDTS = lastDTS;\n          this.trigger('done');\n        };\n\n        this.discontinuity = function () {\n          referenceDTS = void 0;\n          lastDTS = void 0;\n        };\n      };\n\n      TimestampRolloverStream.prototype = new stream();\n\n      var timestampRolloverStream = {\n        TimestampRolloverStream: TimestampRolloverStream,\n        handleRollover: handleRollover\n      };\n\n      var percentEncode = function percentEncode(bytes, start, end) {\n        var i,\n            result = '';\n        for (i = start; i < end; i++) {\n          result += '%' + ('00' + bytes[i].toString(16)).slice(-2);\n        }\n        return result;\n      },\n\n\n      // return the string representation of the specified byte range,\n      // interpreted as UTf-8.\n      parseUtf8 = function parseUtf8(bytes, start, end) {\n        return decodeURIComponent(percentEncode(bytes, start, end));\n      },\n\n\n      // return the string representation of the specified byte range,\n      // interpreted as ISO-8859-1.\n      parseIso88591 = function parseIso88591(bytes, start, end) {\n        return unescape(percentEncode(bytes, start, end)); // jshint ignore:line\n      },\n          parseSyncSafeInteger = function parseSyncSafeInteger(data) {\n        return data[0] << 21 | data[1] << 14 | data[2] << 7 | data[3];\n      },\n          tagParsers = {\n        TXXX: function TXXX(tag) {\n          var i;\n          if (tag.data[0] !== 3) {\n            // ignore frames with unrecognized character encodings\n            return;\n          }\n\n          for (i = 1; i < tag.data.length; i++) {\n            if (tag.data[i] === 0) {\n              // parse the text fields\n              tag.description = parseUtf8(tag.data, 1, i);\n              // do not include the null terminator in the tag value\n              tag.value = parseUtf8(tag.data, i + 1, tag.data.length).replace(/\\0*$/, '');\n              break;\n            }\n          }\n          tag.data = tag.value;\n        },\n        WXXX: function WXXX(tag) {\n          var i;\n          if (tag.data[0] !== 3) {\n            // ignore frames with unrecognized character encodings\n            return;\n          }\n\n          for (i = 1; i < tag.data.length; i++) {\n            if (tag.data[i] === 0) {\n              // parse the description and URL fields\n              tag.description = parseUtf8(tag.data, 1, i);\n              tag.url = parseUtf8(tag.data, i + 1, tag.data.length);\n              break;\n            }\n          }\n        },\n        PRIV: function PRIV(tag) {\n          var i;\n\n          for (i = 0; i < tag.data.length; i++) {\n            if (tag.data[i] === 0) {\n              // parse the description and URL fields\n              tag.owner = parseIso88591(tag.data, 0, i);\n              break;\n            }\n          }\n          tag.privateData = tag.data.subarray(i + 1);\n          tag.data = tag.privateData;\n        }\n      },\n          _MetadataStream;\n\n      _MetadataStream = function MetadataStream(options) {\n        var settings = {\n          debug: !!(options && options.debug),\n\n          // the bytes of the program-level descriptor field in MP2T\n          // see ISO/IEC 13818-1:2013 (E), section 2.6 \"Program and\n          // program element descriptors\"\n          descriptor: options && options.descriptor\n        },\n\n\n        // the total size in bytes of the ID3 tag being parsed\n        tagSize = 0,\n\n\n        // tag data that is not complete enough to be parsed\n        buffer = [],\n\n\n        // the total number of bytes currently in the buffer\n        bufferSize = 0,\n            i;\n\n        _MetadataStream.prototype.init.call(this);\n\n        // calculate the text track in-band metadata track dispatch type\n        // https://html.spec.whatwg.org/multipage/embedded-content.html#steps-to-expose-a-media-resource-specific-text-track\n        this.dispatchType = streamTypes.METADATA_STREAM_TYPE.toString(16);\n        if (settings.descriptor) {\n          for (i = 0; i < settings.descriptor.length; i++) {\n            this.dispatchType += ('00' + settings.descriptor[i].toString(16)).slice(-2);\n          }\n        }\n\n        this.push = function (chunk) {\n          var tag, frameStart, frameSize, frame, i, frameHeader;\n          if (chunk.type !== 'timed-metadata') {\n            return;\n          }\n\n          // if data_alignment_indicator is set in the PES header,\n          // we must have the start of a new ID3 tag. Assume anything\n          // remaining in the buffer was malformed and throw it out\n          if (chunk.dataAlignmentIndicator) {\n            bufferSize = 0;\n            buffer.length = 0;\n          }\n\n          // ignore events that don't look like ID3 data\n          if (buffer.length === 0 && (chunk.data.length < 10 || chunk.data[0] !== 'I'.charCodeAt(0) || chunk.data[1] !== 'D'.charCodeAt(0) || chunk.data[2] !== '3'.charCodeAt(0))) {\n            if (settings.debug) {\n              // eslint-disable-next-line no-console\n              console.log('Skipping unrecognized metadata packet');\n            }\n            return;\n          }\n\n          // add this chunk to the data we've collected so far\n\n          buffer.push(chunk);\n          bufferSize += chunk.data.byteLength;\n\n          // grab the size of the entire frame from the ID3 header\n          if (buffer.length === 1) {\n            // the frame size is transmitted as a 28-bit integer in the\n            // last four bytes of the ID3 header.\n            // The most significant bit of each byte is dropped and the\n            // results concatenated to recover the actual value.\n            tagSize = parseSyncSafeInteger(chunk.data.subarray(6, 10));\n\n            // ID3 reports the tag size excluding the header but it's more\n            // convenient for our comparisons to include it\n            tagSize += 10;\n          }\n\n          // if the entire frame has not arrived, wait for more data\n          if (bufferSize < tagSize) {\n            return;\n          }\n\n          // collect the entire frame so it can be parsed\n          tag = {\n            data: new Uint8Array(tagSize),\n            frames: [],\n            pts: buffer[0].pts,\n            dts: buffer[0].dts\n          };\n          for (i = 0; i < tagSize;) {\n            tag.data.set(buffer[0].data.subarray(0, tagSize - i), i);\n            i += buffer[0].data.byteLength;\n            bufferSize -= buffer[0].data.byteLength;\n            buffer.shift();\n          }\n\n          // find the start of the first frame and the end of the tag\n          frameStart = 10;\n          if (tag.data[5] & 0x40) {\n            // advance the frame start past the extended header\n            frameStart += 4; // header size field\n            frameStart += parseSyncSafeInteger(tag.data.subarray(10, 14));\n\n            // clip any padding off the end\n            tagSize -= parseSyncSafeInteger(tag.data.subarray(16, 20));\n          }\n\n          // parse one or more ID3 frames\n          // http://id3.org/id3v2.3.0#ID3v2_frame_overview\n          do {\n            // determine the number of bytes in this frame\n            frameSize = parseSyncSafeInteger(tag.data.subarray(frameStart + 4, frameStart + 8));\n            if (frameSize < 1) {\n              // eslint-disable-next-line no-console\n              return console.log('Malformed ID3 frame encountered. Skipping metadata parsing.');\n            }\n            frameHeader = String.fromCharCode(tag.data[frameStart], tag.data[frameStart + 1], tag.data[frameStart + 2], tag.data[frameStart + 3]);\n\n            frame = {\n              id: frameHeader,\n              data: tag.data.subarray(frameStart + 10, frameStart + frameSize + 10)\n            };\n            frame.key = frame.id;\n            if (tagParsers[frame.id]) {\n              tagParsers[frame.id](frame);\n\n              // handle the special PRIV frame used to indicate the start\n              // time for raw AAC data\n              if (frame.owner === 'com.apple.streaming.transportStreamTimestamp') {\n                var d = frame.data,\n                    size = (d[3] & 0x01) << 30 | d[4] << 22 | d[5] << 14 | d[6] << 6 | d[7] >>> 2;\n\n                size *= 4;\n                size += d[7] & 0x03;\n                frame.timeStamp = size;\n                // in raw AAC, all subsequent data will be timestamped based\n                // on the value of this frame\n                // we couldn't have known the appropriate pts and dts before\n                // parsing this ID3 tag so set those values now\n                if (tag.pts === undefined && tag.dts === undefined) {\n                  tag.pts = frame.timeStamp;\n                  tag.dts = frame.timeStamp;\n                }\n                this.trigger('timestamp', frame);\n              }\n            }\n            tag.frames.push(frame);\n\n            frameStart += 10; // advance past the frame header\n            frameStart += frameSize; // advance past the frame body\n          } while (frameStart < tagSize);\n          this.trigger('data', tag);\n        };\n      };\n      _MetadataStream.prototype = new stream();\n\n      var metadataStream = _MetadataStream;\n\n      var TimestampRolloverStream$1 = timestampRolloverStream.TimestampRolloverStream;\n\n      // object types\n      var _TransportPacketStream, _TransportParseStream, _ElementaryStream;\n\n      // constants\n      var MP2T_PACKET_LENGTH = 188,\n\n      // bytes\n      SYNC_BYTE = 0x47;\n\n      /**\n       * Splits an incoming stream of binary data into MPEG-2 Transport\n       * Stream packets.\n       */\n      _TransportPacketStream = function TransportPacketStream() {\n        var buffer = new Uint8Array(MP2T_PACKET_LENGTH),\n            bytesInBuffer = 0;\n\n        _TransportPacketStream.prototype.init.call(this);\n\n        // Deliver new bytes to the stream.\n\n        this.push = function (bytes) {\n          var startIndex = 0,\n              endIndex = MP2T_PACKET_LENGTH,\n              everything;\n\n          // If there are bytes remaining from the last segment, prepend them to the\n          // bytes that were pushed in\n          if (bytesInBuffer) {\n            everything = new Uint8Array(bytes.byteLength + bytesInBuffer);\n            everything.set(buffer.subarray(0, bytesInBuffer));\n            everything.set(bytes, bytesInBuffer);\n            bytesInBuffer = 0;\n          } else {\n            everything = bytes;\n          }\n\n          // While we have enough data for a packet\n          while (endIndex < everything.byteLength) {\n            // Look for a pair of start and end sync bytes in the data..\n            if (everything[startIndex] === SYNC_BYTE && everything[endIndex] === SYNC_BYTE) {\n              // We found a packet so emit it and jump one whole packet forward in\n              // the stream\n              this.trigger('data', everything.subarray(startIndex, endIndex));\n              startIndex += MP2T_PACKET_LENGTH;\n              endIndex += MP2T_PACKET_LENGTH;\n              continue;\n            }\n            // If we get here, we have somehow become de-synchronized and we need to step\n            // forward one byte at a time until we find a pair of sync bytes that denote\n            // a packet\n            startIndex++;\n            endIndex++;\n          }\n\n          // If there was some data left over at the end of the segment that couldn't\n          // possibly be a whole packet, keep it because it might be the start of a packet\n          // that continues in the next segment\n          if (startIndex < everything.byteLength) {\n            buffer.set(everything.subarray(startIndex), 0);\n            bytesInBuffer = everything.byteLength - startIndex;\n          }\n        };\n\n        this.flush = function () {\n          // If the buffer contains a whole packet when we are being flushed, emit it\n          // and empty the buffer. Otherwise hold onto the data because it may be\n          // important for decoding the next segment\n          if (bytesInBuffer === MP2T_PACKET_LENGTH && buffer[0] === SYNC_BYTE) {\n            this.trigger('data', buffer);\n            bytesInBuffer = 0;\n          }\n          this.trigger('done');\n        };\n      };\n      _TransportPacketStream.prototype = new stream();\n\n      /**\n       * Accepts an MP2T TransportPacketStream and emits data events with parsed\n       * forms of the individual transport stream packets.\n       */\n      _TransportParseStream = function TransportParseStream() {\n        var parsePsi, parsePat, parsePmt, self;\n        _TransportParseStream.prototype.init.call(this);\n        self = this;\n\n        this.packetsWaitingForPmt = [];\n        this.programMapTable = undefined;\n\n        parsePsi = function parsePsi(payload, psi) {\n          var offset = 0;\n\n          // PSI packets may be split into multiple sections and those\n          // sections may be split into multiple packets. If a PSI\n          // section starts in this packet, the payload_unit_start_indicator\n          // will be true and the first byte of the payload will indicate\n          // the offset from the current position to the start of the\n          // section.\n          if (psi.payloadUnitStartIndicator) {\n            offset += payload[offset] + 1;\n          }\n\n          if (psi.type === 'pat') {\n            parsePat(payload.subarray(offset), psi);\n          } else {\n            parsePmt(payload.subarray(offset), psi);\n          }\n        };\n\n        parsePat = function parsePat(payload, pat) {\n          pat.section_number = payload[7]; // eslint-disable-line camelcase\n          pat.last_section_number = payload[8]; // eslint-disable-line camelcase\n\n          // skip the PSI header and parse the first PMT entry\n          self.pmtPid = (payload[10] & 0x1F) << 8 | payload[11];\n          pat.pmtPid = self.pmtPid;\n        };\n\n        /**\n         * Parse out the relevant fields of a Program Map Table (PMT).\n         * @param payload {Uint8Array} the PMT-specific portion of an MP2T\n         * packet. The first byte in this array should be the table_id\n         * field.\n         * @param pmt {object} the object that should be decorated with\n         * fields parsed from the PMT.\n         */\n        parsePmt = function parsePmt(payload, pmt) {\n          var sectionLength, tableEnd, programInfoLength, offset;\n\n          // PMTs can be sent ahead of the time when they should actually\n          // take effect. We don't believe this should ever be the case\n          // for HLS but we'll ignore \"forward\" PMT declarations if we see\n          // them. Future PMT declarations have the current_next_indicator\n          // set to zero.\n          if (!(payload[5] & 0x01)) {\n            return;\n          }\n\n          // overwrite any existing program map table\n          self.programMapTable = {\n            video: null,\n            audio: null,\n            'timed-metadata': {}\n          };\n\n          // the mapping table ends at the end of the current section\n          sectionLength = (payload[1] & 0x0f) << 8 | payload[2];\n          tableEnd = 3 + sectionLength - 4;\n\n          // to determine where the table is, we have to figure out how\n          // long the program info descriptors are\n          programInfoLength = (payload[10] & 0x0f) << 8 | payload[11];\n\n          // advance the offset to the first entry in the mapping table\n          offset = 12 + programInfoLength;\n          while (offset < tableEnd) {\n            var streamType = payload[offset];\n            var pid = (payload[offset + 1] & 0x1F) << 8 | payload[offset + 2];\n\n            // only map a single elementary_pid for audio and video stream types\n            // TODO: should this be done for metadata too? for now maintain behavior of\n            //       multiple metadata streams\n            if (streamType === streamTypes.H264_STREAM_TYPE && self.programMapTable.video === null) {\n              self.programMapTable.video = pid;\n            } else if (streamType === streamTypes.ADTS_STREAM_TYPE && self.programMapTable.audio === null) {\n              self.programMapTable.audio = pid;\n            } else if (streamType === streamTypes.METADATA_STREAM_TYPE) {\n              // map pid to stream type for metadata streams\n              self.programMapTable['timed-metadata'][pid] = streamType;\n            }\n\n            // move to the next table entry\n            // skip past the elementary stream descriptors, if present\n            offset += ((payload[offset + 3] & 0x0F) << 8 | payload[offset + 4]) + 5;\n          }\n\n          // record the map on the packet as well\n          pmt.programMapTable = self.programMapTable;\n        };\n\n        /**\n         * Deliver a new MP2T packet to the stream.\n         */\n        this.push = function (packet) {\n          var result = {},\n              offset = 4;\n\n          result.payloadUnitStartIndicator = !!(packet[1] & 0x40);\n\n          // pid is a 13-bit field starting at the last bit of packet[1]\n          result.pid = packet[1] & 0x1f;\n          result.pid <<= 8;\n          result.pid |= packet[2];\n\n          // if an adaption field is present, its length is specified by the\n          // fifth byte of the TS packet header. The adaptation field is\n          // used to add stuffing to PES packets that don't fill a complete\n          // TS packet, and to specify some forms of timing and control data\n          // that we do not currently use.\n          if ((packet[3] & 0x30) >>> 4 > 0x01) {\n            offset += packet[offset] + 1;\n          }\n\n          // parse the rest of the packet based on the type\n          if (result.pid === 0) {\n            result.type = 'pat';\n            parsePsi(packet.subarray(offset), result);\n            this.trigger('data', result);\n          } else if (result.pid === this.pmtPid) {\n            result.type = 'pmt';\n            parsePsi(packet.subarray(offset), result);\n            this.trigger('data', result);\n\n            // if there are any packets waiting for a PMT to be found, process them now\n            while (this.packetsWaitingForPmt.length) {\n              this.processPes_.apply(this, this.packetsWaitingForPmt.shift());\n            }\n          } else if (this.programMapTable === undefined) {\n            // When we have not seen a PMT yet, defer further processing of\n            // PES packets until one has been parsed\n            this.packetsWaitingForPmt.push([packet, offset, result]);\n          } else {\n            this.processPes_(packet, offset, result);\n          }\n        };\n\n        this.processPes_ = function (packet, offset, result) {\n          // set the appropriate stream type\n          if (result.pid === this.programMapTable.video) {\n            result.streamType = streamTypes.H264_STREAM_TYPE;\n          } else if (result.pid === this.programMapTable.audio) {\n            result.streamType = streamTypes.ADTS_STREAM_TYPE;\n          } else {\n            // if not video or audio, it is timed-metadata or unknown\n            // if unknown, streamType will be undefined\n            result.streamType = this.programMapTable['timed-metadata'][result.pid];\n          }\n\n          result.type = 'pes';\n          result.data = packet.subarray(offset);\n\n          this.trigger('data', result);\n        };\n      };\n      _TransportParseStream.prototype = new stream();\n      _TransportParseStream.STREAM_TYPES = {\n        h264: 0x1b,\n        adts: 0x0f\n      };\n\n      /**\n       * Reconsistutes program elementary stream (PES) packets from parsed\n       * transport stream packets. That is, if you pipe an\n       * mp2t.TransportParseStream into a mp2t.ElementaryStream, the output\n       * events will be events which capture the bytes for individual PES\n       * packets plus relevant metadata that has been extracted from the\n       * container.\n       */\n      _ElementaryStream = function ElementaryStream() {\n        var self = this,\n\n\n        // PES packet fragments\n        video = {\n          data: [],\n          size: 0\n        },\n            audio = {\n          data: [],\n          size: 0\n        },\n            timedMetadata = {\n          data: [],\n          size: 0\n        },\n            parsePes = function parsePes(payload, pes) {\n          var ptsDtsFlags;\n\n          // get the packet length, this will be 0 for video\n          pes.packetLength = 6 + (payload[4] << 8 | payload[5]);\n\n          // find out if this packets starts a new keyframe\n          pes.dataAlignmentIndicator = (payload[6] & 0x04) !== 0;\n          // PES packets may be annotated with a PTS value, or a PTS value\n          // and a DTS value. Determine what combination of values is\n          // available to work with.\n          ptsDtsFlags = payload[7];\n\n          // PTS and DTS are normally stored as a 33-bit number.  Javascript\n          // performs all bitwise operations on 32-bit integers but javascript\n          // supports a much greater range (52-bits) of integer using standard\n          // mathematical operations.\n          // We construct a 31-bit value using bitwise operators over the 31\n          // most significant bits and then multiply by 4 (equal to a left-shift\n          // of 2) before we add the final 2 least significant bits of the\n          // timestamp (equal to an OR.)\n          if (ptsDtsFlags & 0xC0) {\n            // the PTS and DTS are not written out directly. For information\n            // on how they are encoded, see\n            // http://dvd.sourceforge.net/dvdinfo/pes-hdr.html\n            pes.pts = (payload[9] & 0x0E) << 27 | (payload[10] & 0xFF) << 20 | (payload[11] & 0xFE) << 12 | (payload[12] & 0xFF) << 5 | (payload[13] & 0xFE) >>> 3;\n            pes.pts *= 4; // Left shift by 2\n            pes.pts += (payload[13] & 0x06) >>> 1; // OR by the two LSBs\n            pes.dts = pes.pts;\n            if (ptsDtsFlags & 0x40) {\n              pes.dts = (payload[14] & 0x0E) << 27 | (payload[15] & 0xFF) << 20 | (payload[16] & 0xFE) << 12 | (payload[17] & 0xFF) << 5 | (payload[18] & 0xFE) >>> 3;\n              pes.dts *= 4; // Left shift by 2\n              pes.dts += (payload[18] & 0x06) >>> 1; // OR by the two LSBs\n            }\n          }\n          // the data section starts immediately after the PES header.\n          // pes_header_data_length specifies the number of header bytes\n          // that follow the last byte of the field.\n          pes.data = payload.subarray(9 + payload[8]);\n        },\n            flushStream = function flushStream(stream$$1, type, forceFlush) {\n          var packetData = new Uint8Array(stream$$1.size),\n              event = {\n            type: type\n          },\n              i = 0,\n              offset = 0,\n              packetFlushable = false,\n              fragment;\n\n          // do nothing if there is not enough buffered data for a complete\n          // PES header\n          if (!stream$$1.data.length || stream$$1.size < 9) {\n            return;\n          }\n          event.trackId = stream$$1.data[0].pid;\n\n          // reassemble the packet\n          for (i = 0; i < stream$$1.data.length; i++) {\n            fragment = stream$$1.data[i];\n\n            packetData.set(fragment.data, offset);\n            offset += fragment.data.byteLength;\n          }\n\n          // parse assembled packet's PES header\n          parsePes(packetData, event);\n\n          // non-video PES packets MUST have a non-zero PES_packet_length\n          // check that there is enough stream data to fill the packet\n          packetFlushable = type === 'video' || event.packetLength <= stream$$1.size;\n\n          // flush pending packets if the conditions are right\n          if (forceFlush || packetFlushable) {\n            stream$$1.size = 0;\n            stream$$1.data.length = 0;\n          }\n\n          // only emit packets that are complete. this is to avoid assembling\n          // incomplete PES packets due to poor segmentation\n          if (packetFlushable) {\n            self.trigger('data', event);\n          }\n        };\n\n        _ElementaryStream.prototype.init.call(this);\n\n        this.push = function (data) {\n          ({\n            pat: function pat() {\n              // we have to wait for the PMT to arrive as well before we\n              // have any meaningful metadata\n            },\n            pes: function pes() {\n              var stream$$1, streamType;\n\n              switch (data.streamType) {\n                case streamTypes.H264_STREAM_TYPE:\n                case streamTypes.H264_STREAM_TYPE:\n                  stream$$1 = video;\n                  streamType = 'video';\n                  break;\n                case streamTypes.ADTS_STREAM_TYPE:\n                  stream$$1 = audio;\n                  streamType = 'audio';\n                  break;\n                case streamTypes.METADATA_STREAM_TYPE:\n                  stream$$1 = timedMetadata;\n                  streamType = 'timed-metadata';\n                  break;\n                default:\n                  // ignore unknown stream types\n                  return;\n              }\n\n              // if a new packet is starting, we can flush the completed\n              // packet\n              if (data.payloadUnitStartIndicator) {\n                flushStream(stream$$1, streamType, true);\n              }\n\n              // buffer this fragment until we are sure we've received the\n              // complete payload\n              stream$$1.data.push(data);\n              stream$$1.size += data.data.byteLength;\n            },\n            pmt: function pmt() {\n              var event = {\n                type: 'metadata',\n                tracks: []\n              },\n                  programMapTable = data.programMapTable;\n\n              // translate audio and video streams to tracks\n              if (programMapTable.video !== null) {\n                event.tracks.push({\n                  timelineStartInfo: {\n                    baseMediaDecodeTime: 0\n                  },\n                  id: +programMapTable.video,\n                  codec: 'avc',\n                  type: 'video'\n                });\n              }\n              if (programMapTable.audio !== null) {\n                event.tracks.push({\n                  timelineStartInfo: {\n                    baseMediaDecodeTime: 0\n                  },\n                  id: +programMapTable.audio,\n                  codec: 'adts',\n                  type: 'audio'\n                });\n              }\n\n              self.trigger('data', event);\n            }\n          })[data.type]();\n        };\n\n        /**\n         * Flush any remaining input. Video PES packets may be of variable\n         * length. Normally, the start of a new video packet can trigger the\n         * finalization of the previous packet. That is not possible if no\n         * more video is forthcoming, however. In that case, some other\n         * mechanism (like the end of the file) has to be employed. When it is\n         * clear that no additional data is forthcoming, calling this method\n         * will flush the buffered packets.\n         */\n        this.flush = function () {\n          // !!THIS ORDER IS IMPORTANT!!\n          // video first then audio\n          flushStream(video, 'video');\n          flushStream(audio, 'audio');\n          flushStream(timedMetadata, 'timed-metadata');\n          this.trigger('done');\n        };\n      };\n      _ElementaryStream.prototype = new stream();\n\n      var m2ts = {\n        PAT_PID: 0x0000,\n        MP2T_PACKET_LENGTH: MP2T_PACKET_LENGTH,\n        TransportPacketStream: _TransportPacketStream,\n        TransportParseStream: _TransportParseStream,\n        ElementaryStream: _ElementaryStream,\n        TimestampRolloverStream: TimestampRolloverStream$1,\n        CaptionStream: captionStream.CaptionStream,\n        Cea608Stream: captionStream.Cea608Stream,\n        MetadataStream: metadataStream\n      };\n\n      for (var type in streamTypes) {\n        if (streamTypes.hasOwnProperty(type)) {\n          m2ts[type] = streamTypes[type];\n        }\n      }\n\n      var m2ts_1 = m2ts;\n\n      var _AdtsStream;\n\n      var ADTS_SAMPLING_FREQUENCIES = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\n\n      /*\n       * Accepts a ElementaryStream and emits data events with parsed\n       * AAC Audio Frames of the individual packets. Input audio in ADTS\n       * format is unpacked and re-emitted as AAC frames.\n       *\n       * @see http://wiki.multimedia.cx/index.php?title=ADTS\n       * @see http://wiki.multimedia.cx/?title=Understanding_AAC\n       */\n      _AdtsStream = function AdtsStream() {\n        var buffer;\n\n        _AdtsStream.prototype.init.call(this);\n\n        this.push = function (packet) {\n          var i = 0,\n              frameNum = 0,\n              frameLength,\n              protectionSkipBytes,\n              frameEnd,\n              oldBuffer,\n              sampleCount,\n              adtsFrameDuration;\n\n          if (packet.type !== 'audio') {\n            // ignore non-audio data\n            return;\n          }\n\n          // Prepend any data in the buffer to the input data so that we can parse\n          // aac frames the cross a PES packet boundary\n          if (buffer) {\n            oldBuffer = buffer;\n            buffer = new Uint8Array(oldBuffer.byteLength + packet.data.byteLength);\n            buffer.set(oldBuffer);\n            buffer.set(packet.data, oldBuffer.byteLength);\n          } else {\n            buffer = packet.data;\n          }\n\n          // unpack any ADTS frames which have been fully received\n          // for details on the ADTS header, see http://wiki.multimedia.cx/index.php?title=ADTS\n          while (i + 5 < buffer.length) {\n\n            // Loook for the start of an ADTS header..\n            if (buffer[i] !== 0xFF || (buffer[i + 1] & 0xF6) !== 0xF0) {\n              // If a valid header was not found,  jump one forward and attempt to\n              // find a valid ADTS header starting at the next byte\n              i++;\n              continue;\n            }\n\n            // The protection skip bit tells us if we have 2 bytes of CRC data at the\n            // end of the ADTS header\n            protectionSkipBytes = (~buffer[i + 1] & 0x01) * 2;\n\n            // Frame length is a 13 bit integer starting 16 bits from the\n            // end of the sync sequence\n            frameLength = (buffer[i + 3] & 0x03) << 11 | buffer[i + 4] << 3 | (buffer[i + 5] & 0xe0) >> 5;\n\n            sampleCount = ((buffer[i + 6] & 0x03) + 1) * 1024;\n            adtsFrameDuration = sampleCount * 90000 / ADTS_SAMPLING_FREQUENCIES[(buffer[i + 2] & 0x3c) >>> 2];\n\n            frameEnd = i + frameLength;\n\n            // If we don't have enough data to actually finish this ADTS frame, return\n            // and wait for more data\n            if (buffer.byteLength < frameEnd) {\n              return;\n            }\n\n            // Otherwise, deliver the complete AAC frame\n            this.trigger('data', {\n              pts: packet.pts + frameNum * adtsFrameDuration,\n              dts: packet.dts + frameNum * adtsFrameDuration,\n              sampleCount: sampleCount,\n              audioobjecttype: (buffer[i + 2] >>> 6 & 0x03) + 1,\n              channelcount: (buffer[i + 2] & 1) << 2 | (buffer[i + 3] & 0xc0) >>> 6,\n              samplerate: ADTS_SAMPLING_FREQUENCIES[(buffer[i + 2] & 0x3c) >>> 2],\n              samplingfrequencyindex: (buffer[i + 2] & 0x3c) >>> 2,\n              // assume ISO/IEC 14496-12 AudioSampleEntry default of 16\n              samplesize: 16,\n              data: buffer.subarray(i + 7 + protectionSkipBytes, frameEnd)\n            });\n\n            // If the buffer is empty, clear it and return\n            if (buffer.byteLength === frameEnd) {\n              buffer = undefined;\n              return;\n            }\n\n            frameNum++;\n\n            // Remove the finished frame from the buffer and start the process again\n            buffer = buffer.subarray(frameEnd);\n          }\n        };\n        this.flush = function () {\n          this.trigger('done');\n        };\n      };\n\n      _AdtsStream.prototype = new stream();\n\n      var adts = _AdtsStream;\n\n      var ExpGolomb;\n\n      /**\n       * Parser for exponential Golomb codes, a variable-bitwidth number encoding\n       * scheme used by h264.\n       */\n      ExpGolomb = function ExpGolomb(workingData) {\n        var\n        // the number of bytes left to examine in workingData\n        workingBytesAvailable = workingData.byteLength,\n\n\n        // the current word being examined\n        workingWord = 0,\n\n        // :uint\n\n        // the number of bits left to examine in the current word\n        workingBitsAvailable = 0; // :uint;\n\n        // ():uint\n        this.length = function () {\n          return 8 * workingBytesAvailable;\n        };\n\n        // ():uint\n        this.bitsAvailable = function () {\n          return 8 * workingBytesAvailable + workingBitsAvailable;\n        };\n\n        // ():void\n        this.loadWord = function () {\n          var position = workingData.byteLength - workingBytesAvailable,\n              workingBytes = new Uint8Array(4),\n              availableBytes = Math.min(4, workingBytesAvailable);\n\n          if (availableBytes === 0) {\n            throw new Error('no bytes available');\n          }\n\n          workingBytes.set(workingData.subarray(position, position + availableBytes));\n          workingWord = new DataView(workingBytes.buffer).getUint32(0);\n\n          // track the amount of workingData that has been processed\n          workingBitsAvailable = availableBytes * 8;\n          workingBytesAvailable -= availableBytes;\n        };\n\n        // (count:int):void\n        this.skipBits = function (count) {\n          var skipBytes; // :int\n          if (workingBitsAvailable > count) {\n            workingWord <<= count;\n            workingBitsAvailable -= count;\n          } else {\n            count -= workingBitsAvailable;\n            skipBytes = Math.floor(count / 8);\n\n            count -= skipBytes * 8;\n            workingBytesAvailable -= skipBytes;\n\n            this.loadWord();\n\n            workingWord <<= count;\n            workingBitsAvailable -= count;\n          }\n        };\n\n        // (size:int):uint\n        this.readBits = function (size) {\n          var bits = Math.min(workingBitsAvailable, size),\n\n          // :uint\n          valu = workingWord >>> 32 - bits; // :uint\n          // if size > 31, handle error\n          workingBitsAvailable -= bits;\n          if (workingBitsAvailable > 0) {\n            workingWord <<= bits;\n          } else if (workingBytesAvailable > 0) {\n            this.loadWord();\n          }\n\n          bits = size - bits;\n          if (bits > 0) {\n            return valu << bits | this.readBits(bits);\n          }\n          return valu;\n        };\n\n        // ():uint\n        this.skipLeadingZeros = function () {\n          var leadingZeroCount; // :uint\n          for (leadingZeroCount = 0; leadingZeroCount < workingBitsAvailable; ++leadingZeroCount) {\n            if ((workingWord & 0x80000000 >>> leadingZeroCount) !== 0) {\n              // the first bit of working word is 1\n              workingWord <<= leadingZeroCount;\n              workingBitsAvailable -= leadingZeroCount;\n              return leadingZeroCount;\n            }\n          }\n\n          // we exhausted workingWord and still have not found a 1\n          this.loadWord();\n          return leadingZeroCount + this.skipLeadingZeros();\n        };\n\n        // ():void\n        this.skipUnsignedExpGolomb = function () {\n          this.skipBits(1 + this.skipLeadingZeros());\n        };\n\n        // ():void\n        this.skipExpGolomb = function () {\n          this.skipBits(1 + this.skipLeadingZeros());\n        };\n\n        // ():uint\n        this.readUnsignedExpGolomb = function () {\n          var clz = this.skipLeadingZeros(); // :uint\n          return this.readBits(clz + 1) - 1;\n        };\n\n        // ():int\n        this.readExpGolomb = function () {\n          var valu = this.readUnsignedExpGolomb(); // :int\n          if (0x01 & valu) {\n            // the number is odd if the low order bit is set\n            return 1 + valu >>> 1; // add 1 to make it even, and divide by 2\n          }\n          return -1 * (valu >>> 1); // divide by two then make it negative\n        };\n\n        // Some convenience functions\n        // :Boolean\n        this.readBoolean = function () {\n          return this.readBits(1) === 1;\n        };\n\n        // ():int\n        this.readUnsignedByte = function () {\n          return this.readBits(8);\n        };\n\n        this.loadWord();\n      };\n\n      var expGolomb = ExpGolomb;\n\n      var _H264Stream, _NalByteStream;\n      var PROFILES_WITH_OPTIONAL_SPS_DATA;\n\n      /**\n       * Accepts a NAL unit byte stream and unpacks the embedded NAL units.\n       */\n      _NalByteStream = function NalByteStream() {\n        var syncPoint = 0,\n            i,\n            buffer;\n        _NalByteStream.prototype.init.call(this);\n\n        this.push = function (data) {\n          var swapBuffer;\n\n          if (!buffer) {\n            buffer = data.data;\n          } else {\n            swapBuffer = new Uint8Array(buffer.byteLength + data.data.byteLength);\n            swapBuffer.set(buffer);\n            swapBuffer.set(data.data, buffer.byteLength);\n            buffer = swapBuffer;\n          }\n\n          // Rec. ITU-T H.264, Annex B\n          // scan for NAL unit boundaries\n\n          // a match looks like this:\n          // 0 0 1 .. NAL .. 0 0 1\n          // ^ sync point        ^ i\n          // or this:\n          // 0 0 1 .. NAL .. 0 0 0\n          // ^ sync point        ^ i\n\n          // advance the sync point to a NAL start, if necessary\n          for (; syncPoint < buffer.byteLength - 3; syncPoint++) {\n            if (buffer[syncPoint + 2] === 1) {\n              // the sync point is properly aligned\n              i = syncPoint + 5;\n              break;\n            }\n          }\n\n          while (i < buffer.byteLength) {\n            // look at the current byte to determine if we've hit the end of\n            // a NAL unit boundary\n            switch (buffer[i]) {\n              case 0:\n                // skip past non-sync sequences\n                if (buffer[i - 1] !== 0) {\n                  i += 2;\n                  break;\n                } else if (buffer[i - 2] !== 0) {\n                  i++;\n                  break;\n                }\n\n                // deliver the NAL unit if it isn't empty\n                if (syncPoint + 3 !== i - 2) {\n                  this.trigger('data', buffer.subarray(syncPoint + 3, i - 2));\n                }\n\n                // drop trailing zeroes\n                do {\n                  i++;\n                } while (buffer[i] !== 1 && i < buffer.length);\n                syncPoint = i - 2;\n                i += 3;\n                break;\n              case 1:\n                // skip past non-sync sequences\n                if (buffer[i - 1] !== 0 || buffer[i - 2] !== 0) {\n                  i += 3;\n                  break;\n                }\n\n                // deliver the NAL unit\n                this.trigger('data', buffer.subarray(syncPoint + 3, i - 2));\n                syncPoint = i - 2;\n                i += 3;\n                break;\n              default:\n                // the current byte isn't a one or zero, so it cannot be part\n                // of a sync sequence\n                i += 3;\n                break;\n            }\n          }\n          // filter out the NAL units that were delivered\n          buffer = buffer.subarray(syncPoint);\n          i -= syncPoint;\n          syncPoint = 0;\n        };\n\n        this.flush = function () {\n          // deliver the last buffered NAL unit\n          if (buffer && buffer.byteLength > 3) {\n            this.trigger('data', buffer.subarray(syncPoint + 3));\n          }\n          // reset the stream state\n          buffer = null;\n          syncPoint = 0;\n          this.trigger('done');\n        };\n      };\n      _NalByteStream.prototype = new stream();\n\n      // values of profile_idc that indicate additional fields are included in the SPS\n      // see Recommendation ITU-T H.264 (4/2013),\n      // 7.3.2.1.1 Sequence parameter set data syntax\n      PROFILES_WITH_OPTIONAL_SPS_DATA = {\n        100: true,\n        110: true,\n        122: true,\n        244: true,\n        44: true,\n        83: true,\n        86: true,\n        118: true,\n        128: true,\n        138: true,\n        139: true,\n        134: true\n      };\n\n      /**\n       * Accepts input from a ElementaryStream and produces H.264 NAL unit data\n       * events.\n       */\n      _H264Stream = function H264Stream() {\n        var nalByteStream = new _NalByteStream(),\n            self,\n            trackId,\n            currentPts,\n            currentDts,\n            discardEmulationPreventionBytes,\n            readSequenceParameterSet,\n            skipScalingList;\n\n        _H264Stream.prototype.init.call(this);\n        self = this;\n\n        this.push = function (packet) {\n          if (packet.type !== 'video') {\n            return;\n          }\n          trackId = packet.trackId;\n          currentPts = packet.pts;\n          currentDts = packet.dts;\n\n          nalByteStream.push(packet);\n        };\n\n        nalByteStream.on('data', function (data) {\n          var event = {\n            trackId: trackId,\n            pts: currentPts,\n            dts: currentDts,\n            data: data\n          };\n\n          switch (data[0] & 0x1f) {\n            case 0x05:\n              event.nalUnitType = 'slice_layer_without_partitioning_rbsp_idr';\n              break;\n            case 0x06:\n              event.nalUnitType = 'sei_rbsp';\n              event.escapedRBSP = discardEmulationPreventionBytes(data.subarray(1));\n              break;\n            case 0x07:\n              event.nalUnitType = 'seq_parameter_set_rbsp';\n              event.escapedRBSP = discardEmulationPreventionBytes(data.subarray(1));\n              event.config = readSequenceParameterSet(event.escapedRBSP);\n              break;\n            case 0x08:\n              event.nalUnitType = 'pic_parameter_set_rbsp';\n              break;\n            case 0x09:\n              event.nalUnitType = 'access_unit_delimiter_rbsp';\n              break;\n\n            default:\n              break;\n          }\n          self.trigger('data', event);\n        });\n        nalByteStream.on('done', function () {\n          self.trigger('done');\n        });\n\n        this.flush = function () {\n          nalByteStream.flush();\n        };\n\n        /**\n         * Advance the ExpGolomb decoder past a scaling list. The scaling\n         * list is optionally transmitted as part of a sequence parameter\n         * set and is not relevant to transmuxing.\n         * @param count {number} the number of entries in this scaling list\n         * @param expGolombDecoder {object} an ExpGolomb pointed to the\n         * start of a scaling list\n         * @see Recommendation ITU-T H.264, Section 7.3.2.1.1.1\n         */\n        skipScalingList = function skipScalingList(count, expGolombDecoder) {\n          var lastScale = 8,\n              nextScale = 8,\n              j,\n              deltaScale;\n\n          for (j = 0; j < count; j++) {\n            if (nextScale !== 0) {\n              deltaScale = expGolombDecoder.readExpGolomb();\n              nextScale = (lastScale + deltaScale + 256) % 256;\n            }\n\n            lastScale = nextScale === 0 ? lastScale : nextScale;\n          }\n        };\n\n        /**\n         * Expunge any \"Emulation Prevention\" bytes from a \"Raw Byte\n         * Sequence Payload\"\n         * @param data {Uint8Array} the bytes of a RBSP from a NAL\n         * unit\n         * @return {Uint8Array} the RBSP without any Emulation\n         * Prevention Bytes\n         */\n        discardEmulationPreventionBytes = function discardEmulationPreventionBytes(data) {\n          var length = data.byteLength,\n              emulationPreventionBytesPositions = [],\n              i = 1,\n              newLength,\n              newData;\n\n          // Find all `Emulation Prevention Bytes`\n          while (i < length - 2) {\n            if (data[i] === 0 && data[i + 1] === 0 && data[i + 2] === 0x03) {\n              emulationPreventionBytesPositions.push(i + 2);\n              i += 2;\n            } else {\n              i++;\n            }\n          }\n\n          // If no Emulation Prevention Bytes were found just return the original\n          // array\n          if (emulationPreventionBytesPositions.length === 0) {\n            return data;\n          }\n\n          // Create a new array to hold the NAL unit data\n          newLength = length - emulationPreventionBytesPositions.length;\n          newData = new Uint8Array(newLength);\n          var sourceIndex = 0;\n\n          for (i = 0; i < newLength; sourceIndex++, i++) {\n            if (sourceIndex === emulationPreventionBytesPositions[0]) {\n              // Skip this byte\n              sourceIndex++;\n              // Remove this position index\n              emulationPreventionBytesPositions.shift();\n            }\n            newData[i] = data[sourceIndex];\n          }\n\n          return newData;\n        };\n\n        /**\n         * Read a sequence parameter set and return some interesting video\n         * properties. A sequence parameter set is the H264 metadata that\n         * describes the properties of upcoming video frames.\n         * @param data {Uint8Array} the bytes of a sequence parameter set\n         * @return {object} an object with configuration parsed from the\n         * sequence parameter set, including the dimensions of the\n         * associated video frames.\n         */\n        readSequenceParameterSet = function readSequenceParameterSet(data) {\n          var frameCropLeftOffset = 0,\n              frameCropRightOffset = 0,\n              frameCropTopOffset = 0,\n              frameCropBottomOffset = 0,\n              sarScale = 1,\n              expGolombDecoder,\n              profileIdc,\n              levelIdc,\n              profileCompatibility,\n              chromaFormatIdc,\n              picOrderCntType,\n              numRefFramesInPicOrderCntCycle,\n              picWidthInMbsMinus1,\n              picHeightInMapUnitsMinus1,\n              frameMbsOnlyFlag,\n              scalingListCount,\n              sarRatio,\n              aspectRatioIdc,\n              i;\n\n          expGolombDecoder = new expGolomb(data);\n          profileIdc = expGolombDecoder.readUnsignedByte(); // profile_idc\n          profileCompatibility = expGolombDecoder.readUnsignedByte(); // constraint_set[0-5]_flag\n          levelIdc = expGolombDecoder.readUnsignedByte(); // level_idc u(8)\n          expGolombDecoder.skipUnsignedExpGolomb(); // seq_parameter_set_id\n\n          // some profiles have more optional data we don't need\n          if (PROFILES_WITH_OPTIONAL_SPS_DATA[profileIdc]) {\n            chromaFormatIdc = expGolombDecoder.readUnsignedExpGolomb();\n            if (chromaFormatIdc === 3) {\n              expGolombDecoder.skipBits(1); // separate_colour_plane_flag\n            }\n            expGolombDecoder.skipUnsignedExpGolomb(); // bit_depth_luma_minus8\n            expGolombDecoder.skipUnsignedExpGolomb(); // bit_depth_chroma_minus8\n            expGolombDecoder.skipBits(1); // qpprime_y_zero_transform_bypass_flag\n            if (expGolombDecoder.readBoolean()) {\n              // seq_scaling_matrix_present_flag\n              scalingListCount = chromaFormatIdc !== 3 ? 8 : 12;\n              for (i = 0; i < scalingListCount; i++) {\n                if (expGolombDecoder.readBoolean()) {\n                  // seq_scaling_list_present_flag[ i ]\n                  if (i < 6) {\n                    skipScalingList(16, expGolombDecoder);\n                  } else {\n                    skipScalingList(64, expGolombDecoder);\n                  }\n                }\n              }\n            }\n          }\n\n          expGolombDecoder.skipUnsignedExpGolomb(); // log2_max_frame_num_minus4\n          picOrderCntType = expGolombDecoder.readUnsignedExpGolomb();\n\n          if (picOrderCntType === 0) {\n            expGolombDecoder.readUnsignedExpGolomb(); // log2_max_pic_order_cnt_lsb_minus4\n          } else if (picOrderCntType === 1) {\n            expGolombDecoder.skipBits(1); // delta_pic_order_always_zero_flag\n            expGolombDecoder.skipExpGolomb(); // offset_for_non_ref_pic\n            expGolombDecoder.skipExpGolomb(); // offset_for_top_to_bottom_field\n            numRefFramesInPicOrderCntCycle = expGolombDecoder.readUnsignedExpGolomb();\n            for (i = 0; i < numRefFramesInPicOrderCntCycle; i++) {\n              expGolombDecoder.skipExpGolomb(); // offset_for_ref_frame[ i ]\n            }\n          }\n\n          expGolombDecoder.skipUnsignedExpGolomb(); // max_num_ref_frames\n          expGolombDecoder.skipBits(1); // gaps_in_frame_num_value_allowed_flag\n\n          picWidthInMbsMinus1 = expGolombDecoder.readUnsignedExpGolomb();\n          picHeightInMapUnitsMinus1 = expGolombDecoder.readUnsignedExpGolomb();\n\n          frameMbsOnlyFlag = expGolombDecoder.readBits(1);\n          if (frameMbsOnlyFlag === 0) {\n            expGolombDecoder.skipBits(1); // mb_adaptive_frame_field_flag\n          }\n\n          expGolombDecoder.skipBits(1); // direct_8x8_inference_flag\n          if (expGolombDecoder.readBoolean()) {\n            // frame_cropping_flag\n            frameCropLeftOffset = expGolombDecoder.readUnsignedExpGolomb();\n            frameCropRightOffset = expGolombDecoder.readUnsignedExpGolomb();\n            frameCropTopOffset = expGolombDecoder.readUnsignedExpGolomb();\n            frameCropBottomOffset = expGolombDecoder.readUnsignedExpGolomb();\n          }\n          if (expGolombDecoder.readBoolean()) {\n            // vui_parameters_present_flag\n            if (expGolombDecoder.readBoolean()) {\n              // aspect_ratio_info_present_flag\n              aspectRatioIdc = expGolombDecoder.readUnsignedByte();\n              switch (aspectRatioIdc) {\n                case 1:\n                  sarRatio = [1, 1];break;\n                case 2:\n                  sarRatio = [12, 11];break;\n                case 3:\n                  sarRatio = [10, 11];break;\n                case 4:\n                  sarRatio = [16, 11];break;\n                case 5:\n                  sarRatio = [40, 33];break;\n                case 6:\n                  sarRatio = [24, 11];break;\n                case 7:\n                  sarRatio = [20, 11];break;\n                case 8:\n                  sarRatio = [32, 11];break;\n                case 9:\n                  sarRatio = [80, 33];break;\n                case 10:\n                  sarRatio = [18, 11];break;\n                case 11:\n                  sarRatio = [15, 11];break;\n                case 12:\n                  sarRatio = [64, 33];break;\n                case 13:\n                  sarRatio = [160, 99];break;\n                case 14:\n                  sarRatio = [4, 3];break;\n                case 15:\n                  sarRatio = [3, 2];break;\n                case 16:\n                  sarRatio = [2, 1];break;\n                case 255:\n                  {\n                    sarRatio = [expGolombDecoder.readUnsignedByte() << 8 | expGolombDecoder.readUnsignedByte(), expGolombDecoder.readUnsignedByte() << 8 | expGolombDecoder.readUnsignedByte()];\n                    break;\n                  }\n              }\n              if (sarRatio) {\n                sarScale = sarRatio[0] / sarRatio[1];\n              }\n            }\n          }\n          return {\n            profileIdc: profileIdc,\n            levelIdc: levelIdc,\n            profileCompatibility: profileCompatibility,\n            width: Math.ceil(((picWidthInMbsMinus1 + 1) * 16 - frameCropLeftOffset * 2 - frameCropRightOffset * 2) * sarScale),\n            height: (2 - frameMbsOnlyFlag) * (picHeightInMapUnitsMinus1 + 1) * 16 - frameCropTopOffset * 2 - frameCropBottomOffset * 2\n          };\n        };\n      };\n      _H264Stream.prototype = new stream();\n\n      var h264 = {\n        H264Stream: _H264Stream,\n        NalByteStream: _NalByteStream\n      };\n\n      // Constants\n      var _AacStream;\n\n      /**\n       * Splits an incoming stream of binary data into ADTS and ID3 Frames.\n       */\n\n      _AacStream = function AacStream() {\n        var everything = new Uint8Array(),\n            timeStamp = 0;\n\n        _AacStream.prototype.init.call(this);\n\n        this.setTimestamp = function (timestamp) {\n          timeStamp = timestamp;\n        };\n\n        this.parseId3TagSize = function (header, byteIndex) {\n          var returnSize = header[byteIndex + 6] << 21 | header[byteIndex + 7] << 14 | header[byteIndex + 8] << 7 | header[byteIndex + 9],\n              flags = header[byteIndex + 5],\n              footerPresent = (flags & 16) >> 4;\n\n          if (footerPresent) {\n            return returnSize + 20;\n          }\n          return returnSize + 10;\n        };\n\n        this.parseAdtsSize = function (header, byteIndex) {\n          var lowThree = (header[byteIndex + 5] & 0xE0) >> 5,\n              middle = header[byteIndex + 4] << 3,\n              highTwo = header[byteIndex + 3] & 0x3 << 11;\n\n          return highTwo | middle | lowThree;\n        };\n\n        this.push = function (bytes) {\n          var frameSize = 0,\n              byteIndex = 0,\n              bytesLeft,\n              chunk,\n              packet,\n              tempLength;\n\n          // If there are bytes remaining from the last segment, prepend them to the\n          // bytes that were pushed in\n          if (everything.length) {\n            tempLength = everything.length;\n            everything = new Uint8Array(bytes.byteLength + tempLength);\n            everything.set(everything.subarray(0, tempLength));\n            everything.set(bytes, tempLength);\n          } else {\n            everything = bytes;\n          }\n\n          while (everything.length - byteIndex >= 3) {\n            if (everything[byteIndex] === 'I'.charCodeAt(0) && everything[byteIndex + 1] === 'D'.charCodeAt(0) && everything[byteIndex + 2] === '3'.charCodeAt(0)) {\n\n              // Exit early because we don't have enough to parse\n              // the ID3 tag header\n              if (everything.length - byteIndex < 10) {\n                break;\n              }\n\n              // check framesize\n              frameSize = this.parseId3TagSize(everything, byteIndex);\n\n              // Exit early if we don't have enough in the buffer\n              // to emit a full packet\n              if (frameSize > everything.length) {\n                break;\n              }\n              chunk = {\n                type: 'timed-metadata',\n                data: everything.subarray(byteIndex, byteIndex + frameSize)\n              };\n              this.trigger('data', chunk);\n              byteIndex += frameSize;\n              continue;\n            } else if (everything[byteIndex] & 0xff === 0xff && (everything[byteIndex + 1] & 0xf0) === 0xf0) {\n\n              // Exit early because we don't have enough to parse\n              // the ADTS frame header\n              if (everything.length - byteIndex < 7) {\n                break;\n              }\n\n              frameSize = this.parseAdtsSize(everything, byteIndex);\n\n              // Exit early if we don't have enough in the buffer\n              // to emit a full packet\n              if (frameSize > everything.length) {\n                break;\n              }\n\n              packet = {\n                type: 'audio',\n                data: everything.subarray(byteIndex, byteIndex + frameSize),\n                pts: timeStamp,\n                dts: timeStamp\n              };\n              this.trigger('data', packet);\n              byteIndex += frameSize;\n              continue;\n            }\n            byteIndex++;\n          }\n          bytesLeft = everything.length - byteIndex;\n\n          if (bytesLeft > 0) {\n            everything = everything.subarray(byteIndex);\n          } else {\n            everything = new Uint8Array();\n          }\n        };\n      };\n\n      _AacStream.prototype = new stream();\n\n      var aac = _AacStream;\n\n      var highPrefix = [33, 16, 5, 32, 164, 27];\n      var lowPrefix = [33, 65, 108, 84, 1, 2, 4, 8, 168, 2, 4, 8, 17, 191, 252];\n      var zeroFill = function zeroFill(count) {\n        var a = [];\n        while (count--) {\n          a.push(0);\n        }\n        return a;\n      };\n\n      var makeTable = function makeTable(metaTable) {\n        return Object.keys(metaTable).reduce(function (obj, key) {\n          obj[key] = new Uint8Array(metaTable[key].reduce(function (arr, part) {\n            return arr.concat(part);\n          }, []));\n          return obj;\n        }, {});\n      };\n\n      // Frames-of-silence to use for filling in missing AAC frames\n      var coneOfSilence = {\n        96000: [highPrefix, [227, 64], zeroFill(154), [56]],\n        88200: [highPrefix, [231], zeroFill(170), [56]],\n        64000: [highPrefix, [248, 192], zeroFill(240), [56]],\n        48000: [highPrefix, [255, 192], zeroFill(268), [55, 148, 128], zeroFill(54), [112]],\n        44100: [highPrefix, [255, 192], zeroFill(268), [55, 163, 128], zeroFill(84), [112]],\n        32000: [highPrefix, [255, 192], zeroFill(268), [55, 234], zeroFill(226), [112]],\n        24000: [highPrefix, [255, 192], zeroFill(268), [55, 255, 128], zeroFill(268), [111, 112], zeroFill(126), [224]],\n        16000: [highPrefix, [255, 192], zeroFill(268), [55, 255, 128], zeroFill(268), [111, 255], zeroFill(269), [223, 108], zeroFill(195), [1, 192]],\n        12000: [lowPrefix, zeroFill(268), [3, 127, 248], zeroFill(268), [6, 255, 240], zeroFill(268), [13, 255, 224], zeroFill(268), [27, 253, 128], zeroFill(259), [56]],\n        11025: [lowPrefix, zeroFill(268), [3, 127, 248], zeroFill(268), [6, 255, 240], zeroFill(268), [13, 255, 224], zeroFill(268), [27, 255, 192], zeroFill(268), [55, 175, 128], zeroFill(108), [112]],\n        8000: [lowPrefix, zeroFill(268), [3, 121, 16], zeroFill(47), [7]]\n      };\n\n      var silence = makeTable(coneOfSilence);\n\n      var ONE_SECOND_IN_TS = 90000,\n\n      // 90kHz clock\n      secondsToVideoTs,\n          secondsToAudioTs,\n          videoTsToSeconds,\n          audioTsToSeconds,\n          audioTsToVideoTs,\n          videoTsToAudioTs;\n\n      secondsToVideoTs = function secondsToVideoTs(seconds) {\n        return seconds * ONE_SECOND_IN_TS;\n      };\n\n      secondsToAudioTs = function secondsToAudioTs(seconds, sampleRate) {\n        return seconds * sampleRate;\n      };\n\n      videoTsToSeconds = function videoTsToSeconds(timestamp) {\n        return timestamp / ONE_SECOND_IN_TS;\n      };\n\n      audioTsToSeconds = function audioTsToSeconds(timestamp, sampleRate) {\n        return timestamp / sampleRate;\n      };\n\n      audioTsToVideoTs = function audioTsToVideoTs(timestamp, sampleRate) {\n        return secondsToVideoTs(audioTsToSeconds(timestamp, sampleRate));\n      };\n\n      videoTsToAudioTs = function videoTsToAudioTs(timestamp, sampleRate) {\n        return secondsToAudioTs(videoTsToSeconds(timestamp), sampleRate);\n      };\n\n      var clock = {\n        secondsToVideoTs: secondsToVideoTs,\n        secondsToAudioTs: secondsToAudioTs,\n        videoTsToSeconds: videoTsToSeconds,\n        audioTsToSeconds: audioTsToSeconds,\n        audioTsToVideoTs: audioTsToVideoTs,\n        videoTsToAudioTs: videoTsToAudioTs\n      };\n\n      var H264Stream = h264.H264Stream;\n\n      // constants\n      var AUDIO_PROPERTIES = ['audioobjecttype', 'channelcount', 'samplerate', 'samplingfrequencyindex', 'samplesize'];\n\n      var VIDEO_PROPERTIES = ['width', 'height', 'profileIdc', 'levelIdc', 'profileCompatibility'];\n\n      var ONE_SECOND_IN_TS$1 = 90000; // 90kHz clock\n\n      // object types\n      var _VideoSegmentStream, _AudioSegmentStream, _Transmuxer, _CoalesceStream;\n\n      // Helper functions\n      var createDefaultSample, isLikelyAacData, collectDtsInfo, clearDtsInfo, calculateTrackBaseMediaDecodeTime, arrayEquals, sumFrameByteLengths;\n\n      /**\n       * Default sample object\n       * see ISO/IEC 14496-12:2012, section 8.6.4.3\n       */\n      createDefaultSample = function createDefaultSample() {\n        return {\n          size: 0,\n          flags: {\n            isLeading: 0,\n            dependsOn: 1,\n            isDependedOn: 0,\n            hasRedundancy: 0,\n            degradationPriority: 0\n          }\n        };\n      };\n\n      isLikelyAacData = function isLikelyAacData(data) {\n        if (data[0] === 'I'.charCodeAt(0) && data[1] === 'D'.charCodeAt(0) && data[2] === '3'.charCodeAt(0)) {\n          return true;\n        }\n        return false;\n      };\n\n      /**\n       * Compare two arrays (even typed) for same-ness\n       */\n      arrayEquals = function arrayEquals(a, b) {\n        var i;\n\n        if (a.length !== b.length) {\n          return false;\n        }\n\n        // compare the value of each element in the array\n        for (i = 0; i < a.length; i++) {\n          if (a[i] !== b[i]) {\n            return false;\n          }\n        }\n\n        return true;\n      };\n\n      /**\n       * Sum the `byteLength` properties of the data in each AAC frame\n       */\n      sumFrameByteLengths = function sumFrameByteLengths(array) {\n        var i,\n            currentObj,\n            sum = 0;\n\n        // sum the byteLength's all each nal unit in the frame\n        for (i = 0; i < array.length; i++) {\n          currentObj = array[i];\n          sum += currentObj.data.byteLength;\n        }\n\n        return sum;\n      };\n\n      /**\n       * Constructs a single-track, ISO BMFF media segment from AAC data\n       * events. The output of this stream can be fed to a SourceBuffer\n       * configured with a suitable initialization segment.\n       * @param track {object} track metadata configuration\n       * @param options {object} transmuxer options object\n       * @param options.keepOriginalTimestamps {boolean} If true, keep the timestamps\n       *        in the source; false to adjust the first segment to start at 0.\n       */\n      _AudioSegmentStream = function AudioSegmentStream(track, options) {\n        var adtsFrames = [],\n            sequenceNumber = 0,\n            earliestAllowedDts = 0,\n            audioAppendStartTs = 0,\n            videoBaseMediaDecodeTime = Infinity;\n\n        options = options || {};\n\n        _AudioSegmentStream.prototype.init.call(this);\n\n        this.push = function (data) {\n          collectDtsInfo(track, data);\n\n          if (track) {\n            AUDIO_PROPERTIES.forEach(function (prop) {\n              track[prop] = data[prop];\n            });\n          }\n\n          // buffer audio data until end() is called\n          adtsFrames.push(data);\n        };\n\n        this.setEarliestDts = function (earliestDts) {\n          earliestAllowedDts = earliestDts - track.timelineStartInfo.baseMediaDecodeTime;\n        };\n\n        this.setVideoBaseMediaDecodeTime = function (baseMediaDecodeTime) {\n          videoBaseMediaDecodeTime = baseMediaDecodeTime;\n        };\n\n        this.setAudioAppendStart = function (timestamp) {\n          audioAppendStartTs = timestamp;\n        };\n\n        this.flush = function () {\n          var frames, moof, mdat, boxes;\n\n          // return early if no audio data has been observed\n          if (adtsFrames.length === 0) {\n            this.trigger('done', 'AudioSegmentStream');\n            return;\n          }\n\n          frames = this.trimAdtsFramesByEarliestDts_(adtsFrames);\n          track.baseMediaDecodeTime = calculateTrackBaseMediaDecodeTime(track, options.keepOriginalTimestamps);\n\n          this.prefixWithSilence_(track, frames);\n\n          // we have to build the index from byte locations to\n          // samples (that is, adts frames) in the audio data\n          track.samples = this.generateSampleTable_(frames);\n\n          // concatenate the audio data to constuct the mdat\n          mdat = mp4Generator.mdat(this.concatenateFrameData_(frames));\n\n          adtsFrames = [];\n\n          moof = mp4Generator.moof(sequenceNumber, [track]);\n          boxes = new Uint8Array(moof.byteLength + mdat.byteLength);\n\n          // bump the sequence number for next time\n          sequenceNumber++;\n\n          boxes.set(moof);\n          boxes.set(mdat, moof.byteLength);\n\n          clearDtsInfo(track);\n\n          this.trigger('data', { track: track, boxes: boxes });\n          this.trigger('done', 'AudioSegmentStream');\n        };\n\n        // Possibly pad (prefix) the audio track with silence if appending this track\n        // would lead to the introduction of a gap in the audio buffer\n        this.prefixWithSilence_ = function (track, frames) {\n          var baseMediaDecodeTimeTs,\n              frameDuration = 0,\n              audioGapDuration = 0,\n              audioFillFrameCount = 0,\n              audioFillDuration = 0,\n              silentFrame,\n              i;\n\n          if (!frames.length) {\n            return;\n          }\n\n          baseMediaDecodeTimeTs = clock.audioTsToVideoTs(track.baseMediaDecodeTime, track.samplerate);\n          // determine frame clock duration based on sample rate, round up to avoid overfills\n          frameDuration = Math.ceil(ONE_SECOND_IN_TS$1 / (track.samplerate / 1024));\n\n          if (audioAppendStartTs && videoBaseMediaDecodeTime) {\n            // insert the shortest possible amount (audio gap or audio to video gap)\n            audioGapDuration = baseMediaDecodeTimeTs - Math.max(audioAppendStartTs, videoBaseMediaDecodeTime);\n            // number of full frames in the audio gap\n            audioFillFrameCount = Math.floor(audioGapDuration / frameDuration);\n            audioFillDuration = audioFillFrameCount * frameDuration;\n          }\n\n          // don't attempt to fill gaps smaller than a single frame or larger\n          // than a half second\n          if (audioFillFrameCount < 1 || audioFillDuration > ONE_SECOND_IN_TS$1 / 2) {\n            return;\n          }\n\n          silentFrame = silence[track.samplerate];\n\n          if (!silentFrame) {\n            // we don't have a silent frame pregenerated for the sample rate, so use a frame\n            // from the content instead\n            silentFrame = frames[0].data;\n          }\n\n          for (i = 0; i < audioFillFrameCount; i++) {\n            frames.splice(i, 0, {\n              data: silentFrame\n            });\n          }\n\n          track.baseMediaDecodeTime -= Math.floor(clock.videoTsToAudioTs(audioFillDuration, track.samplerate));\n        };\n\n        // If the audio segment extends before the earliest allowed dts\n        // value, remove AAC frames until starts at or after the earliest\n        // allowed DTS so that we don't end up with a negative baseMedia-\n        // DecodeTime for the audio track\n        this.trimAdtsFramesByEarliestDts_ = function (adtsFrames) {\n          if (track.minSegmentDts >= earliestAllowedDts) {\n            return adtsFrames;\n          }\n\n          // We will need to recalculate the earliest segment Dts\n          track.minSegmentDts = Infinity;\n\n          return adtsFrames.filter(function (currentFrame) {\n            // If this is an allowed frame, keep it and record it's Dts\n            if (currentFrame.dts >= earliestAllowedDts) {\n              track.minSegmentDts = Math.min(track.minSegmentDts, currentFrame.dts);\n              track.minSegmentPts = track.minSegmentDts;\n              return true;\n            }\n            // Otherwise, discard it\n            return false;\n          });\n        };\n\n        // generate the track's raw mdat data from an array of frames\n        this.generateSampleTable_ = function (frames) {\n          var i,\n              currentFrame,\n              samples = [];\n\n          for (i = 0; i < frames.length; i++) {\n            currentFrame = frames[i];\n            samples.push({\n              size: currentFrame.data.byteLength,\n              duration: 1024 // For AAC audio, all samples contain 1024 samples\n            });\n          }\n          return samples;\n        };\n\n        // generate the track's sample table from an array of frames\n        this.concatenateFrameData_ = function (frames) {\n          var i,\n              currentFrame,\n              dataOffset = 0,\n              data = new Uint8Array(sumFrameByteLengths(frames));\n\n          for (i = 0; i < frames.length; i++) {\n            currentFrame = frames[i];\n\n            data.set(currentFrame.data, dataOffset);\n            dataOffset += currentFrame.data.byteLength;\n          }\n          return data;\n        };\n      };\n\n      _AudioSegmentStream.prototype = new stream();\n\n      /**\n       * Constructs a single-track, ISO BMFF media segment from H264 data\n       * events. The output of this stream can be fed to a SourceBuffer\n       * configured with a suitable initialization segment.\n       * @param track {object} track metadata configuration\n       * @param options {object} transmuxer options object\n       * @param options.alignGopsAtEnd {boolean} If true, start from the end of the\n       *        gopsToAlignWith list when attempting to align gop pts\n       * @param options.keepOriginalTimestamps {boolean} If true, keep the timestamps\n       *        in the source; false to adjust the first segment to start at 0.\n       */\n      _VideoSegmentStream = function VideoSegmentStream(track, options) {\n        var sequenceNumber = 0,\n            nalUnits = [],\n            gopsToAlignWith = [],\n            config,\n            pps;\n\n        options = options || {};\n\n        _VideoSegmentStream.prototype.init.call(this);\n\n        delete track.minPTS;\n\n        this.gopCache_ = [];\n\n        this.push = function (nalUnit) {\n          collectDtsInfo(track, nalUnit);\n\n          // record the track config\n          if (nalUnit.nalUnitType === 'seq_parameter_set_rbsp' && !config) {\n            config = nalUnit.config;\n            track.sps = [nalUnit.data];\n\n            VIDEO_PROPERTIES.forEach(function (prop) {\n              track[prop] = config[prop];\n            }, this);\n          }\n\n          if (nalUnit.nalUnitType === 'pic_parameter_set_rbsp' && !pps) {\n            pps = nalUnit.data;\n            track.pps = [nalUnit.data];\n          }\n\n          // buffer video until flush() is called\n          nalUnits.push(nalUnit);\n        };\n\n        this.flush = function () {\n          var frames, gopForFusion, gops, moof, mdat, boxes;\n\n          // Throw away nalUnits at the start of the byte stream until\n          // we find the first AUD\n          while (nalUnits.length) {\n            if (nalUnits[0].nalUnitType === 'access_unit_delimiter_rbsp') {\n              break;\n            }\n            nalUnits.shift();\n          }\n\n          // Return early if no video data has been observed\n          if (nalUnits.length === 0) {\n            this.resetStream_();\n            this.trigger('done', 'VideoSegmentStream');\n            return;\n          }\n\n          // Organize the raw nal-units into arrays that represent\n          // higher-level constructs such as frames and gops\n          // (group-of-pictures)\n          frames = this.groupNalsIntoFrames_(nalUnits);\n          gops = this.groupFramesIntoGops_(frames);\n\n          // If the first frame of this fragment is not a keyframe we have\n          // a problem since MSE (on Chrome) requires a leading keyframe.\n          //\n          // We have two approaches to repairing this situation:\n          // 1) GOP-FUSION:\n          //    This is where we keep track of the GOPS (group-of-pictures)\n          //    from previous fragments and attempt to find one that we can\n          //    prepend to the current fragment in order to create a valid\n          //    fragment.\n          // 2) KEYFRAME-PULLING:\n          //    Here we search for the first keyframe in the fragment and\n          //    throw away all the frames between the start of the fragment\n          //    and that keyframe. We then extend the duration and pull the\n          //    PTS of the keyframe forward so that it covers the time range\n          //    of the frames that were disposed of.\n          //\n          // #1 is far prefereable over #2 which can cause \"stuttering\" but\n          // requires more things to be just right.\n          if (!gops[0][0].keyFrame) {\n            // Search for a gop for fusion from our gopCache\n            gopForFusion = this.getGopForFusion_(nalUnits[0], track);\n\n            if (gopForFusion) {\n              gops.unshift(gopForFusion);\n              // Adjust Gops' metadata to account for the inclusion of the\n              // new gop at the beginning\n              gops.byteLength += gopForFusion.byteLength;\n              gops.nalCount += gopForFusion.nalCount;\n              gops.pts = gopForFusion.pts;\n              gops.dts = gopForFusion.dts;\n              gops.duration += gopForFusion.duration;\n            } else {\n              // If we didn't find a candidate gop fall back to keyframe-pulling\n              gops = this.extendFirstKeyFrame_(gops);\n            }\n          }\n\n          // Trim gops to align with gopsToAlignWith\n          if (gopsToAlignWith.length) {\n            var alignedGops;\n\n            if (options.alignGopsAtEnd) {\n              alignedGops = this.alignGopsAtEnd_(gops);\n            } else {\n              alignedGops = this.alignGopsAtStart_(gops);\n            }\n\n            if (!alignedGops) {\n              // save all the nals in the last GOP into the gop cache\n              this.gopCache_.unshift({\n                gop: gops.pop(),\n                pps: track.pps,\n                sps: track.sps\n              });\n\n              // Keep a maximum of 6 GOPs in the cache\n              this.gopCache_.length = Math.min(6, this.gopCache_.length);\n\n              // Clear nalUnits\n              nalUnits = [];\n\n              // return early no gops can be aligned with desired gopsToAlignWith\n              this.resetStream_();\n              this.trigger('done', 'VideoSegmentStream');\n              return;\n            }\n\n            // Some gops were trimmed. clear dts info so minSegmentDts and pts are correct\n            // when recalculated before sending off to CoalesceStream\n            clearDtsInfo(track);\n\n            gops = alignedGops;\n          }\n\n          collectDtsInfo(track, gops);\n\n          // First, we have to build the index from byte locations to\n          // samples (that is, frames) in the video data\n          track.samples = this.generateSampleTable_(gops);\n\n          // Concatenate the video data and construct the mdat\n          mdat = mp4Generator.mdat(this.concatenateNalData_(gops));\n\n          track.baseMediaDecodeTime = calculateTrackBaseMediaDecodeTime(track, options.keepOriginalTimestamps);\n\n          this.trigger('processedGopsInfo', gops.map(function (gop) {\n            return {\n              pts: gop.pts,\n              dts: gop.dts,\n              byteLength: gop.byteLength\n            };\n          }));\n\n          // save all the nals in the last GOP into the gop cache\n          this.gopCache_.unshift({\n            gop: gops.pop(),\n            pps: track.pps,\n            sps: track.sps\n          });\n\n          // Keep a maximum of 6 GOPs in the cache\n          this.gopCache_.length = Math.min(6, this.gopCache_.length);\n\n          // Clear nalUnits\n          nalUnits = [];\n\n          this.trigger('baseMediaDecodeTime', track.baseMediaDecodeTime);\n          this.trigger('timelineStartInfo', track.timelineStartInfo);\n\n          moof = mp4Generator.moof(sequenceNumber, [track]);\n\n          // it would be great to allocate this array up front instead of\n          // throwing away hundreds of media segment fragments\n          boxes = new Uint8Array(moof.byteLength + mdat.byteLength);\n\n          // Bump the sequence number for next time\n          sequenceNumber++;\n\n          boxes.set(moof);\n          boxes.set(mdat, moof.byteLength);\n\n          this.trigger('data', { track: track, boxes: boxes });\n\n          this.resetStream_();\n\n          // Continue with the flush process now\n          this.trigger('done', 'VideoSegmentStream');\n        };\n\n        this.resetStream_ = function () {\n          clearDtsInfo(track);\n\n          // reset config and pps because they may differ across segments\n          // for instance, when we are rendition switching\n          config = undefined;\n          pps = undefined;\n        };\n\n        // Search for a candidate Gop for gop-fusion from the gop cache and\n        // return it or return null if no good candidate was found\n        this.getGopForFusion_ = function (nalUnit) {\n          var halfSecond = 45000,\n\n          // Half-a-second in a 90khz clock\n          allowableOverlap = 10000,\n\n          // About 3 frames @ 30fps\n          nearestDistance = Infinity,\n              dtsDistance,\n              nearestGopObj,\n              currentGop,\n              currentGopObj,\n              i;\n\n          // Search for the GOP nearest to the beginning of this nal unit\n          for (i = 0; i < this.gopCache_.length; i++) {\n            currentGopObj = this.gopCache_[i];\n            currentGop = currentGopObj.gop;\n\n            // Reject Gops with different SPS or PPS\n            if (!(track.pps && arrayEquals(track.pps[0], currentGopObj.pps[0])) || !(track.sps && arrayEquals(track.sps[0], currentGopObj.sps[0]))) {\n              continue;\n            }\n\n            // Reject Gops that would require a negative baseMediaDecodeTime\n            if (currentGop.dts < track.timelineStartInfo.dts) {\n              continue;\n            }\n\n            // The distance between the end of the gop and the start of the nalUnit\n            dtsDistance = nalUnit.dts - currentGop.dts - currentGop.duration;\n\n            // Only consider GOPS that start before the nal unit and end within\n            // a half-second of the nal unit\n            if (dtsDistance >= -allowableOverlap && dtsDistance <= halfSecond) {\n\n              // Always use the closest GOP we found if there is more than\n              // one candidate\n              if (!nearestGopObj || nearestDistance > dtsDistance) {\n                nearestGopObj = currentGopObj;\n                nearestDistance = dtsDistance;\n              }\n            }\n          }\n\n          if (nearestGopObj) {\n            return nearestGopObj.gop;\n          }\n          return null;\n        };\n\n        this.extendFirstKeyFrame_ = function (gops) {\n          var currentGop;\n\n          if (!gops[0][0].keyFrame && gops.length > 1) {\n            // Remove the first GOP\n            currentGop = gops.shift();\n\n            gops.byteLength -= currentGop.byteLength;\n            gops.nalCount -= currentGop.nalCount;\n\n            // Extend the first frame of what is now the\n            // first gop to cover the time period of the\n            // frames we just removed\n            gops[0][0].dts = currentGop.dts;\n            gops[0][0].pts = currentGop.pts;\n            gops[0][0].duration += currentGop.duration;\n          }\n\n          return gops;\n        };\n\n        // Convert an array of nal units into an array of frames with each frame being\n        // composed of the nal units that make up that frame\n        // Also keep track of cummulative data about the frame from the nal units such\n        // as the frame duration, starting pts, etc.\n        this.groupNalsIntoFrames_ = function (nalUnits) {\n          var i,\n              currentNal,\n              currentFrame = [],\n              frames = [];\n\n          currentFrame.byteLength = 0;\n\n          for (i = 0; i < nalUnits.length; i++) {\n            currentNal = nalUnits[i];\n\n            // Split on 'aud'-type nal units\n            if (currentNal.nalUnitType === 'access_unit_delimiter_rbsp') {\n              // Since the very first nal unit is expected to be an AUD\n              // only push to the frames array when currentFrame is not empty\n              if (currentFrame.length) {\n                currentFrame.duration = currentNal.dts - currentFrame.dts;\n                frames.push(currentFrame);\n              }\n              currentFrame = [currentNal];\n              currentFrame.byteLength = currentNal.data.byteLength;\n              currentFrame.pts = currentNal.pts;\n              currentFrame.dts = currentNal.dts;\n            } else {\n              // Specifically flag key frames for ease of use later\n              if (currentNal.nalUnitType === 'slice_layer_without_partitioning_rbsp_idr') {\n                currentFrame.keyFrame = true;\n              }\n              currentFrame.duration = currentNal.dts - currentFrame.dts;\n              currentFrame.byteLength += currentNal.data.byteLength;\n              currentFrame.push(currentNal);\n            }\n          }\n\n          // For the last frame, use the duration of the previous frame if we\n          // have nothing better to go on\n          if (frames.length && (!currentFrame.duration || currentFrame.duration <= 0)) {\n            currentFrame.duration = frames[frames.length - 1].duration;\n          }\n\n          // Push the final frame\n          frames.push(currentFrame);\n          return frames;\n        };\n\n        // Convert an array of frames into an array of Gop with each Gop being composed\n        // of the frames that make up that Gop\n        // Also keep track of cummulative data about the Gop from the frames such as the\n        // Gop duration, starting pts, etc.\n        this.groupFramesIntoGops_ = function (frames) {\n          var i,\n              currentFrame,\n              currentGop = [],\n              gops = [];\n\n          // We must pre-set some of the values on the Gop since we\n          // keep running totals of these values\n          currentGop.byteLength = 0;\n          currentGop.nalCount = 0;\n          currentGop.duration = 0;\n          currentGop.pts = frames[0].pts;\n          currentGop.dts = frames[0].dts;\n\n          // store some metadata about all the Gops\n          gops.byteLength = 0;\n          gops.nalCount = 0;\n          gops.duration = 0;\n          gops.pts = frames[0].pts;\n          gops.dts = frames[0].dts;\n\n          for (i = 0; i < frames.length; i++) {\n            currentFrame = frames[i];\n\n            if (currentFrame.keyFrame) {\n              // Since the very first frame is expected to be an keyframe\n              // only push to the gops array when currentGop is not empty\n              if (currentGop.length) {\n                gops.push(currentGop);\n                gops.byteLength += currentGop.byteLength;\n                gops.nalCount += currentGop.nalCount;\n                gops.duration += currentGop.duration;\n              }\n\n              currentGop = [currentFrame];\n              currentGop.nalCount = currentFrame.length;\n              currentGop.byteLength = currentFrame.byteLength;\n              currentGop.pts = currentFrame.pts;\n              currentGop.dts = currentFrame.dts;\n              currentGop.duration = currentFrame.duration;\n            } else {\n              currentGop.duration += currentFrame.duration;\n              currentGop.nalCount += currentFrame.length;\n              currentGop.byteLength += currentFrame.byteLength;\n              currentGop.push(currentFrame);\n            }\n          }\n\n          if (gops.length && currentGop.duration <= 0) {\n            currentGop.duration = gops[gops.length - 1].duration;\n          }\n          gops.byteLength += currentGop.byteLength;\n          gops.nalCount += currentGop.nalCount;\n          gops.duration += currentGop.duration;\n\n          // push the final Gop\n          gops.push(currentGop);\n          return gops;\n        };\n\n        // generate the track's sample table from an array of gops\n        this.generateSampleTable_ = function (gops, baseDataOffset) {\n          var h,\n              i,\n              sample,\n              currentGop,\n              currentFrame,\n              dataOffset = baseDataOffset || 0,\n              samples = [];\n\n          for (h = 0; h < gops.length; h++) {\n            currentGop = gops[h];\n\n            for (i = 0; i < currentGop.length; i++) {\n              currentFrame = currentGop[i];\n\n              sample = createDefaultSample();\n\n              sample.dataOffset = dataOffset;\n              sample.compositionTimeOffset = currentFrame.pts - currentFrame.dts;\n              sample.duration = currentFrame.duration;\n              sample.size = 4 * currentFrame.length; // Space for nal unit size\n              sample.size += currentFrame.byteLength;\n\n              if (currentFrame.keyFrame) {\n                sample.flags.dependsOn = 2;\n              }\n\n              dataOffset += sample.size;\n\n              samples.push(sample);\n            }\n          }\n          return samples;\n        };\n\n        // generate the track's raw mdat data from an array of gops\n        this.concatenateNalData_ = function (gops) {\n          var h,\n              i,\n              j,\n              currentGop,\n              currentFrame,\n              currentNal,\n              dataOffset = 0,\n              nalsByteLength = gops.byteLength,\n              numberOfNals = gops.nalCount,\n              totalByteLength = nalsByteLength + 4 * numberOfNals,\n              data = new Uint8Array(totalByteLength),\n              view = new DataView(data.buffer);\n\n          // For each Gop..\n          for (h = 0; h < gops.length; h++) {\n            currentGop = gops[h];\n\n            // For each Frame..\n            for (i = 0; i < currentGop.length; i++) {\n              currentFrame = currentGop[i];\n\n              // For each NAL..\n              for (j = 0; j < currentFrame.length; j++) {\n                currentNal = currentFrame[j];\n\n                view.setUint32(dataOffset, currentNal.data.byteLength);\n                dataOffset += 4;\n                data.set(currentNal.data, dataOffset);\n                dataOffset += currentNal.data.byteLength;\n              }\n            }\n          }\n          return data;\n        };\n\n        // trim gop list to the first gop found that has a matching pts with a gop in the list\n        // of gopsToAlignWith starting from the START of the list\n        this.alignGopsAtStart_ = function (gops) {\n          var alignIndex, gopIndex, align, gop, byteLength, nalCount, duration, alignedGops;\n\n          byteLength = gops.byteLength;\n          nalCount = gops.nalCount;\n          duration = gops.duration;\n          alignIndex = gopIndex = 0;\n\n          while (alignIndex < gopsToAlignWith.length && gopIndex < gops.length) {\n            align = gopsToAlignWith[alignIndex];\n            gop = gops[gopIndex];\n\n            if (align.pts === gop.pts) {\n              break;\n            }\n\n            if (gop.pts > align.pts) {\n              // this current gop starts after the current gop we want to align on, so increment\n              // align index\n              alignIndex++;\n              continue;\n            }\n\n            // current gop starts before the current gop we want to align on. so increment gop\n            // index\n            gopIndex++;\n            byteLength -= gop.byteLength;\n            nalCount -= gop.nalCount;\n            duration -= gop.duration;\n          }\n\n          if (gopIndex === 0) {\n            // no gops to trim\n            return gops;\n          }\n\n          if (gopIndex === gops.length) {\n            // all gops trimmed, skip appending all gops\n            return null;\n          }\n\n          alignedGops = gops.slice(gopIndex);\n          alignedGops.byteLength = byteLength;\n          alignedGops.duration = duration;\n          alignedGops.nalCount = nalCount;\n          alignedGops.pts = alignedGops[0].pts;\n          alignedGops.dts = alignedGops[0].dts;\n\n          return alignedGops;\n        };\n\n        // trim gop list to the first gop found that has a matching pts with a gop in the list\n        // of gopsToAlignWith starting from the END of the list\n        this.alignGopsAtEnd_ = function (gops) {\n          var alignIndex, gopIndex, align, gop, alignEndIndex, matchFound;\n\n          alignIndex = gopsToAlignWith.length - 1;\n          gopIndex = gops.length - 1;\n          alignEndIndex = null;\n          matchFound = false;\n\n          while (alignIndex >= 0 && gopIndex >= 0) {\n            align = gopsToAlignWith[alignIndex];\n            gop = gops[gopIndex];\n\n            if (align.pts === gop.pts) {\n              matchFound = true;\n              break;\n            }\n\n            if (align.pts > gop.pts) {\n              alignIndex--;\n              continue;\n            }\n\n            if (alignIndex === gopsToAlignWith.length - 1) {\n              // gop.pts is greater than the last alignment candidate. If no match is found\n              // by the end of this loop, we still want to append gops that come after this\n              // point\n              alignEndIndex = gopIndex;\n            }\n\n            gopIndex--;\n          }\n\n          if (!matchFound && alignEndIndex === null) {\n            return null;\n          }\n\n          var trimIndex;\n\n          if (matchFound) {\n            trimIndex = gopIndex;\n          } else {\n            trimIndex = alignEndIndex;\n          }\n\n          if (trimIndex === 0) {\n            return gops;\n          }\n\n          var alignedGops = gops.slice(trimIndex);\n          var metadata = alignedGops.reduce(function (total, gop) {\n            total.byteLength += gop.byteLength;\n            total.duration += gop.duration;\n            total.nalCount += gop.nalCount;\n            return total;\n          }, { byteLength: 0, duration: 0, nalCount: 0 });\n\n          alignedGops.byteLength = metadata.byteLength;\n          alignedGops.duration = metadata.duration;\n          alignedGops.nalCount = metadata.nalCount;\n          alignedGops.pts = alignedGops[0].pts;\n          alignedGops.dts = alignedGops[0].dts;\n\n          return alignedGops;\n        };\n\n        this.alignGopsWith = function (newGopsToAlignWith) {\n          gopsToAlignWith = newGopsToAlignWith;\n        };\n      };\n\n      _VideoSegmentStream.prototype = new stream();\n\n      /**\n       * Store information about the start and end of the track and the\n       * duration for each frame/sample we process in order to calculate\n       * the baseMediaDecodeTime\n       */\n      collectDtsInfo = function collectDtsInfo(track, data) {\n        if (typeof data.pts === 'number') {\n          if (track.timelineStartInfo.pts === undefined) {\n            track.timelineStartInfo.pts = data.pts;\n          }\n\n          if (track.minSegmentPts === undefined) {\n            track.minSegmentPts = data.pts;\n          } else {\n            track.minSegmentPts = Math.min(track.minSegmentPts, data.pts);\n          }\n\n          if (track.maxSegmentPts === undefined) {\n            track.maxSegmentPts = data.pts;\n          } else {\n            track.maxSegmentPts = Math.max(track.maxSegmentPts, data.pts);\n          }\n        }\n\n        if (typeof data.dts === 'number') {\n          if (track.timelineStartInfo.dts === undefined) {\n            track.timelineStartInfo.dts = data.dts;\n          }\n\n          if (track.minSegmentDts === undefined) {\n            track.minSegmentDts = data.dts;\n          } else {\n            track.minSegmentDts = Math.min(track.minSegmentDts, data.dts);\n          }\n\n          if (track.maxSegmentDts === undefined) {\n            track.maxSegmentDts = data.dts;\n          } else {\n            track.maxSegmentDts = Math.max(track.maxSegmentDts, data.dts);\n          }\n        }\n      };\n\n      /**\n       * Clear values used to calculate the baseMediaDecodeTime between\n       * tracks\n       */\n      clearDtsInfo = function clearDtsInfo(track) {\n        delete track.minSegmentDts;\n        delete track.maxSegmentDts;\n        delete track.minSegmentPts;\n        delete track.maxSegmentPts;\n      };\n\n      /**\n       * Calculate the track's baseMediaDecodeTime based on the earliest\n       * DTS the transmuxer has ever seen and the minimum DTS for the\n       * current track\n       * @param track {object} track metadata configuration\n       * @param keepOriginalTimestamps {boolean} If true, keep the timestamps\n       *        in the source; false to adjust the first segment to start at 0.\n       */\n      calculateTrackBaseMediaDecodeTime = function calculateTrackBaseMediaDecodeTime(track, keepOriginalTimestamps) {\n        var baseMediaDecodeTime,\n            scale,\n            minSegmentDts = track.minSegmentDts;\n\n        // Optionally adjust the time so the first segment starts at zero.\n        if (!keepOriginalTimestamps) {\n          minSegmentDts -= track.timelineStartInfo.dts;\n        }\n\n        // track.timelineStartInfo.baseMediaDecodeTime is the location, in time, where\n        // we want the start of the first segment to be placed\n        baseMediaDecodeTime = track.timelineStartInfo.baseMediaDecodeTime;\n\n        // Add to that the distance this segment is from the very first\n        baseMediaDecodeTime += minSegmentDts;\n\n        // baseMediaDecodeTime must not become negative\n        baseMediaDecodeTime = Math.max(0, baseMediaDecodeTime);\n\n        if (track.type === 'audio') {\n          // Audio has a different clock equal to the sampling_rate so we need to\n          // scale the PTS values into the clock rate of the track\n          scale = track.samplerate / ONE_SECOND_IN_TS$1;\n          baseMediaDecodeTime *= scale;\n          baseMediaDecodeTime = Math.floor(baseMediaDecodeTime);\n        }\n\n        return baseMediaDecodeTime;\n      };\n\n      /**\n       * A Stream that can combine multiple streams (ie. audio & video)\n       * into a single output segment for MSE. Also supports audio-only\n       * and video-only streams.\n       */\n      _CoalesceStream = function CoalesceStream(options, metadataStream) {\n        // Number of Tracks per output segment\n        // If greater than 1, we combine multiple\n        // tracks into a single segment\n        this.numberOfTracks = 0;\n        this.metadataStream = metadataStream;\n\n        if (typeof options.remux !== 'undefined') {\n          this.remuxTracks = !!options.remux;\n        } else {\n          this.remuxTracks = true;\n        }\n\n        this.pendingTracks = [];\n        this.videoTrack = null;\n        this.pendingBoxes = [];\n        this.pendingCaptions = [];\n        this.pendingMetadata = [];\n        this.pendingBytes = 0;\n        this.emittedTracks = 0;\n\n        _CoalesceStream.prototype.init.call(this);\n\n        // Take output from multiple\n        this.push = function (output) {\n          // buffer incoming captions until the associated video segment\n          // finishes\n          if (output.text) {\n            return this.pendingCaptions.push(output);\n          }\n          // buffer incoming id3 tags until the final flush\n          if (output.frames) {\n            return this.pendingMetadata.push(output);\n          }\n\n          // Add this track to the list of pending tracks and store\n          // important information required for the construction of\n          // the final segment\n          this.pendingTracks.push(output.track);\n          this.pendingBoxes.push(output.boxes);\n          this.pendingBytes += output.boxes.byteLength;\n\n          if (output.track.type === 'video') {\n            this.videoTrack = output.track;\n          }\n          if (output.track.type === 'audio') {\n            this.audioTrack = output.track;\n          }\n        };\n      };\n\n      _CoalesceStream.prototype = new stream();\n      _CoalesceStream.prototype.flush = function (flushSource) {\n        var offset = 0,\n            event = {\n          captions: [],\n          captionStreams: {},\n          metadata: [],\n          info: {}\n        },\n            caption,\n            id3,\n            initSegment,\n            timelineStartPts = 0,\n            i;\n\n        if (this.pendingTracks.length < this.numberOfTracks) {\n          if (flushSource !== 'VideoSegmentStream' && flushSource !== 'AudioSegmentStream') {\n            // Return because we haven't received a flush from a data-generating\n            // portion of the segment (meaning that we have only recieved meta-data\n            // or captions.)\n            return;\n          } else if (this.remuxTracks) {\n            // Return until we have enough tracks from the pipeline to remux (if we\n            // are remuxing audio and video into a single MP4)\n            return;\n          } else if (this.pendingTracks.length === 0) {\n            // In the case where we receive a flush without any data having been\n            // received we consider it an emitted track for the purposes of coalescing\n            // `done` events.\n            // We do this for the case where there is an audio and video track in the\n            // segment but no audio data. (seen in several playlists with alternate\n            // audio tracks and no audio present in the main TS segments.)\n            this.emittedTracks++;\n\n            if (this.emittedTracks >= this.numberOfTracks) {\n              this.trigger('done');\n              this.emittedTracks = 0;\n            }\n            return;\n          }\n        }\n\n        if (this.videoTrack) {\n          timelineStartPts = this.videoTrack.timelineStartInfo.pts;\n          VIDEO_PROPERTIES.forEach(function (prop) {\n            event.info[prop] = this.videoTrack[prop];\n          }, this);\n        } else if (this.audioTrack) {\n          timelineStartPts = this.audioTrack.timelineStartInfo.pts;\n          AUDIO_PROPERTIES.forEach(function (prop) {\n            event.info[prop] = this.audioTrack[prop];\n          }, this);\n        }\n\n        if (this.pendingTracks.length === 1) {\n          event.type = this.pendingTracks[0].type;\n        } else {\n          event.type = 'combined';\n        }\n\n        this.emittedTracks += this.pendingTracks.length;\n\n        initSegment = mp4Generator.initSegment(this.pendingTracks);\n\n        // Create a new typed array to hold the init segment\n        event.initSegment = new Uint8Array(initSegment.byteLength);\n\n        // Create an init segment containing a moov\n        // and track definitions\n        event.initSegment.set(initSegment);\n\n        // Create a new typed array to hold the moof+mdats\n        event.data = new Uint8Array(this.pendingBytes);\n\n        // Append each moof+mdat (one per track) together\n        for (i = 0; i < this.pendingBoxes.length; i++) {\n          event.data.set(this.pendingBoxes[i], offset);\n          offset += this.pendingBoxes[i].byteLength;\n        }\n\n        // Translate caption PTS times into second offsets into the\n        // video timeline for the segment, and add track info\n        for (i = 0; i < this.pendingCaptions.length; i++) {\n          caption = this.pendingCaptions[i];\n          caption.startTime = caption.startPts - timelineStartPts;\n          caption.startTime /= 90e3;\n          caption.endTime = caption.endPts - timelineStartPts;\n          caption.endTime /= 90e3;\n          event.captionStreams[caption.stream] = true;\n          event.captions.push(caption);\n        }\n\n        // Translate ID3 frame PTS times into second offsets into the\n        // video timeline for the segment\n        for (i = 0; i < this.pendingMetadata.length; i++) {\n          id3 = this.pendingMetadata[i];\n          id3.cueTime = id3.pts - timelineStartPts;\n          id3.cueTime /= 90e3;\n          event.metadata.push(id3);\n        }\n        // We add this to every single emitted segment even though we only need\n        // it for the first\n        event.metadata.dispatchType = this.metadataStream.dispatchType;\n\n        // Reset stream state\n        this.pendingTracks.length = 0;\n        this.videoTrack = null;\n        this.pendingBoxes.length = 0;\n        this.pendingCaptions.length = 0;\n        this.pendingBytes = 0;\n        this.pendingMetadata.length = 0;\n\n        // Emit the built segment\n        this.trigger('data', event);\n\n        // Only emit `done` if all tracks have been flushed and emitted\n        if (this.emittedTracks >= this.numberOfTracks) {\n          this.trigger('done');\n          this.emittedTracks = 0;\n        }\n      };\n      /**\n       * A Stream that expects MP2T binary data as input and produces\n       * corresponding media segments, suitable for use with Media Source\n       * Extension (MSE) implementations that support the ISO BMFF byte\n       * stream format, like Chrome.\n       */\n      _Transmuxer = function Transmuxer(options) {\n        var self = this,\n            hasFlushed = true,\n            videoTrack,\n            audioTrack;\n\n        _Transmuxer.prototype.init.call(this);\n\n        options = options || {};\n        this.baseMediaDecodeTime = options.baseMediaDecodeTime || 0;\n        this.transmuxPipeline_ = {};\n\n        this.setupAacPipeline = function () {\n          var pipeline = {};\n          this.transmuxPipeline_ = pipeline;\n\n          pipeline.type = 'aac';\n          pipeline.metadataStream = new m2ts_1.MetadataStream();\n\n          // set up the parsing pipeline\n          pipeline.aacStream = new aac();\n          pipeline.audioTimestampRolloverStream = new m2ts_1.TimestampRolloverStream('audio');\n          pipeline.timedMetadataTimestampRolloverStream = new m2ts_1.TimestampRolloverStream('timed-metadata');\n          pipeline.adtsStream = new adts();\n          pipeline.coalesceStream = new _CoalesceStream(options, pipeline.metadataStream);\n          pipeline.headOfPipeline = pipeline.aacStream;\n\n          pipeline.aacStream.pipe(pipeline.audioTimestampRolloverStream).pipe(pipeline.adtsStream);\n          pipeline.aacStream.pipe(pipeline.timedMetadataTimestampRolloverStream).pipe(pipeline.metadataStream).pipe(pipeline.coalesceStream);\n\n          pipeline.metadataStream.on('timestamp', function (frame) {\n            pipeline.aacStream.setTimestamp(frame.timeStamp);\n          });\n\n          pipeline.aacStream.on('data', function (data) {\n            if (data.type === 'timed-metadata' && !pipeline.audioSegmentStream) {\n              audioTrack = audioTrack || {\n                timelineStartInfo: {\n                  baseMediaDecodeTime: self.baseMediaDecodeTime\n                },\n                codec: 'adts',\n                type: 'audio'\n              };\n              // hook up the audio segment stream to the first track with aac data\n              pipeline.coalesceStream.numberOfTracks++;\n              pipeline.audioSegmentStream = new _AudioSegmentStream(audioTrack, options);\n              // Set up the final part of the audio pipeline\n              pipeline.adtsStream.pipe(pipeline.audioSegmentStream).pipe(pipeline.coalesceStream);\n            }\n          });\n\n          // Re-emit any data coming from the coalesce stream to the outside world\n          pipeline.coalesceStream.on('data', this.trigger.bind(this, 'data'));\n          // Let the consumer know we have finished flushing the entire pipeline\n          pipeline.coalesceStream.on('done', this.trigger.bind(this, 'done'));\n        };\n\n        this.setupTsPipeline = function () {\n          var pipeline = {};\n          this.transmuxPipeline_ = pipeline;\n\n          pipeline.type = 'ts';\n          pipeline.metadataStream = new m2ts_1.MetadataStream();\n\n          // set up the parsing pipeline\n          pipeline.packetStream = new m2ts_1.TransportPacketStream();\n          pipeline.parseStream = new m2ts_1.TransportParseStream();\n          pipeline.elementaryStream = new m2ts_1.ElementaryStream();\n          pipeline.videoTimestampRolloverStream = new m2ts_1.TimestampRolloverStream('video');\n          pipeline.audioTimestampRolloverStream = new m2ts_1.TimestampRolloverStream('audio');\n          pipeline.timedMetadataTimestampRolloverStream = new m2ts_1.TimestampRolloverStream('timed-metadata');\n          pipeline.adtsStream = new adts();\n          pipeline.h264Stream = new H264Stream();\n          pipeline.captionStream = new m2ts_1.CaptionStream();\n          pipeline.coalesceStream = new _CoalesceStream(options, pipeline.metadataStream);\n          pipeline.headOfPipeline = pipeline.packetStream;\n\n          // disassemble MPEG2-TS packets into elementary streams\n          pipeline.packetStream.pipe(pipeline.parseStream).pipe(pipeline.elementaryStream);\n\n          // !!THIS ORDER IS IMPORTANT!!\n          // demux the streams\n          pipeline.elementaryStream.pipe(pipeline.videoTimestampRolloverStream).pipe(pipeline.h264Stream);\n          pipeline.elementaryStream.pipe(pipeline.audioTimestampRolloverStream).pipe(pipeline.adtsStream);\n\n          pipeline.elementaryStream.pipe(pipeline.timedMetadataTimestampRolloverStream).pipe(pipeline.metadataStream).pipe(pipeline.coalesceStream);\n\n          // Hook up CEA-608/708 caption stream\n          pipeline.h264Stream.pipe(pipeline.captionStream).pipe(pipeline.coalesceStream);\n\n          pipeline.elementaryStream.on('data', function (data) {\n            var i;\n\n            if (data.type === 'metadata') {\n              i = data.tracks.length;\n\n              // scan the tracks listed in the metadata\n              while (i--) {\n                if (!videoTrack && data.tracks[i].type === 'video') {\n                  videoTrack = data.tracks[i];\n                  videoTrack.timelineStartInfo.baseMediaDecodeTime = self.baseMediaDecodeTime;\n                } else if (!audioTrack && data.tracks[i].type === 'audio') {\n                  audioTrack = data.tracks[i];\n                  audioTrack.timelineStartInfo.baseMediaDecodeTime = self.baseMediaDecodeTime;\n                }\n              }\n\n              // hook up the video segment stream to the first track with h264 data\n              if (videoTrack && !pipeline.videoSegmentStream) {\n                pipeline.coalesceStream.numberOfTracks++;\n                pipeline.videoSegmentStream = new _VideoSegmentStream(videoTrack, options);\n\n                pipeline.videoSegmentStream.on('timelineStartInfo', function (timelineStartInfo) {\n                  // When video emits timelineStartInfo data after a flush, we forward that\n                  // info to the AudioSegmentStream, if it exists, because video timeline\n                  // data takes precedence.\n                  if (audioTrack) {\n                    audioTrack.timelineStartInfo = timelineStartInfo;\n                    // On the first segment we trim AAC frames that exist before the\n                    // very earliest DTS we have seen in video because Chrome will\n                    // interpret any video track with a baseMediaDecodeTime that is\n                    // non-zero as a gap.\n                    pipeline.audioSegmentStream.setEarliestDts(timelineStartInfo.dts);\n                  }\n                });\n\n                pipeline.videoSegmentStream.on('processedGopsInfo', self.trigger.bind(self, 'gopInfo'));\n\n                pipeline.videoSegmentStream.on('baseMediaDecodeTime', function (baseMediaDecodeTime) {\n                  if (audioTrack) {\n                    pipeline.audioSegmentStream.setVideoBaseMediaDecodeTime(baseMediaDecodeTime);\n                  }\n                });\n\n                // Set up the final part of the video pipeline\n                pipeline.h264Stream.pipe(pipeline.videoSegmentStream).pipe(pipeline.coalesceStream);\n              }\n\n              if (audioTrack && !pipeline.audioSegmentStream) {\n                // hook up the audio segment stream to the first track with aac data\n                pipeline.coalesceStream.numberOfTracks++;\n                pipeline.audioSegmentStream = new _AudioSegmentStream(audioTrack, options);\n\n                // Set up the final part of the audio pipeline\n                pipeline.adtsStream.pipe(pipeline.audioSegmentStream).pipe(pipeline.coalesceStream);\n              }\n            }\n          });\n\n          // Re-emit any data coming from the coalesce stream to the outside world\n          pipeline.coalesceStream.on('data', this.trigger.bind(this, 'data'));\n          // Let the consumer know we have finished flushing the entire pipeline\n          pipeline.coalesceStream.on('done', this.trigger.bind(this, 'done'));\n        };\n\n        // hook up the segment streams once track metadata is delivered\n        this.setBaseMediaDecodeTime = function (baseMediaDecodeTime) {\n          var pipeline = this.transmuxPipeline_;\n\n          this.baseMediaDecodeTime = baseMediaDecodeTime;\n          if (audioTrack) {\n            audioTrack.timelineStartInfo.dts = undefined;\n            audioTrack.timelineStartInfo.pts = undefined;\n            clearDtsInfo(audioTrack);\n            audioTrack.timelineStartInfo.baseMediaDecodeTime = baseMediaDecodeTime;\n            if (pipeline.audioTimestampRolloverStream) {\n              pipeline.audioTimestampRolloverStream.discontinuity();\n            }\n          }\n          if (videoTrack) {\n            if (pipeline.videoSegmentStream) {\n              pipeline.videoSegmentStream.gopCache_ = [];\n              pipeline.videoTimestampRolloverStream.discontinuity();\n            }\n            videoTrack.timelineStartInfo.dts = undefined;\n            videoTrack.timelineStartInfo.pts = undefined;\n            clearDtsInfo(videoTrack);\n            pipeline.captionStream.reset();\n            videoTrack.timelineStartInfo.baseMediaDecodeTime = baseMediaDecodeTime;\n          }\n\n          if (pipeline.timedMetadataTimestampRolloverStream) {\n            pipeline.timedMetadataTimestampRolloverStream.discontinuity();\n          }\n        };\n\n        this.setAudioAppendStart = function (timestamp) {\n          if (audioTrack) {\n            this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(timestamp);\n          }\n        };\n\n        this.alignGopsWith = function (gopsToAlignWith) {\n          if (videoTrack && this.transmuxPipeline_.videoSegmentStream) {\n            this.transmuxPipeline_.videoSegmentStream.alignGopsWith(gopsToAlignWith);\n          }\n        };\n\n        // feed incoming data to the front of the parsing pipeline\n        this.push = function (data) {\n          if (hasFlushed) {\n            var isAac = isLikelyAacData(data);\n\n            if (isAac && this.transmuxPipeline_.type !== 'aac') {\n              this.setupAacPipeline();\n            } else if (!isAac && this.transmuxPipeline_.type !== 'ts') {\n              this.setupTsPipeline();\n            }\n            hasFlushed = false;\n          }\n          this.transmuxPipeline_.headOfPipeline.push(data);\n        };\n\n        // flush any buffered data\n        this.flush = function () {\n          hasFlushed = true;\n          // Start at the top of the pipeline and flush all pending work\n          this.transmuxPipeline_.headOfPipeline.flush();\n        };\n\n        // Caption data has to be reset when seeking outside buffered range\n        this.resetCaptions = function () {\n          if (this.transmuxPipeline_.captionStream) {\n            this.transmuxPipeline_.captionStream.reset();\n          }\n        };\n      };\n      _Transmuxer.prototype = new stream();\n\n      var transmuxer = {\n        Transmuxer: _Transmuxer,\n        VideoSegmentStream: _VideoSegmentStream,\n        AudioSegmentStream: _AudioSegmentStream,\n        AUDIO_PROPERTIES: AUDIO_PROPERTIES,\n        VIDEO_PROPERTIES: VIDEO_PROPERTIES\n      };\n\n      var mp4 = {\n        generator: mp4Generator,\n        Transmuxer: transmuxer.Transmuxer,\n        AudioSegmentStream: transmuxer.AudioSegmentStream,\n        VideoSegmentStream: transmuxer.VideoSegmentStream\n      };\n\n      var classCallCheck$$1 = function classCallCheck$$1(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n          throw new TypeError(\"Cannot call a class as a function\");\n        }\n      };\n\n      var createClass$$1 = function () {\n        function defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        return function (Constructor, protoProps, staticProps) {\n          if (protoProps) defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) defineProperties(Constructor, staticProps);\n          return Constructor;\n        };\n      }();\n\n      /**\n       * @file transmuxer-worker.js\n       */\n\n      /**\n       * Re-emits transmuxer events by converting them into messages to the\n       * world outside the worker.\n       *\n       * @param {Object} transmuxer the transmuxer to wire events on\n       * @private\n       */\n      var wireTransmuxerEvents = function wireTransmuxerEvents(transmuxer) {\n        transmuxer.on('data', function (segment) {\n          // transfer ownership of the underlying ArrayBuffer\n          // instead of doing a copy to save memory\n          // ArrayBuffers are transferable but generic TypedArrays are not\n          // @link https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers#Passing_data_by_transferring_ownership_(transferable_objects)\n          var initArray = segment.initSegment;\n\n          segment.initSegment = {\n            data: initArray.buffer,\n            byteOffset: initArray.byteOffset,\n            byteLength: initArray.byteLength\n          };\n\n          var typedArray = segment.data;\n\n          segment.data = typedArray.buffer;\n          window_1$$1.postMessage({\n            action: 'data',\n            segment: segment,\n            byteOffset: typedArray.byteOffset,\n            byteLength: typedArray.byteLength\n          }, [segment.data]);\n        });\n\n        if (transmuxer.captionStream) {\n          transmuxer.captionStream.on('data', function (caption) {\n            window_1$$1.postMessage({\n              action: 'caption',\n              data: caption\n            });\n          });\n        }\n\n        transmuxer.on('done', function (data) {\n          window_1$$1.postMessage({ action: 'done' });\n        });\n\n        transmuxer.on('gopInfo', function (gopInfo) {\n          window_1$$1.postMessage({\n            action: 'gopInfo',\n            gopInfo: gopInfo\n          });\n        });\n      };\n\n      /**\n       * All incoming messages route through this hash. If no function exists\n       * to handle an incoming message, then we ignore the message.\n       *\n       * @class MessageHandlers\n       * @param {Object} options the options to initialize with\n       */\n\n      var MessageHandlers = function () {\n        function MessageHandlers(options) {\n          classCallCheck$$1(this, MessageHandlers);\n\n          this.options = options || {};\n          this.init();\n        }\n\n        /**\n         * initialize our web worker and wire all the events.\n         */\n\n        createClass$$1(MessageHandlers, [{\n          key: 'init',\n          value: function init() {\n            if (this.transmuxer) {\n              this.transmuxer.dispose();\n            }\n            this.transmuxer = new mp4.Transmuxer(this.options);\n            wireTransmuxerEvents(this.transmuxer);\n          }\n\n          /**\n           * Adds data (a ts segment) to the start of the transmuxer pipeline for\n           * processing.\n           *\n           * @param {ArrayBuffer} data data to push into the muxer\n           */\n\n        }, {\n          key: 'push',\n          value: function push(data) {\n            // Cast array buffer to correct type for transmuxer\n            var segment = new Uint8Array(data.data, data.byteOffset, data.byteLength);\n\n            this.transmuxer.push(segment);\n          }\n\n          /**\n           * Recreate the transmuxer so that the next segment added via `push`\n           * start with a fresh transmuxer.\n           */\n\n        }, {\n          key: 'reset',\n          value: function reset() {\n            this.init();\n          }\n\n          /**\n           * Set the value that will be used as the `baseMediaDecodeTime` time for the\n           * next segment pushed in. Subsequent segments will have their `baseMediaDecodeTime`\n           * set relative to the first based on the PTS values.\n           *\n           * @param {Object} data used to set the timestamp offset in the muxer\n           */\n\n        }, {\n          key: 'setTimestampOffset',\n          value: function setTimestampOffset(data) {\n            var timestampOffset = data.timestampOffset || 0;\n\n            this.transmuxer.setBaseMediaDecodeTime(Math.round(timestampOffset * 90000));\n          }\n        }, {\n          key: 'setAudioAppendStart',\n          value: function setAudioAppendStart(data) {\n            this.transmuxer.setAudioAppendStart(Math.ceil(data.appendStart * 90000));\n          }\n\n          /**\n           * Forces the pipeline to finish processing the last segment and emit it's\n           * results.\n           *\n           * @param {Object} data event data, not really used\n           */\n\n        }, {\n          key: 'flush',\n          value: function flush(data) {\n            this.transmuxer.flush();\n          }\n        }, {\n          key: 'resetCaptions',\n          value: function resetCaptions() {\n            this.transmuxer.resetCaptions();\n          }\n        }, {\n          key: 'alignGopsWith',\n          value: function alignGopsWith(data) {\n            this.transmuxer.alignGopsWith(data.gopsToAlignWith.slice());\n          }\n        }]);\n        return MessageHandlers;\n      }();\n\n      /**\n       * Our web wroker interface so that things can talk to mux.js\n       * that will be running in a web worker. the scope is passed to this by\n       * webworkify.\n       *\n       * @param {Object} self the scope for the web worker\n       */\n\n      var TransmuxerWorker = function TransmuxerWorker(self) {\n        self.onmessage = function (event) {\n          if (event.data.action === 'init' && event.data.options) {\n            this.messageHandlers = new MessageHandlers(event.data.options);\n            return;\n          }\n\n          if (!this.messageHandlers) {\n            this.messageHandlers = new MessageHandlers();\n          }\n\n          if (event.data && event.data.action && event.data.action !== 'init') {\n            if (this.messageHandlers[event.data.action]) {\n              this.messageHandlers[event.data.action](event.data);\n            }\n          }\n        };\n      };\n\n      var transmuxerWorker = new TransmuxerWorker(self);\n\n      return transmuxerWorker;\n    }();\n  });\n\n  /**\n   * @file codec-utils.js\n   */\n\n  /**\n   * Check if a codec string refers to an audio codec.\n   *\n   * @param {String} codec codec string to check\n   * @return {Boolean} if this is an audio codec\n   * @private\n   */\n  var isAudioCodec = function isAudioCodec(codec) {\n    return (/mp4a\\.\\d+.\\d+/i.test(codec)\n    );\n  };\n\n  /**\n   * Check if a codec string refers to a video codec.\n   *\n   * @param {String} codec codec string to check\n   * @return {Boolean} if this is a video codec\n   * @private\n   */\n  var isVideoCodec = function isVideoCodec(codec) {\n    return (/avc1\\.[\\da-f]+/i.test(codec)\n    );\n  };\n\n  /**\n   * Parse a content type header into a type and parameters\n   * object\n   *\n   * @param {String} type the content type header\n   * @return {Object} the parsed content-type\n   * @private\n   */\n  var parseContentType = function parseContentType(type) {\n    var object = { type: '', parameters: {} };\n    var parameters = type.trim().split(';');\n\n    // first parameter should always be content-type\n    object.type = parameters.shift().trim();\n    parameters.forEach(function (parameter) {\n      var pair = parameter.trim().split('=');\n\n      if (pair.length > 1) {\n        var name = pair[0].replace(/\"/g, '').trim();\n        var value = pair[1].replace(/\"/g, '').trim();\n\n        object.parameters[name] = value;\n      }\n    });\n\n    return object;\n  };\n\n  /**\n   * Replace the old apple-style `avc1.<dd>.<dd>` codec string with the standard\n   * `avc1.<hhhhhh>`\n   *\n   * @param {Array} codecs an array of codec strings to fix\n   * @return {Array} the translated codec array\n   * @private\n   */\n  var translateLegacyCodecs = function translateLegacyCodecs(codecs) {\n    return codecs.map(function (codec) {\n      return codec.replace(/avc1\\.(\\d+)\\.(\\d+)/i, function (orig, profile, avcLevel) {\n        var profileHex = ('00' + Number(profile).toString(16)).slice(-2);\n        var avcLevelHex = ('00' + Number(avcLevel).toString(16)).slice(-2);\n\n        return 'avc1.' + profileHex + '00' + avcLevelHex;\n      });\n    });\n  };\n\n  /**\n   * @file virtual-source-buffer.js\n   */\n\n  // We create a wrapper around the SourceBuffer so that we can manage the\n  // state of the `updating` property manually. We have to do this because\n  // Firefox changes `updating` to false long before triggering `updateend`\n  // events and that was causing strange problems in videojs-contrib-hls\n  var makeWrappedSourceBuffer = function makeWrappedSourceBuffer(mediaSource, mimeType) {\n    var sourceBuffer = mediaSource.addSourceBuffer(mimeType);\n    var wrapper = Object.create(null);\n\n    wrapper.updating = false;\n    wrapper.realBuffer_ = sourceBuffer;\n\n    var _loop = function _loop(key) {\n      if (typeof sourceBuffer[key] === 'function') {\n        wrapper[key] = function () {\n          return sourceBuffer[key].apply(sourceBuffer, arguments);\n        };\n      } else if (typeof wrapper[key] === 'undefined') {\n        Object.defineProperty(wrapper, key, {\n          get: function get$$1() {\n            return sourceBuffer[key];\n          },\n          set: function set$$1(v) {\n            return sourceBuffer[key] = v;\n          }\n        });\n      }\n    };\n\n    for (var key in sourceBuffer) {\n      _loop(key);\n    }\n\n    return wrapper;\n  };\n\n  /**\n   * Returns a list of gops in the buffer that have a pts value of 3 seconds or more in\n   * front of current time.\n   *\n   * @param {Array} buffer\n   *        The current buffer of gop information\n   * @param {Player} player\n   *        The player instance\n   * @param {Double} mapping\n   *        Offset to map display time to stream presentation time\n   * @return {Array}\n   *         List of gops considered safe to append over\n   */\n  var gopsSafeToAlignWith = function gopsSafeToAlignWith(buffer, player, mapping) {\n    if (!player || !buffer.length) {\n      return [];\n    }\n\n    // pts value for current time + 3 seconds to give a bit more wiggle room\n    var currentTimePts = Math.ceil((player.currentTime() - mapping + 3) * 90000);\n\n    var i = void 0;\n\n    for (i = 0; i < buffer.length; i++) {\n      if (buffer[i].pts > currentTimePts) {\n        break;\n      }\n    }\n\n    return buffer.slice(i);\n  };\n\n  /**\n   * Appends gop information (timing and byteLength) received by the transmuxer for the\n   * gops appended in the last call to appendBuffer\n   *\n   * @param {Array} buffer\n   *        The current buffer of gop information\n   * @param {Array} gops\n   *        List of new gop information\n   * @param {boolean} replace\n   *        If true, replace the buffer with the new gop information. If false, append the\n   *        new gop information to the buffer in the right location of time.\n   * @return {Array}\n   *         Updated list of gop information\n   */\n  var updateGopBuffer = function updateGopBuffer(buffer, gops, replace) {\n    if (!gops.length) {\n      return buffer;\n    }\n\n    if (replace) {\n      // If we are in safe append mode, then completely overwrite the gop buffer\n      // with the most recent appeneded data. This will make sure that when appending\n      // future segments, we only try to align with gops that are both ahead of current\n      // time and in the last segment appended.\n      return gops.slice();\n    }\n\n    var start = gops[0].pts;\n\n    var i = 0;\n\n    for (i; i < buffer.length; i++) {\n      if (buffer[i].pts >= start) {\n        break;\n      }\n    }\n\n    return buffer.slice(0, i).concat(gops);\n  };\n\n  /**\n   * Removes gop information in buffer that overlaps with provided start and end\n   *\n   * @param {Array} buffer\n   *        The current buffer of gop information\n   * @param {Double} start\n   *        position to start the remove at\n   * @param {Double} end\n   *        position to end the remove at\n   * @param {Double} mapping\n   *        Offset to map display time to stream presentation time\n   */\n  var removeGopBuffer = function removeGopBuffer(buffer, start, end, mapping) {\n    var startPts = Math.ceil((start - mapping) * 90000);\n    var endPts = Math.ceil((end - mapping) * 90000);\n    var updatedBuffer = buffer.slice();\n\n    var i = buffer.length;\n\n    while (i--) {\n      if (buffer[i].pts <= endPts) {\n        break;\n      }\n    }\n\n    if (i === -1) {\n      // no removal because end of remove range is before start of buffer\n      return updatedBuffer;\n    }\n\n    var j = i + 1;\n\n    while (j--) {\n      if (buffer[j].pts <= startPts) {\n        break;\n      }\n    }\n\n    // clamp remove range start to 0 index\n    j = Math.max(j, 0);\n\n    updatedBuffer.splice(j, i - j + 1);\n\n    return updatedBuffer;\n  };\n\n  /**\n   * VirtualSourceBuffers exist so that we can transmux non native formats\n   * into a native format, but keep the same api as a native source buffer.\n   * It creates a transmuxer, that works in its own thread (a web worker) and\n   * that transmuxer muxes the data into a native format. VirtualSourceBuffer will\n   * then send all of that data to the naive sourcebuffer so that it is\n   * indestinguishable from a natively supported format.\n   *\n   * @param {HtmlMediaSource} mediaSource the parent mediaSource\n   * @param {Array} codecs array of codecs that we will be dealing with\n   * @class VirtualSourceBuffer\n   * @extends video.js.EventTarget\n   */\n\n  var VirtualSourceBuffer = function (_videojs$EventTarget) {\n    inherits(VirtualSourceBuffer, _videojs$EventTarget);\n\n    function VirtualSourceBuffer(mediaSource, codecs) {\n      classCallCheck(this, VirtualSourceBuffer);\n\n      var _this7 = possibleConstructorReturn(this, _videojs$EventTarget.call(this, videojs$1.EventTarget));\n\n      _this7.timestampOffset_ = 0;\n      _this7.pendingBuffers_ = [];\n      _this7.bufferUpdating_ = false;\n\n      _this7.mediaSource_ = mediaSource;\n      _this7.codecs_ = codecs;\n      _this7.audioCodec_ = null;\n      _this7.videoCodec_ = null;\n      _this7.audioDisabled_ = false;\n      _this7.appendAudioInitSegment_ = true;\n      _this7.gopBuffer_ = [];\n      _this7.timeMapping_ = 0;\n      _this7.safeAppend_ = videojs$1.browser.IE_VERSION >= 11;\n\n      var options = {\n        remux: false,\n        alignGopsAtEnd: _this7.safeAppend_\n      };\n\n      _this7.codecs_.forEach(function (codec) {\n        if (isAudioCodec(codec)) {\n          _this7.audioCodec_ = codec;\n        } else if (isVideoCodec(codec)) {\n          _this7.videoCodec_ = codec;\n        }\n      });\n\n      // append muxed segments to their respective native buffers as\n      // soon as they are available\n      _this7.transmuxer_ = new TransmuxWorker();\n      _this7.transmuxer_.postMessage({ action: 'init', options: options });\n\n      _this7.transmuxer_.onmessage = function (event) {\n        if (event.data.action === 'data') {\n          return _this7.data_(event);\n        }\n\n        if (event.data.action === 'done') {\n          return _this7.done_(event);\n        }\n\n        if (event.data.action === 'gopInfo') {\n          return _this7.appendGopInfo_(event);\n        }\n      };\n\n      // this timestampOffset is a property with the side-effect of resetting\n      // baseMediaDecodeTime in the transmuxer on the setter\n      Object.defineProperty(_this7, 'timestampOffset', {\n        get: function get$$1() {\n          return this.timestampOffset_;\n        },\n        set: function set$$1(val) {\n          if (typeof val === 'number' && val >= 0) {\n            this.timestampOffset_ = val;\n            this.appendAudioInitSegment_ = true;\n\n            // reset gop buffer on timestampoffset as this signals a change in timeline\n            this.gopBuffer_.length = 0;\n            this.timeMapping_ = 0;\n\n            // We have to tell the transmuxer to set the baseMediaDecodeTime to\n            // the desired timestampOffset for the next segment\n            this.transmuxer_.postMessage({\n              action: 'setTimestampOffset',\n              timestampOffset: val\n            });\n          }\n        }\n      });\n\n      // setting the append window affects both source buffers\n      Object.defineProperty(_this7, 'appendWindowStart', {\n        get: function get$$1() {\n          return (this.videoBuffer_ || this.audioBuffer_).appendWindowStart;\n        },\n        set: function set$$1(start) {\n          if (this.videoBuffer_) {\n            this.videoBuffer_.appendWindowStart = start;\n          }\n          if (this.audioBuffer_) {\n            this.audioBuffer_.appendWindowStart = start;\n          }\n        }\n      });\n\n      // this buffer is \"updating\" if either of its native buffers are\n      Object.defineProperty(_this7, 'updating', {\n        get: function get$$1() {\n          return !!(this.bufferUpdating_ || !this.audioDisabled_ && this.audioBuffer_ && this.audioBuffer_.updating || this.videoBuffer_ && this.videoBuffer_.updating);\n        }\n      });\n\n      // the buffered property is the intersection of the buffered\n      // ranges of the native source buffers\n      Object.defineProperty(_this7, 'buffered', {\n        get: function get$$1() {\n          var start = null;\n          var end = null;\n          var arity = 0;\n          var extents = [];\n          var ranges = [];\n\n          // neither buffer has been created yet\n          if (!this.videoBuffer_ && !this.audioBuffer_) {\n            return videojs$1.createTimeRange();\n          }\n\n          // only one buffer is configured\n          if (!this.videoBuffer_) {\n            return this.audioBuffer_.buffered;\n          }\n          if (!this.audioBuffer_) {\n            return this.videoBuffer_.buffered;\n          }\n\n          // both buffers are configured\n          if (this.audioDisabled_) {\n            return this.videoBuffer_.buffered;\n          }\n\n          // both buffers are empty\n          if (this.videoBuffer_.buffered.length === 0 && this.audioBuffer_.buffered.length === 0) {\n            return videojs$1.createTimeRange();\n          }\n\n          // Handle the case where we have both buffers and create an\n          // intersection of the two\n          var videoBuffered = this.videoBuffer_.buffered;\n          var audioBuffered = this.audioBuffer_.buffered;\n          var count = videoBuffered.length;\n\n          // A) Gather up all start and end times\n          while (count--) {\n            extents.push({ time: videoBuffered.start(count), type: 'start' });\n            extents.push({ time: videoBuffered.end(count), type: 'end' });\n          }\n          count = audioBuffered.length;\n          while (count--) {\n            extents.push({ time: audioBuffered.start(count), type: 'start' });\n            extents.push({ time: audioBuffered.end(count), type: 'end' });\n          }\n          // B) Sort them by time\n          extents.sort(function (a, b) {\n            return a.time - b.time;\n          });\n\n          // C) Go along one by one incrementing arity for start and decrementing\n          //    arity for ends\n          for (count = 0; count < extents.length; count++) {\n            if (extents[count].type === 'start') {\n              arity++;\n\n              // D) If arity is ever incremented to 2 we are entering an\n              //    overlapping range\n              if (arity === 2) {\n                start = extents[count].time;\n              }\n            } else if (extents[count].type === 'end') {\n              arity--;\n\n              // E) If arity is ever decremented to 1 we leaving an\n              //    overlapping range\n              if (arity === 1) {\n                end = extents[count].time;\n              }\n            }\n\n            // F) Record overlapping ranges\n            if (start !== null && end !== null) {\n              ranges.push([start, end]);\n              start = null;\n              end = null;\n            }\n          }\n\n          return videojs$1.createTimeRanges(ranges);\n        }\n      });\n      return _this7;\n    }\n\n    /**\n     * When we get a data event from the transmuxer\n     * we call this function and handle the data that\n     * was sent to us\n     *\n     * @private\n     * @param {Event} event the data event from the transmuxer\n     */\n\n\n    VirtualSourceBuffer.prototype.data_ = function data_(event) {\n      var segment = event.data.segment;\n\n      // Cast ArrayBuffer to TypedArray\n      segment.data = new Uint8Array(segment.data, event.data.byteOffset, event.data.byteLength);\n\n      segment.initSegment = new Uint8Array(segment.initSegment.data, segment.initSegment.byteOffset, segment.initSegment.byteLength);\n\n      createTextTracksIfNecessary(this, this.mediaSource_, segment);\n\n      // Add the segments to the pendingBuffers array\n      this.pendingBuffers_.push(segment);\n      return;\n    };\n\n    /**\n     * When we get a done event from the transmuxer\n     * we call this function and we process all\n     * of the pending data that we have been saving in the\n     * data_ function\n     *\n     * @private\n     * @param {Event} event the done event from the transmuxer\n     */\n\n\n    VirtualSourceBuffer.prototype.done_ = function done_(event) {\n      // Don't process and append data if the mediaSource is closed\n      if (this.mediaSource_.readyState === 'closed') {\n        this.pendingBuffers_.length = 0;\n        return;\n      }\n\n      // All buffers should have been flushed from the muxer\n      // start processing anything we have received\n      this.processPendingSegments_();\n      return;\n    };\n\n    /**\n     * Create our internal native audio/video source buffers and add\n     * event handlers to them with the following conditions:\n     * 1. they do not already exist on the mediaSource\n     * 2. this VSB has a codec for them\n     *\n     * @private\n     */\n\n\n    VirtualSourceBuffer.prototype.createRealSourceBuffers_ = function createRealSourceBuffers_() {\n      var _this8 = this;\n\n      var types = ['audio', 'video'];\n\n      types.forEach(function (type) {\n        // Don't create a SourceBuffer of this type if we don't have a\n        // codec for it\n        if (!_this8[type + 'Codec_']) {\n          return;\n        }\n\n        // Do nothing if a SourceBuffer of this type already exists\n        if (_this8[type + 'Buffer_']) {\n          return;\n        }\n\n        var buffer = null;\n\n        // If the mediasource already has a SourceBuffer for the codec\n        // use that\n        if (_this8.mediaSource_[type + 'Buffer_']) {\n          buffer = _this8.mediaSource_[type + 'Buffer_'];\n          // In multiple audio track cases, the audio source buffer is disabled\n          // on the main VirtualSourceBuffer by the HTMLMediaSource much earlier\n          // than createRealSourceBuffers_ is called to create the second\n          // VirtualSourceBuffer because that happens as a side-effect of\n          // videojs-contrib-hls starting the audioSegmentLoader. As a result,\n          // the audioBuffer is essentially \"ownerless\" and no one will toggle\n          // the `updating` state back to false once the `updateend` event is received\n          //\n          // Setting `updating` to false manually will work around this\n          // situation and allow work to continue\n          buffer.updating = false;\n        } else {\n          var codecProperty = type + 'Codec_';\n          var mimeType = type + '/mp4;codecs=\"' + _this8[codecProperty] + '\"';\n\n          buffer = makeWrappedSourceBuffer(_this8.mediaSource_.nativeMediaSource_, mimeType);\n\n          _this8.mediaSource_[type + 'Buffer_'] = buffer;\n        }\n\n        _this8[type + 'Buffer_'] = buffer;\n\n        // Wire up the events to the SourceBuffer\n        ['update', 'updatestart', 'updateend'].forEach(function (event) {\n          buffer.addEventListener(event, function () {\n            // if audio is disabled\n            if (type === 'audio' && _this8.audioDisabled_) {\n              return;\n            }\n\n            if (event === 'updateend') {\n              _this8[type + 'Buffer_'].updating = false;\n            }\n\n            var shouldTrigger = types.every(function (t) {\n              // skip checking audio's updating status if audio\n              // is not enabled\n              if (t === 'audio' && _this8.audioDisabled_) {\n                return true;\n              }\n              // if the other type if updating we don't trigger\n              if (type !== t && _this8[t + 'Buffer_'] && _this8[t + 'Buffer_'].updating) {\n                return false;\n              }\n              return true;\n            });\n\n            if (shouldTrigger) {\n              return _this8.trigger(event);\n            }\n          });\n        });\n      });\n    };\n\n    /**\n     * Emulate the native mediasource function, but our function will\n     * send all of the proposed segments to the transmuxer so that we\n     * can transmux them before we append them to our internal\n     * native source buffers in the correct format.\n     *\n     * @link https://developer.mozilla.org/en-US/docs/Web/API/SourceBuffer/appendBuffer\n     * @param {Uint8Array} segment the segment to append to the buffer\n     */\n\n\n    VirtualSourceBuffer.prototype.appendBuffer = function appendBuffer(segment) {\n      // Start the internal \"updating\" state\n      this.bufferUpdating_ = true;\n\n      if (this.audioBuffer_ && this.audioBuffer_.buffered.length) {\n        var audioBuffered = this.audioBuffer_.buffered;\n\n        this.transmuxer_.postMessage({\n          action: 'setAudioAppendStart',\n          appendStart: audioBuffered.end(audioBuffered.length - 1)\n        });\n      }\n\n      if (this.videoBuffer_) {\n        this.transmuxer_.postMessage({\n          action: 'alignGopsWith',\n          gopsToAlignWith: gopsSafeToAlignWith(this.gopBuffer_, this.mediaSource_.player_, this.timeMapping_)\n        });\n      }\n\n      this.transmuxer_.postMessage({\n        action: 'push',\n        // Send the typed-array of data as an ArrayBuffer so that\n        // it can be sent as a \"Transferable\" and avoid the costly\n        // memory copy\n        data: segment.buffer,\n\n        // To recreate the original typed-array, we need information\n        // about what portion of the ArrayBuffer it was a view into\n        byteOffset: segment.byteOffset,\n        byteLength: segment.byteLength\n      }, [segment.buffer]);\n      this.transmuxer_.postMessage({ action: 'flush' });\n    };\n\n    /**\n     * Appends gop information (timing and byteLength) received by the transmuxer for the\n     * gops appended in the last call to appendBuffer\n     *\n     * @param {Event} event\n     *        The gopInfo event from the transmuxer\n     * @param {Array} event.data.gopInfo\n     *        List of gop info to append\n     */\n\n\n    VirtualSourceBuffer.prototype.appendGopInfo_ = function appendGopInfo_(event) {\n      this.gopBuffer_ = updateGopBuffer(this.gopBuffer_, event.data.gopInfo, this.safeAppend_);\n    };\n\n    /**\n     * Emulate the native mediasource function and remove parts\n     * of the buffer from any of our internal buffers that exist\n     *\n     * @link https://developer.mozilla.org/en-US/docs/Web/API/SourceBuffer/remove\n     * @param {Double} start position to start the remove at\n     * @param {Double} end position to end the remove at\n     */\n\n\n    VirtualSourceBuffer.prototype.remove = function remove(start, end) {\n      if (this.videoBuffer_) {\n        this.videoBuffer_.updating = true;\n        this.videoBuffer_.remove(start, end);\n        this.gopBuffer_ = removeGopBuffer(this.gopBuffer_, start, end, this.timeMapping_);\n      }\n      if (!this.audioDisabled_ && this.audioBuffer_) {\n        this.audioBuffer_.updating = true;\n        this.audioBuffer_.remove(start, end);\n      }\n\n      // Remove Metadata Cues (id3)\n      removeCuesFromTrack(start, end, this.metadataTrack_);\n\n      // Remove Any Captions\n      if (this.inbandTextTracks_) {\n        for (var track in this.inbandTextTracks_) {\n          removeCuesFromTrack(start, end, this.inbandTextTracks_[track]);\n        }\n      }\n    };\n\n    /**\n     * Process any segments that the muxer has output\n     * Concatenate segments together based on type and append them into\n     * their respective sourceBuffers\n     *\n     * @private\n     */\n\n\n    VirtualSourceBuffer.prototype.processPendingSegments_ = function processPendingSegments_() {\n      var sortedSegments = {\n        video: {\n          segments: [],\n          bytes: 0\n        },\n        audio: {\n          segments: [],\n          bytes: 0\n        },\n        captions: [],\n        metadata: []\n      };\n\n      // Sort segments into separate video/audio arrays and\n      // keep track of their total byte lengths\n      sortedSegments = this.pendingBuffers_.reduce(function (segmentObj, segment) {\n        var type = segment.type;\n        var data = segment.data;\n        var initSegment = segment.initSegment;\n\n        segmentObj[type].segments.push(data);\n        segmentObj[type].bytes += data.byteLength;\n\n        segmentObj[type].initSegment = initSegment;\n\n        // Gather any captions into a single array\n        if (segment.captions) {\n          segmentObj.captions = segmentObj.captions.concat(segment.captions);\n        }\n\n        if (segment.info) {\n          segmentObj[type].info = segment.info;\n        }\n\n        // Gather any metadata into a single array\n        if (segment.metadata) {\n          segmentObj.metadata = segmentObj.metadata.concat(segment.metadata);\n        }\n\n        return segmentObj;\n      }, sortedSegments);\n\n      // Create the real source buffers if they don't exist by now since we\n      // finally are sure what tracks are contained in the source\n      if (!this.videoBuffer_ && !this.audioBuffer_) {\n        // Remove any codecs that may have been specified by default but\n        // are no longer applicable now\n        if (sortedSegments.video.bytes === 0) {\n          this.videoCodec_ = null;\n        }\n        if (sortedSegments.audio.bytes === 0) {\n          this.audioCodec_ = null;\n        }\n\n        this.createRealSourceBuffers_();\n      }\n\n      if (sortedSegments.audio.info) {\n        this.mediaSource_.trigger({ type: 'audioinfo', info: sortedSegments.audio.info });\n      }\n      if (sortedSegments.video.info) {\n        this.mediaSource_.trigger({ type: 'videoinfo', info: sortedSegments.video.info });\n      }\n\n      if (this.appendAudioInitSegment_) {\n        if (!this.audioDisabled_ && this.audioBuffer_) {\n          sortedSegments.audio.segments.unshift(sortedSegments.audio.initSegment);\n          sortedSegments.audio.bytes += sortedSegments.audio.initSegment.byteLength;\n        }\n        this.appendAudioInitSegment_ = false;\n      }\n\n      var triggerUpdateend = false;\n\n      // Merge multiple video and audio segments into one and append\n      if (this.videoBuffer_ && sortedSegments.video.bytes) {\n        sortedSegments.video.segments.unshift(sortedSegments.video.initSegment);\n        sortedSegments.video.bytes += sortedSegments.video.initSegment.byteLength;\n        this.concatAndAppendSegments_(sortedSegments.video, this.videoBuffer_);\n        // TODO: are video tracks the only ones with text tracks?\n        addTextTrackData(this, sortedSegments.captions, sortedSegments.metadata);\n      } else if (this.videoBuffer_ && (this.audioDisabled_ || !this.audioBuffer_)) {\n        // The transmuxer did not return any bytes of video, meaning it was all trimmed\n        // for gop alignment. Since we have a video buffer and audio is disabled, updateend\n        // will never be triggered by this source buffer, which will cause contrib-hls\n        // to be stuck forever waiting for updateend. If audio is not disabled, updateend\n        // will be triggered by the audio buffer, which will be sent upwards since the video\n        // buffer will not be in an updating state.\n        triggerUpdateend = true;\n      }\n\n      if (!this.audioDisabled_ && this.audioBuffer_) {\n        this.concatAndAppendSegments_(sortedSegments.audio, this.audioBuffer_);\n      }\n\n      this.pendingBuffers_.length = 0;\n\n      if (triggerUpdateend) {\n        this.trigger('updateend');\n      }\n\n      // We are no longer in the internal \"updating\" state\n      this.bufferUpdating_ = false;\n    };\n\n    /**\n     * Combine all segments into a single Uint8Array and then append them\n     * to the destination buffer\n     *\n     * @param {Object} segmentObj\n     * @param {SourceBuffer} destinationBuffer native source buffer to append data to\n     * @private\n     */\n\n\n    VirtualSourceBuffer.prototype.concatAndAppendSegments_ = function concatAndAppendSegments_(segmentObj, destinationBuffer) {\n      var offset = 0;\n      var tempBuffer = void 0;\n\n      if (segmentObj.bytes) {\n        tempBuffer = new Uint8Array(segmentObj.bytes);\n\n        // Combine the individual segments into one large typed-array\n        segmentObj.segments.forEach(function (segment) {\n          tempBuffer.set(segment, offset);\n          offset += segment.byteLength;\n        });\n\n        try {\n          destinationBuffer.updating = true;\n          destinationBuffer.appendBuffer(tempBuffer);\n        } catch (error) {\n          if (this.mediaSource_.player_) {\n            this.mediaSource_.player_.error({\n              code: -3,\n              type: 'APPEND_BUFFER_ERR',\n              message: error.message,\n              originalError: error\n            });\n          }\n        }\n      }\n    };\n\n    /**\n     * Emulate the native mediasource function. abort any soureBuffer\n     * actions and throw out any un-appended data.\n     *\n     * @link https://developer.mozilla.org/en-US/docs/Web/API/SourceBuffer/abort\n     */\n\n\n    VirtualSourceBuffer.prototype.abort = function abort() {\n      if (this.videoBuffer_) {\n        this.videoBuffer_.abort();\n      }\n      if (!this.audioDisabled_ && this.audioBuffer_) {\n        this.audioBuffer_.abort();\n      }\n      if (this.transmuxer_) {\n        this.transmuxer_.postMessage({ action: 'reset' });\n      }\n      this.pendingBuffers_.length = 0;\n      this.bufferUpdating_ = false;\n    };\n\n    return VirtualSourceBuffer;\n  }(videojs$1.EventTarget);\n\n  /**\n   * @file html-media-source.js\n   */\n\n  /**\n   * Our MediaSource implementation in HTML, mimics native\n   * MediaSource where/if possible.\n   *\n   * @link https://developer.mozilla.org/en-US/docs/Web/API/MediaSource\n   * @class HtmlMediaSource\n   * @extends videojs.EventTarget\n   */\n\n\n  var HtmlMediaSource = function (_videojs$EventTarget2) {\n    inherits(HtmlMediaSource, _videojs$EventTarget2);\n\n    function HtmlMediaSource() {\n      classCallCheck(this, HtmlMediaSource);\n\n      var _this9 = possibleConstructorReturn(this, _videojs$EventTarget2.call(this));\n\n      var property = void 0;\n\n      _this9.nativeMediaSource_ = new window_1.MediaSource();\n      // delegate to the native MediaSource's methods by default\n      for (property in _this9.nativeMediaSource_) {\n        if (!(property in HtmlMediaSource.prototype) && typeof _this9.nativeMediaSource_[property] === 'function') {\n          _this9[property] = _this9.nativeMediaSource_[property].bind(_this9.nativeMediaSource_);\n        }\n      }\n\n      // emulate `duration` and `seekable` until seeking can be\n      // handled uniformly for live streams\n      // see https://github.com/w3c/media-source/issues/5\n      _this9.duration_ = NaN;\n      Object.defineProperty(_this9, 'duration', {\n        get: function get$$1() {\n          if (this.duration_ === Infinity) {\n            return this.duration_;\n          }\n          return this.nativeMediaSource_.duration;\n        },\n        set: function set$$1(duration) {\n          this.duration_ = duration;\n          if (duration !== Infinity) {\n            this.nativeMediaSource_.duration = duration;\n            return;\n          }\n        }\n      });\n      Object.defineProperty(_this9, 'seekable', {\n        get: function get$$1() {\n          if (this.duration_ === Infinity) {\n            return videojs$1.createTimeRanges([[0, this.nativeMediaSource_.duration]]);\n          }\n          return this.nativeMediaSource_.seekable;\n        }\n      });\n\n      Object.defineProperty(_this9, 'readyState', {\n        get: function get$$1() {\n          return this.nativeMediaSource_.readyState;\n        }\n      });\n\n      Object.defineProperty(_this9, 'activeSourceBuffers', {\n        get: function get$$1() {\n          return this.activeSourceBuffers_;\n        }\n      });\n\n      // the list of virtual and native SourceBuffers created by this\n      // MediaSource\n      _this9.sourceBuffers = [];\n\n      _this9.activeSourceBuffers_ = [];\n\n      /**\n       * update the list of active source buffers based upon various\n       * imformation from HLS and video.js\n       *\n       * @private\n       */\n      _this9.updateActiveSourceBuffers_ = function () {\n        // Retain the reference but empty the array\n        _this9.activeSourceBuffers_.length = 0;\n\n        // If there is only one source buffer, then it will always be active and audio will\n        // be disabled based on the codec of the source buffer\n        if (_this9.sourceBuffers.length === 1) {\n          var sourceBuffer = _this9.sourceBuffers[0];\n\n          sourceBuffer.appendAudioInitSegment_ = true;\n          sourceBuffer.audioDisabled_ = !sourceBuffer.audioCodec_;\n          _this9.activeSourceBuffers_.push(sourceBuffer);\n          return;\n        }\n\n        // There are 2 source buffers, a combined (possibly video only) source buffer and\n        // and an audio only source buffer.\n        // By default, the audio in the combined virtual source buffer is enabled\n        // and the audio-only source buffer (if it exists) is disabled.\n        var disableCombined = false;\n        var disableAudioOnly = true;\n\n        // TODO: maybe we can store the sourcebuffers on the track objects?\n        // safari may do something like this\n        for (var i = 0; i < _this9.player_.audioTracks().length; i++) {\n          var track = _this9.player_.audioTracks()[i];\n\n          if (track.enabled && track.kind !== 'main') {\n            // The enabled track is an alternate audio track so disable the audio in\n            // the combined source buffer and enable the audio-only source buffer.\n            disableCombined = true;\n            disableAudioOnly = false;\n            break;\n          }\n        }\n\n        _this9.sourceBuffers.forEach(function (sourceBuffer, index) {\n          /* eslinst-disable */\n          // TODO once codecs are required, we can switch to using the codecs to determine\n          //      what stream is the video stream, rather than relying on videoTracks\n          /* eslinst-enable */\n\n          sourceBuffer.appendAudioInitSegment_ = true;\n\n          if (sourceBuffer.videoCodec_ && sourceBuffer.audioCodec_) {\n            // combined\n            sourceBuffer.audioDisabled_ = disableCombined;\n          } else if (sourceBuffer.videoCodec_ && !sourceBuffer.audioCodec_) {\n            // If the \"combined\" source buffer is video only, then we do not want\n            // disable the audio-only source buffer (this is mostly for demuxed\n            // audio and video hls)\n            sourceBuffer.audioDisabled_ = true;\n            disableAudioOnly = false;\n          } else if (!sourceBuffer.videoCodec_ && sourceBuffer.audioCodec_) {\n            // audio only\n            // In the case of audio only with alternate audio and disableAudioOnly is true\n            // this means we want to disable the audio on the alternate audio sourcebuffer\n            // but not the main \"combined\" source buffer. The \"combined\" source buffer is\n            // always at index 0, so this ensures audio won't be disabled in both source\n            // buffers.\n            sourceBuffer.audioDisabled_ = index ? disableAudioOnly : !disableAudioOnly;\n            if (sourceBuffer.audioDisabled_) {\n              return;\n            }\n          }\n\n          _this9.activeSourceBuffers_.push(sourceBuffer);\n        });\n      };\n\n      _this9.onPlayerMediachange_ = function () {\n        _this9.sourceBuffers.forEach(function (sourceBuffer) {\n          sourceBuffer.appendAudioInitSegment_ = true;\n        });\n      };\n\n      _this9.onHlsReset_ = function () {\n        _this9.sourceBuffers.forEach(function (sourceBuffer) {\n          if (sourceBuffer.transmuxer_) {\n            sourceBuffer.transmuxer_.postMessage({ action: 'resetCaptions' });\n          }\n        });\n      };\n\n      _this9.onHlsSegmentTimeMapping_ = function (event) {\n        _this9.sourceBuffers.forEach(function (buffer) {\n          return buffer.timeMapping_ = event.mapping;\n        });\n      };\n\n      // Re-emit MediaSource events on the polyfill\n      ['sourceopen', 'sourceclose', 'sourceended'].forEach(function (eventName) {\n        this.nativeMediaSource_.addEventListener(eventName, this.trigger.bind(this));\n      }, _this9);\n\n      // capture the associated player when the MediaSource is\n      // successfully attached\n      _this9.on('sourceopen', function (event) {\n        // Get the player this MediaSource is attached to\n        var video = document_1.querySelector('[src=\"' + _this9.url_ + '\"]');\n\n        if (!video) {\n          return;\n        }\n\n        _this9.player_ = videojs$1(video.parentNode);\n\n        // hls-reset is fired by videojs.Hls on to the tech after the main SegmentLoader\n        // resets its state and flushes the buffer\n        _this9.player_.tech_.on('hls-reset', _this9.onHlsReset_);\n        // hls-segment-time-mapping is fired by videojs.Hls on to the tech after the main\n        // SegmentLoader inspects an MTS segment and has an accurate stream to display\n        // time mapping\n        _this9.player_.tech_.on('hls-segment-time-mapping', _this9.onHlsSegmentTimeMapping_);\n\n        if (_this9.player_.audioTracks && _this9.player_.audioTracks()) {\n          _this9.player_.audioTracks().on('change', _this9.updateActiveSourceBuffers_);\n          _this9.player_.audioTracks().on('addtrack', _this9.updateActiveSourceBuffers_);\n          _this9.player_.audioTracks().on('removetrack', _this9.updateActiveSourceBuffers_);\n        }\n\n        _this9.player_.on('mediachange', _this9.onPlayerMediachange_);\n      });\n\n      _this9.on('sourceended', function (event) {\n        var duration = durationOfVideo(_this9.duration);\n\n        for (var i = 0; i < _this9.sourceBuffers.length; i++) {\n          var sourcebuffer = _this9.sourceBuffers[i];\n          var cues = sourcebuffer.metadataTrack_ && sourcebuffer.metadataTrack_.cues;\n\n          if (cues && cues.length) {\n            cues[cues.length - 1].endTime = duration;\n          }\n        }\n      });\n\n      // explicitly terminate any WebWorkers that were created\n      // by SourceHandlers\n      _this9.on('sourceclose', function (event) {\n        this.sourceBuffers.forEach(function (sourceBuffer) {\n          if (sourceBuffer.transmuxer_) {\n            sourceBuffer.transmuxer_.terminate();\n          }\n        });\n\n        this.sourceBuffers.length = 0;\n        if (!this.player_) {\n          return;\n        }\n\n        if (this.player_.audioTracks && this.player_.audioTracks()) {\n          this.player_.audioTracks().off('change', this.updateActiveSourceBuffers_);\n          this.player_.audioTracks().off('addtrack', this.updateActiveSourceBuffers_);\n          this.player_.audioTracks().off('removetrack', this.updateActiveSourceBuffers_);\n        }\n\n        // We can only change this if the player hasn't been disposed of yet\n        // because `off` eventually tries to use the el_ property. If it has\n        // been disposed of, then don't worry about it because there are no\n        // event handlers left to unbind anyway\n        if (this.player_.el_) {\n          this.player_.off('mediachange', this.onPlayerMediachange_);\n          this.player_.tech_.off('hls-reset', this.onHlsReset_);\n          this.player_.tech_.off('hls-segment-time-mapping', this.onHlsSegmentTimeMapping_);\n        }\n      });\n      return _this9;\n    }\n\n    /**\n     * Add a range that that can now be seeked to.\n     *\n     * @param {Double} start where to start the addition\n     * @param {Double} end where to end the addition\n     * @private\n     */\n\n\n    HtmlMediaSource.prototype.addSeekableRange_ = function addSeekableRange_(start, end) {\n      var error = void 0;\n\n      if (this.duration !== Infinity) {\n        error = new Error('MediaSource.addSeekableRange() can only be invoked ' + 'when the duration is Infinity');\n        error.name = 'InvalidStateError';\n        error.code = 11;\n        throw error;\n      }\n\n      if (end > this.nativeMediaSource_.duration || isNaN(this.nativeMediaSource_.duration)) {\n        this.nativeMediaSource_.duration = end;\n      }\n    };\n\n    /**\n     * Add a source buffer to the media source.\n     *\n     * @link https://developer.mozilla.org/en-US/docs/Web/API/MediaSource/addSourceBuffer\n     * @param {String} type the content-type of the content\n     * @return {Object} the created source buffer\n     */\n\n\n    HtmlMediaSource.prototype.addSourceBuffer = function addSourceBuffer(type) {\n      var buffer = void 0;\n      var parsedType = parseContentType(type);\n\n      // Create a VirtualSourceBuffer to transmux MPEG-2 transport\n      // stream segments into fragmented MP4s\n      if (/^(video|audio)\\/mp2t$/i.test(parsedType.type)) {\n        var codecs = [];\n\n        if (parsedType.parameters && parsedType.parameters.codecs) {\n          codecs = parsedType.parameters.codecs.split(',');\n          codecs = translateLegacyCodecs(codecs);\n          codecs = codecs.filter(function (codec) {\n            return isAudioCodec(codec) || isVideoCodec(codec);\n          });\n        }\n\n        if (codecs.length === 0) {\n          codecs = ['avc1.4d400d', 'mp4a.40.2'];\n        }\n\n        buffer = new VirtualSourceBuffer(this, codecs);\n\n        if (this.sourceBuffers.length !== 0) {\n          // If another VirtualSourceBuffer already exists, then we are creating a\n          // SourceBuffer for an alternate audio track and therefore we know that\n          // the source has both an audio and video track.\n          // That means we should trigger the manual creation of the real\n          // SourceBuffers instead of waiting for the transmuxer to return data\n          this.sourceBuffers[0].createRealSourceBuffers_();\n          buffer.createRealSourceBuffers_();\n\n          // Automatically disable the audio on the first source buffer if\n          // a second source buffer is ever created\n          this.sourceBuffers[0].audioDisabled_ = true;\n        }\n      } else {\n        // delegate to the native implementation\n        buffer = this.nativeMediaSource_.addSourceBuffer(type);\n      }\n\n      this.sourceBuffers.push(buffer);\n      return buffer;\n    };\n\n    return HtmlMediaSource;\n  }(videojs$1.EventTarget);\n\n  /**\n   * @file videojs-contrib-media-sources.js\n   */\n\n\n  var urlCount = 0;\n\n  // ------------\n  // Media Source\n  // ------------\n\n  // store references to the media sources so they can be connected\n  // to a video element (a swf object)\n  // TODO: can we store this somewhere local to this module?\n  videojs$1.mediaSources = {};\n\n  /**\n   * Provide a method for a swf object to notify JS that a\n   * media source is now open.\n   *\n   * @param {String} msObjectURL string referencing the MSE Object URL\n   * @param {String} swfId the swf id\n   */\n  var open = function open(msObjectURL, swfId) {\n    var mediaSource = videojs$1.mediaSources[msObjectURL];\n\n    if (mediaSource) {\n      mediaSource.trigger({ type: 'sourceopen', swfId: swfId });\n    } else {\n      throw new Error('Media Source not found (Video.js)');\n    }\n  };\n\n  /**\n   * Check to see if the native MediaSource object exists and supports\n   * an MP4 container with both H.264 video and AAC-LC audio.\n   *\n   * @return {Boolean} if  native media sources are supported\n   */\n  var supportsNativeMediaSources = function supportsNativeMediaSources() {\n    return !!window_1.MediaSource && !!window_1.MediaSource.isTypeSupported && window_1.MediaSource.isTypeSupported('video/mp4;codecs=\"avc1.4d400d,mp4a.40.2\"');\n  };\n\n  /**\n   * An emulation of the MediaSource API so that we can support\n   * native and non-native functionality. returns an instance of\n   * HtmlMediaSource.\n   *\n   * @link https://developer.mozilla.org/en-US/docs/Web/API/MediaSource/MediaSource\n   */\n  var MediaSource = function MediaSource() {\n    this.MediaSource = {\n      open: open,\n      supportsNativeMediaSources: supportsNativeMediaSources\n    };\n\n    if (supportsNativeMediaSources()) {\n      return new HtmlMediaSource();\n    }\n\n    throw new Error('Cannot use create a virtual MediaSource for this video');\n  };\n\n  MediaSource.open = open;\n  MediaSource.supportsNativeMediaSources = supportsNativeMediaSources;\n\n  /**\n   * A wrapper around the native URL for our MSE object\n   * implementation, this object is exposed under videojs.URL\n   *\n   * @link https://developer.mozilla.org/en-US/docs/Web/API/URL/URL\n   */\n  var URL$1 = {\n    /**\n     * A wrapper around the native createObjectURL for our objects.\n     * This function maps a native or emulated mediaSource to a blob\n     * url so that it can be loaded into video.js\n     *\n     * @link https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL\n     * @param {MediaSource} object the object to create a blob url to\n     */\n    createObjectURL: function createObjectURL(object) {\n      var objectUrlPrefix = 'blob:vjs-media-source/';\n      var url = void 0;\n\n      // use the native MediaSource to generate an object URL\n      if (object instanceof HtmlMediaSource) {\n        url = window_1.URL.createObjectURL(object.nativeMediaSource_);\n        object.url_ = url;\n        return url;\n      }\n      // if the object isn't an emulated MediaSource, delegate to the\n      // native implementation\n      if (!(object instanceof HtmlMediaSource)) {\n        url = window_1.URL.createObjectURL(object);\n        object.url_ = url;\n        return url;\n      }\n\n      // build a URL that can be used to map back to the emulated\n      // MediaSource\n      url = objectUrlPrefix + urlCount;\n\n      urlCount++;\n\n      // setup the mapping back to object\n      videojs$1.mediaSources[url] = object;\n\n      return url;\n    }\n  };\n\n  videojs$1.MediaSource = MediaSource;\n  videojs$1.URL = URL$1;\n\n  var EventTarget$1$1 = videojs$1.EventTarget,\n      mergeOptions$2 = videojs$1.mergeOptions;\n\n  /**\n   * Returns a new master manifest that is the result of merging an updated master manifest\n   * into the original version.\n   *\n   * @param {Object} oldMaster\n   *        The old parsed mpd object\n   * @param {Object} newMaster\n   *        The updated parsed mpd object\n   * @return {Object}\n   *         A new object representing the original master manifest with the updated media\n   *         playlists merged in\n   */\n\n  var updateMaster$1 = function updateMaster$1(oldMaster, newMaster) {\n    var update = mergeOptions$2(oldMaster, {\n      // These are top level properties that can be updated\n      duration: newMaster.duration,\n      minimumUpdatePeriod: newMaster.minimumUpdatePeriod\n    });\n\n    // First update the playlists in playlist list\n    for (var i = 0; i < newMaster.playlists.length; i++) {\n      var playlistUpdate = updateMaster(update, newMaster.playlists[i]);\n\n      if (playlistUpdate) {\n        update = playlistUpdate;\n      }\n    }\n\n    // Then update media group playlists\n    forEachMediaGroup(newMaster, function (properties, type, group, label) {\n      if (properties.playlists && properties.playlists.length) {\n        var uri = properties.playlists[0].uri;\n        var _playlistUpdate = updateMaster(update, properties.playlists[0]);\n\n        if (_playlistUpdate) {\n          update = _playlistUpdate;\n          // update the playlist reference within media groups\n          update.mediaGroups[type][group][label].playlists[0] = update.playlists[uri];\n        }\n      }\n    });\n\n    return update;\n  };\n\n  var DashPlaylistLoader = function (_EventTarget$) {\n    inherits(DashPlaylistLoader, _EventTarget$);\n\n    // DashPlaylistLoader must accept either a src url or a playlist because subsequent\n    // playlist loader setups from media groups will expect to be able to pass a playlist\n    // (since there aren't external URLs to media playlists with DASH)\n    function DashPlaylistLoader(srcUrlOrPlaylist, hls, withCredentials, masterPlaylistLoader) {\n      classCallCheck(this, DashPlaylistLoader);\n\n      var _this10 = possibleConstructorReturn(this, _EventTarget$.call(this));\n\n      _this10.hls_ = hls;\n      _this10.withCredentials = withCredentials;\n\n      if (!srcUrlOrPlaylist) {\n        throw new Error('A non-empty playlist URL or playlist is required');\n      }\n\n      // event naming?\n      _this10.on('minimumUpdatePeriod', function () {\n        _this10.refreshXml_();\n      });\n\n      // live playlist staleness timeout\n      _this10.on('mediaupdatetimeout', function () {\n        _this10.refreshMedia_();\n      });\n\n      // initialize the loader state\n      if (typeof srcUrlOrPlaylist === 'string') {\n        _this10.srcUrl = srcUrlOrPlaylist;\n        _this10.state = 'HAVE_NOTHING';\n        return possibleConstructorReturn(_this10);\n      }\n\n      _this10.masterPlaylistLoader_ = masterPlaylistLoader;\n\n      _this10.state = 'HAVE_METADATA';\n      _this10.started = true;\n      // we only should have one playlist so select it\n      _this10.media(srcUrlOrPlaylist);\n      // trigger async to mimic behavior of HLS, where it must request a playlist\n      window_1.setTimeout(function () {\n        _this10.trigger('loadedmetadata');\n      }, 0);\n      return _this10;\n    }\n\n    DashPlaylistLoader.prototype.dispose = function dispose() {\n      this.stopRequest();\n      window_1.clearTimeout(this.mediaUpdateTimeout);\n    };\n\n    DashPlaylistLoader.prototype.stopRequest = function stopRequest() {\n      if (this.request) {\n        var oldRequest = this.request;\n\n        this.request = null;\n        oldRequest.onreadystatechange = null;\n        oldRequest.abort();\n      }\n    };\n\n    DashPlaylistLoader.prototype.media = function media(playlist) {\n      // getter\n      if (!playlist) {\n        return this.media_;\n      }\n\n      // setter\n      if (this.state === 'HAVE_NOTHING') {\n        throw new Error('Cannot switch media playlist from ' + this.state);\n      }\n\n      var startingState = this.state;\n\n      // find the playlist object if the target playlist has been specified by URI\n      if (typeof playlist === 'string') {\n        if (!this.master.playlists[playlist]) {\n          throw new Error('Unknown playlist URI: ' + playlist);\n        }\n        playlist = this.master.playlists[playlist];\n      }\n\n      var mediaChange = !this.media_ || playlist.uri !== this.media_.uri;\n\n      this.state = 'HAVE_METADATA';\n\n      // switching to the active playlist is a no-op\n      if (!mediaChange) {\n        return;\n      }\n\n      // switching from an already loaded playlist\n      if (this.media_) {\n        this.trigger('mediachanging');\n      }\n\n      this.media_ = playlist;\n\n      this.refreshMedia_();\n\n      // trigger media change if the active media has been updated\n      if (startingState !== 'HAVE_MASTER') {\n        this.trigger('mediachange');\n      }\n    };\n\n    DashPlaylistLoader.prototype.pause = function pause() {\n      this.stopRequest();\n      if (this.state === 'HAVE_NOTHING') {\n        // If we pause the loader before any data has been retrieved, its as if we never\n        // started, so reset to an unstarted state.\n        this.started = false;\n      }\n    };\n\n    DashPlaylistLoader.prototype.load = function load() {\n      // because the playlists are internal to the manifest, load should either load the\n      // main manifest, or do nothing but trigger an event\n      if (!this.started) {\n        this.start();\n        return;\n      }\n\n      this.trigger('loadedplaylist');\n    };\n\n    /**\n     * Parses the master xml string and updates playlist uri references\n     *\n     * @return {Object}\n     *         The parsed mpd manifest object\n     */\n\n\n    DashPlaylistLoader.prototype.parseMasterXml = function parseMasterXml() {\n      var master = parse(this.masterXml_, {\n        manifestUri: this.srcUrl,\n        clientOffset: this.clientOffset_\n      });\n\n      master.uri = this.srcUrl;\n\n      // Set up phony URIs for the playlists since we won't have external URIs for DASH\n      // but reference playlists by their URI throughout the project\n      // TODO: Should we create the dummy uris in mpd-parser as well (leaning towards yes).\n      for (var i = 0; i < master.playlists.length; i++) {\n        var phonyUri = 'placeholder-uri-' + i;\n\n        master.playlists[i].uri = phonyUri;\n        // set up by URI references\n        master.playlists[phonyUri] = master.playlists[i];\n      }\n\n      // set up phony URIs for the media group playlists since we won't have external\n      // URIs for DASH but reference playlists by their URI throughout the project\n      forEachMediaGroup(master, function (properties, mediaType, groupKey, labelKey) {\n        if (properties.playlists && properties.playlists.length) {\n          var _phonyUri = 'placeholder-uri-' + mediaType + '-' + groupKey + '-' + labelKey;\n\n          properties.playlists[0].uri = _phonyUri;\n          // setup URI references\n          master.playlists[_phonyUri] = properties.playlists[0];\n        }\n      });\n\n      setupMediaPlaylists(master);\n      resolveMediaGroupUris(master);\n\n      return master;\n    };\n\n    DashPlaylistLoader.prototype.start = function start() {\n      var _this11 = this;\n\n      this.started = true;\n\n      // request the specified URL\n      this.request = this.hls_.xhr({\n        uri: this.srcUrl,\n        withCredentials: this.withCredentials\n      }, function (error, req) {\n        // disposed\n        if (!_this11.request) {\n          return;\n        }\n\n        // clear the loader's request reference\n        _this11.request = null;\n\n        if (error) {\n          _this11.error = {\n            status: req.status,\n            message: 'DASH playlist request error at URL: ' + _this11.srcUrl,\n            responseText: req.responseText,\n            // MEDIA_ERR_NETWORK\n            code: 2\n          };\n          if (_this11.state === 'HAVE_NOTHING') {\n            _this11.started = false;\n          }\n          return _this11.trigger('error');\n        }\n\n        _this11.masterXml_ = req.responseText;\n\n        if (req.responseHeaders && req.responseHeaders.date) {\n          _this11.masterLoaded_ = Date.parse(req.responseHeaders.date);\n        } else {\n          _this11.masterLoaded_ = Date.now();\n        }\n\n        _this11.syncClientServerClock_(_this11.onClientServerClockSync_.bind(_this11));\n      });\n    };\n\n    /**\n     * Parses the master xml for UTCTiming node to sync the client clock to the server\n     * clock. If the UTCTiming node requires a HEAD or GET request, that request is made.\n     *\n     * @param {Function} done\n     *        Function to call when clock sync has completed\n     */\n\n\n    DashPlaylistLoader.prototype.syncClientServerClock_ = function syncClientServerClock_(done) {\n      var _this12 = this;\n\n      var utcTiming = parseUTCTiming(this.masterXml_);\n\n      // No UTCTiming element found in the mpd. Use Date header from mpd request as the\n      // server clock\n      if (utcTiming === null) {\n        this.clientOffset_ = this.masterLoaded_ - Date.now();\n        return done();\n      }\n\n      if (utcTiming.method === 'DIRECT') {\n        this.clientOffset_ = utcTiming.value - Date.now();\n        return done();\n      }\n\n      this.request = this.hls_.xhr({\n        uri: resolveUrl$1(this.srcUrl, utcTiming.value),\n        method: utcTiming.method,\n        withCredentials: this.withCredentials\n      }, function (error, req) {\n        // disposed\n        if (!_this12.request) {\n          return;\n        }\n\n        if (error) {\n          // sync request failed, fall back to using date header from mpd\n          // TODO: log warning\n          _this12.clientOffset_ = _this12.masterLoaded_ - Date.now();\n          return done();\n        }\n\n        var serverTime = void 0;\n\n        if (utcTiming.method === 'HEAD') {\n          if (!req.responseHeaders || !req.responseHeaders.date) {\n            // expected date header not preset, fall back to using date header from mpd\n            // TODO: log warning\n            serverTime = _this12.masterLoaded_;\n          } else {\n            serverTime = Date.parse(req.responseHeaders.date);\n          }\n        } else {\n          serverTime = Date.parse(req.responseText);\n        }\n\n        _this12.clientOffset_ = serverTime - Date.now();\n\n        done();\n      });\n    };\n\n    /**\n     * Handler for after client/server clock synchronization has happened. Sets up\n     * xml refresh timer if specificed by the manifest.\n     */\n\n\n    DashPlaylistLoader.prototype.onClientServerClockSync_ = function onClientServerClockSync_() {\n      var _this13 = this;\n\n      this.master = this.parseMasterXml();\n\n      this.state = 'HAVE_MASTER';\n\n      this.trigger('loadedplaylist');\n\n      if (!this.media_) {\n        // no media playlist was specifically selected so start\n        // from the first listed one\n        this.media(this.master.playlists[0]);\n      }\n      // trigger loadedmetadata to resolve setup of media groups\n      // trigger async to mimic behavior of HLS, where it must request a playlist\n      window_1.setTimeout(function () {\n        _this13.trigger('loadedmetadata');\n      }, 0);\n\n      // TODO: minimumUpdatePeriod can have a value of 0. Currently the manifest will not\n      // be refreshed when this is the case. The inter-op guide says that when the\n      // minimumUpdatePeriod is 0, the manifest should outline all currently available\n      // segments, but future segments may require an update. I think a good solution\n      // would be to update the manifest at the same rate that the media playlists\n      // are \"refreshed\", i.e. every targetDuration.\n      if (this.master.minimumUpdatePeriod) {\n        window_1.setTimeout(function () {\n          _this13.trigger('minimumUpdatePeriod');\n        }, this.master.minimumUpdatePeriod);\n      }\n    };\n\n    /**\n     * Sends request to refresh the master xml and updates the parsed master manifest\n     * TODO: Does the client offset need to be recalculated when the xml is refreshed?\n     */\n\n\n    DashPlaylistLoader.prototype.refreshXml_ = function refreshXml_() {\n      var _this14 = this;\n\n      this.request = this.hls_.xhr({\n        uri: this.srcUrl,\n        withCredentials: this.withCredentials\n      }, function (error, req) {\n        // disposed\n        if (!_this14.request) {\n          return;\n        }\n\n        // clear the loader's request reference\n        _this14.request = null;\n\n        if (error) {\n          _this14.error = {\n            status: req.status,\n            message: 'DASH playlist request error at URL: ' + _this14.srcUrl,\n            responseText: req.responseText,\n            // MEDIA_ERR_NETWORK\n            code: 2\n          };\n          if (_this14.state === 'HAVE_NOTHING') {\n            _this14.started = false;\n          }\n          return _this14.trigger('error');\n        }\n\n        _this14.masterXml_ = req.responseText;\n\n        var newMaster = _this14.parseMasterXml();\n\n        _this14.master = updateMaster$1(_this14.master, newMaster);\n\n        window_1.setTimeout(function () {\n          _this14.trigger('minimumUpdatePeriod');\n        }, _this14.master.minimumUpdatePeriod);\n      });\n    };\n\n    /**\n     * Refreshes the media playlist by re-parsing the master xml and updating playlist\n     * references. If this is an alternate loader, the updated parsed manifest is retrieved\n     * from the master loader.\n     */\n\n\n    DashPlaylistLoader.prototype.refreshMedia_ = function refreshMedia_() {\n      var _this15 = this;\n\n      var oldMaster = void 0;\n      var newMaster = void 0;\n\n      if (this.masterPlaylistLoader_) {\n        oldMaster = this.masterPlaylistLoader_.master;\n        newMaster = this.masterPlaylistLoader_.parseMasterXml();\n      } else {\n        oldMaster = this.master;\n        newMaster = this.parseMasterXml();\n      }\n\n      var updatedMaster = updateMaster$1(oldMaster, newMaster);\n\n      if (updatedMaster) {\n        if (this.masterPlaylistLoader_) {\n          this.masterPlaylistLoader_.master = updatedMaster;\n        } else {\n          this.master = updatedMaster;\n        }\n        this.media_ = updatedMaster.playlists[this.media_.uri];\n      } else {\n        this.trigger('playlistunchanged');\n      }\n\n      if (!this.media().endList) {\n        this.mediaUpdateTimeout = window_1.setTimeout(function () {\n          _this15.trigger('mediaupdatetimeout');\n        }, refreshDelay(this.media(), !!updatedMaster));\n      }\n\n      this.trigger('loadedplaylist');\n    };\n\n    return DashPlaylistLoader;\n  }(EventTarget$1$1);\n\n  var logger = function logger(source) {\n    if (videojs$1.log.debug) {\n      return videojs$1.log.debug.bind(videojs$1, 'VHS:', source + ' >');\n    }\n\n    return function () {};\n  };\n\n  function noop$1() {}\n\n  /**\n   * @file source-updater.js\n   */\n\n  /**\n   * A queue of callbacks to be serialized and applied when a\n   * MediaSource and its associated SourceBuffers are not in the\n   * updating state. It is used by the segment loader to update the\n   * underlying SourceBuffers when new data is loaded, for instance.\n   *\n   * @class SourceUpdater\n   * @param {MediaSource} mediaSource the MediaSource to create the\n   * SourceBuffer from\n   * @param {String} mimeType the desired MIME type of the underlying\n   * SourceBuffer\n   * @param {Object} sourceBufferEmitter an event emitter that fires when a source buffer is\n   * added to the media source\n   */\n\n  var SourceUpdater = function () {\n    function SourceUpdater(mediaSource, mimeType, type, sourceBufferEmitter) {\n      classCallCheck(this, SourceUpdater);\n\n      this.callbacks_ = [];\n      this.pendingCallback_ = null;\n      this.timestampOffset_ = 0;\n      this.mediaSource = mediaSource;\n      this.processedAppend_ = false;\n      this.type_ = type;\n      this.mimeType_ = mimeType;\n      this.logger_ = logger('SourceUpdater[' + type + '][' + mimeType + ']');\n\n      if (mediaSource.readyState === 'closed') {\n        mediaSource.addEventListener('sourceopen', this.createSourceBuffer_.bind(this, mimeType, sourceBufferEmitter));\n      } else {\n        this.createSourceBuffer_(mimeType, sourceBufferEmitter);\n      }\n    }\n\n    SourceUpdater.prototype.createSourceBuffer_ = function createSourceBuffer_(mimeType, sourceBufferEmitter) {\n      var _this16 = this;\n\n      this.sourceBuffer_ = this.mediaSource.addSourceBuffer(mimeType);\n\n      this.logger_('created SourceBuffer');\n\n      if (sourceBufferEmitter) {\n        sourceBufferEmitter.trigger('sourcebufferadded');\n\n        if (this.mediaSource.sourceBuffers.length < 2) {\n          // There's another source buffer we must wait for before we can start updating\n          // our own (or else we can get into a bad state, i.e., appending video/audio data\n          // before the other video/audio source buffer is available and leading to a video\n          // or audio only buffer).\n          sourceBufferEmitter.on('sourcebufferadded', function () {\n            _this16.start_();\n          });\n          return;\n        }\n      }\n\n      this.start_();\n    };\n\n    SourceUpdater.prototype.start_ = function start_() {\n      var _this17 = this;\n\n      this.started_ = true;\n\n      // run completion handlers and process callbacks as updateend\n      // events fire\n      this.onUpdateendCallback_ = function () {\n        var pendingCallback = _this17.pendingCallback_;\n\n        _this17.pendingCallback_ = null;\n\n        _this17.logger_('buffered [' + printableRange(_this17.buffered()) + ']');\n\n        if (pendingCallback) {\n          pendingCallback();\n        }\n\n        _this17.runCallback_();\n      };\n\n      this.sourceBuffer_.addEventListener('updateend', this.onUpdateendCallback_);\n\n      this.runCallback_();\n    };\n\n    /**\n     * Aborts the current segment and resets the segment parser.\n     *\n     * @param {Function} done function to call when done\n     * @see http://w3c.github.io/media-source/#widl-SourceBuffer-abort-void\n     */\n\n\n    SourceUpdater.prototype.abort = function abort(done) {\n      var _this18 = this;\n\n      if (this.processedAppend_) {\n        this.queueCallback_(function () {\n          _this18.sourceBuffer_.abort();\n        }, done);\n      }\n    };\n\n    /**\n     * Queue an update to append an ArrayBuffer.\n     *\n     * @param {ArrayBuffer} bytes\n     * @param {Function} done the function to call when done\n     * @see http://www.w3.org/TR/media-source/#widl-SourceBuffer-appendBuffer-void-ArrayBuffer-data\n     */\n\n\n    SourceUpdater.prototype.appendBuffer = function appendBuffer(bytes, done) {\n      var _this19 = this;\n\n      this.processedAppend_ = true;\n      this.queueCallback_(function () {\n        _this19.sourceBuffer_.appendBuffer(bytes);\n      }, done);\n    };\n\n    /**\n     * Indicates what TimeRanges are buffered in the managed SourceBuffer.\n     *\n     * @see http://www.w3.org/TR/media-source/#widl-SourceBuffer-buffered\n     */\n\n\n    SourceUpdater.prototype.buffered = function buffered() {\n      if (!this.sourceBuffer_) {\n        return videojs$1.createTimeRanges();\n      }\n      return this.sourceBuffer_.buffered;\n    };\n\n    /**\n     * Queue an update to remove a time range from the buffer.\n     *\n     * @param {Number} start where to start the removal\n     * @param {Number} end where to end the removal\n     * @see http://www.w3.org/TR/media-source/#widl-SourceBuffer-remove-void-double-start-unrestricted-double-end\n     */\n\n\n    SourceUpdater.prototype.remove = function remove(start, end) {\n      var _this20 = this;\n\n      if (this.processedAppend_) {\n        this.queueCallback_(function () {\n          _this20.logger_('remove [' + start + ' => ' + end + ']');\n          _this20.sourceBuffer_.remove(start, end);\n        }, noop$1);\n      }\n    };\n\n    /**\n     * Whether the underlying sourceBuffer is updating or not\n     *\n     * @return {Boolean} the updating status of the SourceBuffer\n     */\n\n\n    SourceUpdater.prototype.updating = function updating() {\n      return !this.sourceBuffer_ || this.sourceBuffer_.updating || this.pendingCallback_;\n    };\n\n    /**\n     * Set/get the timestampoffset on the SourceBuffer\n     *\n     * @return {Number} the timestamp offset\n     */\n\n\n    SourceUpdater.prototype.timestampOffset = function timestampOffset(offset) {\n      var _this21 = this;\n\n      if (typeof offset !== 'undefined') {\n        this.queueCallback_(function () {\n          _this21.sourceBuffer_.timestampOffset = offset;\n        });\n        this.timestampOffset_ = offset;\n      }\n      return this.timestampOffset_;\n    };\n\n    /**\n     * Queue a callback to run\n     */\n\n\n    SourceUpdater.prototype.queueCallback_ = function queueCallback_(callback, done) {\n      this.callbacks_.push([callback.bind(this), done]);\n      this.runCallback_();\n    };\n\n    /**\n     * Run a queued callback\n     */\n\n\n    SourceUpdater.prototype.runCallback_ = function runCallback_() {\n      var callbacks = void 0;\n\n      if (!this.updating() && this.callbacks_.length && this.started_) {\n        callbacks = this.callbacks_.shift();\n        this.pendingCallback_ = callbacks[1];\n        callbacks[0]();\n      }\n    };\n\n    /**\n     * dispose of the source updater and the underlying sourceBuffer\n     */\n\n\n    SourceUpdater.prototype.dispose = function dispose() {\n      this.sourceBuffer_.removeEventListener('updateend', this.onUpdateendCallback_);\n      if (this.sourceBuffer_ && this.mediaSource.readyState === 'open') {\n        this.sourceBuffer_.abort();\n      }\n    };\n\n    return SourceUpdater;\n  }();\n\n  var Config = {\n    GOAL_BUFFER_LENGTH: 30,\n    MAX_GOAL_BUFFER_LENGTH: 60,\n    GOAL_BUFFER_LENGTH_RATE: 1,\n    // A fudge factor to apply to advertised playlist bitrates to account for\n    // temporary flucations in client bandwidth\n    BANDWIDTH_VARIANCE: 1.2,\n    // How much of the buffer must be filled before we consider upswitching\n    BUFFER_LOW_WATER_LINE: 0,\n    MAX_BUFFER_LOW_WATER_LINE: 30,\n    BUFFER_LOW_WATER_LINE_RATE: 1\n  };\n\n  var REQUEST_ERRORS = {\n    FAILURE: 2,\n    TIMEOUT: -101,\n    ABORTED: -102\n  };\n\n  /**\n   * Turns segment byterange into a string suitable for use in\n   * HTTP Range requests\n   *\n   * @param {Object} byterange - an object with two values defining the start and end\n   *                             of a byte-range\n   */\n  var byterangeStr = function byterangeStr(byterange) {\n    var byterangeStart = void 0;\n    var byterangeEnd = void 0;\n\n    // `byterangeEnd` is one less than `offset + length` because the HTTP range\n    // header uses inclusive ranges\n    byterangeEnd = byterange.offset + byterange.length - 1;\n    byterangeStart = byterange.offset;\n    return 'bytes=' + byterangeStart + '-' + byterangeEnd;\n  };\n\n  /**\n   * Defines headers for use in the xhr request for a particular segment.\n   *\n   * @param {Object} segment - a simplified copy of the segmentInfo object\n   *                           from SegmentLoader\n   */\n  var segmentXhrHeaders = function segmentXhrHeaders(segment) {\n    var headers = {};\n\n    if (segment.byterange) {\n      headers.Range = byterangeStr(segment.byterange);\n    }\n    return headers;\n  };\n\n  /**\n   * Abort all requests\n   *\n   * @param {Object} activeXhrs - an object that tracks all XHR requests\n   */\n  var abortAll = function abortAll(activeXhrs) {\n    activeXhrs.forEach(function (xhr) {\n      xhr.abort();\n    });\n  };\n\n  /**\n   * Gather important bandwidth stats once a request has completed\n   *\n   * @param {Object} request - the XHR request from which to gather stats\n   */\n  var getRequestStats = function getRequestStats(request) {\n    return {\n      bandwidth: request.bandwidth,\n      bytesReceived: request.bytesReceived || 0,\n      roundTripTime: request.roundTripTime || 0\n    };\n  };\n\n  /**\n   * If possible gather bandwidth stats as a request is in\n   * progress\n   *\n   * @param {Event} progressEvent - an event object from an XHR's progress event\n   */\n  var getProgressStats = function getProgressStats(progressEvent) {\n    var request = progressEvent.target;\n    var roundTripTime = Date.now() - request.requestTime;\n    var stats = {\n      bandwidth: Infinity,\n      bytesReceived: 0,\n      roundTripTime: roundTripTime || 0\n    };\n\n    stats.bytesReceived = progressEvent.loaded;\n    // This can result in Infinity if stats.roundTripTime is 0 but that is ok\n    // because we should only use bandwidth stats on progress to determine when\n    // abort a request early due to insufficient bandwidth\n    stats.bandwidth = Math.floor(stats.bytesReceived / stats.roundTripTime * 8 * 1000);\n\n    return stats;\n  };\n\n  /**\n   * Handle all error conditions in one place and return an object\n   * with all the information\n   *\n   * @param {Error|null} error - if non-null signals an error occured with the XHR\n   * @param {Object} request -  the XHR request that possibly generated the error\n   */\n  var handleErrors = function handleErrors(error, request) {\n    if (request.timedout) {\n      return {\n        status: request.status,\n        message: 'HLS request timed-out at URL: ' + request.uri,\n        code: REQUEST_ERRORS.TIMEOUT,\n        xhr: request\n      };\n    }\n\n    if (request.aborted) {\n      return {\n        status: request.status,\n        message: 'HLS request aborted at URL: ' + request.uri,\n        code: REQUEST_ERRORS.ABORTED,\n        xhr: request\n      };\n    }\n\n    if (error) {\n      return {\n        status: request.status,\n        message: 'HLS request errored at URL: ' + request.uri,\n        code: REQUEST_ERRORS.FAILURE,\n        xhr: request\n      };\n    }\n\n    return null;\n  };\n\n  /**\n   * Handle responses for key data and convert the key data to the correct format\n   * for the decryption step later\n   *\n   * @param {Object} segment - a simplified copy of the segmentInfo object\n   *                           from SegmentLoader\n   * @param {Function} finishProcessingFn - a callback to execute to continue processing\n   *                                        this request\n   */\n  var handleKeyResponse = function handleKeyResponse(segment, finishProcessingFn) {\n    return function (error, request) {\n      var response = request.response;\n      var errorObj = handleErrors(error, request);\n\n      if (errorObj) {\n        return finishProcessingFn(errorObj, segment);\n      }\n\n      if (response.byteLength !== 16) {\n        return finishProcessingFn({\n          status: request.status,\n          message: 'Invalid HLS key at URL: ' + request.uri,\n          code: REQUEST_ERRORS.FAILURE,\n          xhr: request\n        }, segment);\n      }\n\n      var view = new DataView(response);\n\n      segment.key.bytes = new Uint32Array([view.getUint32(0), view.getUint32(4), view.getUint32(8), view.getUint32(12)]);\n      return finishProcessingFn(null, segment);\n    };\n  };\n\n  /**\n   * Handle init-segment responses\n   *\n   * @param {Object} segment - a simplified copy of the segmentInfo object\n   *                           from SegmentLoader\n   * @param {Function} finishProcessingFn - a callback to execute to continue processing\n   *                                        this request\n   */\n  var handleInitSegmentResponse = function handleInitSegmentResponse(segment, finishProcessingFn) {\n    return function (error, request) {\n      var response = request.response;\n      var errorObj = handleErrors(error, request);\n\n      if (errorObj) {\n        return finishProcessingFn(errorObj, segment);\n      }\n\n      // stop processing if received empty content\n      if (response.byteLength === 0) {\n        return finishProcessingFn({\n          status: request.status,\n          message: 'Empty HLS segment content at URL: ' + request.uri,\n          code: REQUEST_ERRORS.FAILURE,\n          xhr: request\n        }, segment);\n      }\n\n      segment.map.bytes = new Uint8Array(request.response);\n      return finishProcessingFn(null, segment);\n    };\n  };\n\n  /**\n   * Response handler for segment-requests being sure to set the correct\n   * property depending on whether the segment is encryped or not\n   * Also records and keeps track of stats that are used for ABR purposes\n   *\n   * @param {Object} segment - a simplified copy of the segmentInfo object\n   *                           from SegmentLoader\n   * @param {Function} finishProcessingFn - a callback to execute to continue processing\n   *                                        this request\n   */\n  var handleSegmentResponse = function handleSegmentResponse(segment, finishProcessingFn) {\n    return function (error, request) {\n      var response = request.response;\n      var errorObj = handleErrors(error, request);\n\n      if (errorObj) {\n        return finishProcessingFn(errorObj, segment);\n      }\n\n      // stop processing if received empty content\n      if (response.byteLength === 0) {\n        return finishProcessingFn({\n          status: request.status,\n          message: 'Empty HLS segment content at URL: ' + request.uri,\n          code: REQUEST_ERRORS.FAILURE,\n          xhr: request\n        }, segment);\n      }\n\n      segment.stats = getRequestStats(request);\n\n      if (segment.key) {\n        segment.encryptedBytes = new Uint8Array(request.response);\n      } else {\n        segment.bytes = new Uint8Array(request.response);\n      }\n\n      return finishProcessingFn(null, segment);\n    };\n  };\n\n  /**\n   * Decrypt the segment via the decryption web worker\n   *\n   * @param {WebWorker} decrypter - a WebWorker interface to AES-128 decryption routines\n   * @param {Object} segment - a simplified copy of the segmentInfo object\n   *                           from SegmentLoader\n   * @param {Function} doneFn - a callback that is executed after decryption has completed\n   */\n  var decryptSegment = function decryptSegment(decrypter, segment, doneFn) {\n    var decryptionHandler = function decryptionHandler(event) {\n      if (event.data.source === segment.requestId) {\n        decrypter.removeEventListener('message', decryptionHandler);\n        var decrypted = event.data.decrypted;\n\n        segment.bytes = new Uint8Array(decrypted.bytes, decrypted.byteOffset, decrypted.byteLength);\n        return doneFn(null, segment);\n      }\n    };\n\n    decrypter.addEventListener('message', decryptionHandler);\n\n    // this is an encrypted segment\n    // incrementally decrypt the segment\n    decrypter.postMessage(createTransferableMessage({\n      source: segment.requestId,\n      encrypted: segment.encryptedBytes,\n      key: segment.key.bytes,\n      iv: segment.key.iv\n    }), [segment.encryptedBytes.buffer, segment.key.bytes.buffer]);\n  };\n\n  /**\n   * The purpose of this function is to get the most pertinent error from the\n   * array of errors.\n   * For instance if a timeout and two aborts occur, then the aborts were\n   * likely triggered by the timeout so return that error object.\n   */\n  var getMostImportantError = function getMostImportantError(errors) {\n    return errors.reduce(function (prev, err) {\n      return err.code > prev.code ? err : prev;\n    });\n  };\n\n  /**\n   * This function waits for all XHRs to finish (with either success or failure)\n   * before continueing processing via it's callback. The function gathers errors\n   * from each request into a single errors array so that the error status for\n   * each request can be examined later.\n   *\n   * @param {Object} activeXhrs - an object that tracks all XHR requests\n   * @param {WebWorker} decrypter - a WebWorker interface to AES-128 decryption routines\n   * @param {Function} doneFn - a callback that is executed after all resources have been\n   *                            downloaded and any decryption completed\n   */\n  var waitForCompletion = function waitForCompletion(activeXhrs, decrypter, doneFn) {\n    var errors = [];\n    var count = 0;\n\n    return function (error, segment) {\n      if (error) {\n        // If there are errors, we have to abort any outstanding requests\n        abortAll(activeXhrs);\n        errors.push(error);\n      }\n      count += 1;\n\n      if (count === activeXhrs.length) {\n        // Keep track of when *all* of the requests have completed\n        segment.endOfAllRequests = Date.now();\n\n        if (errors.length > 0) {\n          var worstError = getMostImportantError(errors);\n\n          return doneFn(worstError, segment);\n        }\n        if (segment.encryptedBytes) {\n          return decryptSegment(decrypter, segment, doneFn);\n        }\n        // Otherwise, everything is ready just continue\n        return doneFn(null, segment);\n      }\n    };\n  };\n\n  /**\n   * Simple progress event callback handler that gathers some stats before\n   * executing a provided callback with the `segment` object\n   *\n   * @param {Object} segment - a simplified copy of the segmentInfo object\n   *                           from SegmentLoader\n   * @param {Function} progressFn - a callback that is executed each time a progress event\n   *                                is received\n   * @param {Event} event - the progress event object from XMLHttpRequest\n   */\n  var handleProgress = function handleProgress(segment, progressFn) {\n    return function (event) {\n      segment.stats = videojs$1.mergeOptions(segment.stats, getProgressStats(event));\n\n      // record the time that we receive the first byte of data\n      if (!segment.stats.firstBytesReceivedAt && segment.stats.bytesReceived) {\n        segment.stats.firstBytesReceivedAt = Date.now();\n      }\n\n      return progressFn(event, segment);\n    };\n  };\n\n  /**\n   * Load all resources and does any processing necessary for a media-segment\n   *\n   * Features:\n   *   decrypts the media-segment if it has a key uri and an iv\n   *   aborts *all* requests if *any* one request fails\n   *\n   * The segment object, at minimum, has the following format:\n   * {\n   *   resolvedUri: String,\n   *   [byterange]: {\n   *     offset: Number,\n   *     length: Number\n   *   },\n   *   [key]: {\n   *     resolvedUri: String\n   *     [byterange]: {\n   *       offset: Number,\n   *       length: Number\n   *     },\n   *     iv: {\n   *       bytes: Uint32Array\n   *     }\n   *   },\n   *   [map]: {\n   *     resolvedUri: String,\n   *     [byterange]: {\n   *       offset: Number,\n   *       length: Number\n   *     },\n   *     [bytes]: Uint8Array\n   *   }\n   * }\n   * ...where [name] denotes optional properties\n   *\n   * @param {Function} xhr - an instance of the xhr wrapper in xhr.js\n   * @param {Object} xhrOptions - the base options to provide to all xhr requests\n   * @param {WebWorker} decryptionWorker - a WebWorker interface to AES-128\n   *                                       decryption routines\n   * @param {Object} segment - a simplified copy of the segmentInfo object\n   *                           from SegmentLoader\n   * @param {Function} progressFn - a callback that receives progress events from the main\n   *                                segment's xhr request\n   * @param {Function} doneFn - a callback that is executed only once all requests have\n   *                            succeeded or failed\n   * @returns {Function} a function that, when invoked, immediately aborts all\n   *                     outstanding requests\n   */\n  var mediaSegmentRequest = function mediaSegmentRequest(xhr, xhrOptions, decryptionWorker, segment, progressFn, doneFn) {\n    var activeXhrs = [];\n    var finishProcessingFn = waitForCompletion(activeXhrs, decryptionWorker, doneFn);\n\n    // optionally, request the decryption key\n    if (segment.key) {\n      var keyRequestOptions = videojs$1.mergeOptions(xhrOptions, {\n        uri: segment.key.resolvedUri,\n        responseType: 'arraybuffer'\n      });\n      var keyRequestCallback = handleKeyResponse(segment, finishProcessingFn);\n      var keyXhr = xhr(keyRequestOptions, keyRequestCallback);\n\n      activeXhrs.push(keyXhr);\n    }\n\n    // optionally, request the associated media init segment\n    if (segment.map && !segment.map.bytes) {\n      var initSegmentOptions = videojs$1.mergeOptions(xhrOptions, {\n        uri: segment.map.resolvedUri,\n        responseType: 'arraybuffer',\n        headers: segmentXhrHeaders(segment.map)\n      });\n      var initSegmentRequestCallback = handleInitSegmentResponse(segment, finishProcessingFn);\n      var initSegmentXhr = xhr(initSegmentOptions, initSegmentRequestCallback);\n\n      activeXhrs.push(initSegmentXhr);\n    }\n\n    var segmentRequestOptions = videojs$1.mergeOptions(xhrOptions, {\n      uri: segment.resolvedUri,\n      responseType: 'arraybuffer',\n      headers: segmentXhrHeaders(segment)\n    });\n    var segmentRequestCallback = handleSegmentResponse(segment, finishProcessingFn);\n    var segmentXhr = xhr(segmentRequestOptions, segmentRequestCallback);\n\n    segmentXhr.addEventListener('progress', handleProgress(segment, progressFn));\n    activeXhrs.push(segmentXhr);\n\n    return function () {\n      return abortAll(activeXhrs);\n    };\n  };\n\n  /**\n   * @file - codecs.js - Handles tasks regarding codec strings such as translating them to\n   * codec strings, or translating codec strings into objects that can be examined.\n   */\n\n  // Default codec parameters if none were provided for video and/or audio\n  var defaultCodecs = {\n    videoCodec: 'avc1',\n    videoObjectTypeIndicator: '.4d400d',\n    // AAC-LC\n    audioProfile: '2'\n  };\n\n  /**\n   * Parses a codec string to retrieve the number of codecs specified,\n   * the video codec and object type indicator, and the audio profile.\n   */\n\n  var parseCodecs = function parseCodecs() {\n    var codecs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n    var result = {\n      codecCount: 0\n    };\n    var parsed = void 0;\n\n    result.codecCount = codecs.split(',').length;\n    result.codecCount = result.codecCount || 2;\n\n    // parse the video codec\n    parsed = /(^|\\s|,)+(avc[13])([^ ,]*)/i.exec(codecs);\n    if (parsed) {\n      result.videoCodec = parsed[2];\n      result.videoObjectTypeIndicator = parsed[3];\n    }\n\n    // parse the last field of the audio codec\n    result.audioProfile = /(^|\\s|,)+mp4a.[0-9A-Fa-f]+\\.([0-9A-Fa-f]+)/i.exec(codecs);\n    result.audioProfile = result.audioProfile && result.audioProfile[2];\n\n    return result;\n  };\n\n  /**\n   * Replace codecs in the codec string with the old apple-style `avc1.<dd>.<dd>` to the\n   * standard `avc1.<hhhhhh>`.\n   *\n   * @param codecString {String} the codec string\n   * @return {String} the codec string with old apple-style codecs replaced\n   *\n   * @private\n   */\n  var mapLegacyAvcCodecs = function mapLegacyAvcCodecs(codecString) {\n    return codecString.replace(/avc1\\.(\\d+)\\.(\\d+)/i, function (match) {\n      return translateLegacyCodecs([match])[0];\n    });\n  };\n\n  /**\n   * Build a media mime-type string from a set of parameters\n   * @param {String} type either 'audio' or 'video'\n   * @param {String} container either 'mp2t' or 'mp4'\n   * @param {Array} codecs an array of codec strings to add\n   * @return {String} a valid media mime-type\n   */\n  var makeMimeTypeString = function makeMimeTypeString(type, container, codecs) {\n    // The codecs array is filtered so that falsey values are\n    // dropped and don't cause Array#join to create spurious\n    // commas\n    return type + '/' + container + '; codecs=\"' + codecs.filter(function (c) {\n      return !!c;\n    }).join(', ') + '\"';\n  };\n\n  /**\n   * Returns the type container based on information in the playlist\n   * @param {Playlist} media the current media playlist\n   * @return {String} a valid media container type\n   */\n  var getContainerType = function getContainerType(media) {\n    // An initialization segment means the media playlist is an iframe\n    // playlist or is using the mp4 container. We don't currently\n    // support iframe playlists, so assume this is signalling mp4\n    // fragments.\n    if (media.segments && media.segments.length && media.segments[0].map) {\n      return 'mp4';\n    }\n    return 'mp2t';\n  };\n\n  /**\n   * Returns a set of codec strings parsed from the playlist or the default\n   * codec strings if no codecs were specified in the playlist\n   * @param {Playlist} media the current media playlist\n   * @return {Object} an object with the video and audio codecs\n   */\n  var getCodecs = function getCodecs(media) {\n    // if the codecs were explicitly specified, use them instead of the\n    // defaults\n    var mediaAttributes = media.attributes || {};\n\n    if (mediaAttributes.CODECS) {\n      return parseCodecs(mediaAttributes.CODECS);\n    }\n    return defaultCodecs;\n  };\n\n  var audioProfileFromDefault = function audioProfileFromDefault(master, audioGroupId) {\n    if (!master.mediaGroups.AUDIO || !audioGroupId) {\n      return null;\n    }\n\n    var audioGroup = master.mediaGroups.AUDIO[audioGroupId];\n\n    if (!audioGroup) {\n      return null;\n    }\n\n    for (var name in audioGroup) {\n      var audioType = audioGroup[name];\n\n      if (audioType.default && audioType.playlists) {\n        // codec should be the same for all playlists within the audio type\n        return parseCodecs(audioType.playlists[0].attributes.CODECS).audioProfile;\n      }\n    }\n\n    return null;\n  };\n\n  /**\n   * Calculates the MIME type strings for a working configuration of\n   * SourceBuffers to play variant streams in a master playlist. If\n   * there is no possible working configuration, an empty array will be\n   * returned.\n   *\n   * @param master {Object} the m3u8 object for the master playlist\n   * @param media {Object} the m3u8 object for the variant playlist\n   * @return {Array} the MIME type strings. If the array has more than\n   * one entry, the first element should be applied to the video\n   * SourceBuffer and the second to the audio SourceBuffer.\n   *\n   * @private\n   */\n  var mimeTypesForPlaylist = function mimeTypesForPlaylist(master, media) {\n    var containerType = getContainerType(media);\n    var codecInfo = getCodecs(media);\n    var mediaAttributes = media.attributes || {};\n    // Default condition for a traditional HLS (no demuxed audio/video)\n    var isMuxed = true;\n    var isMaat = false;\n\n    if (!media) {\n      // Not enough information\n      return [];\n    }\n\n    if (master.mediaGroups.AUDIO && mediaAttributes.AUDIO) {\n      var audioGroup = master.mediaGroups.AUDIO[mediaAttributes.AUDIO];\n\n      // Handle the case where we are in a multiple-audio track scenario\n      if (audioGroup) {\n        isMaat = true;\n        // Start with the everything demuxed then...\n        isMuxed = false;\n        // ...check to see if any audio group tracks are muxed (ie. lacking a uri)\n        for (var groupId in audioGroup) {\n          // either a uri is present (if the case of HLS and an external playlist), or\n          // playlists is present (in the case of DASH where we don't have external audio\n          // playlists)\n          if (!audioGroup[groupId].uri && !audioGroup[groupId].playlists) {\n            isMuxed = true;\n            break;\n          }\n        }\n      }\n    }\n\n    // HLS with multiple-audio tracks must always get an audio codec.\n    // Put another way, there is no way to have a video-only multiple-audio HLS!\n    if (isMaat && !codecInfo.audioProfile) {\n      if (!isMuxed) {\n        // It is possible for codecs to be specified on the audio media group playlist but\n        // not on the rendition playlist. This is mostly the case for DASH, where audio and\n        // video are always separate (and separately specified).\n        codecInfo.audioProfile = audioProfileFromDefault(master, mediaAttributes.AUDIO);\n      }\n\n      if (!codecInfo.audioProfile) {\n        videojs$1.log.warn('Multiple audio tracks present but no audio codec string is specified. ' + 'Attempting to use the default audio codec (mp4a.40.2)');\n        codecInfo.audioProfile = defaultCodecs.audioProfile;\n      }\n    }\n\n    // Generate the final codec strings from the codec object generated above\n    var codecStrings = {};\n\n    if (codecInfo.videoCodec) {\n      codecStrings.video = '' + codecInfo.videoCodec + codecInfo.videoObjectTypeIndicator;\n    }\n\n    if (codecInfo.audioProfile) {\n      codecStrings.audio = 'mp4a.40.' + codecInfo.audioProfile;\n    }\n\n    // Finally, make and return an array with proper mime-types depending on\n    // the configuration\n    var justAudio = makeMimeTypeString('audio', containerType, [codecStrings.audio]);\n    var justVideo = makeMimeTypeString('video', containerType, [codecStrings.video]);\n    var bothVideoAudio = makeMimeTypeString('video', containerType, [codecStrings.video, codecStrings.audio]);\n\n    if (isMaat) {\n      if (!isMuxed && codecStrings.video) {\n        return [justVideo, justAudio];\n      }\n\n      if (!isMuxed && !codecStrings.video) {\n        // There is no muxed content and no video codec string, so this is an audio only\n        // stream with alternate audio.\n        return [justAudio, justAudio];\n      }\n\n      // There exists the possiblity that this will return a `video/container`\n      // mime-type for the first entry in the array even when there is only audio.\n      // This doesn't appear to be a problem and simplifies the code.\n      return [bothVideoAudio, justAudio];\n    }\n\n    // If there is no video codec at all, always just return a single\n    // audio/<container> mime-type\n    if (!codecStrings.video) {\n      return [justAudio];\n    }\n\n    // When not using separate audio media groups, audio and video is\n    // *always* muxed\n    return [bothVideoAudio];\n  };\n\n  // Utilities\n\n  /**\n   * Returns the CSS value for the specified property on an element\n   * using `getComputedStyle`. Firefox has a long-standing issue where\n   * getComputedStyle() may return null when running in an iframe with\n   * `display: none`.\n   *\n   * @see https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n   * @param {HTMLElement} el the htmlelement to work on\n   * @param {string} the proprety to get the style for\n   */\n  var safeGetComputedStyle = function safeGetComputedStyle(el, property) {\n    var result = void 0;\n\n    if (!el) {\n      return '';\n    }\n\n    result = window_1.getComputedStyle(el);\n    if (!result) {\n      return '';\n    }\n\n    return result[property];\n  };\n\n  /**\n   * Resuable stable sort function\n   *\n   * @param {Playlists} array\n   * @param {Function} sortFn Different comparators\n   * @function stableSort\n   */\n  var stableSort = function stableSort(array, sortFn) {\n    var newArray = array.slice();\n\n    array.sort(function (left, right) {\n      var cmp = sortFn(left, right);\n\n      if (cmp === 0) {\n        return newArray.indexOf(left) - newArray.indexOf(right);\n      }\n      return cmp;\n    });\n  };\n\n  /**\n   * A comparator function to sort two playlist object by bandwidth.\n   *\n   * @param {Object} left a media playlist object\n   * @param {Object} right a media playlist object\n   * @return {Number} Greater than zero if the bandwidth attribute of\n   * left is greater than the corresponding attribute of right. Less\n   * than zero if the bandwidth of right is greater than left and\n   * exactly zero if the two are equal.\n   */\n  var comparePlaylistBandwidth = function comparePlaylistBandwidth(left, right) {\n    var leftBandwidth = void 0;\n    var rightBandwidth = void 0;\n\n    if (left.attributes.BANDWIDTH) {\n      leftBandwidth = left.attributes.BANDWIDTH;\n    }\n    leftBandwidth = leftBandwidth || window_1.Number.MAX_VALUE;\n    if (right.attributes.BANDWIDTH) {\n      rightBandwidth = right.attributes.BANDWIDTH;\n    }\n    rightBandwidth = rightBandwidth || window_1.Number.MAX_VALUE;\n\n    return leftBandwidth - rightBandwidth;\n  };\n\n  /**\n   * A comparator function to sort two playlist object by resolution (width).\n   * @param {Object} left a media playlist object\n   * @param {Object} right a media playlist object\n   * @return {Number} Greater than zero if the resolution.width attribute of\n   * left is greater than the corresponding attribute of right. Less\n   * than zero if the resolution.width of right is greater than left and\n   * exactly zero if the two are equal.\n   */\n  var comparePlaylistResolution = function comparePlaylistResolution(left, right) {\n    var leftWidth = void 0;\n    var rightWidth = void 0;\n\n    if (left.attributes.RESOLUTION && left.attributes.RESOLUTION.width) {\n      leftWidth = left.attributes.RESOLUTION.width;\n    }\n\n    leftWidth = leftWidth || window_1.Number.MAX_VALUE;\n\n    if (right.attributes.RESOLUTION && right.attributes.RESOLUTION.width) {\n      rightWidth = right.attributes.RESOLUTION.width;\n    }\n\n    rightWidth = rightWidth || window_1.Number.MAX_VALUE;\n\n    // NOTE - Fallback to bandwidth sort as appropriate in cases where multiple renditions\n    // have the same media dimensions/ resolution\n    if (leftWidth === rightWidth && left.attributes.BANDWIDTH && right.attributes.BANDWIDTH) {\n      return left.attributes.BANDWIDTH - right.attributes.BANDWIDTH;\n    }\n    return leftWidth - rightWidth;\n  };\n\n  /**\n   * Chooses the appropriate media playlist based on bandwidth and player size\n   *\n   * @param {Object} master\n   *        Object representation of the master manifest\n   * @param {Number} playerBandwidth\n   *        Current calculated bandwidth of the player\n   * @param {Number} playerWidth\n   *        Current width of the player element\n   * @param {Number} playerHeight\n   *        Current height of the player element\n   * @return {Playlist} the highest bitrate playlist less than the\n   * currently detected bandwidth, accounting for some amount of\n   * bandwidth variance\n   */\n  var simpleSelector = function simpleSelector(master, playerBandwidth, playerWidth, playerHeight) {\n    // convert the playlists to an intermediary representation to make comparisons easier\n    var sortedPlaylistReps = master.playlists.map(function (playlist) {\n      var width = void 0;\n      var height = void 0;\n      var bandwidth = void 0;\n\n      width = playlist.attributes.RESOLUTION && playlist.attributes.RESOLUTION.width;\n      height = playlist.attributes.RESOLUTION && playlist.attributes.RESOLUTION.height;\n      bandwidth = playlist.attributes.BANDWIDTH;\n\n      bandwidth = bandwidth || window_1.Number.MAX_VALUE;\n\n      return {\n        bandwidth: bandwidth,\n        width: width,\n        height: height,\n        playlist: playlist\n      };\n    });\n\n    stableSort(sortedPlaylistReps, function (left, right) {\n      return left.bandwidth - right.bandwidth;\n    });\n\n    // filter out any playlists that have been excluded due to\n    // incompatible configurations\n    sortedPlaylistReps = sortedPlaylistReps.filter(function (rep) {\n      return !Playlist.isIncompatible(rep.playlist);\n    });\n\n    // filter out any playlists that have been disabled manually through the representations\n    // api or blacklisted temporarily due to playback errors.\n    var enabledPlaylistReps = sortedPlaylistReps.filter(function (rep) {\n      return Playlist.isEnabled(rep.playlist);\n    });\n\n    if (!enabledPlaylistReps.length) {\n      // if there are no enabled playlists, then they have all been blacklisted or disabled\n      // by the user through the representations api. In this case, ignore blacklisting and\n      // fallback to what the user wants by using playlists the user has not disabled.\n      enabledPlaylistReps = sortedPlaylistReps.filter(function (rep) {\n        return !Playlist.isDisabled(rep.playlist);\n      });\n    }\n\n    // filter out any variant that has greater effective bitrate\n    // than the current estimated bandwidth\n    var bandwidthPlaylistReps = enabledPlaylistReps.filter(function (rep) {\n      return rep.bandwidth * Config.BANDWIDTH_VARIANCE < playerBandwidth;\n    });\n\n    var highestRemainingBandwidthRep = bandwidthPlaylistReps[bandwidthPlaylistReps.length - 1];\n\n    // get all of the renditions with the same (highest) bandwidth\n    // and then taking the very first element\n    var bandwidthBestRep = bandwidthPlaylistReps.filter(function (rep) {\n      return rep.bandwidth === highestRemainingBandwidthRep.bandwidth;\n    })[0];\n\n    // filter out playlists without resolution information\n    var haveResolution = bandwidthPlaylistReps.filter(function (rep) {\n      return rep.width && rep.height;\n    });\n\n    // sort variants by resolution\n    stableSort(haveResolution, function (left, right) {\n      return left.width - right.width;\n    });\n\n    // if we have the exact resolution as the player use it\n    var resolutionBestRepList = haveResolution.filter(function (rep) {\n      return rep.width === playerWidth && rep.height === playerHeight;\n    });\n\n    highestRemainingBandwidthRep = resolutionBestRepList[resolutionBestRepList.length - 1];\n    // ensure that we pick the highest bandwidth variant that have exact resolution\n    var resolutionBestRep = resolutionBestRepList.filter(function (rep) {\n      return rep.bandwidth === highestRemainingBandwidthRep.bandwidth;\n    })[0];\n\n    var resolutionPlusOneList = void 0;\n    var resolutionPlusOneSmallest = void 0;\n    var resolutionPlusOneRep = void 0;\n\n    // find the smallest variant that is larger than the player\n    // if there is no match of exact resolution\n    if (!resolutionBestRep) {\n      resolutionPlusOneList = haveResolution.filter(function (rep) {\n        return rep.width > playerWidth || rep.height > playerHeight;\n      });\n\n      // find all the variants have the same smallest resolution\n      resolutionPlusOneSmallest = resolutionPlusOneList.filter(function (rep) {\n        return rep.width === resolutionPlusOneList[0].width && rep.height === resolutionPlusOneList[0].height;\n      });\n\n      // ensure that we also pick the highest bandwidth variant that\n      // is just-larger-than the video player\n      highestRemainingBandwidthRep = resolutionPlusOneSmallest[resolutionPlusOneSmallest.length - 1];\n      resolutionPlusOneRep = resolutionPlusOneSmallest.filter(function (rep) {\n        return rep.bandwidth === highestRemainingBandwidthRep.bandwidth;\n      })[0];\n    }\n\n    // fallback chain of variants\n    var chosenRep = resolutionPlusOneRep || resolutionBestRep || bandwidthBestRep || enabledPlaylistReps[0] || sortedPlaylistReps[0];\n\n    return chosenRep ? chosenRep.playlist : null;\n  };\n\n  // Playlist Selectors\n\n  /**\n   * Chooses the appropriate media playlist based on the most recent\n   * bandwidth estimate and the player size.\n   *\n   * Expects to be called within the context of an instance of HlsHandler\n   *\n   * @return {Playlist} the highest bitrate playlist less than the\n   * currently detected bandwidth, accounting for some amount of\n   * bandwidth variance\n   */\n  var lastBandwidthSelector = function lastBandwidthSelector() {\n    return simpleSelector(this.playlists.master, this.systemBandwidth, parseInt(safeGetComputedStyle(this.tech_.el(), 'width'), 10), parseInt(safeGetComputedStyle(this.tech_.el(), 'height'), 10));\n  };\n\n  /**\n   * Chooses the appropriate media playlist based on the potential to rebuffer\n   *\n   * @param {Object} settings\n   *        Object of information required to use this selector\n   * @param {Object} settings.master\n   *        Object representation of the master manifest\n   * @param {Number} settings.currentTime\n   *        The current time of the player\n   * @param {Number} settings.bandwidth\n   *        Current measured bandwidth\n   * @param {Number} settings.duration\n   *        Duration of the media\n   * @param {Number} settings.segmentDuration\n   *        Segment duration to be used in round trip time calculations\n   * @param {Number} settings.timeUntilRebuffer\n   *        Time left in seconds until the player has to rebuffer\n   * @param {Number} settings.currentTimeline\n   *        The current timeline segments are being loaded from\n   * @param {SyncController} settings.syncController\n   *        SyncController for determining if we have a sync point for a given playlist\n   * @return {Object|null}\n   *         {Object} return.playlist\n   *         The highest bandwidth playlist with the least amount of rebuffering\n   *         {Number} return.rebufferingImpact\n   *         The amount of time in seconds switching to this playlist will rebuffer. A\n   *         negative value means that switching will cause zero rebuffering.\n   */\n  var minRebufferMaxBandwidthSelector = function minRebufferMaxBandwidthSelector(settings) {\n    var master = settings.master,\n        currentTime = settings.currentTime,\n        bandwidth = settings.bandwidth,\n        duration$$1 = settings.duration,\n        segmentDuration = settings.segmentDuration,\n        timeUntilRebuffer = settings.timeUntilRebuffer,\n        currentTimeline = settings.currentTimeline,\n        syncController = settings.syncController;\n\n    // filter out any playlists that have been excluded due to\n    // incompatible configurations\n\n    var compatiblePlaylists = master.playlists.filter(function (playlist) {\n      return !Playlist.isIncompatible(playlist);\n    });\n\n    // filter out any playlists that have been disabled manually through the representations\n    // api or blacklisted temporarily due to playback errors.\n    var enabledPlaylists = compatiblePlaylists.filter(Playlist.isEnabled);\n\n    if (!enabledPlaylists.length) {\n      // if there are no enabled playlists, then they have all been blacklisted or disabled\n      // by the user through the representations api. In this case, ignore blacklisting and\n      // fallback to what the user wants by using playlists the user has not disabled.\n      enabledPlaylists = compatiblePlaylists.filter(function (playlist) {\n        return !Playlist.isDisabled(playlist);\n      });\n    }\n\n    var bandwidthPlaylists = enabledPlaylists.filter(Playlist.hasAttribute.bind(null, 'BANDWIDTH'));\n\n    var rebufferingEstimates = bandwidthPlaylists.map(function (playlist) {\n      var syncPoint = syncController.getSyncPoint(playlist, duration$$1, currentTimeline, currentTime);\n      // If there is no sync point for this playlist, switching to it will require a\n      // sync request first. This will double the request time\n      var numRequests = syncPoint ? 1 : 2;\n      var requestTimeEstimate = Playlist.estimateSegmentRequestTime(segmentDuration, bandwidth, playlist);\n      var rebufferingImpact = requestTimeEstimate * numRequests - timeUntilRebuffer;\n\n      return {\n        playlist: playlist,\n        rebufferingImpact: rebufferingImpact\n      };\n    });\n\n    var noRebufferingPlaylists = rebufferingEstimates.filter(function (estimate) {\n      return estimate.rebufferingImpact <= 0;\n    });\n\n    // Sort by bandwidth DESC\n    stableSort(noRebufferingPlaylists, function (a, b) {\n      return comparePlaylistBandwidth(b.playlist, a.playlist);\n    });\n\n    if (noRebufferingPlaylists.length) {\n      return noRebufferingPlaylists[0];\n    }\n\n    stableSort(rebufferingEstimates, function (a, b) {\n      return a.rebufferingImpact - b.rebufferingImpact;\n    });\n\n    return rebufferingEstimates[0] || null;\n  };\n\n  /**\n   * Chooses the appropriate media playlist, which in this case is the lowest bitrate\n   * one with video.  If no renditions with video exist, return the lowest audio rendition.\n   *\n   * Expects to be called within the context of an instance of HlsHandler\n   *\n   * @return {Object|null}\n   *         {Object} return.playlist\n   *         The lowest bitrate playlist that contains a video codec.  If no such rendition\n   *         exists pick the lowest audio rendition.\n   */\n  var lowestBitrateCompatibleVariantSelector = function lowestBitrateCompatibleVariantSelector() {\n    // filter out any playlists that have been excluded due to\n    // incompatible configurations or playback errors\n    var playlists = this.playlists.master.playlists.filter(Playlist.isEnabled);\n\n    // Sort ascending by bitrate\n    stableSort(playlists, function (a, b) {\n      return comparePlaylistBandwidth(a, b);\n    });\n\n    // Parse and assume that playlists with no video codec have no video\n    // (this is not necessarily true, although it is generally true).\n    //\n    // If an entire manifest has no valid videos everything will get filtered\n    // out.\n    var playlistsWithVideo = playlists.filter(function (playlist) {\n      return parseCodecs(playlist.attributes.CODECS).videoCodec;\n    });\n\n    return playlistsWithVideo[0] || null;\n  };\n\n  /**\n   * @file segment-loader.js\n   */\n\n  // in ms\n  var CHECK_BUFFER_DELAY = 500;\n\n  /**\n   * Determines if we should call endOfStream on the media source based\n   * on the state of the buffer or if appened segment was the final\n   * segment in the playlist.\n   *\n   * @param {Object} playlist a media playlist object\n   * @param {Object} mediaSource the MediaSource object\n   * @param {Number} segmentIndex the index of segment we last appended\n   * @returns {Boolean} do we need to call endOfStream on the MediaSource\n   */\n  var detectEndOfStream = function detectEndOfStream(playlist, mediaSource, segmentIndex) {\n    if (!playlist || !mediaSource) {\n      return false;\n    }\n\n    var segments = playlist.segments;\n\n    // determine a few boolean values to help make the branch below easier\n    // to read\n    var appendedLastSegment = segmentIndex === segments.length;\n\n    // if we've buffered to the end of the video, we need to call endOfStream\n    // so that MediaSources can trigger the `ended` event when it runs out of\n    // buffered data instead of waiting for me\n    return playlist.endList && mediaSource.readyState === 'open' && appendedLastSegment;\n  };\n\n  var finite = function finite(num) {\n    return typeof num === 'number' && isFinite(num);\n  };\n\n  var illegalMediaSwitch = function illegalMediaSwitch(loaderType, startingMedia, newSegmentMedia) {\n    // Although these checks should most likely cover non 'main' types, for now it narrows\n    // the scope of our checks.\n    if (loaderType !== 'main' || !startingMedia || !newSegmentMedia) {\n      return null;\n    }\n\n    if (!newSegmentMedia.containsAudio && !newSegmentMedia.containsVideo) {\n      return 'Neither audio nor video found in segment.';\n    }\n\n    if (startingMedia.containsVideo && !newSegmentMedia.containsVideo) {\n      return 'Only audio found in segment when we expected video.' + ' We can\\'t switch to audio only from a stream that had video.' + ' To get rid of this message, please add codec information to the manifest.';\n    }\n\n    if (!startingMedia.containsVideo && newSegmentMedia.containsVideo) {\n      return 'Video found in segment when we expected only audio.' + ' We can\\'t switch to a stream with video from an audio only stream.' + ' To get rid of this message, please add codec information to the manifest.';\n    }\n\n    return null;\n  };\n\n  /**\n   * Calculates a time value that is safe to remove from the back buffer without interupting\n   * playback.\n   *\n   * @param {TimeRange} seekable\n   *        The current seekable range\n   * @param {Number} currentTime\n   *        The current time of the player\n   * @param {Number} targetDuration\n   *        The target duration of the current playlist\n   * @return {Number}\n   *         Time that is safe to remove from the back buffer without interupting playback\n   */\n  var safeBackBufferTrimTime = function safeBackBufferTrimTime(seekable$$1, currentTime, targetDuration) {\n    var removeToTime = void 0;\n\n    if (seekable$$1.length && seekable$$1.start(0) > 0 && seekable$$1.start(0) < currentTime) {\n      // If we have a seekable range use that as the limit for what can be removed safely\n      removeToTime = seekable$$1.start(0);\n    } else {\n      // otherwise remove anything older than 30 seconds before the current play head\n      removeToTime = currentTime - 30;\n    }\n\n    // Don't allow removing from the buffer within target duration of current time\n    // to avoid the possibility of removing the GOP currently being played which could\n    // cause playback stalls.\n    return Math.min(removeToTime, currentTime - targetDuration);\n  };\n\n  var segmentInfoString = function segmentInfoString(segmentInfo) {\n    var _segmentInfo$segment = segmentInfo.segment,\n        start = _segmentInfo$segment.start,\n        end = _segmentInfo$segment.end,\n        _segmentInfo$playlist = segmentInfo.playlist,\n        seq = _segmentInfo$playlist.mediaSequence,\n        id = _segmentInfo$playlist.id,\n        _segmentInfo$playlist2 = _segmentInfo$playlist.segments,\n        segments = _segmentInfo$playlist2 === undefined ? [] : _segmentInfo$playlist2,\n        index = segmentInfo.mediaIndex,\n        timeline = segmentInfo.timeline;\n\n\n    return ['appending [' + index + '] of [' + seq + ', ' + (seq + segments.length) + '] from playlist [' + id + ']', '[' + start + ' => ' + end + '] in timeline [' + timeline + ']'].join(' ');\n  };\n\n  /**\n   * An object that manages segment loading and appending.\n   *\n   * @class SegmentLoader\n   * @param {Object} options required and optional options\n   * @extends videojs.EventTarget\n   */\n\n  var SegmentLoader = function (_videojs$EventTarget3) {\n    inherits(SegmentLoader, _videojs$EventTarget3);\n\n    function SegmentLoader(settings) {\n      classCallCheck(this, SegmentLoader);\n\n      // check pre-conditions\n      var _this22 = possibleConstructorReturn(this, _videojs$EventTarget3.call(this));\n\n      if (!settings) {\n        throw new TypeError('Initialization settings are required');\n      }\n      if (typeof settings.currentTime !== 'function') {\n        throw new TypeError('No currentTime getter specified');\n      }\n      if (!settings.mediaSource) {\n        throw new TypeError('No MediaSource specified');\n      }\n      // public properties\n      _this22.bandwidth = settings.bandwidth;\n      _this22.throughput = { rate: 0, count: 0 };\n      _this22.roundTrip = NaN;\n      _this22.resetStats_();\n      _this22.mediaIndex = null;\n\n      // private settings\n      _this22.hasPlayed_ = settings.hasPlayed;\n      _this22.currentTime_ = settings.currentTime;\n      _this22.seekable_ = settings.seekable;\n      _this22.seeking_ = settings.seeking;\n      _this22.duration_ = settings.duration;\n      _this22.mediaSource_ = settings.mediaSource;\n      _this22.hls_ = settings.hls;\n      _this22.loaderType_ = settings.loaderType;\n      _this22.startingMedia_ = void 0;\n      _this22.segmentMetadataTrack_ = settings.segmentMetadataTrack;\n      _this22.goalBufferLength_ = settings.goalBufferLength;\n      _this22.sourceType_ = settings.sourceType;\n      _this22.state_ = 'INIT';\n\n      // private instance variables\n      _this22.checkBufferTimeout_ = null;\n      _this22.error_ = void 0;\n      _this22.currentTimeline_ = -1;\n      _this22.pendingSegment_ = null;\n      _this22.mimeType_ = null;\n      _this22.sourceUpdater_ = null;\n      _this22.xhrOptions_ = null;\n\n      // Fragmented mp4 playback\n      _this22.activeInitSegmentId_ = null;\n      _this22.initSegments_ = {};\n\n      _this22.decrypter_ = settings.decrypter;\n\n      // Manages the tracking and generation of sync-points, mappings\n      // between a time in the display time and a segment index within\n      // a playlist\n      _this22.syncController_ = settings.syncController;\n      _this22.syncPoint_ = {\n        segmentIndex: 0,\n        time: 0\n      };\n\n      _this22.syncController_.on('syncinfoupdate', function () {\n        return _this22.trigger('syncinfoupdate');\n      });\n\n      _this22.mediaSource_.addEventListener('sourceopen', function () {\n        return _this22.ended_ = false;\n      });\n\n      // ...for determining the fetch location\n      _this22.fetchAtBuffer_ = false;\n\n      _this22.logger_ = logger('SegmentLoader[' + _this22.loaderType_ + ']');\n\n      Object.defineProperty(_this22, 'state', {\n        get: function get$$1() {\n          return this.state_;\n        },\n        set: function set$$1(newState) {\n          if (newState !== this.state_) {\n            this.logger_(this.state_ + ' -> ' + newState);\n            this.state_ = newState;\n          }\n        }\n      });\n      return _this22;\n    }\n\n    /**\n     * reset all of our media stats\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.resetStats_ = function resetStats_() {\n      this.mediaBytesTransferred = 0;\n      this.mediaRequests = 0;\n      this.mediaRequestsAborted = 0;\n      this.mediaRequestsTimedout = 0;\n      this.mediaRequestsErrored = 0;\n      this.mediaTransferDuration = 0;\n      this.mediaSecondsLoaded = 0;\n    };\n\n    /**\n     * dispose of the SegmentLoader and reset to the default state\n     */\n\n\n    SegmentLoader.prototype.dispose = function dispose() {\n      this.state = 'DISPOSED';\n      this.pause();\n      this.abort_();\n      if (this.sourceUpdater_) {\n        this.sourceUpdater_.dispose();\n      }\n      this.resetStats_();\n    };\n\n    /**\n     * abort anything that is currently doing on with the SegmentLoader\n     * and reset to a default state\n     */\n\n\n    SegmentLoader.prototype.abort = function abort() {\n      if (this.state !== 'WAITING') {\n        if (this.pendingSegment_) {\n          this.pendingSegment_ = null;\n        }\n        return;\n      }\n\n      this.abort_();\n\n      // We aborted the requests we were waiting on, so reset the loader's state to READY\n      // since we are no longer \"waiting\" on any requests. XHR callback is not always run\n      // when the request is aborted. This will prevent the loader from being stuck in the\n      // WAITING state indefinitely.\n      this.state = 'READY';\n\n      // don't wait for buffer check timeouts to begin fetching the\n      // next segment\n      if (!this.paused()) {\n        this.monitorBuffer_();\n      }\n    };\n\n    /**\n     * abort all pending xhr requests and null any pending segements\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.abort_ = function abort_() {\n      if (this.pendingSegment_) {\n        this.pendingSegment_.abortRequests();\n      }\n\n      // clear out the segment being processed\n      this.pendingSegment_ = null;\n    };\n\n    /**\n     * set an error on the segment loader and null out any pending segements\n     *\n     * @param {Error} error the error to set on the SegmentLoader\n     * @return {Error} the error that was set or that is currently set\n     */\n\n\n    SegmentLoader.prototype.error = function error(_error) {\n      if (typeof _error !== 'undefined') {\n        this.error_ = _error;\n      }\n\n      this.pendingSegment_ = null;\n      return this.error_;\n    };\n\n    SegmentLoader.prototype.endOfStream = function endOfStream() {\n      this.ended_ = true;\n      this.pause();\n      this.trigger('ended');\n    };\n\n    /**\n     * Indicates which time ranges are buffered\n     *\n     * @return {TimeRange}\n     *         TimeRange object representing the current buffered ranges\n     */\n\n\n    SegmentLoader.prototype.buffered_ = function buffered_() {\n      if (!this.sourceUpdater_) {\n        return videojs$1.createTimeRanges();\n      }\n\n      return this.sourceUpdater_.buffered();\n    };\n\n    /**\n     * Gets and sets init segment for the provided map\n     *\n     * @param {Object} map\n     *        The map object representing the init segment to get or set\n     * @param {Boolean=} set\n     *        If true, the init segment for the provided map should be saved\n     * @return {Object}\n     *         map object for desired init segment\n     */\n\n\n    SegmentLoader.prototype.initSegment = function initSegment(map) {\n      var set$$1 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!map) {\n        return null;\n      }\n\n      var id = initSegmentId(map);\n      var storedMap = this.initSegments_[id];\n\n      if (set$$1 && !storedMap && map.bytes) {\n        this.initSegments_[id] = storedMap = {\n          resolvedUri: map.resolvedUri,\n          byterange: map.byterange,\n          bytes: map.bytes\n        };\n      }\n\n      return storedMap || map;\n    };\n\n    /**\n     * Returns true if all configuration required for loading is present, otherwise false.\n     *\n     * @return {Boolean} True if the all configuration is ready for loading\n     * @private\n     */\n\n\n    SegmentLoader.prototype.couldBeginLoading_ = function couldBeginLoading_() {\n      return this.playlist_ && (\n      // the source updater is created when init_ is called, so either having a\n      // source updater or being in the INIT state with a mimeType is enough\n      // to say we have all the needed configuration to start loading.\n      this.sourceUpdater_ || this.mimeType_ && this.state === 'INIT') && !this.paused();\n    };\n\n    /**\n     * load a playlist and start to fill the buffer\n     */\n\n\n    SegmentLoader.prototype.load = function load() {\n      // un-pause\n      this.monitorBuffer_();\n\n      // if we don't have a playlist yet, keep waiting for one to be\n      // specified\n      if (!this.playlist_) {\n        return;\n      }\n\n      // not sure if this is the best place for this\n      this.syncController_.setDateTimeMapping(this.playlist_);\n\n      // if all the configuration is ready, initialize and begin loading\n      if (this.state === 'INIT' && this.couldBeginLoading_()) {\n        return this.init_();\n      }\n\n      // if we're in the middle of processing a segment already, don't\n      // kick off an additional segment request\n      if (!this.couldBeginLoading_() || this.state !== 'READY' && this.state !== 'INIT') {\n        return;\n      }\n\n      this.state = 'READY';\n    };\n\n    /**\n     * Once all the starting parameters have been specified, begin\n     * operation. This method should only be invoked from the INIT\n     * state.\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.init_ = function init_() {\n      this.state = 'READY';\n      this.sourceUpdater_ = new SourceUpdater(this.mediaSource_, this.mimeType_, this.loaderType_, this.sourceBufferEmitter_);\n      this.resetEverything();\n      return this.monitorBuffer_();\n    };\n\n    /**\n     * set a playlist on the segment loader\n     *\n     * @param {PlaylistLoader} media the playlist to set on the segment loader\n     */\n\n\n    SegmentLoader.prototype.playlist = function playlist(newPlaylist) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!newPlaylist) {\n        return;\n      }\n\n      var oldPlaylist = this.playlist_;\n      var segmentInfo = this.pendingSegment_;\n\n      this.playlist_ = newPlaylist;\n      this.xhrOptions_ = options;\n\n      // when we haven't started playing yet, the start of a live playlist\n      // is always our zero-time so force a sync update each time the playlist\n      // is refreshed from the server\n      if (!this.hasPlayed_()) {\n        newPlaylist.syncInfo = {\n          mediaSequence: newPlaylist.mediaSequence,\n          time: 0\n        };\n      }\n\n      var oldId = oldPlaylist ? oldPlaylist.id : null;\n\n      this.logger_('playlist update [' + oldId + ' => ' + newPlaylist.id + ']');\n\n      // in VOD, this is always a rendition switch (or we updated our syncInfo above)\n      // in LIVE, we always want to update with new playlists (including refreshes)\n      this.trigger('syncinfoupdate');\n\n      // if we were unpaused but waiting for a playlist, start\n      // buffering now\n      if (this.state === 'INIT' && this.couldBeginLoading_()) {\n        return this.init_();\n      }\n\n      if (!oldPlaylist || oldPlaylist.uri !== newPlaylist.uri) {\n        if (this.mediaIndex !== null) {\n          // we must \"resync\" the segment loader when we switch renditions and\n          // the segment loader is already synced to the previous rendition\n          this.resyncLoader();\n        }\n\n        // the rest of this function depends on `oldPlaylist` being defined\n        return;\n      }\n\n      // we reloaded the same playlist so we are in a live scenario\n      // and we will likely need to adjust the mediaIndex\n      var mediaSequenceDiff = newPlaylist.mediaSequence - oldPlaylist.mediaSequence;\n\n      this.logger_('live window shift [' + mediaSequenceDiff + ']');\n\n      // update the mediaIndex on the SegmentLoader\n      // this is important because we can abort a request and this value must be\n      // equal to the last appended mediaIndex\n      if (this.mediaIndex !== null) {\n        this.mediaIndex -= mediaSequenceDiff;\n      }\n\n      // update the mediaIndex on the SegmentInfo object\n      // this is important because we will update this.mediaIndex with this value\n      // in `handleUpdateEnd_` after the segment has been successfully appended\n      if (segmentInfo) {\n        segmentInfo.mediaIndex -= mediaSequenceDiff;\n\n        // we need to update the referenced segment so that timing information is\n        // saved for the new playlist's segment, however, if the segment fell off the\n        // playlist, we can leave the old reference and just lose the timing info\n        if (segmentInfo.mediaIndex >= 0) {\n          segmentInfo.segment = newPlaylist.segments[segmentInfo.mediaIndex];\n        }\n      }\n\n      this.syncController_.saveExpiredSegmentInfo(oldPlaylist, newPlaylist);\n    };\n\n    /**\n     * Prevent the loader from fetching additional segments. If there\n     * is a segment request outstanding, it will finish processing\n     * before the loader halts. A segment loader can be unpaused by\n     * calling load().\n     */\n\n\n    SegmentLoader.prototype.pause = function pause() {\n      if (this.checkBufferTimeout_) {\n        window_1.clearTimeout(this.checkBufferTimeout_);\n\n        this.checkBufferTimeout_ = null;\n      }\n    };\n\n    /**\n     * Returns whether the segment loader is fetching additional\n     * segments when given the opportunity. This property can be\n     * modified through calls to pause() and load().\n     */\n\n\n    SegmentLoader.prototype.paused = function paused() {\n      return this.checkBufferTimeout_ === null;\n    };\n\n    /**\n     * create/set the following mimetype on the SourceBuffer through a\n     * SourceUpdater\n     *\n     * @param {String} mimeType the mime type string to use\n     * @param {Object} sourceBufferEmitter an event emitter that fires when a source buffer\n     * is added to the media source\n     */\n\n\n    SegmentLoader.prototype.mimeType = function mimeType(_mimeType, sourceBufferEmitter) {\n      if (this.mimeType_) {\n        return;\n      }\n\n      this.mimeType_ = _mimeType;\n      this.sourceBufferEmitter_ = sourceBufferEmitter;\n      // if we were unpaused but waiting for a sourceUpdater, start\n      // buffering now\n      if (this.state === 'INIT' && this.couldBeginLoading_()) {\n        this.init_();\n      }\n    };\n\n    /**\n     * Delete all the buffered data and reset the SegmentLoader\n     */\n\n\n    SegmentLoader.prototype.resetEverything = function resetEverything() {\n      this.ended_ = false;\n      this.resetLoader();\n      this.remove(0, this.duration_());\n      this.trigger('reseteverything');\n    };\n\n    /**\n     * Force the SegmentLoader to resync and start loading around the currentTime instead\n     * of starting at the end of the buffer\n     *\n     * Useful for fast quality changes\n     */\n\n\n    SegmentLoader.prototype.resetLoader = function resetLoader() {\n      this.fetchAtBuffer_ = false;\n      this.resyncLoader();\n    };\n\n    /**\n     * Force the SegmentLoader to restart synchronization and make a conservative guess\n     * before returning to the simple walk-forward method\n     */\n\n\n    SegmentLoader.prototype.resyncLoader = function resyncLoader() {\n      this.mediaIndex = null;\n      this.syncPoint_ = null;\n      this.abort();\n    };\n\n    /**\n     * Remove any data in the source buffer between start and end times\n     * @param {Number} start - the start time of the region to remove from the buffer\n     * @param {Number} end - the end time of the region to remove from the buffer\n     */\n\n\n    SegmentLoader.prototype.remove = function remove(start, end) {\n      if (this.sourceUpdater_) {\n        this.sourceUpdater_.remove(start, end);\n      }\n      removeCuesFromTrack(start, end, this.segmentMetadataTrack_);\n    };\n\n    /**\n     * (re-)schedule monitorBufferTick_ to run as soon as possible\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.monitorBuffer_ = function monitorBuffer_() {\n      if (this.checkBufferTimeout_) {\n        window_1.clearTimeout(this.checkBufferTimeout_);\n      }\n\n      this.checkBufferTimeout_ = window_1.setTimeout(this.monitorBufferTick_.bind(this), 1);\n    };\n\n    /**\n     * As long as the SegmentLoader is in the READY state, periodically\n     * invoke fillBuffer_().\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.monitorBufferTick_ = function monitorBufferTick_() {\n      if (this.state === 'READY') {\n        this.fillBuffer_();\n      }\n\n      if (this.checkBufferTimeout_) {\n        window_1.clearTimeout(this.checkBufferTimeout_);\n      }\n\n      this.checkBufferTimeout_ = window_1.setTimeout(this.monitorBufferTick_.bind(this), CHECK_BUFFER_DELAY);\n    };\n\n    /**\n     * fill the buffer with segements unless the sourceBuffers are\n     * currently updating\n     *\n     * Note: this function should only ever be called by monitorBuffer_\n     * and never directly\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.fillBuffer_ = function fillBuffer_() {\n      if (this.sourceUpdater_.updating()) {\n        return;\n      }\n\n      if (!this.syncPoint_) {\n        this.syncPoint_ = this.syncController_.getSyncPoint(this.playlist_, this.duration_(), this.currentTimeline_, this.currentTime_());\n      }\n\n      // see if we need to begin loading immediately\n      var segmentInfo = this.checkBuffer_(this.buffered_(), this.playlist_, this.mediaIndex, this.hasPlayed_(), this.currentTime_(), this.syncPoint_);\n\n      if (!segmentInfo) {\n        return;\n      }\n\n      var isEndOfStream = detectEndOfStream(this.playlist_, this.mediaSource_, segmentInfo.mediaIndex);\n\n      if (isEndOfStream) {\n        this.endOfStream();\n        return;\n      }\n\n      if (segmentInfo.mediaIndex === this.playlist_.segments.length - 1 && this.mediaSource_.readyState === 'ended' && !this.seeking_()) {\n        return;\n      }\n\n      // We will need to change timestampOffset of the sourceBuffer if either of\n      // the following conditions are true:\n      // - The segment.timeline !== this.currentTimeline\n      //   (we are crossing a discontinuity somehow)\n      // - The \"timestampOffset\" for the start of this segment is less than\n      //   the currently set timestampOffset\n      if (segmentInfo.timeline !== this.currentTimeline_ || segmentInfo.startOfSegment !== null && segmentInfo.startOfSegment < this.sourceUpdater_.timestampOffset()) {\n        this.syncController_.reset();\n        segmentInfo.timestampOffset = segmentInfo.startOfSegment;\n      }\n\n      this.loadSegment_(segmentInfo);\n    };\n\n    /**\n     * Determines what segment request should be made, given current playback\n     * state.\n     *\n     * @param {TimeRanges} buffered - the state of the buffer\n     * @param {Object} playlist - the playlist object to fetch segments from\n     * @param {Number} mediaIndex - the previous mediaIndex fetched or null\n     * @param {Boolean} hasPlayed - a flag indicating whether we have played or not\n     * @param {Number} currentTime - the playback position in seconds\n     * @param {Object} syncPoint - a segment info object that describes the\n     * @returns {Object} a segment request object that describes the segment to load\n     */\n\n\n    SegmentLoader.prototype.checkBuffer_ = function checkBuffer_(buffered, playlist, mediaIndex, hasPlayed, currentTime, syncPoint) {\n      var lastBufferedEnd = 0;\n      var startOfSegment = void 0;\n\n      if (buffered.length) {\n        lastBufferedEnd = buffered.end(buffered.length - 1);\n      }\n\n      var bufferedTime = Math.max(0, lastBufferedEnd - currentTime);\n\n      if (!playlist.segments.length) {\n        return null;\n      }\n\n      // if there is plenty of content buffered, and the video has\n      // been played before relax for awhile\n      if (bufferedTime >= this.goalBufferLength_()) {\n        return null;\n      }\n\n      // if the video has not yet played once, and we already have\n      // one segment downloaded do nothing\n      if (!hasPlayed && bufferedTime >= 1) {\n        return null;\n      }\n\n      // When the syncPoint is null, there is no way of determining a good\n      // conservative segment index to fetch from\n      // The best thing to do here is to get the kind of sync-point data by\n      // making a request\n      if (syncPoint === null) {\n        mediaIndex = this.getSyncSegmentCandidate_(playlist);\n        return this.generateSegmentInfo_(playlist, mediaIndex, null, true);\n      }\n\n      // Under normal playback conditions fetching is a simple walk forward\n      if (mediaIndex !== null) {\n        var segment = playlist.segments[mediaIndex];\n\n        if (segment && segment.end) {\n          startOfSegment = segment.end;\n        } else {\n          startOfSegment = lastBufferedEnd;\n        }\n        return this.generateSegmentInfo_(playlist, mediaIndex + 1, startOfSegment, false);\n      }\n\n      // There is a sync-point but the lack of a mediaIndex indicates that\n      // we need to make a good conservative guess about which segment to\n      // fetch\n      if (this.fetchAtBuffer_) {\n        // Find the segment containing the end of the buffer\n        var mediaSourceInfo = Playlist.getMediaInfoForTime(playlist, lastBufferedEnd, syncPoint.segmentIndex, syncPoint.time);\n\n        mediaIndex = mediaSourceInfo.mediaIndex;\n        startOfSegment = mediaSourceInfo.startTime;\n      } else {\n        // Find the segment containing currentTime\n        var _mediaSourceInfo = Playlist.getMediaInfoForTime(playlist, currentTime, syncPoint.segmentIndex, syncPoint.time);\n\n        mediaIndex = _mediaSourceInfo.mediaIndex;\n        startOfSegment = _mediaSourceInfo.startTime;\n      }\n\n      return this.generateSegmentInfo_(playlist, mediaIndex, startOfSegment, false);\n    };\n\n    /**\n     * The segment loader has no recourse except to fetch a segment in the\n     * current playlist and use the internal timestamps in that segment to\n     * generate a syncPoint. This function returns a good candidate index\n     * for that process.\n     *\n     * @param {Object} playlist - the playlist object to look for a\n     * @returns {Number} An index of a segment from the playlist to load\n     */\n\n\n    SegmentLoader.prototype.getSyncSegmentCandidate_ = function getSyncSegmentCandidate_(playlist) {\n      var _this23 = this;\n\n      if (this.currentTimeline_ === -1) {\n        return 0;\n      }\n\n      var segmentIndexArray = playlist.segments.map(function (s, i) {\n        return {\n          timeline: s.timeline,\n          segmentIndex: i\n        };\n      }).filter(function (s) {\n        return s.timeline === _this23.currentTimeline_;\n      });\n\n      if (segmentIndexArray.length) {\n        return segmentIndexArray[Math.min(segmentIndexArray.length - 1, 1)].segmentIndex;\n      }\n\n      return Math.max(playlist.segments.length - 1, 0);\n    };\n\n    SegmentLoader.prototype.generateSegmentInfo_ = function generateSegmentInfo_(playlist, mediaIndex, startOfSegment, isSyncRequest) {\n      if (mediaIndex < 0 || mediaIndex >= playlist.segments.length) {\n        return null;\n      }\n\n      var segment = playlist.segments[mediaIndex];\n\n      return {\n        requestId: 'segment-loader-' + Math.random(),\n        // resolve the segment URL relative to the playlist\n        uri: segment.resolvedUri,\n        // the segment's mediaIndex at the time it was requested\n        mediaIndex: mediaIndex,\n        // whether or not to update the SegmentLoader's state with this\n        // segment's mediaIndex\n        isSyncRequest: isSyncRequest,\n        startOfSegment: startOfSegment,\n        // the segment's playlist\n        playlist: playlist,\n        // unencrypted bytes of the segment\n        bytes: null,\n        // when a key is defined for this segment, the encrypted bytes\n        encryptedBytes: null,\n        // The target timestampOffset for this segment when we append it\n        // to the source buffer\n        timestampOffset: null,\n        // The timeline that the segment is in\n        timeline: segment.timeline,\n        // The expected duration of the segment in seconds\n        duration: segment.duration,\n        // retain the segment in case the playlist updates while doing an async process\n        segment: segment\n      };\n    };\n\n    /**\n     * Determines if the network has enough bandwidth to complete the current segment\n     * request in a timely manner. If not, the request will be aborted early and bandwidth\n     * updated to trigger a playlist switch.\n     *\n     * @param {Object} stats\n     *        Object containing stats about the request timing and size\n     * @return {Boolean} True if the request was aborted, false otherwise\n     * @private\n     */\n\n\n    SegmentLoader.prototype.abortRequestEarly_ = function abortRequestEarly_(stats) {\n      if (this.hls_.tech_.paused() ||\n      // Don't abort if the current playlist is on the lowestEnabledRendition\n      // TODO: Replace using timeout with a boolean indicating whether this playlist is\n      //       the lowestEnabledRendition.\n      !this.xhrOptions_.timeout ||\n      // Don't abort if we have no bandwidth information to estimate segment sizes\n      !this.playlist_.attributes.BANDWIDTH) {\n        return false;\n      }\n\n      // Wait at least 1 second since the first byte of data has been received before\n      // using the calculated bandwidth from the progress event to allow the bitrate\n      // to stabilize\n      if (Date.now() - (stats.firstBytesReceivedAt || Date.now()) < 1000) {\n        return false;\n      }\n\n      var currentTime = this.currentTime_();\n      var measuredBandwidth = stats.bandwidth;\n      var segmentDuration = this.pendingSegment_.duration;\n\n      var requestTimeRemaining = Playlist.estimateSegmentRequestTime(segmentDuration, measuredBandwidth, this.playlist_, stats.bytesReceived);\n\n      // Subtract 1 from the timeUntilRebuffer so we still consider an early abort\n      // if we are only left with less than 1 second when the request completes.\n      // A negative timeUntilRebuffering indicates we are already rebuffering\n      var timeUntilRebuffer$$1 = timeUntilRebuffer(this.buffered_(), currentTime, this.hls_.tech_.playbackRate()) - 1;\n\n      // Only consider aborting early if the estimated time to finish the download\n      // is larger than the estimated time until the player runs out of forward buffer\n      if (requestTimeRemaining <= timeUntilRebuffer$$1) {\n        return false;\n      }\n\n      var switchCandidate = minRebufferMaxBandwidthSelector({\n        master: this.hls_.playlists.master,\n        currentTime: currentTime,\n        bandwidth: measuredBandwidth,\n        duration: this.duration_(),\n        segmentDuration: segmentDuration,\n        timeUntilRebuffer: timeUntilRebuffer$$1,\n        currentTimeline: this.currentTimeline_,\n        syncController: this.syncController_\n      });\n\n      if (!switchCandidate) {\n        return;\n      }\n\n      var rebufferingImpact = requestTimeRemaining - timeUntilRebuffer$$1;\n\n      var timeSavedBySwitching = rebufferingImpact - switchCandidate.rebufferingImpact;\n\n      var minimumTimeSaving = 0.5;\n\n      // If we are already rebuffering, increase the amount of variance we add to the\n      // potential round trip time of the new request so that we are not too aggressive\n      // with switching to a playlist that might save us a fraction of a second.\n      if (timeUntilRebuffer$$1 <= TIME_FUDGE_FACTOR) {\n        minimumTimeSaving = 1;\n      }\n\n      if (!switchCandidate.playlist || switchCandidate.playlist.uri === this.playlist_.uri || timeSavedBySwitching < minimumTimeSaving) {\n        return false;\n      }\n\n      // set the bandwidth to that of the desired playlist being sure to scale by\n      // BANDWIDTH_VARIANCE and add one so the playlist selector does not exclude it\n      // don't trigger a bandwidthupdate as the bandwidth is artifial\n      this.bandwidth = switchCandidate.playlist.attributes.BANDWIDTH * Config.BANDWIDTH_VARIANCE + 1;\n      this.abort();\n      this.trigger('earlyabort');\n      return true;\n    };\n\n    /**\n     * XHR `progress` event handler\n     *\n     * @param {Event}\n     *        The XHR `progress` event\n     * @param {Object} simpleSegment\n     *        A simplified segment object copy\n     * @private\n     */\n\n\n    SegmentLoader.prototype.handleProgress_ = function handleProgress_(event, simpleSegment) {\n      if (!this.pendingSegment_ || simpleSegment.requestId !== this.pendingSegment_.requestId || this.abortRequestEarly_(simpleSegment.stats)) {\n        return;\n      }\n\n      this.trigger('progress');\n    };\n\n    /**\n     * load a specific segment from a request into the buffer\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.loadSegment_ = function loadSegment_(segmentInfo) {\n      this.state = 'WAITING';\n      this.pendingSegment_ = segmentInfo;\n      this.trimBackBuffer_(segmentInfo);\n\n      segmentInfo.abortRequests = mediaSegmentRequest(this.hls_.xhr, this.xhrOptions_, this.decrypter_, this.createSimplifiedSegmentObj_(segmentInfo),\n      // progress callback\n      this.handleProgress_.bind(this), this.segmentRequestFinished_.bind(this));\n    };\n\n    /**\n     * trim the back buffer so that we don't have too much data\n     * in the source buffer\n     *\n     * @private\n     *\n     * @param {Object} segmentInfo - the current segment\n     */\n\n\n    SegmentLoader.prototype.trimBackBuffer_ = function trimBackBuffer_(segmentInfo) {\n      var removeToTime = safeBackBufferTrimTime(this.seekable_(), this.currentTime_(), this.playlist_.targetDuration || 10);\n\n      // Chrome has a hard limit of 150MB of\n      // buffer and a very conservative \"garbage collector\"\n      // We manually clear out the old buffer to ensure\n      // we don't trigger the QuotaExceeded error\n      // on the source buffer during subsequent appends\n\n      if (removeToTime > 0) {\n        this.remove(0, removeToTime);\n      }\n    };\n\n    /**\n     * created a simplified copy of the segment object with just the\n     * information necessary to perform the XHR and decryption\n     *\n     * @private\n     *\n     * @param {Object} segmentInfo - the current segment\n     * @returns {Object} a simplified segment object copy\n     */\n\n\n    SegmentLoader.prototype.createSimplifiedSegmentObj_ = function createSimplifiedSegmentObj_(segmentInfo) {\n      var segment = segmentInfo.segment;\n      var simpleSegment = {\n        resolvedUri: segment.resolvedUri,\n        byterange: segment.byterange,\n        requestId: segmentInfo.requestId\n      };\n\n      if (segment.key) {\n        // if the media sequence is greater than 2^32, the IV will be incorrect\n        // assuming 10s segments, that would be about 1300 years\n        var iv = segment.key.iv || new Uint32Array([0, 0, 0, segmentInfo.mediaIndex + segmentInfo.playlist.mediaSequence]);\n\n        simpleSegment.key = {\n          resolvedUri: segment.key.resolvedUri,\n          iv: iv\n        };\n      }\n\n      if (segment.map) {\n        simpleSegment.map = this.initSegment(segment.map);\n      }\n\n      return simpleSegment;\n    };\n\n    /**\n     * Handle the callback from the segmentRequest function and set the\n     * associated SegmentLoader state and errors if necessary\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.segmentRequestFinished_ = function segmentRequestFinished_(error, simpleSegment) {\n      // every request counts as a media request even if it has been aborted\n      // or canceled due to a timeout\n      this.mediaRequests += 1;\n\n      if (simpleSegment.stats) {\n        this.mediaBytesTransferred += simpleSegment.stats.bytesReceived;\n        this.mediaTransferDuration += simpleSegment.stats.roundTripTime;\n      }\n\n      // The request was aborted and the SegmentLoader has already been reset\n      if (!this.pendingSegment_) {\n        this.mediaRequestsAborted += 1;\n        return;\n      }\n\n      // the request was aborted and the SegmentLoader has already started\n      // another request. this can happen when the timeout for an aborted\n      // request triggers due to a limitation in the XHR library\n      // do not count this as any sort of request or we risk double-counting\n      if (simpleSegment.requestId !== this.pendingSegment_.requestId) {\n        return;\n      }\n\n      // an error occurred from the active pendingSegment_ so reset everything\n      if (error) {\n        this.pendingSegment_ = null;\n        this.state = 'READY';\n\n        // the requests were aborted just record the aborted stat and exit\n        // this is not a true error condition and nothing corrective needs\n        // to be done\n        if (error.code === REQUEST_ERRORS.ABORTED) {\n          this.mediaRequestsAborted += 1;\n          return;\n        }\n\n        this.pause();\n\n        // the error is really just that at least one of the requests timed-out\n        // set the bandwidth to a very low value and trigger an ABR switch to\n        // take emergency action\n        if (error.code === REQUEST_ERRORS.TIMEOUT) {\n          this.mediaRequestsTimedout += 1;\n          this.bandwidth = 1;\n          this.roundTrip = NaN;\n          this.trigger('bandwidthupdate');\n          return;\n        }\n\n        // if control-flow has arrived here, then the error is real\n        // emit an error event to blacklist the current playlist\n        this.mediaRequestsErrored += 1;\n        this.error(error);\n        this.trigger('error');\n        return;\n      }\n\n      // the response was a success so set any bandwidth stats the request\n      // generated for ABR purposes\n      this.bandwidth = simpleSegment.stats.bandwidth;\n      this.roundTrip = simpleSegment.stats.roundTripTime;\n\n      // if this request included an initialization segment, save that data\n      // to the initSegment cache\n      if (simpleSegment.map) {\n        simpleSegment.map = this.initSegment(simpleSegment.map, true);\n      }\n\n      this.processSegmentResponse_(simpleSegment);\n    };\n\n    /**\n     * Move any important data from the simplified segment object\n     * back to the real segment object for future phases\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.processSegmentResponse_ = function processSegmentResponse_(simpleSegment) {\n      var segmentInfo = this.pendingSegment_;\n\n      segmentInfo.bytes = simpleSegment.bytes;\n      if (simpleSegment.map) {\n        segmentInfo.segment.map.bytes = simpleSegment.map.bytes;\n      }\n\n      segmentInfo.endOfAllRequests = simpleSegment.endOfAllRequests;\n      this.handleSegment_();\n    };\n\n    /**\n     * append a decrypted segement to the SourceBuffer through a SourceUpdater\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.handleSegment_ = function handleSegment_() {\n      var _this24 = this;\n\n      if (!this.pendingSegment_) {\n        this.state = 'READY';\n        return;\n      }\n\n      var segmentInfo = this.pendingSegment_;\n      var segment = segmentInfo.segment;\n      var timingInfo = this.syncController_.probeSegmentInfo(segmentInfo);\n\n      // When we have our first timing info, determine what media types this loader is\n      // dealing with. Although we're maintaining extra state, it helps to preserve the\n      // separation of segment loader from the actual source buffers.\n      if (typeof this.startingMedia_ === 'undefined' && timingInfo && (\n      // Guard against cases where we're not getting timing info at all until we are\n      // certain that all streams will provide it.\n      timingInfo.containsAudio || timingInfo.containsVideo)) {\n        this.startingMedia_ = {\n          containsAudio: timingInfo.containsAudio,\n          containsVideo: timingInfo.containsVideo\n        };\n      }\n\n      var illegalMediaSwitchError = illegalMediaSwitch(this.loaderType_, this.startingMedia_, timingInfo);\n\n      if (illegalMediaSwitchError) {\n        this.error({\n          message: illegalMediaSwitchError,\n          blacklistDuration: Infinity\n        });\n        this.trigger('error');\n        return;\n      }\n\n      if (segmentInfo.isSyncRequest) {\n        this.trigger('syncinfoupdate');\n        this.pendingSegment_ = null;\n        this.state = 'READY';\n        return;\n      }\n\n      if (segmentInfo.timestampOffset !== null && segmentInfo.timestampOffset !== this.sourceUpdater_.timestampOffset()) {\n        this.sourceUpdater_.timestampOffset(segmentInfo.timestampOffset);\n        // fired when a timestamp offset is set in HLS (can also identify discontinuities)\n        this.trigger('timestampoffset');\n      }\n\n      var timelineMapping = this.syncController_.mappingForTimeline(segmentInfo.timeline);\n\n      if (timelineMapping !== null) {\n        this.trigger({\n          type: 'segmenttimemapping',\n          mapping: timelineMapping\n        });\n      }\n\n      this.state = 'APPENDING';\n\n      // if the media initialization segment is changing, append it\n      // before the content segment\n      if (segment.map) {\n        var initId = initSegmentId(segment.map);\n\n        if (!this.activeInitSegmentId_ || this.activeInitSegmentId_ !== initId) {\n          var initSegment = this.initSegment(segment.map);\n\n          this.sourceUpdater_.appendBuffer(initSegment.bytes, function () {\n            _this24.activeInitSegmentId_ = initId;\n          });\n        }\n      }\n\n      segmentInfo.byteLength = segmentInfo.bytes.byteLength;\n      if (typeof segment.start === 'number' && typeof segment.end === 'number') {\n        this.mediaSecondsLoaded += segment.end - segment.start;\n      } else {\n        this.mediaSecondsLoaded += segment.duration;\n      }\n\n      this.logger_(segmentInfoString(segmentInfo));\n\n      this.sourceUpdater_.appendBuffer(segmentInfo.bytes, this.handleUpdateEnd_.bind(this));\n    };\n\n    /**\n     * callback to run when appendBuffer is finished. detects if we are\n     * in a good state to do things with the data we got, or if we need\n     * to wait for more\n     *\n     * @private\n     */\n\n\n    SegmentLoader.prototype.handleUpdateEnd_ = function handleUpdateEnd_() {\n      if (!this.pendingSegment_) {\n        this.state = 'READY';\n        if (!this.paused()) {\n          this.monitorBuffer_();\n        }\n        return;\n      }\n\n      var segmentInfo = this.pendingSegment_;\n      var segment = segmentInfo.segment;\n      var isWalkingForward = this.mediaIndex !== null;\n\n      this.pendingSegment_ = null;\n      this.recordThroughput_(segmentInfo);\n      this.addSegmentMetadataCue_(segmentInfo);\n\n      this.state = 'READY';\n\n      this.mediaIndex = segmentInfo.mediaIndex;\n      this.fetchAtBuffer_ = true;\n      this.currentTimeline_ = segmentInfo.timeline;\n\n      // We must update the syncinfo to recalculate the seekable range before\n      // the following conditional otherwise it may consider this a bad \"guess\"\n      // and attempt to resync when the post-update seekable window and live\n      // point would mean that this was the perfect segment to fetch\n      this.trigger('syncinfoupdate');\n\n      // If we previously appended a segment that ends more than 3 targetDurations before\n      // the currentTime_ that means that our conservative guess was too conservative.\n      // In that case, reset the loader state so that we try to use any information gained\n      // from the previous request to create a new, more accurate, sync-point.\n      if (segment.end && this.currentTime_() - segment.end > segmentInfo.playlist.targetDuration * 3) {\n        this.resetEverything();\n        return;\n      }\n\n      // Don't do a rendition switch unless we have enough time to get a sync segment\n      // and conservatively guess\n      if (isWalkingForward) {\n        this.trigger('bandwidthupdate');\n      }\n      this.trigger('progress');\n\n      // any time an update finishes and the last segment is in the\n      // buffer, end the stream. this ensures the \"ended\" event will\n      // fire if playback reaches that point.\n      var isEndOfStream = detectEndOfStream(segmentInfo.playlist, this.mediaSource_, segmentInfo.mediaIndex + 1);\n\n      if (isEndOfStream) {\n        this.endOfStream();\n      }\n\n      if (!this.paused()) {\n        this.monitorBuffer_();\n      }\n    };\n\n    /**\n     * Records the current throughput of the decrypt, transmux, and append\n     * portion of the semgment pipeline. `throughput.rate` is a the cumulative\n     * moving average of the throughput. `throughput.count` is the number of\n     * data points in the average.\n     *\n     * @private\n     * @param {Object} segmentInfo the object returned by loadSegment\n     */\n\n\n    SegmentLoader.prototype.recordThroughput_ = function recordThroughput_(segmentInfo) {\n      var rate = this.throughput.rate;\n      // Add one to the time to ensure that we don't accidentally attempt to divide\n      // by zero in the case where the throughput is ridiculously high\n      var segmentProcessingTime = Date.now() - segmentInfo.endOfAllRequests + 1;\n      // Multiply by 8000 to convert from bytes/millisecond to bits/second\n      var segmentProcessingThroughput = Math.floor(segmentInfo.byteLength / segmentProcessingTime * 8 * 1000);\n\n      // This is just a cumulative moving average calculation:\n      //   newAvg = oldAvg + (sample - oldAvg) / (sampleCount + 1)\n      this.throughput.rate += (segmentProcessingThroughput - rate) / ++this.throughput.count;\n    };\n\n    /**\n     * Adds a cue to the segment-metadata track with some metadata information about the\n     * segment\n     *\n     * @private\n     * @param {Object} segmentInfo\n     *        the object returned by loadSegment\n     * @method addSegmentMetadataCue_\n     */\n\n\n    SegmentLoader.prototype.addSegmentMetadataCue_ = function addSegmentMetadataCue_(segmentInfo) {\n      if (!this.segmentMetadataTrack_) {\n        return;\n      }\n\n      var segment = segmentInfo.segment;\n      var start = segment.start;\n      var end = segment.end;\n\n      // Do not try adding the cue if the start and end times are invalid.\n      if (!finite(start) || !finite(end)) {\n        return;\n      }\n\n      removeCuesFromTrack(start, end, this.segmentMetadataTrack_);\n\n      var Cue = window_1.WebKitDataCue || window_1.VTTCue;\n      var value = {\n        bandwidth: segmentInfo.playlist.attributes.BANDWIDTH,\n        resolution: segmentInfo.playlist.attributes.RESOLUTION,\n        codecs: segmentInfo.playlist.attributes.CODECS,\n        byteLength: segmentInfo.byteLength,\n        uri: segmentInfo.uri,\n        timeline: segmentInfo.timeline,\n        playlist: segmentInfo.playlist.uri,\n        start: start,\n        end: end\n      };\n      var data = JSON.stringify(value);\n      var cue = new Cue(start, end, data);\n\n      // Attach the metadata to the value property of the cue to keep consistency between\n      // the differences of WebKitDataCue in safari and VTTCue in other browsers\n      cue.value = value;\n\n      this.segmentMetadataTrack_.addCue(cue);\n    };\n\n    return SegmentLoader;\n  }(videojs$1.EventTarget);\n\n  /**\n   * @file vtt-segment-loader.js\n   */\n\n  var VTT_LINE_TERMINATORS = new Uint8Array('\\n\\n'.split('').map(function (char) {\n    return char.charCodeAt(0);\n  }));\n\n  var uintToString = function uintToString(uintArray) {\n    return String.fromCharCode.apply(null, uintArray);\n  };\n\n  /**\n   * An object that manages segment loading and appending.\n   *\n   * @class VTTSegmentLoader\n   * @param {Object} options required and optional options\n   * @extends videojs.EventTarget\n   */\n\n  var VTTSegmentLoader = function (_SegmentLoader) {\n    inherits(VTTSegmentLoader, _SegmentLoader);\n\n    function VTTSegmentLoader(settings) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      classCallCheck(this, VTTSegmentLoader);\n\n      // SegmentLoader requires a MediaSource be specified or it will throw an error;\n      // however, VTTSegmentLoader has no need of a media source, so delete the reference\n      var _this25 = possibleConstructorReturn(this, _SegmentLoader.call(this, settings, options));\n\n      _this25.mediaSource_ = null;\n\n      _this25.subtitlesTrack_ = null;\n      return _this25;\n    }\n\n    /**\n     * Indicates which time ranges are buffered\n     *\n     * @return {TimeRange}\n     *         TimeRange object representing the current buffered ranges\n     */\n\n\n    VTTSegmentLoader.prototype.buffered_ = function buffered_() {\n      if (!this.subtitlesTrack_ || !this.subtitlesTrack_.cues.length) {\n        return videojs$1.createTimeRanges();\n      }\n\n      var cues = this.subtitlesTrack_.cues;\n      var start = cues[0].startTime;\n      var end = cues[cues.length - 1].startTime;\n\n      return videojs$1.createTimeRanges([[start, end]]);\n    };\n\n    /**\n     * Gets and sets init segment for the provided map\n     *\n     * @param {Object} map\n     *        The map object representing the init segment to get or set\n     * @param {Boolean=} set\n     *        If true, the init segment for the provided map should be saved\n     * @return {Object}\n     *         map object for desired init segment\n     */\n\n\n    VTTSegmentLoader.prototype.initSegment = function initSegment(map) {\n      var set$$1 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!map) {\n        return null;\n      }\n\n      var id = initSegmentId(map);\n      var storedMap = this.initSegments_[id];\n\n      if (set$$1 && !storedMap && map.bytes) {\n        // append WebVTT line terminators to the media initialization segment if it exists\n        // to follow the WebVTT spec (https://w3c.github.io/webvtt/#file-structure) that\n        // requires two or more WebVTT line terminators between the WebVTT header and the\n        // rest of the file\n        var combinedByteLength = VTT_LINE_TERMINATORS.byteLength + map.bytes.byteLength;\n        var combinedSegment = new Uint8Array(combinedByteLength);\n\n        combinedSegment.set(map.bytes);\n        combinedSegment.set(VTT_LINE_TERMINATORS, map.bytes.byteLength);\n\n        this.initSegments_[id] = storedMap = {\n          resolvedUri: map.resolvedUri,\n          byterange: map.byterange,\n          bytes: combinedSegment\n        };\n      }\n\n      return storedMap || map;\n    };\n\n    /**\n     * Returns true if all configuration required for loading is present, otherwise false.\n     *\n     * @return {Boolean} True if the all configuration is ready for loading\n     * @private\n     */\n\n\n    VTTSegmentLoader.prototype.couldBeginLoading_ = function couldBeginLoading_() {\n      return this.playlist_ && this.subtitlesTrack_ && !this.paused();\n    };\n\n    /**\n     * Once all the starting parameters have been specified, begin\n     * operation. This method should only be invoked from the INIT\n     * state.\n     *\n     * @private\n     */\n\n\n    VTTSegmentLoader.prototype.init_ = function init_() {\n      this.state = 'READY';\n      this.resetEverything();\n      return this.monitorBuffer_();\n    };\n\n    /**\n     * Set a subtitle track on the segment loader to add subtitles to\n     *\n     * @param {TextTrack=} track\n     *        The text track to add loaded subtitles to\n     * @return {TextTrack}\n     *        Returns the subtitles track\n     */\n\n\n    VTTSegmentLoader.prototype.track = function track(_track) {\n      if (typeof _track === 'undefined') {\n        return this.subtitlesTrack_;\n      }\n\n      this.subtitlesTrack_ = _track;\n\n      // if we were unpaused but waiting for a sourceUpdater, start\n      // buffering now\n      if (this.state === 'INIT' && this.couldBeginLoading_()) {\n        this.init_();\n      }\n\n      return this.subtitlesTrack_;\n    };\n\n    /**\n     * Remove any data in the source buffer between start and end times\n     * @param {Number} start - the start time of the region to remove from the buffer\n     * @param {Number} end - the end time of the region to remove from the buffer\n     */\n\n\n    VTTSegmentLoader.prototype.remove = function remove(start, end) {\n      removeCuesFromTrack(start, end, this.subtitlesTrack_);\n    };\n\n    /**\n     * fill the buffer with segements unless the sourceBuffers are\n     * currently updating\n     *\n     * Note: this function should only ever be called by monitorBuffer_\n     * and never directly\n     *\n     * @private\n     */\n\n\n    VTTSegmentLoader.prototype.fillBuffer_ = function fillBuffer_() {\n      var _this26 = this;\n\n      if (!this.syncPoint_) {\n        this.syncPoint_ = this.syncController_.getSyncPoint(this.playlist_, this.duration_(), this.currentTimeline_, this.currentTime_());\n      }\n\n      // see if we need to begin loading immediately\n      var segmentInfo = this.checkBuffer_(this.buffered_(), this.playlist_, this.mediaIndex, this.hasPlayed_(), this.currentTime_(), this.syncPoint_);\n\n      segmentInfo = this.skipEmptySegments_(segmentInfo);\n\n      if (!segmentInfo) {\n        return;\n      }\n\n      if (this.syncController_.timestampOffsetForTimeline(segmentInfo.timeline) === null) {\n        // We don't have the timestamp offset that we need to sync subtitles.\n        // Rerun on a timestamp offset or user interaction.\n        var checkTimestampOffset = function checkTimestampOffset() {\n          _this26.state = 'READY';\n          if (!_this26.paused()) {\n            // if not paused, queue a buffer check as soon as possible\n            _this26.monitorBuffer_();\n          }\n        };\n\n        this.syncController_.one('timestampoffset', checkTimestampOffset);\n        this.state = 'WAITING_ON_TIMELINE';\n        return;\n      }\n\n      this.loadSegment_(segmentInfo);\n    };\n\n    /**\n     * Prevents the segment loader from requesting segments we know contain no subtitles\n     * by walking forward until we find the next segment that we don't know whether it is\n     * empty or not.\n     *\n     * @param {Object} segmentInfo\n     *        a segment info object that describes the current segment\n     * @return {Object}\n     *         a segment info object that describes the current segment\n     */\n\n\n    VTTSegmentLoader.prototype.skipEmptySegments_ = function skipEmptySegments_(segmentInfo) {\n      while (segmentInfo && segmentInfo.segment.empty) {\n        segmentInfo = this.generateSegmentInfo_(segmentInfo.playlist, segmentInfo.mediaIndex + 1, segmentInfo.startOfSegment + segmentInfo.duration, segmentInfo.isSyncRequest);\n      }\n      return segmentInfo;\n    };\n\n    /**\n     * append a decrypted segement to the SourceBuffer through a SourceUpdater\n     *\n     * @private\n     */\n\n\n    VTTSegmentLoader.prototype.handleSegment_ = function handleSegment_() {\n      var _this27 = this;\n\n      if (!this.pendingSegment_ || !this.subtitlesTrack_) {\n        this.state = 'READY';\n        return;\n      }\n\n      this.state = 'APPENDING';\n\n      var segmentInfo = this.pendingSegment_;\n      var segment = segmentInfo.segment;\n\n      // Make sure that vttjs has loaded, otherwise, wait till it finished loading\n      if (typeof window_1.WebVTT !== 'function' && this.subtitlesTrack_ && this.subtitlesTrack_.tech_) {\n\n        var loadHandler = function loadHandler() {\n          _this27.handleSegment_();\n        };\n\n        this.state = 'WAITING_ON_VTTJS';\n        this.subtitlesTrack_.tech_.one('vttjsloaded', loadHandler);\n        this.subtitlesTrack_.tech_.one('vttjserror', function () {\n          _this27.subtitlesTrack_.tech_.off('vttjsloaded', loadHandler);\n          _this27.error({\n            message: 'Error loading vtt.js'\n          });\n          _this27.state = 'READY';\n          _this27.pause();\n          _this27.trigger('error');\n        });\n\n        return;\n      }\n\n      segment.requested = true;\n\n      try {\n        this.parseVTTCues_(segmentInfo);\n      } catch (e) {\n        this.error({\n          message: e.message\n        });\n        this.state = 'READY';\n        this.pause();\n        return this.trigger('error');\n      }\n\n      this.updateTimeMapping_(segmentInfo, this.syncController_.timelines[segmentInfo.timeline], this.playlist_);\n\n      if (segmentInfo.isSyncRequest) {\n        this.trigger('syncinfoupdate');\n        this.pendingSegment_ = null;\n        this.state = 'READY';\n        return;\n      }\n\n      segmentInfo.byteLength = segmentInfo.bytes.byteLength;\n\n      this.mediaSecondsLoaded += segment.duration;\n\n      if (segmentInfo.cues.length) {\n        // remove any overlapping cues to prevent doubling\n        this.remove(segmentInfo.cues[0].endTime, segmentInfo.cues[segmentInfo.cues.length - 1].endTime);\n      }\n\n      segmentInfo.cues.forEach(function (cue) {\n        _this27.subtitlesTrack_.addCue(cue);\n      });\n\n      this.handleUpdateEnd_();\n    };\n\n    /**\n     * Uses the WebVTT parser to parse the segment response\n     *\n     * @param {Object} segmentInfo\n     *        a segment info object that describes the current segment\n     * @private\n     */\n\n\n    VTTSegmentLoader.prototype.parseVTTCues_ = function parseVTTCues_(segmentInfo) {\n      var decoder = void 0;\n      var decodeBytesToString = false;\n\n      if (typeof window_1.TextDecoder === 'function') {\n        decoder = new window_1.TextDecoder('utf8');\n      } else {\n        decoder = window_1.WebVTT.StringDecoder();\n        decodeBytesToString = true;\n      }\n\n      var parser = new window_1.WebVTT.Parser(window_1, window_1.vttjs, decoder);\n\n      segmentInfo.cues = [];\n      segmentInfo.timestampmap = { MPEGTS: 0, LOCAL: 0 };\n\n      parser.oncue = segmentInfo.cues.push.bind(segmentInfo.cues);\n      parser.ontimestampmap = function (map) {\n        return segmentInfo.timestampmap = map;\n      };\n      parser.onparsingerror = function (error) {\n        videojs$1.log.warn('Error encountered when parsing cues: ' + error.message);\n      };\n\n      if (segmentInfo.segment.map) {\n        var mapData = segmentInfo.segment.map.bytes;\n\n        if (decodeBytesToString) {\n          mapData = uintToString(mapData);\n        }\n\n        parser.parse(mapData);\n      }\n\n      var segmentData = segmentInfo.bytes;\n\n      if (decodeBytesToString) {\n        segmentData = uintToString(segmentData);\n      }\n\n      parser.parse(segmentData);\n      parser.flush();\n    };\n\n    /**\n     * Updates the start and end times of any cues parsed by the WebVTT parser using\n     * the information parsed from the X-TIMESTAMP-MAP header and a TS to media time mapping\n     * from the SyncController\n     *\n     * @param {Object} segmentInfo\n     *        a segment info object that describes the current segment\n     * @param {Object} mappingObj\n     *        object containing a mapping from TS to media time\n     * @param {Object} playlist\n     *        the playlist object containing the segment\n     * @private\n     */\n\n\n    VTTSegmentLoader.prototype.updateTimeMapping_ = function updateTimeMapping_(segmentInfo, mappingObj, playlist) {\n      var segment = segmentInfo.segment;\n\n      if (!mappingObj) {\n        // If the sync controller does not have a mapping of TS to Media Time for the\n        // timeline, then we don't have enough information to update the cue\n        // start/end times\n        return;\n      }\n\n      if (!segmentInfo.cues.length) {\n        // If there are no cues, we also do not have enough information to figure out\n        // segment timing. Mark that the segment contains no cues so we don't re-request\n        // an empty segment.\n        segment.empty = true;\n        return;\n      }\n\n      var timestampmap = segmentInfo.timestampmap;\n      var diff = timestampmap.MPEGTS / 90000 - timestampmap.LOCAL + mappingObj.mapping;\n\n      segmentInfo.cues.forEach(function (cue) {\n        // First convert cue time to TS time using the timestamp-map provided within the vtt\n        cue.startTime += diff;\n        cue.endTime += diff;\n      });\n\n      if (!playlist.syncInfo) {\n        var firstStart = segmentInfo.cues[0].startTime;\n        var lastStart = segmentInfo.cues[segmentInfo.cues.length - 1].startTime;\n\n        playlist.syncInfo = {\n          mediaSequence: playlist.mediaSequence + segmentInfo.mediaIndex,\n          time: Math.min(firstStart, lastStart - segment.duration)\n        };\n      }\n    };\n\n    return VTTSegmentLoader;\n  }(SegmentLoader);\n\n  /**\n   * @file ad-cue-tags.js\n   */\n\n  /**\n   * Searches for an ad cue that overlaps with the given mediaTime\n   */\n\n\n  var findAdCue = function findAdCue(track, mediaTime) {\n    var cues = track.cues;\n\n    for (var i = 0; i < cues.length; i++) {\n      var cue = cues[i];\n\n      if (mediaTime >= cue.adStartTime && mediaTime <= cue.adEndTime) {\n        return cue;\n      }\n    }\n    return null;\n  };\n\n  var updateAdCues = function updateAdCues(media, track) {\n    var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n    if (!media.segments) {\n      return;\n    }\n\n    var mediaTime = offset;\n    var cue = void 0;\n\n    for (var i = 0; i < media.segments.length; i++) {\n      var segment = media.segments[i];\n\n      if (!cue) {\n        // Since the cues will span for at least the segment duration, adding a fudge\n        // factor of half segment duration will prevent duplicate cues from being\n        // created when timing info is not exact (e.g. cue start time initialized\n        // at 10.006677, but next call mediaTime is 10.003332 )\n        cue = findAdCue(track, mediaTime + segment.duration / 2);\n      }\n\n      if (cue) {\n        if ('cueIn' in segment) {\n          // Found a CUE-IN so end the cue\n          cue.endTime = mediaTime;\n          cue.adEndTime = mediaTime;\n          mediaTime += segment.duration;\n          cue = null;\n          continue;\n        }\n\n        if (mediaTime < cue.endTime) {\n          // Already processed this mediaTime for this cue\n          mediaTime += segment.duration;\n          continue;\n        }\n\n        // otherwise extend cue until a CUE-IN is found\n        cue.endTime += segment.duration;\n      } else {\n        if ('cueOut' in segment) {\n          cue = new window_1.VTTCue(mediaTime, mediaTime + segment.duration, segment.cueOut);\n          cue.adStartTime = mediaTime;\n          // Assumes tag format to be\n          // #EXT-X-CUE-OUT:30\n          cue.adEndTime = mediaTime + parseFloat(segment.cueOut);\n          track.addCue(cue);\n        }\n\n        if ('cueOutCont' in segment) {\n          // Entered into the middle of an ad cue\n          var adOffset = void 0;\n          var adTotal = void 0;\n\n          // Assumes tag formate to be\n          // #EXT-X-CUE-OUT-CONT:10/30\n\n          var _segment$cueOutCont$s = segment.cueOutCont.split('/').map(parseFloat);\n\n          adOffset = _segment$cueOutCont$s[0];\n          adTotal = _segment$cueOutCont$s[1];\n\n\n          cue = new window_1.VTTCue(mediaTime, mediaTime + segment.duration, '');\n          cue.adStartTime = mediaTime - adOffset;\n          cue.adEndTime = cue.adStartTime + adTotal;\n          track.addCue(cue);\n        }\n      }\n      mediaTime += segment.duration;\n    }\n  };\n\n  /**\n   * @file sync-controller.js\n   */\n\n  var tsprobe = tsInspector.inspect;\n\n  var syncPointStrategies = [\n  // Stategy \"VOD\": Handle the VOD-case where the sync-point is *always*\n  //                the equivalence display-time 0 === segment-index 0\n  {\n    name: 'VOD',\n    run: function run(syncController, playlist, duration$$1, currentTimeline, currentTime) {\n      if (duration$$1 !== Infinity) {\n        var syncPoint = {\n          time: 0,\n          segmentIndex: 0\n        };\n\n        return syncPoint;\n      }\n      return null;\n    }\n  },\n  // Stategy \"ProgramDateTime\": We have a program-date-time tag in this playlist\n  {\n    name: 'ProgramDateTime',\n    run: function run(syncController, playlist, duration$$1, currentTimeline, currentTime) {\n      if (!syncController.datetimeToDisplayTime) {\n        return null;\n      }\n\n      var segments = playlist.segments || [];\n      var syncPoint = null;\n      var lastDistance = null;\n\n      currentTime = currentTime || 0;\n\n      for (var i = 0; i < segments.length; i++) {\n        var segment = segments[i];\n\n        if (segment.dateTimeObject) {\n          var segmentTime = segment.dateTimeObject.getTime() / 1000;\n          var segmentStart = segmentTime + syncController.datetimeToDisplayTime;\n          var distance = Math.abs(currentTime - segmentStart);\n\n          // Once the distance begins to increase, we have passed\n          // currentTime and can stop looking for better candidates\n          if (lastDistance !== null && lastDistance < distance) {\n            break;\n          }\n\n          lastDistance = distance;\n          syncPoint = {\n            time: segmentStart,\n            segmentIndex: i\n          };\n        }\n      }\n      return syncPoint;\n    }\n  },\n  // Stategy \"Segment\": We have a known time mapping for a timeline and a\n  //                    segment in the current timeline with timing data\n  {\n    name: 'Segment',\n    run: function run(syncController, playlist, duration$$1, currentTimeline, currentTime) {\n      var segments = playlist.segments || [];\n      var syncPoint = null;\n      var lastDistance = null;\n\n      currentTime = currentTime || 0;\n\n      for (var i = 0; i < segments.length; i++) {\n        var segment = segments[i];\n\n        if (segment.timeline === currentTimeline && typeof segment.start !== 'undefined') {\n          var distance = Math.abs(currentTime - segment.start);\n\n          // Once the distance begins to increase, we have passed\n          // currentTime and can stop looking for better candidates\n          if (lastDistance !== null && lastDistance < distance) {\n            break;\n          }\n\n          if (!syncPoint || lastDistance === null || lastDistance >= distance) {\n            lastDistance = distance;\n            syncPoint = {\n              time: segment.start,\n              segmentIndex: i\n            };\n          }\n        }\n      }\n      return syncPoint;\n    }\n  },\n  // Stategy \"Discontinuity\": We have a discontinuity with a known\n  //                          display-time\n  {\n    name: 'Discontinuity',\n    run: function run(syncController, playlist, duration$$1, currentTimeline, currentTime) {\n      var syncPoint = null;\n\n      currentTime = currentTime || 0;\n\n      if (playlist.discontinuityStarts && playlist.discontinuityStarts.length) {\n        var lastDistance = null;\n\n        for (var i = 0; i < playlist.discontinuityStarts.length; i++) {\n          var segmentIndex = playlist.discontinuityStarts[i];\n          var discontinuity = playlist.discontinuitySequence + i + 1;\n          var discontinuitySync = syncController.discontinuities[discontinuity];\n\n          if (discontinuitySync) {\n            var distance = Math.abs(currentTime - discontinuitySync.time);\n\n            // Once the distance begins to increase, we have passed\n            // currentTime and can stop looking for better candidates\n            if (lastDistance !== null && lastDistance < distance) {\n              break;\n            }\n\n            if (!syncPoint || lastDistance === null || lastDistance >= distance) {\n              lastDistance = distance;\n              syncPoint = {\n                time: discontinuitySync.time,\n                segmentIndex: segmentIndex\n              };\n            }\n          }\n        }\n      }\n      return syncPoint;\n    }\n  },\n  // Stategy \"Playlist\": We have a playlist with a known mapping of\n  //                     segment index to display time\n  {\n    name: 'Playlist',\n    run: function run(syncController, playlist, duration$$1, currentTimeline, currentTime) {\n      if (playlist.syncInfo) {\n        var syncPoint = {\n          time: playlist.syncInfo.time,\n          segmentIndex: playlist.syncInfo.mediaSequence - playlist.mediaSequence\n        };\n\n        return syncPoint;\n      }\n      return null;\n    }\n  }];\n\n  var SyncController = function (_videojs$EventTarget4) {\n    inherits(SyncController, _videojs$EventTarget4);\n\n    function SyncController() {\n      classCallCheck(this, SyncController);\n\n      // Segment Loader state variables...\n      // ...for synching across variants\n      var _this28 = possibleConstructorReturn(this, _videojs$EventTarget4.call(this));\n\n      _this28.inspectCache_ = undefined;\n\n      // ...for synching across variants\n      _this28.timelines = [];\n      _this28.discontinuities = [];\n      _this28.datetimeToDisplayTime = null;\n\n      _this28.logger_ = logger('SyncController');\n      return _this28;\n    }\n\n    /**\n     * Find a sync-point for the playlist specified\n     *\n     * A sync-point is defined as a known mapping from display-time to\n     * a segment-index in the current playlist.\n     *\n     * @param {Playlist} playlist\n     *        The playlist that needs a sync-point\n     * @param {Number} duration\n     *        Duration of the MediaSource (Infinite if playing a live source)\n     * @param {Number} currentTimeline\n     *        The last timeline from which a segment was loaded\n     * @returns {Object}\n     *          A sync-point object\n     */\n\n\n    SyncController.prototype.getSyncPoint = function getSyncPoint(playlist, duration$$1, currentTimeline, currentTime) {\n      var syncPoints = this.runStrategies_(playlist, duration$$1, currentTimeline, currentTime);\n\n      if (!syncPoints.length) {\n        // Signal that we need to attempt to get a sync-point manually\n        // by fetching a segment in the playlist and constructing\n        // a sync-point from that information\n        return null;\n      }\n\n      // Now find the sync-point that is closest to the currentTime because\n      // that should result in the most accurate guess about which segment\n      // to fetch\n      return this.selectSyncPoint_(syncPoints, { key: 'time', value: currentTime });\n    };\n\n    /**\n     * Calculate the amount of time that has expired off the playlist during playback\n     *\n     * @param {Playlist} playlist\n     *        Playlist object to calculate expired from\n     * @param {Number} duration\n     *        Duration of the MediaSource (Infinity if playling a live source)\n     * @returns {Number|null}\n     *          The amount of time that has expired off the playlist during playback. Null\n     *          if no sync-points for the playlist can be found.\n     */\n\n\n    SyncController.prototype.getExpiredTime = function getExpiredTime(playlist, duration$$1) {\n      if (!playlist || !playlist.segments) {\n        return null;\n      }\n\n      var syncPoints = this.runStrategies_(playlist, duration$$1, playlist.discontinuitySequence, 0);\n\n      // Without sync-points, there is not enough information to determine the expired time\n      if (!syncPoints.length) {\n        return null;\n      }\n\n      var syncPoint = this.selectSyncPoint_(syncPoints, {\n        key: 'segmentIndex',\n        value: 0\n      });\n\n      // If the sync-point is beyond the start of the playlist, we want to subtract the\n      // duration from index 0 to syncPoint.segmentIndex instead of adding.\n      if (syncPoint.segmentIndex > 0) {\n        syncPoint.time *= -1;\n      }\n\n      return Math.abs(syncPoint.time + sumDurations(playlist, syncPoint.segmentIndex, 0));\n    };\n\n    /**\n     * Runs each sync-point strategy and returns a list of sync-points returned by the\n     * strategies\n     *\n     * @private\n     * @param {Playlist} playlist\n     *        The playlist that needs a sync-point\n     * @param {Number} duration\n     *        Duration of the MediaSource (Infinity if playing a live source)\n     * @param {Number} currentTimeline\n     *        The last timeline from which a segment was loaded\n     * @returns {Array}\n     *          A list of sync-point objects\n     */\n\n\n    SyncController.prototype.runStrategies_ = function runStrategies_(playlist, duration$$1, currentTimeline, currentTime) {\n      var syncPoints = [];\n\n      // Try to find a sync-point in by utilizing various strategies...\n      for (var i = 0; i < syncPointStrategies.length; i++) {\n        var strategy = syncPointStrategies[i];\n        var syncPoint = strategy.run(this, playlist, duration$$1, currentTimeline, currentTime);\n\n        if (syncPoint) {\n          syncPoint.strategy = strategy.name;\n          syncPoints.push({\n            strategy: strategy.name,\n            syncPoint: syncPoint\n          });\n        }\n      }\n\n      return syncPoints;\n    };\n\n    /**\n     * Selects the sync-point nearest the specified target\n     *\n     * @private\n     * @param {Array} syncPoints\n     *        List of sync-points to select from\n     * @param {Object} target\n     *        Object specifying the property and value we are targeting\n     * @param {String} target.key\n     *        Specifies the property to target. Must be either 'time' or 'segmentIndex'\n     * @param {Number} target.value\n     *        The value to target for the specified key.\n     * @returns {Object}\n     *          The sync-point nearest the target\n     */\n\n\n    SyncController.prototype.selectSyncPoint_ = function selectSyncPoint_(syncPoints, target) {\n      var bestSyncPoint = syncPoints[0].syncPoint;\n      var bestDistance = Math.abs(syncPoints[0].syncPoint[target.key] - target.value);\n      var bestStrategy = syncPoints[0].strategy;\n\n      for (var i = 1; i < syncPoints.length; i++) {\n        var newDistance = Math.abs(syncPoints[i].syncPoint[target.key] - target.value);\n\n        if (newDistance < bestDistance) {\n          bestDistance = newDistance;\n          bestSyncPoint = syncPoints[i].syncPoint;\n          bestStrategy = syncPoints[i].strategy;\n        }\n      }\n\n      this.logger_('syncPoint for [' + target.key + ': ' + target.value + '] chosen with strategy' + (' [' + bestStrategy + ']: [time:' + bestSyncPoint.time + ',') + (' segmentIndex:' + bestSyncPoint.segmentIndex + ']'));\n\n      return bestSyncPoint;\n    };\n\n    /**\n     * Save any meta-data present on the segments when segments leave\n     * the live window to the playlist to allow for synchronization at the\n     * playlist level later.\n     *\n     * @param {Playlist} oldPlaylist - The previous active playlist\n     * @param {Playlist} newPlaylist - The updated and most current playlist\n     */\n\n\n    SyncController.prototype.saveExpiredSegmentInfo = function saveExpiredSegmentInfo(oldPlaylist, newPlaylist) {\n      var mediaSequenceDiff = newPlaylist.mediaSequence - oldPlaylist.mediaSequence;\n\n      // When a segment expires from the playlist and it has a start time\n      // save that information as a possible sync-point reference in future\n      for (var i = mediaSequenceDiff - 1; i >= 0; i--) {\n        var lastRemovedSegment = oldPlaylist.segments[i];\n\n        if (lastRemovedSegment && typeof lastRemovedSegment.start !== 'undefined') {\n          newPlaylist.syncInfo = {\n            mediaSequence: oldPlaylist.mediaSequence + i,\n            time: lastRemovedSegment.start\n          };\n          this.logger_('playlist refresh sync: [time:' + newPlaylist.syncInfo.time + ',' + (' mediaSequence: ' + newPlaylist.syncInfo.mediaSequence + ']'));\n          this.trigger('syncinfoupdate');\n          break;\n        }\n      }\n    };\n\n    /**\n     * Save the mapping from playlist's ProgramDateTime to display. This should\n     * only ever happen once at the start of playback.\n     *\n     * @param {Playlist} playlist - The currently active playlist\n     */\n\n\n    SyncController.prototype.setDateTimeMapping = function setDateTimeMapping(playlist) {\n      if (!this.datetimeToDisplayTime && playlist.segments && playlist.segments.length && playlist.segments[0].dateTimeObject) {\n        var playlistTimestamp = playlist.segments[0].dateTimeObject.getTime() / 1000;\n\n        this.datetimeToDisplayTime = -playlistTimestamp;\n      }\n    };\n\n    /**\n     * Reset the state of the inspection cache when we do a rendition\n     * switch\n     */\n\n\n    SyncController.prototype.reset = function reset() {\n      this.inspectCache_ = undefined;\n    };\n\n    /**\n     * Probe or inspect a fmp4 or an mpeg2-ts segment to determine the start\n     * and end of the segment in it's internal \"media time\". Used to generate\n     * mappings from that internal \"media time\" to the display time that is\n     * shown on the player.\n     *\n     * @param {SegmentInfo} segmentInfo - The current active request information\n     */\n\n\n    SyncController.prototype.probeSegmentInfo = function probeSegmentInfo(segmentInfo) {\n      var segment = segmentInfo.segment;\n      var playlist = segmentInfo.playlist;\n      var timingInfo = void 0;\n\n      if (segment.map) {\n        timingInfo = this.probeMp4Segment_(segmentInfo);\n      } else {\n        timingInfo = this.probeTsSegment_(segmentInfo);\n      }\n\n      if (timingInfo) {\n        if (this.calculateSegmentTimeMapping_(segmentInfo, timingInfo)) {\n          this.saveDiscontinuitySyncInfo_(segmentInfo);\n\n          // If the playlist does not have sync information yet, record that information\n          // now with segment timing information\n          if (!playlist.syncInfo) {\n            playlist.syncInfo = {\n              mediaSequence: playlist.mediaSequence + segmentInfo.mediaIndex,\n              time: segment.start\n            };\n          }\n        }\n      }\n\n      return timingInfo;\n    };\n\n    /**\n     * Probe an fmp4 or an mpeg2-ts segment to determine the start of the segment\n     * in it's internal \"media time\".\n     *\n     * @private\n     * @param {SegmentInfo} segmentInfo - The current active request information\n     * @return {object} The start and end time of the current segment in \"media time\"\n     */\n\n\n    SyncController.prototype.probeMp4Segment_ = function probeMp4Segment_(segmentInfo) {\n      var segment = segmentInfo.segment;\n      var timescales = probe.timescale(segment.map.bytes);\n      var startTime = probe.startTime(timescales, segmentInfo.bytes);\n\n      if (segmentInfo.timestampOffset !== null) {\n        segmentInfo.timestampOffset -= startTime;\n      }\n\n      return {\n        start: startTime,\n        end: startTime + segment.duration\n      };\n    };\n\n    /**\n     * Probe an mpeg2-ts segment to determine the start and end of the segment\n     * in it's internal \"media time\".\n     *\n     * @private\n     * @param {SegmentInfo} segmentInfo - The current active request information\n     * @return {object} The start and end time of the current segment in \"media time\"\n     */\n\n\n    SyncController.prototype.probeTsSegment_ = function probeTsSegment_(segmentInfo) {\n      var timeInfo = tsprobe(segmentInfo.bytes, this.inspectCache_);\n      var segmentStartTime = void 0;\n      var segmentEndTime = void 0;\n\n      if (!timeInfo) {\n        return null;\n      }\n\n      if (timeInfo.video && timeInfo.video.length === 2) {\n        this.inspectCache_ = timeInfo.video[1].dts;\n        segmentStartTime = timeInfo.video[0].dtsTime;\n        segmentEndTime = timeInfo.video[1].dtsTime;\n      } else if (timeInfo.audio && timeInfo.audio.length === 2) {\n        this.inspectCache_ = timeInfo.audio[1].dts;\n        segmentStartTime = timeInfo.audio[0].dtsTime;\n        segmentEndTime = timeInfo.audio[1].dtsTime;\n      }\n\n      return {\n        start: segmentStartTime,\n        end: segmentEndTime,\n        containsVideo: timeInfo.video && timeInfo.video.length === 2,\n        containsAudio: timeInfo.audio && timeInfo.audio.length === 2\n      };\n    };\n\n    SyncController.prototype.timestampOffsetForTimeline = function timestampOffsetForTimeline(timeline) {\n      if (typeof this.timelines[timeline] === 'undefined') {\n        return null;\n      }\n      return this.timelines[timeline].time;\n    };\n\n    SyncController.prototype.mappingForTimeline = function mappingForTimeline(timeline) {\n      if (typeof this.timelines[timeline] === 'undefined') {\n        return null;\n      }\n      return this.timelines[timeline].mapping;\n    };\n\n    /**\n     * Use the \"media time\" for a segment to generate a mapping to \"display time\" and\n     * save that display time to the segment.\n     *\n     * @private\n     * @param {SegmentInfo} segmentInfo\n     *        The current active request information\n     * @param {object} timingInfo\n     *        The start and end time of the current segment in \"media time\"\n     * @returns {Boolean}\n     *          Returns false if segment time mapping could not be calculated\n     */\n\n\n    SyncController.prototype.calculateSegmentTimeMapping_ = function calculateSegmentTimeMapping_(segmentInfo, timingInfo) {\n      var segment = segmentInfo.segment;\n      var mappingObj = this.timelines[segmentInfo.timeline];\n\n      if (segmentInfo.timestampOffset !== null) {\n        mappingObj = {\n          time: segmentInfo.startOfSegment,\n          mapping: segmentInfo.startOfSegment - timingInfo.start\n        };\n        this.timelines[segmentInfo.timeline] = mappingObj;\n        this.trigger('timestampoffset');\n\n        this.logger_('time mapping for timeline ' + segmentInfo.timeline + ': ' + ('[time: ' + mappingObj.time + '] [mapping: ' + mappingObj.mapping + ']'));\n\n        segment.start = segmentInfo.startOfSegment;\n        segment.end = timingInfo.end + mappingObj.mapping;\n      } else if (mappingObj) {\n        segment.start = timingInfo.start + mappingObj.mapping;\n        segment.end = timingInfo.end + mappingObj.mapping;\n      } else {\n        return false;\n      }\n\n      return true;\n    };\n\n    /**\n     * Each time we have discontinuity in the playlist, attempt to calculate the location\n     * in display of the start of the discontinuity and save that. We also save an accuracy\n     * value so that we save values with the most accuracy (closest to 0.)\n     *\n     * @private\n     * @param {SegmentInfo} segmentInfo - The current active request information\n     */\n\n\n    SyncController.prototype.saveDiscontinuitySyncInfo_ = function saveDiscontinuitySyncInfo_(segmentInfo) {\n      var playlist = segmentInfo.playlist;\n      var segment = segmentInfo.segment;\n\n      // If the current segment is a discontinuity then we know exactly where\n      // the start of the range and it's accuracy is 0 (greater accuracy values\n      // mean more approximation)\n      if (segment.discontinuity) {\n        this.discontinuities[segment.timeline] = {\n          time: segment.start,\n          accuracy: 0\n        };\n      } else if (playlist.discontinuityStarts && playlist.discontinuityStarts.length) {\n        // Search for future discontinuities that we can provide better timing\n        // information for and save that information for sync purposes\n        for (var i = 0; i < playlist.discontinuityStarts.length; i++) {\n          var segmentIndex = playlist.discontinuityStarts[i];\n          var discontinuity = playlist.discontinuitySequence + i + 1;\n          var mediaIndexDiff = segmentIndex - segmentInfo.mediaIndex;\n          var accuracy = Math.abs(mediaIndexDiff);\n\n          if (!this.discontinuities[discontinuity] || this.discontinuities[discontinuity].accuracy > accuracy) {\n            var time = void 0;\n\n            if (mediaIndexDiff < 0) {\n              time = segment.start - sumDurations(playlist, segmentInfo.mediaIndex, segmentIndex);\n            } else {\n              time = segment.end + sumDurations(playlist, segmentInfo.mediaIndex + 1, segmentIndex);\n            }\n\n            this.discontinuities[discontinuity] = {\n              time: time,\n              accuracy: accuracy\n            };\n          }\n        }\n      }\n    };\n\n    return SyncController;\n  }(videojs$1.EventTarget);\n\n  var Decrypter$1 = new shimWorker(\"./decrypter-worker.worker.js\", function (window, document$$1) {\n    var self = this;\n    var decrypterWorker = function () {\n\n      var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n      var win;\n\n      if (typeof window !== \"undefined\") {\n        win = window;\n      } else if (typeof commonjsGlobal !== \"undefined\") {\n        win = commonjsGlobal;\n      } else if (typeof self !== \"undefined\") {\n        win = self;\n      } else {\n        win = {};\n      }\n\n      var window_1$$1 = win;\n\n      /*\n       * pkcs7.pad\n       * https://github.com/brightcove/pkcs7\n       *\n       * Copyright (c) 2014 Brightcove\n       * Licensed under the apache2 license.\n       */\n\n      /**\n       * Returns the subarray of a Uint8Array without PKCS#7 padding.\n       * @param padded {Uint8Array} unencrypted bytes that have been padded\n       * @return {Uint8Array} the unpadded bytes\n       * @see http://tools.ietf.org/html/rfc5652\n       */\n      function unpad(padded) {\n        return padded.subarray(0, padded.byteLength - padded[padded.byteLength - 1]);\n      }\n\n      var classCallCheck$$1 = function classCallCheck$$1(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n          throw new TypeError(\"Cannot call a class as a function\");\n        }\n      };\n\n      var createClass$$1 = function () {\n        function defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        return function (Constructor, protoProps, staticProps) {\n          if (protoProps) defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) defineProperties(Constructor, staticProps);\n          return Constructor;\n        };\n      }();\n\n      var inherits$$1 = function inherits$$1(subClass, superClass) {\n        if (typeof superClass !== \"function\" && superClass !== null) {\n          throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === 'undefined' ? 'undefined' : _typeof(superClass)));\n        }\n\n        subClass.prototype = Object.create(superClass && superClass.prototype, {\n          constructor: {\n            value: subClass,\n            enumerable: false,\n            writable: true,\n            configurable: true\n          }\n        });\n        if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n      };\n\n      var possibleConstructorReturn$$1 = function possibleConstructorReturn$$1(self, call) {\n        if (!self) {\n          throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        }\n\n        return call && ((typeof call === 'undefined' ? 'undefined' : _typeof(call)) === \"object\" || typeof call === \"function\") ? call : self;\n      };\n\n      /**\n       * @file aes.js\n       *\n       * This file contains an adaptation of the AES decryption algorithm\n       * from the Standford Javascript Cryptography Library. That work is\n       * covered by the following copyright and permissions notice:\n       *\n       * Copyright 2009-2010 Emily Stark, Mike Hamburg, Dan Boneh.\n       * All rights reserved.\n       *\n       * Redistribution and use in source and binary forms, with or without\n       * modification, are permitted provided that the following conditions are\n       * met:\n       *\n       * 1. Redistributions of source code must retain the above copyright\n       *    notice, this list of conditions and the following disclaimer.\n       *\n       * 2. Redistributions in binary form must reproduce the above\n       *    copyright notice, this list of conditions and the following\n       *    disclaimer in the documentation and/or other materials provided\n       *    with the distribution.\n       *\n       * THIS SOFTWARE IS PROVIDED BY THE AUTHORS ``AS IS'' AND ANY EXPRESS OR\n       * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n       * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n       * DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR CONTRIBUTORS BE\n       * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n       * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n       * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR\n       * BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n       * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n       * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN\n       * IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n       *\n       * The views and conclusions contained in the software and documentation\n       * are those of the authors and should not be interpreted as representing\n       * official policies, either expressed or implied, of the authors.\n       */\n\n      /**\n       * Expand the S-box tables.\n       *\n       * @private\n       */\n      var precompute = function precompute() {\n        var tables = [[[], [], [], [], []], [[], [], [], [], []]];\n        var encTable = tables[0];\n        var decTable = tables[1];\n        var sbox = encTable[4];\n        var sboxInv = decTable[4];\n        var i = void 0;\n        var x = void 0;\n        var xInv = void 0;\n        var d = [];\n        var th = [];\n        var x2 = void 0;\n        var x4 = void 0;\n        var x8 = void 0;\n        var s = void 0;\n        var tEnc = void 0;\n        var tDec = void 0;\n\n        // Compute double and third tables\n        for (i = 0; i < 256; i++) {\n          th[(d[i] = i << 1 ^ (i >> 7) * 283) ^ i] = i;\n        }\n\n        for (x = xInv = 0; !sbox[x]; x ^= x2 || 1, xInv = th[xInv] || 1) {\n          // Compute sbox\n          s = xInv ^ xInv << 1 ^ xInv << 2 ^ xInv << 3 ^ xInv << 4;\n          s = s >> 8 ^ s & 255 ^ 99;\n          sbox[x] = s;\n          sboxInv[s] = x;\n\n          // Compute MixColumns\n          x8 = d[x4 = d[x2 = d[x]]];\n          tDec = x8 * 0x1010101 ^ x4 * 0x10001 ^ x2 * 0x101 ^ x * 0x1010100;\n          tEnc = d[s] * 0x101 ^ s * 0x1010100;\n\n          for (i = 0; i < 4; i++) {\n            encTable[i][x] = tEnc = tEnc << 24 ^ tEnc >>> 8;\n            decTable[i][s] = tDec = tDec << 24 ^ tDec >>> 8;\n          }\n        }\n\n        // Compactify. Considerable speedup on Firefox.\n        for (i = 0; i < 5; i++) {\n          encTable[i] = encTable[i].slice(0);\n          decTable[i] = decTable[i].slice(0);\n        }\n        return tables;\n      };\n      var aesTables = null;\n\n      /**\n       * Schedule out an AES key for both encryption and decryption. This\n       * is a low-level class. Use a cipher mode to do bulk encryption.\n       *\n       * @class AES\n       * @param key {Array} The key as an array of 4, 6 or 8 words.\n       */\n\n      var AES = function () {\n        function AES(key) {\n          classCallCheck$$1(this, AES);\n\n          /**\n           * The expanded S-box and inverse S-box tables. These will be computed\n           * on the client so that we don't have to send them down the wire.\n           *\n           * There are two tables, _tables[0] is for encryption and\n           * _tables[1] is for decryption.\n           *\n           * The first 4 sub-tables are the expanded S-box with MixColumns. The\n           * last (_tables[01][4]) is the S-box itself.\n           *\n           * @private\n           */\n          // if we have yet to precompute the S-box tables\n          // do so now\n          if (!aesTables) {\n            aesTables = precompute();\n          }\n          // then make a copy of that object for use\n          this._tables = [[aesTables[0][0].slice(), aesTables[0][1].slice(), aesTables[0][2].slice(), aesTables[0][3].slice(), aesTables[0][4].slice()], [aesTables[1][0].slice(), aesTables[1][1].slice(), aesTables[1][2].slice(), aesTables[1][3].slice(), aesTables[1][4].slice()]];\n          var i = void 0;\n          var j = void 0;\n          var tmp = void 0;\n          var encKey = void 0;\n          var decKey = void 0;\n          var sbox = this._tables[0][4];\n          var decTable = this._tables[1];\n          var keyLen = key.length;\n          var rcon = 1;\n\n          if (keyLen !== 4 && keyLen !== 6 && keyLen !== 8) {\n            throw new Error('Invalid aes key size');\n          }\n\n          encKey = key.slice(0);\n          decKey = [];\n          this._key = [encKey, decKey];\n\n          // schedule encryption keys\n          for (i = keyLen; i < 4 * keyLen + 28; i++) {\n            tmp = encKey[i - 1];\n\n            // apply sbox\n            if (i % keyLen === 0 || keyLen === 8 && i % keyLen === 4) {\n              tmp = sbox[tmp >>> 24] << 24 ^ sbox[tmp >> 16 & 255] << 16 ^ sbox[tmp >> 8 & 255] << 8 ^ sbox[tmp & 255];\n\n              // shift rows and add rcon\n              if (i % keyLen === 0) {\n                tmp = tmp << 8 ^ tmp >>> 24 ^ rcon << 24;\n                rcon = rcon << 1 ^ (rcon >> 7) * 283;\n              }\n            }\n\n            encKey[i] = encKey[i - keyLen] ^ tmp;\n          }\n\n          // schedule decryption keys\n          for (j = 0; i; j++, i--) {\n            tmp = encKey[j & 3 ? i : i - 4];\n            if (i <= 4 || j < 4) {\n              decKey[j] = tmp;\n            } else {\n              decKey[j] = decTable[0][sbox[tmp >>> 24]] ^ decTable[1][sbox[tmp >> 16 & 255]] ^ decTable[2][sbox[tmp >> 8 & 255]] ^ decTable[3][sbox[tmp & 255]];\n            }\n          }\n        }\n\n        /**\n         * Decrypt 16 bytes, specified as four 32-bit words.\n         *\n         * @param {Number} encrypted0 the first word to decrypt\n         * @param {Number} encrypted1 the second word to decrypt\n         * @param {Number} encrypted2 the third word to decrypt\n         * @param {Number} encrypted3 the fourth word to decrypt\n         * @param {Int32Array} out the array to write the decrypted words\n         * into\n         * @param {Number} offset the offset into the output array to start\n         * writing results\n         * @return {Array} The plaintext.\n         */\n\n        AES.prototype.decrypt = function decrypt$$1(encrypted0, encrypted1, encrypted2, encrypted3, out, offset) {\n          var key = this._key[1];\n          // state variables a,b,c,d are loaded with pre-whitened data\n          var a = encrypted0 ^ key[0];\n          var b = encrypted3 ^ key[1];\n          var c = encrypted2 ^ key[2];\n          var d = encrypted1 ^ key[3];\n          var a2 = void 0;\n          var b2 = void 0;\n          var c2 = void 0;\n\n          // key.length === 2 ?\n          var nInnerRounds = key.length / 4 - 2;\n          var i = void 0;\n          var kIndex = 4;\n          var table = this._tables[1];\n\n          // load up the tables\n          var table0 = table[0];\n          var table1 = table[1];\n          var table2 = table[2];\n          var table3 = table[3];\n          var sbox = table[4];\n\n          // Inner rounds. Cribbed from OpenSSL.\n          for (i = 0; i < nInnerRounds; i++) {\n            a2 = table0[a >>> 24] ^ table1[b >> 16 & 255] ^ table2[c >> 8 & 255] ^ table3[d & 255] ^ key[kIndex];\n            b2 = table0[b >>> 24] ^ table1[c >> 16 & 255] ^ table2[d >> 8 & 255] ^ table3[a & 255] ^ key[kIndex + 1];\n            c2 = table0[c >>> 24] ^ table1[d >> 16 & 255] ^ table2[a >> 8 & 255] ^ table3[b & 255] ^ key[kIndex + 2];\n            d = table0[d >>> 24] ^ table1[a >> 16 & 255] ^ table2[b >> 8 & 255] ^ table3[c & 255] ^ key[kIndex + 3];\n            kIndex += 4;\n            a = a2;b = b2;c = c2;\n          }\n\n          // Last round.\n          for (i = 0; i < 4; i++) {\n            out[(3 & -i) + offset] = sbox[a >>> 24] << 24 ^ sbox[b >> 16 & 255] << 16 ^ sbox[c >> 8 & 255] << 8 ^ sbox[d & 255] ^ key[kIndex++];\n            a2 = a;a = b;b = c;c = d;d = a2;\n          }\n        };\n\n        return AES;\n      }();\n\n      /**\n       * @file stream.js\n       */\n      /**\n       * A lightweight readable stream implemention that handles event dispatching.\n       *\n       * @class Stream\n       */\n      var Stream = function () {\n        function Stream() {\n          classCallCheck$$1(this, Stream);\n\n          this.listeners = {};\n        }\n\n        /**\n         * Add a listener for a specified event type.\n         *\n         * @param {String} type the event name\n         * @param {Function} listener the callback to be invoked when an event of\n         * the specified type occurs\n         */\n\n        Stream.prototype.on = function on(type, listener) {\n          if (!this.listeners[type]) {\n            this.listeners[type] = [];\n          }\n          this.listeners[type].push(listener);\n        };\n\n        /**\n         * Remove a listener for a specified event type.\n         *\n         * @param {String} type the event name\n         * @param {Function} listener  a function previously registered for this\n         * type of event through `on`\n         * @return {Boolean} if we could turn it off or not\n         */\n\n        Stream.prototype.off = function off(type, listener) {\n          if (!this.listeners[type]) {\n            return false;\n          }\n\n          var index = this.listeners[type].indexOf(listener);\n\n          this.listeners[type].splice(index, 1);\n          return index > -1;\n        };\n\n        /**\n         * Trigger an event of the specified type on this stream. Any additional\n         * arguments to this function are passed as parameters to event listeners.\n         *\n         * @param {String} type the event name\n         */\n\n        Stream.prototype.trigger = function trigger(type) {\n          var callbacks = this.listeners[type];\n\n          if (!callbacks) {\n            return;\n          }\n\n          // Slicing the arguments on every invocation of this method\n          // can add a significant amount of overhead. Avoid the\n          // intermediate object creation for the common case of a\n          // single callback argument\n          if (arguments.length === 2) {\n            var length = callbacks.length;\n\n            for (var i = 0; i < length; ++i) {\n              callbacks[i].call(this, arguments[1]);\n            }\n          } else {\n            var args = Array.prototype.slice.call(arguments, 1);\n            var _length = callbacks.length;\n\n            for (var _i = 0; _i < _length; ++_i) {\n              callbacks[_i].apply(this, args);\n            }\n          }\n        };\n\n        /**\n         * Destroys the stream and cleans up.\n         */\n\n        Stream.prototype.dispose = function dispose() {\n          this.listeners = {};\n        };\n        /**\n         * Forwards all `data` events on this stream to the destination stream. The\n         * destination stream should provide a method `push` to receive the data\n         * events as they arrive.\n         *\n         * @param {Stream} destination the stream that will receive all `data` events\n         * @see http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options\n         */\n\n        Stream.prototype.pipe = function pipe(destination) {\n          this.on('data', function (data) {\n            destination.push(data);\n          });\n        };\n\n        return Stream;\n      }();\n\n      /**\n       * @file async-stream.js\n       */\n      /**\n       * A wrapper around the Stream class to use setTiemout\n       * and run stream \"jobs\" Asynchronously\n       *\n       * @class AsyncStream\n       * @extends Stream\n       */\n\n      var AsyncStream$$1 = function (_Stream) {\n        inherits$$1(AsyncStream$$1, _Stream);\n\n        function AsyncStream$$1() {\n          classCallCheck$$1(this, AsyncStream$$1);\n\n          var _this = possibleConstructorReturn$$1(this, _Stream.call(this, Stream));\n\n          _this.jobs = [];\n          _this.delay = 1;\n          _this.timeout_ = null;\n          return _this;\n        }\n\n        /**\n         * process an async job\n         *\n         * @private\n         */\n\n        AsyncStream$$1.prototype.processJob_ = function processJob_() {\n          this.jobs.shift()();\n          if (this.jobs.length) {\n            this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay);\n          } else {\n            this.timeout_ = null;\n          }\n        };\n\n        /**\n         * push a job into the stream\n         *\n         * @param {Function} job the job to push into the stream\n         */\n\n        AsyncStream$$1.prototype.push = function push(job) {\n          this.jobs.push(job);\n          if (!this.timeout_) {\n            this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay);\n          }\n        };\n\n        return AsyncStream$$1;\n      }(Stream);\n\n      /**\n       * @file decrypter.js\n       *\n       * An asynchronous implementation of AES-128 CBC decryption with\n       * PKCS#7 padding.\n       */\n\n      /**\n       * Convert network-order (big-endian) bytes into their little-endian\n       * representation.\n       */\n      var ntoh = function ntoh(word) {\n        return word << 24 | (word & 0xff00) << 8 | (word & 0xff0000) >> 8 | word >>> 24;\n      };\n\n      /**\n       * Decrypt bytes using AES-128 with CBC and PKCS#7 padding.\n       *\n       * @param {Uint8Array} encrypted the encrypted bytes\n       * @param {Uint32Array} key the bytes of the decryption key\n       * @param {Uint32Array} initVector the initialization vector (IV) to\n       * use for the first round of CBC.\n       * @return {Uint8Array} the decrypted bytes\n       *\n       * @see http://en.wikipedia.org/wiki/Advanced_Encryption_Standard\n       * @see http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_.28CBC.29\n       * @see https://tools.ietf.org/html/rfc2315\n       */\n      var decrypt$$1 = function decrypt$$1(encrypted, key, initVector) {\n        // word-level access to the encrypted bytes\n        var encrypted32 = new Int32Array(encrypted.buffer, encrypted.byteOffset, encrypted.byteLength >> 2);\n\n        var decipher = new AES(Array.prototype.slice.call(key));\n\n        // byte and word-level access for the decrypted output\n        var decrypted = new Uint8Array(encrypted.byteLength);\n        var decrypted32 = new Int32Array(decrypted.buffer);\n\n        // temporary variables for working with the IV, encrypted, and\n        // decrypted data\n        var init0 = void 0;\n        var init1 = void 0;\n        var init2 = void 0;\n        var init3 = void 0;\n        var encrypted0 = void 0;\n        var encrypted1 = void 0;\n        var encrypted2 = void 0;\n        var encrypted3 = void 0;\n\n        // iteration variable\n        var wordIx = void 0;\n\n        // pull out the words of the IV to ensure we don't modify the\n        // passed-in reference and easier access\n        init0 = initVector[0];\n        init1 = initVector[1];\n        init2 = initVector[2];\n        init3 = initVector[3];\n\n        // decrypt four word sequences, applying cipher-block chaining (CBC)\n        // to each decrypted block\n        for (wordIx = 0; wordIx < encrypted32.length; wordIx += 4) {\n          // convert big-endian (network order) words into little-endian\n          // (javascript order)\n          encrypted0 = ntoh(encrypted32[wordIx]);\n          encrypted1 = ntoh(encrypted32[wordIx + 1]);\n          encrypted2 = ntoh(encrypted32[wordIx + 2]);\n          encrypted3 = ntoh(encrypted32[wordIx + 3]);\n\n          // decrypt the block\n          decipher.decrypt(encrypted0, encrypted1, encrypted2, encrypted3, decrypted32, wordIx);\n\n          // XOR with the IV, and restore network byte-order to obtain the\n          // plaintext\n          decrypted32[wordIx] = ntoh(decrypted32[wordIx] ^ init0);\n          decrypted32[wordIx + 1] = ntoh(decrypted32[wordIx + 1] ^ init1);\n          decrypted32[wordIx + 2] = ntoh(decrypted32[wordIx + 2] ^ init2);\n          decrypted32[wordIx + 3] = ntoh(decrypted32[wordIx + 3] ^ init3);\n\n          // setup the IV for the next round\n          init0 = encrypted0;\n          init1 = encrypted1;\n          init2 = encrypted2;\n          init3 = encrypted3;\n        }\n\n        return decrypted;\n      };\n\n      /**\n       * The `Decrypter` class that manages decryption of AES\n       * data through `AsyncStream` objects and the `decrypt`\n       * function\n       *\n       * @param {Uint8Array} encrypted the encrypted bytes\n       * @param {Uint32Array} key the bytes of the decryption key\n       * @param {Uint32Array} initVector the initialization vector (IV) to\n       * @param {Function} done the function to run when done\n       * @class Decrypter\n       */\n\n      var Decrypter$$1 = function () {\n        function Decrypter$$1(encrypted, key, initVector, done) {\n          classCallCheck$$1(this, Decrypter$$1);\n\n          var step = Decrypter$$1.STEP;\n          var encrypted32 = new Int32Array(encrypted.buffer);\n          var decrypted = new Uint8Array(encrypted.byteLength);\n          var i = 0;\n\n          this.asyncStream_ = new AsyncStream$$1();\n\n          // split up the encryption job and do the individual chunks asynchronously\n          this.asyncStream_.push(this.decryptChunk_(encrypted32.subarray(i, i + step), key, initVector, decrypted));\n          for (i = step; i < encrypted32.length; i += step) {\n            initVector = new Uint32Array([ntoh(encrypted32[i - 4]), ntoh(encrypted32[i - 3]), ntoh(encrypted32[i - 2]), ntoh(encrypted32[i - 1])]);\n            this.asyncStream_.push(this.decryptChunk_(encrypted32.subarray(i, i + step), key, initVector, decrypted));\n          }\n          // invoke the done() callback when everything is finished\n          this.asyncStream_.push(function () {\n            // remove pkcs#7 padding from the decrypted bytes\n            done(null, unpad(decrypted));\n          });\n        }\n\n        /**\n         * a getter for step the maximum number of bytes to process at one time\n         *\n         * @return {Number} the value of step 32000\n         */\n\n        /**\n         * @private\n         */\n        Decrypter$$1.prototype.decryptChunk_ = function decryptChunk_(encrypted, key, initVector, decrypted) {\n          return function () {\n            var bytes = decrypt$$1(encrypted, key, initVector);\n\n            decrypted.set(bytes, encrypted.byteOffset);\n          };\n        };\n\n        createClass$$1(Decrypter$$1, null, [{\n          key: 'STEP',\n          get: function get$$1() {\n            // 4 * 8000;\n            return 32000;\n          }\n        }]);\n        return Decrypter$$1;\n      }();\n\n      /**\n       * @file bin-utils.js\n       */\n\n      /**\n       * Creates an object for sending to a web worker modifying properties that are TypedArrays\n       * into a new object with seperated properties for the buffer, byteOffset, and byteLength.\n       *\n       * @param {Object} message\n       *        Object of properties and values to send to the web worker\n       * @return {Object}\n       *         Modified message with TypedArray values expanded\n       * @function createTransferableMessage\n       */\n      var createTransferableMessage = function createTransferableMessage(message) {\n        var transferable = {};\n\n        Object.keys(message).forEach(function (key) {\n          var value = message[key];\n\n          if (ArrayBuffer.isView(value)) {\n            transferable[key] = {\n              bytes: value.buffer,\n              byteOffset: value.byteOffset,\n              byteLength: value.byteLength\n            };\n          } else {\n            transferable[key] = value;\n          }\n        });\n\n        return transferable;\n      };\n\n      /**\n       * Our web worker interface so that things can talk to aes-decrypter\n       * that will be running in a web worker. the scope is passed to this by\n       * webworkify.\n       *\n       * @param {Object} self\n       *        the scope for the web worker\n       */\n      var DecrypterWorker = function DecrypterWorker(self) {\n        self.onmessage = function (event) {\n          var data = event.data;\n          var encrypted = new Uint8Array(data.encrypted.bytes, data.encrypted.byteOffset, data.encrypted.byteLength);\n          var key = new Uint32Array(data.key.bytes, data.key.byteOffset, data.key.byteLength / 4);\n          var iv = new Uint32Array(data.iv.bytes, data.iv.byteOffset, data.iv.byteLength / 4);\n\n          /* eslint-disable no-new, handle-callback-err */\n          new Decrypter$$1(encrypted, key, iv, function (err, bytes) {\n            window_1$$1.postMessage(createTransferableMessage({\n              source: data.source,\n              decrypted: bytes\n            }), [bytes.buffer]);\n          });\n          /* eslint-enable */\n        };\n      };\n\n      var decrypterWorker = new DecrypterWorker(self);\n\n      return decrypterWorker;\n    }();\n  });\n\n  /**\n   * Convert the properties of an HLS track into an audioTrackKind.\n   *\n   * @private\n   */\n  var audioTrackKind_ = function audioTrackKind_(properties) {\n    var kind = properties.default ? 'main' : 'alternative';\n\n    if (properties.characteristics && properties.characteristics.indexOf('public.accessibility.describes-video') >= 0) {\n      kind = 'main-desc';\n    }\n\n    return kind;\n  };\n\n  /**\n   * Pause provided segment loader and playlist loader if active\n   *\n   * @param {SegmentLoader} segmentLoader\n   *        SegmentLoader to pause\n   * @param {Object} mediaType\n   *        Active media type\n   * @function stopLoaders\n   */\n  var stopLoaders = function stopLoaders(segmentLoader, mediaType) {\n    segmentLoader.abort();\n    segmentLoader.pause();\n\n    if (mediaType && mediaType.activePlaylistLoader) {\n      mediaType.activePlaylistLoader.pause();\n      mediaType.activePlaylistLoader = null;\n    }\n  };\n\n  /**\n   * Start loading provided segment loader and playlist loader\n   *\n   * @param {PlaylistLoader} playlistLoader\n   *        PlaylistLoader to start loading\n   * @param {Object} mediaType\n   *        Active media type\n   * @function startLoaders\n   */\n  var startLoaders = function startLoaders(playlistLoader, mediaType) {\n    // Segment loader will be started after `loadedmetadata` or `loadedplaylist` from the\n    // playlist loader\n    mediaType.activePlaylistLoader = playlistLoader;\n    playlistLoader.load();\n  };\n\n  /**\n   * Returns a function to be called when the media group changes. It performs a\n   * non-destructive (preserve the buffer) resync of the SegmentLoader. This is because a\n   * change of group is merely a rendition switch of the same content at another encoding,\n   * rather than a change of content, such as switching audio from English to Spanish.\n   *\n   * @param {String} type\n   *        MediaGroup type\n   * @param {Object} settings\n   *        Object containing required information for media groups\n   * @return {Function}\n   *         Handler for a non-destructive resync of SegmentLoader when the active media\n   *         group changes.\n   * @function onGroupChanged\n   */\n  var onGroupChanged = function onGroupChanged(type, settings) {\n    return function () {\n      var _settings$segmentLoad = settings.segmentLoaders,\n          segmentLoader = _settings$segmentLoad[type],\n          mainSegmentLoader = _settings$segmentLoad.main,\n          mediaType = settings.mediaTypes[type];\n\n      var activeTrack = mediaType.activeTrack();\n      var activeGroup = mediaType.activeGroup(activeTrack);\n      var previousActiveLoader = mediaType.activePlaylistLoader;\n\n      stopLoaders(segmentLoader, mediaType);\n\n      if (!activeGroup) {\n        // there is no group active\n        return;\n      }\n\n      if (!activeGroup.playlistLoader) {\n        if (previousActiveLoader) {\n          // The previous group had a playlist loader but the new active group does not\n          // this means we are switching from demuxed to muxed audio. In this case we want to\n          // do a destructive reset of the main segment loader and not restart the audio\n          // loaders.\n          mainSegmentLoader.resetEverything();\n        }\n        return;\n      }\n\n      // Non-destructive resync\n      segmentLoader.resyncLoader();\n\n      startLoaders(activeGroup.playlistLoader, mediaType);\n    };\n  };\n\n  /**\n   * Returns a function to be called when the media track changes. It performs a\n   * destructive reset of the SegmentLoader to ensure we start loading as close to\n   * currentTime as possible.\n   *\n   * @param {String} type\n   *        MediaGroup type\n   * @param {Object} settings\n   *        Object containing required information for media groups\n   * @return {Function}\n   *         Handler for a destructive reset of SegmentLoader when the active media\n   *         track changes.\n   * @function onTrackChanged\n   */\n  var onTrackChanged = function onTrackChanged(type, settings) {\n    return function () {\n      var _settings$segmentLoad2 = settings.segmentLoaders,\n          segmentLoader = _settings$segmentLoad2[type],\n          mainSegmentLoader = _settings$segmentLoad2.main,\n          mediaType = settings.mediaTypes[type];\n\n      var activeTrack = mediaType.activeTrack();\n      var activeGroup = mediaType.activeGroup(activeTrack);\n      var previousActiveLoader = mediaType.activePlaylistLoader;\n\n      stopLoaders(segmentLoader, mediaType);\n\n      if (!activeGroup) {\n        // there is no group active so we do not want to restart loaders\n        return;\n      }\n\n      if (!activeGroup.playlistLoader) {\n        // when switching from demuxed audio/video to muxed audio/video (noted by no playlist\n        // loader for the audio group), we want to do a destructive reset of the main segment\n        // loader and not restart the audio loaders\n        mainSegmentLoader.resetEverything();\n        return;\n      }\n\n      if (previousActiveLoader === activeGroup.playlistLoader) {\n        // Nothing has actually changed. This can happen because track change events can fire\n        // multiple times for a \"single\" change. One for enabling the new active track, and\n        // one for disabling the track that was active\n        startLoaders(activeGroup.playlistLoader, mediaType);\n        return;\n      }\n\n      if (segmentLoader.track) {\n        // For WebVTT, set the new text track in the segmentloader\n        segmentLoader.track(activeTrack);\n      }\n\n      // destructive reset\n      segmentLoader.resetEverything();\n\n      startLoaders(activeGroup.playlistLoader, mediaType);\n    };\n  };\n\n  var onError = {\n    /**\n     * Returns a function to be called when a SegmentLoader or PlaylistLoader encounters\n     * an error.\n     *\n     * @param {String} type\n     *        MediaGroup type\n     * @param {Object} settings\n     *        Object containing required information for media groups\n     * @return {Function}\n     *         Error handler. Logs warning (or error if the playlist is blacklisted) to\n     *         console and switches back to default audio track.\n     * @function onError.AUDIO\n     */\n    AUDIO: function AUDIO(type, settings) {\n      return function () {\n        var segmentLoader = settings.segmentLoaders[type],\n            mediaType = settings.mediaTypes[type],\n            blacklistCurrentPlaylist = settings.blacklistCurrentPlaylist;\n\n\n        stopLoaders(segmentLoader, mediaType);\n\n        // switch back to default audio track\n        var activeTrack = mediaType.activeTrack();\n        var activeGroup = mediaType.activeGroup();\n        var id = (activeGroup.filter(function (group) {\n          return group.default;\n        })[0] || activeGroup[0]).id;\n        var defaultTrack = mediaType.tracks[id];\n\n        if (activeTrack === defaultTrack) {\n          // Default track encountered an error. All we can do now is blacklist the current\n          // rendition and hope another will switch audio groups\n          blacklistCurrentPlaylist({\n            message: 'Problem encountered loading the default audio track.'\n          });\n          return;\n        }\n\n        videojs$1.log.warn('Problem encountered loading the alternate audio track.' + 'Switching back to default.');\n\n        for (var trackId in mediaType.tracks) {\n          mediaType.tracks[trackId].enabled = mediaType.tracks[trackId] === defaultTrack;\n        }\n\n        mediaType.onTrackChanged();\n      };\n    },\n    /**\n     * Returns a function to be called when a SegmentLoader or PlaylistLoader encounters\n     * an error.\n     *\n     * @param {String} type\n     *        MediaGroup type\n     * @param {Object} settings\n     *        Object containing required information for media groups\n     * @return {Function}\n     *         Error handler. Logs warning to console and disables the active subtitle track\n     * @function onError.SUBTITLES\n     */\n    SUBTITLES: function SUBTITLES(type, settings) {\n      return function () {\n        var segmentLoader = settings.segmentLoaders[type],\n            mediaType = settings.mediaTypes[type];\n\n\n        videojs$1.log.warn('Problem encountered loading the subtitle track.' + 'Disabling subtitle track.');\n\n        stopLoaders(segmentLoader, mediaType);\n\n        var track = mediaType.activeTrack();\n\n        if (track) {\n          track.mode = 'disabled';\n        }\n\n        mediaType.onTrackChanged();\n      };\n    }\n  };\n\n  var setupListeners = {\n    /**\n     * Setup event listeners for audio playlist loader\n     *\n     * @param {String} type\n     *        MediaGroup type\n     * @param {PlaylistLoader|null} playlistLoader\n     *        PlaylistLoader to register listeners on\n     * @param {Object} settings\n     *        Object containing required information for media groups\n     * @function setupListeners.AUDIO\n     */\n    AUDIO: function AUDIO(type, playlistLoader, settings) {\n      if (!playlistLoader) {\n        // no playlist loader means audio will be muxed with the video\n        return;\n      }\n\n      var tech = settings.tech,\n          requestOptions = settings.requestOptions,\n          segmentLoader = settings.segmentLoaders[type];\n\n\n      playlistLoader.on('loadedmetadata', function () {\n        var media = playlistLoader.media();\n\n        segmentLoader.playlist(media, requestOptions);\n\n        // if the video is already playing, or if this isn't a live video and preload\n        // permits, start downloading segments\n        if (!tech.paused() || media.endList && tech.preload() !== 'none') {\n          segmentLoader.load();\n        }\n      });\n\n      playlistLoader.on('loadedplaylist', function () {\n        segmentLoader.playlist(playlistLoader.media(), requestOptions);\n\n        // If the player isn't paused, ensure that the segment loader is running\n        if (!tech.paused()) {\n          segmentLoader.load();\n        }\n      });\n\n      playlistLoader.on('error', onError[type](type, settings));\n    },\n    /**\n     * Setup event listeners for subtitle playlist loader\n     *\n     * @param {String} type\n     *        MediaGroup type\n     * @param {PlaylistLoader|null} playlistLoader\n     *        PlaylistLoader to register listeners on\n     * @param {Object} settings\n     *        Object containing required information for media groups\n     * @function setupListeners.SUBTITLES\n     */\n    SUBTITLES: function SUBTITLES(type, playlistLoader, settings) {\n      var tech = settings.tech,\n          requestOptions = settings.requestOptions,\n          segmentLoader = settings.segmentLoaders[type],\n          mediaType = settings.mediaTypes[type];\n\n\n      playlistLoader.on('loadedmetadata', function () {\n        var media = playlistLoader.media();\n\n        segmentLoader.playlist(media, requestOptions);\n        segmentLoader.track(mediaType.activeTrack());\n\n        // if the video is already playing, or if this isn't a live video and preload\n        // permits, start downloading segments\n        if (!tech.paused() || media.endList && tech.preload() !== 'none') {\n          segmentLoader.load();\n        }\n      });\n\n      playlistLoader.on('loadedplaylist', function () {\n        segmentLoader.playlist(playlistLoader.media(), requestOptions);\n\n        // If the player isn't paused, ensure that the segment loader is running\n        if (!tech.paused()) {\n          segmentLoader.load();\n        }\n      });\n\n      playlistLoader.on('error', onError[type](type, settings));\n    }\n  };\n\n  var byGroupId = function byGroupId(type, groupId) {\n    return function (playlist) {\n      return playlist.attributes[type] === groupId;\n    };\n  };\n\n  var byResolvedUri = function byResolvedUri(resolvedUri) {\n    return function (playlist) {\n      return playlist.resolvedUri === resolvedUri;\n    };\n  };\n\n  var initialize = {\n    /**\n     * Setup PlaylistLoaders and AudioTracks for the audio groups\n     *\n     * @param {String} type\n     *        MediaGroup type\n     * @param {Object} settings\n     *        Object containing required information for media groups\n     * @function initialize.AUDIO\n     */\n    'AUDIO': function AUDIO(type, settings) {\n      var hls = settings.hls,\n          sourceType = settings.sourceType,\n          segmentLoader = settings.segmentLoaders[type],\n          withCredentials = settings.requestOptions.withCredentials,\n          _settings$master = settings.master,\n          mediaGroups = _settings$master.mediaGroups,\n          playlists = _settings$master.playlists,\n          _settings$mediaTypes$ = settings.mediaTypes[type],\n          groups = _settings$mediaTypes$.groups,\n          tracks = _settings$mediaTypes$.tracks,\n          masterPlaylistLoader = settings.masterPlaylistLoader;\n\n      // force a default if we have none\n\n      if (!mediaGroups[type] || Object.keys(mediaGroups[type]).length === 0) {\n        mediaGroups[type] = { main: { default: { default: true } } };\n      }\n\n      for (var groupId in mediaGroups[type]) {\n        if (!groups[groupId]) {\n          groups[groupId] = [];\n        }\n\n        // List of playlists that have an AUDIO attribute value matching the current\n        // group ID\n        var groupPlaylists = playlists.filter(byGroupId(type, groupId));\n\n        for (var variantLabel in mediaGroups[type][groupId]) {\n          var properties = mediaGroups[type][groupId][variantLabel];\n\n          // List of playlists for the current group ID that have a matching uri with\n          // this alternate audio variant\n          var matchingPlaylists = groupPlaylists.filter(byResolvedUri(properties.resolvedUri));\n\n          if (matchingPlaylists.length) {\n            // If there is a playlist that has the same uri as this audio variant, assume\n            // that the playlist is audio only. We delete the resolvedUri property here\n            // to prevent a playlist loader from being created so that we don't have\n            // both the main and audio segment loaders loading the same audio segments\n            // from the same playlist.\n            delete properties.resolvedUri;\n          }\n\n          var playlistLoader = void 0;\n\n          if (properties.resolvedUri) {\n            playlistLoader = new PlaylistLoader(properties.resolvedUri, hls, withCredentials);\n          } else if (properties.playlists && sourceType === 'dash') {\n            playlistLoader = new DashPlaylistLoader(properties.playlists[0], hls, withCredentials, masterPlaylistLoader);\n          } else {\n            // no resolvedUri means the audio is muxed with the video when using this\n            // audio track\n            playlistLoader = null;\n          }\n\n          properties = videojs$1.mergeOptions({ id: variantLabel, playlistLoader: playlistLoader }, properties);\n\n          setupListeners[type](type, properties.playlistLoader, settings);\n\n          groups[groupId].push(properties);\n\n          if (typeof tracks[variantLabel] === 'undefined') {\n            var track = new videojs$1.AudioTrack({\n              id: variantLabel,\n              kind: audioTrackKind_(properties),\n              enabled: false,\n              language: properties.language,\n              default: properties.default,\n              label: variantLabel\n            });\n\n            tracks[variantLabel] = track;\n          }\n        }\n      }\n\n      // setup single error event handler for the segment loader\n      segmentLoader.on('error', onError[type](type, settings));\n    },\n    /**\n     * Setup PlaylistLoaders and TextTracks for the subtitle groups\n     *\n     * @param {String} type\n     *        MediaGroup type\n     * @param {Object} settings\n     *        Object containing required information for media groups\n     * @function initialize.SUBTITLES\n     */\n    'SUBTITLES': function SUBTITLES(type, settings) {\n      var tech = settings.tech,\n          hls = settings.hls,\n          sourceType = settings.sourceType,\n          segmentLoader = settings.segmentLoaders[type],\n          withCredentials = settings.requestOptions.withCredentials,\n          mediaGroups = settings.master.mediaGroups,\n          _settings$mediaTypes$2 = settings.mediaTypes[type],\n          groups = _settings$mediaTypes$2.groups,\n          tracks = _settings$mediaTypes$2.tracks,\n          masterPlaylistLoader = settings.masterPlaylistLoader;\n\n\n      for (var groupId in mediaGroups[type]) {\n        if (!groups[groupId]) {\n          groups[groupId] = [];\n        }\n\n        for (var variantLabel in mediaGroups[type][groupId]) {\n          if (mediaGroups[type][groupId][variantLabel].forced) {\n            // Subtitle playlists with the forced attribute are not selectable in Safari.\n            // According to Apple's HLS Authoring Specification:\n            //   If content has forced subtitles and regular subtitles in a given language,\n            //   the regular subtitles track in that language MUST contain both the forced\n            //   subtitles and the regular subtitles for that language.\n            // Because of this requirement and that Safari does not add forced subtitles,\n            // forced subtitles are skipped here to maintain consistent experience across\n            // all platforms\n            continue;\n          }\n\n          var properties = mediaGroups[type][groupId][variantLabel];\n\n          var playlistLoader = void 0;\n\n          if (sourceType === 'hls') {\n            playlistLoader = new PlaylistLoader(properties.resolvedUri, hls, withCredentials);\n          } else if (sourceType === 'dash') {\n            playlistLoader = new DashPlaylistLoader(properties.playlists[0], hls, withCredentials, masterPlaylistLoader);\n          }\n\n          properties = videojs$1.mergeOptions({\n            id: variantLabel,\n            playlistLoader: playlistLoader\n          }, properties);\n\n          setupListeners[type](type, properties.playlistLoader, settings);\n\n          groups[groupId].push(properties);\n\n          if (typeof tracks[variantLabel] === 'undefined') {\n            var track = tech.addRemoteTextTrack({\n              id: variantLabel,\n              kind: 'subtitles',\n              enabled: false,\n              language: properties.language,\n              label: variantLabel\n            }, false).track;\n\n            tracks[variantLabel] = track;\n          }\n        }\n      }\n\n      // setup single error event handler for the segment loader\n      segmentLoader.on('error', onError[type](type, settings));\n    },\n    /**\n     * Setup TextTracks for the closed-caption groups\n     *\n     * @param {String} type\n     *        MediaGroup type\n     * @param {Object} settings\n     *        Object containing required information for media groups\n     * @function initialize['CLOSED-CAPTIONS']\n     */\n    'CLOSED-CAPTIONS': function CLOSEDCAPTIONS(type, settings) {\n      var tech = settings.tech,\n          mediaGroups = settings.master.mediaGroups,\n          _settings$mediaTypes$3 = settings.mediaTypes[type],\n          groups = _settings$mediaTypes$3.groups,\n          tracks = _settings$mediaTypes$3.tracks;\n\n\n      for (var groupId in mediaGroups[type]) {\n        if (!groups[groupId]) {\n          groups[groupId] = [];\n        }\n\n        for (var variantLabel in mediaGroups[type][groupId]) {\n          var properties = mediaGroups[type][groupId][variantLabel];\n\n          // We only support CEA608 captions for now, so ignore anything that\n          // doesn't use a CCx INSTREAM-ID\n          if (!properties.instreamId.match(/CC\\d/)) {\n            continue;\n          }\n\n          // No PlaylistLoader is required for Closed-Captions because the captions are\n          // embedded within the video stream\n          groups[groupId].push(videojs$1.mergeOptions({ id: variantLabel }, properties));\n\n          if (typeof tracks[variantLabel] === 'undefined') {\n            var track = tech.addRemoteTextTrack({\n              id: properties.instreamId,\n              kind: 'captions',\n              enabled: false,\n              language: properties.language,\n              label: variantLabel\n            }, false).track;\n\n            tracks[variantLabel] = track;\n          }\n        }\n      }\n    }\n  };\n\n  /**\n   * Returns a function used to get the active group of the provided type\n   *\n   * @param {String} type\n   *        MediaGroup type\n   * @param {Object} settings\n   *        Object containing required information for media groups\n   * @return {Function}\n   *         Function that returns the active media group for the provided type. Takes an\n   *         optional parameter {TextTrack} track. If no track is provided, a list of all\n   *         variants in the group, otherwise the variant corresponding to the provided\n   *         track is returned.\n   * @function activeGroup\n   */\n  var activeGroup = function activeGroup(type, settings) {\n    return function (track) {\n      var masterPlaylistLoader = settings.masterPlaylistLoader,\n          groups = settings.mediaTypes[type].groups;\n\n\n      var media = masterPlaylistLoader.media();\n\n      if (!media) {\n        return null;\n      }\n\n      var variants = null;\n\n      if (media.attributes[type]) {\n        variants = groups[media.attributes[type]];\n      }\n\n      variants = variants || groups.main;\n\n      if (typeof track === 'undefined') {\n        return variants;\n      }\n\n      if (track === null) {\n        // An active track was specified so a corresponding group is expected. track === null\n        // means no track is currently active so there is no corresponding group\n        return null;\n      }\n\n      return variants.filter(function (props) {\n        return props.id === track.id;\n      })[0] || null;\n    };\n  };\n\n  var activeTrack = {\n    /**\n     * Returns a function used to get the active track of type provided\n     *\n     * @param {String} type\n     *        MediaGroup type\n     * @param {Object} settings\n     *        Object containing required information for media groups\n     * @return {Function}\n     *         Function that returns the active media track for the provided type. Returns\n     *         null if no track is active\n     * @function activeTrack.AUDIO\n     */\n    AUDIO: function AUDIO(type, settings) {\n      return function () {\n        var tracks = settings.mediaTypes[type].tracks;\n\n\n        for (var id in tracks) {\n          if (tracks[id].enabled) {\n            return tracks[id];\n          }\n        }\n\n        return null;\n      };\n    },\n    /**\n     * Returns a function used to get the active track of type provided\n     *\n     * @param {String} type\n     *        MediaGroup type\n     * @param {Object} settings\n     *        Object containing required information for media groups\n     * @return {Function}\n     *         Function that returns the active media track for the provided type. Returns\n     *         null if no track is active\n     * @function activeTrack.SUBTITLES\n     */\n    SUBTITLES: function SUBTITLES(type, settings) {\n      return function () {\n        var tracks = settings.mediaTypes[type].tracks;\n\n\n        for (var id in tracks) {\n          if (tracks[id].mode === 'showing') {\n            return tracks[id];\n          }\n        }\n\n        return null;\n      };\n    }\n  };\n\n  /**\n   * Setup PlaylistLoaders and Tracks for media groups (Audio, Subtitles,\n   * Closed-Captions) specified in the master manifest.\n   *\n   * @param {Object} settings\n   *        Object containing required information for setting up the media groups\n   * @param {SegmentLoader} settings.segmentLoaders.AUDIO\n   *        Audio segment loader\n   * @param {SegmentLoader} settings.segmentLoaders.SUBTITLES\n   *        Subtitle segment loader\n   * @param {SegmentLoader} settings.segmentLoaders.main\n   *        Main segment loader\n   * @param {Tech} settings.tech\n   *        The tech of the player\n   * @param {Object} settings.requestOptions\n   *        XHR request options used by the segment loaders\n   * @param {PlaylistLoader} settings.masterPlaylistLoader\n   *        PlaylistLoader for the master source\n   * @param {HlsHandler} settings.hls\n   *        HLS SourceHandler\n   * @param {Object} settings.master\n   *        The parsed master manifest\n   * @param {Object} settings.mediaTypes\n   *        Object to store the loaders, tracks, and utility methods for each media type\n   * @param {Function} settings.blacklistCurrentPlaylist\n   *        Blacklists the current rendition and forces a rendition switch.\n   * @function setupMediaGroups\n   */\n  var setupMediaGroups = function setupMediaGroups(settings) {\n    ['AUDIO', 'SUBTITLES', 'CLOSED-CAPTIONS'].forEach(function (type) {\n      initialize[type](type, settings);\n    });\n\n    var mediaTypes = settings.mediaTypes,\n        masterPlaylistLoader = settings.masterPlaylistLoader,\n        tech = settings.tech,\n        hls = settings.hls;\n\n    // setup active group and track getters and change event handlers\n\n    ['AUDIO', 'SUBTITLES'].forEach(function (type) {\n      mediaTypes[type].activeGroup = activeGroup(type, settings);\n      mediaTypes[type].activeTrack = activeTrack[type](type, settings);\n      mediaTypes[type].onGroupChanged = onGroupChanged(type, settings);\n      mediaTypes[type].onTrackChanged = onTrackChanged(type, settings);\n    });\n\n    // DO NOT enable the default subtitle or caption track.\n    // DO enable the default audio track\n    var audioGroup = mediaTypes.AUDIO.activeGroup();\n    var groupId = (audioGroup.filter(function (group) {\n      return group.default;\n    })[0] || audioGroup[0]).id;\n\n    mediaTypes.AUDIO.tracks[groupId].enabled = true;\n    mediaTypes.AUDIO.onTrackChanged();\n\n    masterPlaylistLoader.on('mediachange', function () {\n      ['AUDIO', 'SUBTITLES'].forEach(function (type) {\n        return mediaTypes[type].onGroupChanged();\n      });\n    });\n\n    // custom audio track change event handler for usage event\n    var onAudioTrackChanged = function onAudioTrackChanged() {\n      mediaTypes.AUDIO.onTrackChanged();\n      tech.trigger({ type: 'usage', name: 'hls-audio-change' });\n    };\n\n    tech.audioTracks().addEventListener('change', onAudioTrackChanged);\n    tech.remoteTextTracks().addEventListener('change', mediaTypes.SUBTITLES.onTrackChanged);\n\n    hls.on('dispose', function () {\n      tech.audioTracks().removeEventListener('change', onAudioTrackChanged);\n      tech.remoteTextTracks().removeEventListener('change', mediaTypes.SUBTITLES.onTrackChanged);\n    });\n\n    // clear existing audio tracks and add the ones we just created\n    tech.clearTracks('audio');\n\n    for (var id in mediaTypes.AUDIO.tracks) {\n      tech.audioTracks().addTrack(mediaTypes.AUDIO.tracks[id]);\n    }\n  };\n\n  /**\n   * Creates skeleton object used to store the loaders, tracks, and utility methods for each\n   * media type\n   *\n   * @return {Object}\n   *         Object to store the loaders, tracks, and utility methods for each media type\n   * @function createMediaTypes\n   */\n  var createMediaTypes = function createMediaTypes() {\n    var mediaTypes = {};\n\n    ['AUDIO', 'SUBTITLES', 'CLOSED-CAPTIONS'].forEach(function (type) {\n      mediaTypes[type] = {\n        groups: {},\n        tracks: {},\n        activePlaylistLoader: null,\n        activeGroup: noop$1,\n        activeTrack: noop$1,\n        onGroupChanged: noop$1,\n        onTrackChanged: noop$1\n      };\n    });\n\n    return mediaTypes;\n  };\n\n  /**\n   * @file master-playlist-controller.js\n   */\n\n  var ABORT_EARLY_BLACKLIST_SECONDS = 60 * 2;\n\n  var Hls = void 0;\n\n  // SegmentLoader stats that need to have each loader's\n  // values summed to calculate the final value\n  var loaderStats = ['mediaRequests', 'mediaRequestsAborted', 'mediaRequestsTimedout', 'mediaRequestsErrored', 'mediaTransferDuration', 'mediaBytesTransferred'];\n  var sumLoaderStat = function sumLoaderStat(stat) {\n    return this.audioSegmentLoader_[stat] + this.mainSegmentLoader_[stat];\n  };\n\n  /**\n   * the master playlist controller controller all interactons\n   * between playlists and segmentloaders. At this time this mainly\n   * involves a master playlist and a series of audio playlists\n   * if they are available\n   *\n   * @class MasterPlaylistController\n   * @extends videojs.EventTarget\n   */\n\n  var MasterPlaylistController = function (_videojs$EventTarget5) {\n    inherits(MasterPlaylistController, _videojs$EventTarget5);\n\n    function MasterPlaylistController(options) {\n      classCallCheck(this, MasterPlaylistController);\n\n      var _this29 = possibleConstructorReturn(this, _videojs$EventTarget5.call(this));\n\n      var url = options.url,\n          withCredentials = options.withCredentials,\n          tech = options.tech,\n          bandwidth = options.bandwidth,\n          externHls = options.externHls,\n          useCueTags = options.useCueTags,\n          blacklistDuration = options.blacklistDuration,\n          enableLowInitialPlaylist = options.enableLowInitialPlaylist,\n          sourceType = options.sourceType;\n\n\n      if (!url) {\n        throw new Error('A non-empty playlist URL is required');\n      }\n\n      Hls = externHls;\n\n      _this29.withCredentials = withCredentials;\n      _this29.tech_ = tech;\n      _this29.hls_ = tech.hls;\n      _this29.sourceType_ = sourceType;\n      _this29.useCueTags_ = useCueTags;\n      _this29.blacklistDuration = blacklistDuration;\n      _this29.enableLowInitialPlaylist = enableLowInitialPlaylist;\n      if (_this29.useCueTags_) {\n        _this29.cueTagsTrack_ = _this29.tech_.addTextTrack('metadata', 'ad-cues');\n        _this29.cueTagsTrack_.inBandMetadataTrackDispatchType = '';\n      }\n\n      _this29.requestOptions_ = {\n        withCredentials: _this29.withCredentials,\n        timeout: null\n      };\n\n      _this29.mediaTypes_ = createMediaTypes();\n\n      _this29.mediaSource = new videojs$1.MediaSource();\n\n      // load the media source into the player\n      _this29.mediaSource.addEventListener('sourceopen', _this29.handleSourceOpen_.bind(_this29));\n\n      _this29.seekable_ = videojs$1.createTimeRanges();\n      _this29.hasPlayed_ = function () {\n        return false;\n      };\n\n      _this29.syncController_ = new SyncController(options);\n      _this29.segmentMetadataTrack_ = tech.addRemoteTextTrack({\n        kind: 'metadata',\n        label: 'segment-metadata'\n      }, false).track;\n\n      _this29.decrypter_ = new Decrypter$1();\n\n      var segmentLoaderSettings = {\n        hls: _this29.hls_,\n        mediaSource: _this29.mediaSource,\n        currentTime: _this29.tech_.currentTime.bind(_this29.tech_),\n        seekable: function seekable() {\n          return _this29.seekable();\n        },\n        seeking: function seeking() {\n          return _this29.tech_.seeking();\n        },\n        duration: function duration() {\n          return _this29.mediaSource.duration;\n        },\n        hasPlayed: function hasPlayed() {\n          return _this29.hasPlayed_();\n        },\n        goalBufferLength: function goalBufferLength() {\n          return _this29.goalBufferLength();\n        },\n        bandwidth: bandwidth,\n        syncController: _this29.syncController_,\n        decrypter: _this29.decrypter_,\n        sourceType: _this29.sourceType_\n      };\n\n      _this29.masterPlaylistLoader_ = _this29.sourceType_ === 'dash' ? new DashPlaylistLoader(url, _this29.hls_, _this29.withCredentials) : new PlaylistLoader(url, _this29.hls_, _this29.withCredentials);\n      _this29.setupMasterPlaylistLoaderListeners_();\n\n      // setup segment loaders\n      // combined audio/video or just video when alternate audio track is selected\n      _this29.mainSegmentLoader_ = new SegmentLoader(videojs$1.mergeOptions(segmentLoaderSettings, {\n        segmentMetadataTrack: _this29.segmentMetadataTrack_,\n        loaderType: 'main'\n      }), options);\n\n      // alternate audio track\n      _this29.audioSegmentLoader_ = new SegmentLoader(videojs$1.mergeOptions(segmentLoaderSettings, {\n        loaderType: 'audio'\n      }), options);\n\n      _this29.subtitleSegmentLoader_ = new VTTSegmentLoader(videojs$1.mergeOptions(segmentLoaderSettings, {\n        loaderType: 'vtt'\n      }), options);\n\n      _this29.setupSegmentLoaderListeners_();\n\n      // Create SegmentLoader stat-getters\n      loaderStats.forEach(function (stat) {\n        _this29[stat + '_'] = sumLoaderStat.bind(_this29, stat);\n      });\n\n      _this29.logger_ = logger('MPC');\n\n      _this29.masterPlaylistLoader_.load();\n      return _this29;\n    }\n\n    /**\n     * Register event handlers on the master playlist loader. A helper\n     * function for construction time.\n     *\n     * @private\n     */\n\n\n    MasterPlaylistController.prototype.setupMasterPlaylistLoaderListeners_ = function setupMasterPlaylistLoaderListeners_() {\n      var _this30 = this;\n\n      this.masterPlaylistLoader_.on('loadedmetadata', function () {\n        var media = _this30.masterPlaylistLoader_.media();\n        var requestTimeout = _this30.masterPlaylistLoader_.targetDuration * 1.5 * 1000;\n\n        // If we don't have any more available playlists, we don't want to\n        // timeout the request.\n        if (isLowestEnabledRendition(_this30.masterPlaylistLoader_.master, _this30.masterPlaylistLoader_.media())) {\n          _this30.requestOptions_.timeout = 0;\n        } else {\n          _this30.requestOptions_.timeout = requestTimeout;\n        }\n\n        // if this isn't a live video and preload permits, start\n        // downloading segments\n        if (media.endList && _this30.tech_.preload() !== 'none') {\n          _this30.mainSegmentLoader_.playlist(media, _this30.requestOptions_);\n          _this30.mainSegmentLoader_.load();\n        }\n\n        setupMediaGroups({\n          sourceType: _this30.sourceType_,\n          segmentLoaders: {\n            AUDIO: _this30.audioSegmentLoader_,\n            SUBTITLES: _this30.subtitleSegmentLoader_,\n            main: _this30.mainSegmentLoader_\n          },\n          tech: _this30.tech_,\n          requestOptions: _this30.requestOptions_,\n          masterPlaylistLoader: _this30.masterPlaylistLoader_,\n          hls: _this30.hls_,\n          master: _this30.master(),\n          mediaTypes: _this30.mediaTypes_,\n          blacklistCurrentPlaylist: _this30.blacklistCurrentPlaylist.bind(_this30)\n        });\n\n        _this30.triggerPresenceUsage_(_this30.master(), media);\n\n        try {\n          _this30.setupSourceBuffers_();\n        } catch (e) {\n          videojs$1.log.warn('Failed to create SourceBuffers', e);\n          return _this30.mediaSource.endOfStream('decode');\n        }\n        _this30.setupFirstPlay();\n\n        _this30.trigger('selectedinitialmedia');\n      });\n\n      this.masterPlaylistLoader_.on('loadedplaylist', function () {\n        var updatedPlaylist = _this30.masterPlaylistLoader_.media();\n\n        if (!updatedPlaylist) {\n          // blacklist any variants that are not supported by the browser before selecting\n          // an initial media as the playlist selectors do not consider browser support\n          _this30.excludeUnsupportedVariants_();\n\n          var selectedMedia = void 0;\n\n          if (_this30.enableLowInitialPlaylist) {\n            selectedMedia = _this30.selectInitialPlaylist();\n          }\n\n          if (!selectedMedia) {\n            selectedMedia = _this30.selectPlaylist();\n          }\n\n          _this30.initialMedia_ = selectedMedia;\n          _this30.masterPlaylistLoader_.media(_this30.initialMedia_);\n          return;\n        }\n\n        if (_this30.useCueTags_) {\n          _this30.updateAdCues_(updatedPlaylist);\n        }\n\n        // TODO: Create a new event on the PlaylistLoader that signals\n        // that the segments have changed in some way and use that to\n        // update the SegmentLoader instead of doing it twice here and\n        // on `mediachange`\n        _this30.mainSegmentLoader_.playlist(updatedPlaylist, _this30.requestOptions_);\n        _this30.updateDuration();\n\n        // If the player isn't paused, ensure that the segment loader is running,\n        // as it is possible that it was temporarily stopped while waiting for\n        // a playlist (e.g., in case the playlist errored and we re-requested it).\n        if (!_this30.tech_.paused()) {\n          _this30.mainSegmentLoader_.load();\n        }\n\n        if (!updatedPlaylist.endList) {\n          var addSeekableRange = function addSeekableRange() {\n            var seekable$$1 = _this30.seekable();\n\n            if (seekable$$1.length !== 0) {\n              _this30.mediaSource.addSeekableRange_(seekable$$1.start(0), seekable$$1.end(0));\n            }\n          };\n\n          if (_this30.duration() !== Infinity) {\n            var onDurationchange = function onDurationchange() {\n              if (_this30.duration() === Infinity) {\n                addSeekableRange();\n              } else {\n                _this30.tech_.one('durationchange', onDurationchange);\n              }\n            };\n\n            _this30.tech_.one('durationchange', onDurationchange);\n          } else {\n            addSeekableRange();\n          }\n        }\n      });\n\n      this.masterPlaylistLoader_.on('error', function () {\n        _this30.blacklistCurrentPlaylist(_this30.masterPlaylistLoader_.error);\n      });\n\n      this.masterPlaylistLoader_.on('mediachanging', function () {\n        _this30.mainSegmentLoader_.abort();\n        _this30.mainSegmentLoader_.pause();\n      });\n\n      this.masterPlaylistLoader_.on('mediachange', function () {\n        var media = _this30.masterPlaylistLoader_.media();\n        var requestTimeout = _this30.masterPlaylistLoader_.targetDuration * 1.5 * 1000;\n\n        // If we don't have any more available playlists, we don't want to\n        // timeout the request.\n        if (isLowestEnabledRendition(_this30.masterPlaylistLoader_.master, _this30.masterPlaylistLoader_.media())) {\n          _this30.requestOptions_.timeout = 0;\n        } else {\n          _this30.requestOptions_.timeout = requestTimeout;\n        }\n\n        // TODO: Create a new event on the PlaylistLoader that signals\n        // that the segments have changed in some way and use that to\n        // update the SegmentLoader instead of doing it twice here and\n        // on `loadedplaylist`\n        _this30.mainSegmentLoader_.playlist(media, _this30.requestOptions_);\n        _this30.mainSegmentLoader_.load();\n\n        _this30.tech_.trigger({\n          type: 'mediachange',\n          bubbles: true\n        });\n      });\n\n      this.masterPlaylistLoader_.on('playlistunchanged', function () {\n        var updatedPlaylist = _this30.masterPlaylistLoader_.media();\n        var playlistOutdated = _this30.stuckAtPlaylistEnd_(updatedPlaylist);\n\n        if (playlistOutdated) {\n          // Playlist has stopped updating and we're stuck at its end. Try to\n          // blacklist it and switch to another playlist in the hope that that\n          // one is updating (and give the player a chance to re-adjust to the\n          // safe live point).\n          _this30.blacklistCurrentPlaylist({\n            message: 'Playlist no longer updating.'\n          });\n          // useful for monitoring QoS\n          _this30.tech_.trigger('playliststuck');\n        }\n      });\n\n      this.masterPlaylistLoader_.on('renditiondisabled', function () {\n        _this30.tech_.trigger({ type: 'usage', name: 'hls-rendition-disabled' });\n      });\n      this.masterPlaylistLoader_.on('renditionenabled', function () {\n        _this30.tech_.trigger({ type: 'usage', name: 'hls-rendition-enabled' });\n      });\n    };\n\n    /**\n     * A helper function for triggerring presence usage events once per source\n     *\n     * @private\n     */\n\n\n    MasterPlaylistController.prototype.triggerPresenceUsage_ = function triggerPresenceUsage_(master, media) {\n      var mediaGroups = master.mediaGroups || {};\n      var defaultDemuxed = true;\n      var audioGroupKeys = Object.keys(mediaGroups.AUDIO);\n\n      for (var mediaGroup in mediaGroups.AUDIO) {\n        for (var label in mediaGroups.AUDIO[mediaGroup]) {\n          var properties = mediaGroups.AUDIO[mediaGroup][label];\n\n          if (!properties.uri) {\n            defaultDemuxed = false;\n          }\n        }\n      }\n\n      if (defaultDemuxed) {\n        this.tech_.trigger({ type: 'usage', name: 'hls-demuxed' });\n      }\n\n      if (Object.keys(mediaGroups.SUBTITLES).length) {\n        this.tech_.trigger({ type: 'usage', name: 'hls-webvtt' });\n      }\n\n      if (Hls.Playlist.isAes(media)) {\n        this.tech_.trigger({ type: 'usage', name: 'hls-aes' });\n      }\n\n      if (Hls.Playlist.isFmp4(media)) {\n        this.tech_.trigger({ type: 'usage', name: 'hls-fmp4' });\n      }\n\n      if (audioGroupKeys.length && Object.keys(mediaGroups.AUDIO[audioGroupKeys[0]]).length > 1) {\n        this.tech_.trigger({ type: 'usage', name: 'hls-alternate-audio' });\n      }\n\n      if (this.useCueTags_) {\n        this.tech_.trigger({ type: 'usage', name: 'hls-playlist-cue-tags' });\n      }\n    };\n    /**\n     * Register event handlers on the segment loaders. A helper function\n     * for construction time.\n     *\n     * @private\n     */\n\n\n    MasterPlaylistController.prototype.setupSegmentLoaderListeners_ = function setupSegmentLoaderListeners_() {\n      var _this31 = this;\n\n      this.mainSegmentLoader_.on('bandwidthupdate', function () {\n        var nextPlaylist = _this31.selectPlaylist();\n        var currentPlaylist = _this31.masterPlaylistLoader_.media();\n        var buffered = _this31.tech_.buffered();\n        var forwardBuffer = buffered.length ? buffered.end(buffered.length - 1) - _this31.tech_.currentTime() : 0;\n\n        var bufferLowWaterLine = _this31.bufferLowWaterLine();\n\n        // If the playlist is live, then we want to not take low water line into account.\n        // This is because in LIVE, the player plays 3 segments from the end of the\n        // playlist, and if `BUFFER_LOW_WATER_LINE` is greater than the duration availble\n        // in those segments, a viewer will never experience a rendition upswitch.\n        if (!currentPlaylist.endList ||\n        // For the same reason as LIVE, we ignore the low water line when the VOD\n        // duration is below the max potential low water line\n        _this31.duration() < Config.MAX_BUFFER_LOW_WATER_LINE ||\n        // we want to switch down to lower resolutions quickly to continue playback, but\n        nextPlaylist.attributes.BANDWIDTH < currentPlaylist.attributes.BANDWIDTH ||\n        // ensure we have some buffer before we switch up to prevent us running out of\n        // buffer while loading a higher rendition.\n        forwardBuffer >= bufferLowWaterLine) {\n          _this31.masterPlaylistLoader_.media(nextPlaylist);\n        }\n\n        _this31.tech_.trigger('bandwidthupdate');\n      });\n      this.mainSegmentLoader_.on('progress', function () {\n        _this31.trigger('progress');\n      });\n\n      this.mainSegmentLoader_.on('error', function () {\n        _this31.blacklistCurrentPlaylist(_this31.mainSegmentLoader_.error());\n      });\n\n      this.mainSegmentLoader_.on('syncinfoupdate', function () {\n        _this31.onSyncInfoUpdate_();\n      });\n\n      this.mainSegmentLoader_.on('timestampoffset', function () {\n        _this31.tech_.trigger({ type: 'usage', name: 'hls-timestamp-offset' });\n      });\n      this.audioSegmentLoader_.on('syncinfoupdate', function () {\n        _this31.onSyncInfoUpdate_();\n      });\n\n      this.mainSegmentLoader_.on('ended', function () {\n        _this31.onEndOfStream();\n      });\n\n      this.mainSegmentLoader_.on('earlyabort', function () {\n        _this31.blacklistCurrentPlaylist({\n          message: 'Aborted early because there isn\\'t enough bandwidth to complete the ' + 'request without rebuffering.'\n        }, ABORT_EARLY_BLACKLIST_SECONDS);\n      });\n\n      this.mainSegmentLoader_.on('reseteverything', function () {\n        // If playing an MTS stream, a videojs.MediaSource is listening for\n        // hls-reset to reset caption parsing state in the transmuxer\n        _this31.tech_.trigger('hls-reset');\n      });\n\n      this.mainSegmentLoader_.on('segmenttimemapping', function (event) {\n        // If playing an MTS stream in html, a videojs.MediaSource is listening for\n        // hls-segment-time-mapping update its internal mapping of stream to display time\n        _this31.tech_.trigger({\n          type: 'hls-segment-time-mapping',\n          mapping: event.mapping\n        });\n      });\n\n      this.audioSegmentLoader_.on('ended', function () {\n        _this31.onEndOfStream();\n      });\n    };\n\n    MasterPlaylistController.prototype.mediaSecondsLoaded_ = function mediaSecondsLoaded_() {\n      return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded + this.mainSegmentLoader_.mediaSecondsLoaded);\n    };\n\n    /**\n     * Call load on our SegmentLoaders\n     */\n\n\n    MasterPlaylistController.prototype.load = function load() {\n      this.mainSegmentLoader_.load();\n      if (this.mediaTypes_.AUDIO.activePlaylistLoader) {\n        this.audioSegmentLoader_.load();\n      }\n      if (this.mediaTypes_.SUBTITLES.activePlaylistLoader) {\n        this.subtitleSegmentLoader_.load();\n      }\n    };\n\n    /**\n     * Re-tune playback quality level for the current player\n     * conditions. This method may perform destructive actions, like\n     * removing already buffered content, to readjust the currently\n     * active playlist quickly.\n     *\n     * @private\n     */\n\n\n    MasterPlaylistController.prototype.fastQualityChange_ = function fastQualityChange_() {\n      var media = this.selectPlaylist();\n\n      if (media !== this.masterPlaylistLoader_.media()) {\n        this.masterPlaylistLoader_.media(media);\n\n        this.mainSegmentLoader_.resetLoader();\n        // don't need to reset audio as it is reset when media changes\n      }\n    };\n\n    /**\n     * Begin playback.\n     */\n\n\n    MasterPlaylistController.prototype.play = function play() {\n      if (this.setupFirstPlay()) {\n        return;\n      }\n\n      if (this.tech_.ended()) {\n        this.tech_.setCurrentTime(0);\n      }\n\n      if (this.hasPlayed_()) {\n        this.load();\n      }\n\n      var seekable$$1 = this.tech_.seekable();\n\n      // if the viewer has paused and we fell out of the live window,\n      // seek forward to the live point\n      if (this.tech_.duration() === Infinity) {\n        if (this.tech_.currentTime() < seekable$$1.start(0)) {\n          return this.tech_.setCurrentTime(seekable$$1.end(seekable$$1.length - 1));\n        }\n      }\n    };\n\n    /**\n     * Seek to the latest media position if this is a live video and the\n     * player and video are loaded and initialized.\n     */\n\n\n    MasterPlaylistController.prototype.setupFirstPlay = function setupFirstPlay() {\n      var _this32 = this;\n\n      var media = this.masterPlaylistLoader_.media();\n\n      // Check that everything is ready to begin buffering for the first call to play\n      //  If 1) there is no active media\n      //     2) the player is paused\n      //     3) the first play has already been setup\n      // then exit early\n      if (!media || this.tech_.paused() || this.hasPlayed_()) {\n        return false;\n      }\n\n      // when the video is a live stream\n      if (!media.endList) {\n        var seekable$$1 = this.seekable();\n\n        if (!seekable$$1.length) {\n          // without a seekable range, the player cannot seek to begin buffering at the live\n          // point\n          return false;\n        }\n\n        if (videojs$1.browser.IE_VERSION && this.tech_.readyState() === 0) {\n          // IE11 throws an InvalidStateError if you try to set currentTime while the\n          // readyState is 0, so it must be delayed until the tech fires loadedmetadata.\n          this.tech_.one('loadedmetadata', function () {\n            _this32.trigger('firstplay');\n            _this32.tech_.setCurrentTime(seekable$$1.end(0));\n            _this32.hasPlayed_ = function () {\n              return true;\n            };\n          });\n\n          return false;\n        }\n\n        // trigger firstplay to inform the source handler to ignore the next seek event\n        this.trigger('firstplay');\n        // seek to the live point\n        this.tech_.setCurrentTime(seekable$$1.end(0));\n      }\n\n      this.hasPlayed_ = function () {\n        return true;\n      };\n      // we can begin loading now that everything is ready\n      this.load();\n      return true;\n    };\n\n    /**\n     * handle the sourceopen event on the MediaSource\n     *\n     * @private\n     */\n\n\n    MasterPlaylistController.prototype.handleSourceOpen_ = function handleSourceOpen_() {\n      // Only attempt to create the source buffer if none already exist.\n      // handleSourceOpen is also called when we are \"re-opening\" a source buffer\n      // after `endOfStream` has been called (in response to a seek for instance)\n      try {\n        this.setupSourceBuffers_();\n      } catch (e) {\n        videojs$1.log.warn('Failed to create Source Buffers', e);\n        return this.mediaSource.endOfStream('decode');\n      }\n\n      // if autoplay is enabled, begin playback. This is duplicative of\n      // code in video.js but is required because play() must be invoked\n      // *after* the media source has opened.\n      if (this.tech_.autoplay()) {\n        var playPromise = this.tech_.play();\n\n        // Catch/silence error when a pause interrupts a play request\n        // on browsers which return a promise\n        if (typeof playPromise !== 'undefined' && typeof playPromise.then === 'function') {\n          playPromise.then(null, function (e) {});\n        }\n      }\n\n      this.trigger('sourceopen');\n    };\n\n    /**\n     * Calls endOfStream on the media source when all active stream types have called\n     * endOfStream\n     *\n     * @param {string} streamType\n     *        Stream type of the segment loader that called endOfStream\n     * @private\n     */\n\n\n    MasterPlaylistController.prototype.onEndOfStream = function onEndOfStream() {\n      var isEndOfStream = this.mainSegmentLoader_.ended_;\n\n      if (this.mediaTypes_.AUDIO.activePlaylistLoader) {\n        // if the audio playlist loader exists, then alternate audio is active\n        if (!this.mainSegmentLoader_.startingMedia_ || this.mainSegmentLoader_.startingMedia_.containsVideo) {\n          // if we do not know if the main segment loader contains video yet or if we\n          // definitively know the main segment loader contains video, then we need to wait\n          // for both main and audio segment loaders to call endOfStream\n          isEndOfStream = isEndOfStream && this.audioSegmentLoader_.ended_;\n        } else {\n          // otherwise just rely on the audio loader\n          isEndOfStream = this.audioSegmentLoader_.ended_;\n        }\n      }\n\n      if (isEndOfStream) {\n        this.mediaSource.endOfStream();\n      }\n    };\n\n    /**\n     * Check if a playlist has stopped being updated\n     * @param {Object} playlist the media playlist object\n     * @return {boolean} whether the playlist has stopped being updated or not\n     */\n\n\n    MasterPlaylistController.prototype.stuckAtPlaylistEnd_ = function stuckAtPlaylistEnd_(playlist) {\n      var seekable$$1 = this.seekable();\n\n      if (!seekable$$1.length) {\n        // playlist doesn't have enough information to determine whether we are stuck\n        return false;\n      }\n\n      var expired = this.syncController_.getExpiredTime(playlist, this.mediaSource.duration);\n\n      if (expired === null) {\n        return false;\n      }\n\n      // does not use the safe live end to calculate playlist end, since we\n      // don't want to say we are stuck while there is still content\n      var absolutePlaylistEnd = Hls.Playlist.playlistEnd(playlist, expired);\n      var currentTime = this.tech_.currentTime();\n      var buffered = this.tech_.buffered();\n\n      if (!buffered.length) {\n        // return true if the playhead reached the absolute end of the playlist\n        return absolutePlaylistEnd - currentTime <= SAFE_TIME_DELTA;\n      }\n      var bufferedEnd = buffered.end(buffered.length - 1);\n\n      // return true if there is too little buffer left and buffer has reached absolute\n      // end of playlist\n      return bufferedEnd - currentTime <= SAFE_TIME_DELTA && absolutePlaylistEnd - bufferedEnd <= SAFE_TIME_DELTA;\n    };\n\n    /**\n     * Blacklists a playlist when an error occurs for a set amount of time\n     * making it unavailable for selection by the rendition selection algorithm\n     * and then forces a new playlist (rendition) selection.\n     *\n     * @param {Object=} error an optional error that may include the playlist\n     * to blacklist\n     * @param {Number=} blacklistDuration an optional number of seconds to blacklist the\n     * playlist\n     */\n\n\n    MasterPlaylistController.prototype.blacklistCurrentPlaylist = function blacklistCurrentPlaylist() {\n      var error = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var blacklistDuration = arguments[1];\n\n      var currentPlaylist = void 0;\n      var nextPlaylist = void 0;\n\n      // If the `error` was generated by the playlist loader, it will contain\n      // the playlist we were trying to load (but failed) and that should be\n      // blacklisted instead of the currently selected playlist which is likely\n      // out-of-date in this scenario\n      currentPlaylist = error.playlist || this.masterPlaylistLoader_.media();\n\n      blacklistDuration = blacklistDuration || error.blacklistDuration || this.blacklistDuration;\n\n      // If there is no current playlist, then an error occurred while we were\n      // trying to load the master OR while we were disposing of the tech\n      if (!currentPlaylist) {\n        this.error = error;\n\n        try {\n          return this.mediaSource.endOfStream('network');\n        } catch (e) {\n          return this.trigger('error');\n        }\n      }\n\n      var isFinalRendition = this.masterPlaylistLoader_.master.playlists.filter(isEnabled).length === 1;\n\n      if (isFinalRendition) {\n        // Never blacklisting this playlist because it's final rendition\n        videojs$1.log.warn('Problem encountered with the current ' + 'HLS playlist. Trying again since it is the final playlist.');\n\n        this.tech_.trigger('retryplaylist');\n        return this.masterPlaylistLoader_.load(isFinalRendition);\n      }\n      // Blacklist this playlist\n      currentPlaylist.excludeUntil = Date.now() + blacklistDuration * 1000;\n      this.tech_.trigger('blacklistplaylist');\n      this.tech_.trigger({ type: 'usage', name: 'hls-rendition-blacklisted' });\n\n      // Select a new playlist\n      nextPlaylist = this.selectPlaylist();\n      videojs$1.log.warn('Problem encountered with the current HLS playlist.' + (error.message ? ' ' + error.message : '') + ' Switching to another playlist.');\n\n      return this.masterPlaylistLoader_.media(nextPlaylist);\n    };\n\n    /**\n     * Pause all segment loaders\n     */\n\n\n    MasterPlaylistController.prototype.pauseLoading = function pauseLoading() {\n      this.mainSegmentLoader_.pause();\n      if (this.mediaTypes_.AUDIO.activePlaylistLoader) {\n        this.audioSegmentLoader_.pause();\n      }\n      if (this.mediaTypes_.SUBTITLES.activePlaylistLoader) {\n        this.subtitleSegmentLoader_.pause();\n      }\n    };\n\n    /**\n     * set the current time on all segment loaders\n     *\n     * @param {TimeRange} currentTime the current time to set\n     * @return {TimeRange} the current time\n     */\n\n\n    MasterPlaylistController.prototype.setCurrentTime = function setCurrentTime(currentTime) {\n      var buffered = findRange(this.tech_.buffered(), currentTime);\n\n      if (!(this.masterPlaylistLoader_ && this.masterPlaylistLoader_.media())) {\n        // return immediately if the metadata is not ready yet\n        return 0;\n      }\n\n      // it's clearly an edge-case but don't thrown an error if asked to\n      // seek within an empty playlist\n      if (!this.masterPlaylistLoader_.media().segments) {\n        return 0;\n      }\n\n      // In flash playback, the segment loaders should be reset on every seek, even\n      // in buffer seeks. If the seek location is already buffered, continue buffering as\n      // usual\n      // TODO: redo this comment\n      if (buffered && buffered.length) {\n        return currentTime;\n      }\n\n      // cancel outstanding requests so we begin buffering at the new\n      // location\n      this.mainSegmentLoader_.resetEverything();\n      this.mainSegmentLoader_.abort();\n      if (this.mediaTypes_.AUDIO.activePlaylistLoader) {\n        this.audioSegmentLoader_.resetEverything();\n        this.audioSegmentLoader_.abort();\n      }\n      if (this.mediaTypes_.SUBTITLES.activePlaylistLoader) {\n        this.subtitleSegmentLoader_.resetEverything();\n        this.subtitleSegmentLoader_.abort();\n      }\n\n      // start segment loader loading in case they are paused\n      this.load();\n    };\n\n    /**\n     * get the current duration\n     *\n     * @return {TimeRange} the duration\n     */\n\n\n    MasterPlaylistController.prototype.duration = function duration() {\n      if (!this.masterPlaylistLoader_) {\n        return 0;\n      }\n\n      if (this.mediaSource) {\n        return this.mediaSource.duration;\n      }\n\n      return Hls.Playlist.duration(this.masterPlaylistLoader_.media());\n    };\n\n    /**\n     * check the seekable range\n     *\n     * @return {TimeRange} the seekable range\n     */\n\n\n    MasterPlaylistController.prototype.seekable = function seekable() {\n      return this.seekable_;\n    };\n\n    MasterPlaylistController.prototype.onSyncInfoUpdate_ = function onSyncInfoUpdate_() {\n      var mainSeekable = void 0;\n      var audioSeekable = void 0;\n\n      if (!this.masterPlaylistLoader_) {\n        return;\n      }\n\n      var media = this.masterPlaylistLoader_.media();\n\n      if (!media) {\n        return;\n      }\n\n      var expired = this.syncController_.getExpiredTime(media, this.mediaSource.duration);\n\n      if (expired === null) {\n        // not enough information to update seekable\n        return;\n      }\n\n      mainSeekable = Hls.Playlist.seekable(media, expired);\n\n      if (mainSeekable.length === 0) {\n        return;\n      }\n\n      if (this.mediaTypes_.AUDIO.activePlaylistLoader) {\n        media = this.mediaTypes_.AUDIO.activePlaylistLoader.media();\n        expired = this.syncController_.getExpiredTime(media, this.mediaSource.duration);\n\n        if (expired === null) {\n          return;\n        }\n\n        audioSeekable = Hls.Playlist.seekable(media, expired);\n\n        if (audioSeekable.length === 0) {\n          return;\n        }\n      }\n\n      if (!audioSeekable) {\n        // seekable has been calculated based on buffering video data so it\n        // can be returned directly\n        this.seekable_ = mainSeekable;\n      } else if (audioSeekable.start(0) > mainSeekable.end(0) || mainSeekable.start(0) > audioSeekable.end(0)) {\n        // seekables are pretty far off, rely on main\n        this.seekable_ = mainSeekable;\n      } else {\n        this.seekable_ = videojs$1.createTimeRanges([[audioSeekable.start(0) > mainSeekable.start(0) ? audioSeekable.start(0) : mainSeekable.start(0), audioSeekable.end(0) < mainSeekable.end(0) ? audioSeekable.end(0) : mainSeekable.end(0)]]);\n      }\n\n      this.logger_('seekable updated [' + printableRange(this.seekable_) + ']');\n\n      this.tech_.trigger('seekablechanged');\n    };\n\n    /**\n     * Update the player duration\n     */\n\n\n    MasterPlaylistController.prototype.updateDuration = function updateDuration() {\n      var _this33 = this;\n\n      var oldDuration = this.mediaSource.duration;\n      var newDuration = Hls.Playlist.duration(this.masterPlaylistLoader_.media());\n      var buffered = this.tech_.buffered();\n      var setDuration = function setDuration() {\n        _this33.mediaSource.duration = newDuration;\n        _this33.tech_.trigger('durationchange');\n\n        _this33.mediaSource.removeEventListener('sourceopen', setDuration);\n      };\n\n      if (buffered.length > 0) {\n        newDuration = Math.max(newDuration, buffered.end(buffered.length - 1));\n      }\n\n      // if the duration has changed, invalidate the cached value\n      if (oldDuration !== newDuration) {\n        // update the duration\n        if (this.mediaSource.readyState !== 'open') {\n          this.mediaSource.addEventListener('sourceopen', setDuration);\n        } else {\n          setDuration();\n        }\n      }\n    };\n\n    /**\n     * dispose of the MasterPlaylistController and everything\n     * that it controls\n     */\n\n\n    MasterPlaylistController.prototype.dispose = function dispose() {\n      var _this34 = this;\n\n      this.decrypter_.terminate();\n      this.masterPlaylistLoader_.dispose();\n      this.mainSegmentLoader_.dispose();\n\n      ['AUDIO', 'SUBTITLES'].forEach(function (type) {\n        var groups = _this34.mediaTypes_[type].groups;\n\n        for (var id in groups) {\n          groups[id].forEach(function (group) {\n            if (group.playlistLoader) {\n              group.playlistLoader.dispose();\n            }\n          });\n        }\n      });\n\n      this.audioSegmentLoader_.dispose();\n      this.subtitleSegmentLoader_.dispose();\n    };\n\n    /**\n     * return the master playlist object if we have one\n     *\n     * @return {Object} the master playlist object that we parsed\n     */\n\n\n    MasterPlaylistController.prototype.master = function master() {\n      return this.masterPlaylistLoader_.master;\n    };\n\n    /**\n     * return the currently selected playlist\n     *\n     * @return {Object} the currently selected playlist object that we parsed\n     */\n\n\n    MasterPlaylistController.prototype.media = function media() {\n      // playlist loader will not return media if it has not been fully loaded\n      return this.masterPlaylistLoader_.media() || this.initialMedia_;\n    };\n\n    /**\n     * setup our internal source buffers on our segment Loaders\n     *\n     * @private\n     */\n\n\n    MasterPlaylistController.prototype.setupSourceBuffers_ = function setupSourceBuffers_() {\n      var media = this.masterPlaylistLoader_.media();\n      var mimeTypes = void 0;\n\n      // wait until a media playlist is available and the Media Source is\n      // attached\n      if (!media || this.mediaSource.readyState !== 'open') {\n        return;\n      }\n\n      mimeTypes = mimeTypesForPlaylist(this.masterPlaylistLoader_.master, media);\n      if (mimeTypes.length < 1) {\n        this.error = 'No compatible SourceBuffer configuration for the variant stream:' + media.resolvedUri;\n        return this.mediaSource.endOfStream('decode');\n      }\n\n      this.configureLoaderMimeTypes_(mimeTypes);\n      // exclude any incompatible variant streams from future playlist\n      // selection\n      this.excludeIncompatibleVariants_(media);\n    };\n\n    MasterPlaylistController.prototype.configureLoaderMimeTypes_ = function configureLoaderMimeTypes_(mimeTypes) {\n      // If the content is demuxed, we can't start appending segments to a source buffer\n      // until both source buffers are set up, or else the browser may not let us add the\n      // second source buffer (it will assume we are playing either audio only or video\n      // only).\n      var sourceBufferEmitter =\n      // If there is more than one mime type\n      mimeTypes.length > 1 &&\n      // and the first mime type does not have muxed video and audio\n      mimeTypes[0].indexOf(',') === -1 &&\n      // and the two mime types are different (they can be the same in the case of audio\n      // only with alternate audio)\n      mimeTypes[0] !== mimeTypes[1] ?\n      // then we want to wait on the second source buffer\n      new videojs$1.EventTarget() :\n      // otherwise there is no need to wait as the content is either audio only,\n      // video only, or muxed content.\n      null;\n\n      this.mainSegmentLoader_.mimeType(mimeTypes[0], sourceBufferEmitter);\n      if (mimeTypes[1]) {\n        this.audioSegmentLoader_.mimeType(mimeTypes[1], sourceBufferEmitter);\n      }\n    };\n\n    /**\n     * Blacklists playlists with codecs that are unsupported by the browser.\n     */\n\n\n    MasterPlaylistController.prototype.excludeUnsupportedVariants_ = function excludeUnsupportedVariants_() {\n      this.master().playlists.forEach(function (variant) {\n        if (variant.attributes.CODECS && window_1.MediaSource && window_1.MediaSource.isTypeSupported && !window_1.MediaSource.isTypeSupported('video/mp4; codecs=\"' + mapLegacyAvcCodecs(variant.attributes.CODECS) + '\"')) {\n          variant.excludeUntil = Infinity;\n        }\n      });\n    };\n\n    /**\n     * Blacklist playlists that are known to be codec or\n     * stream-incompatible with the SourceBuffer configuration. For\n     * instance, Media Source Extensions would cause the video element to\n     * stall waiting for video data if you switched from a variant with\n     * video and audio to an audio-only one.\n     *\n     * @param {Object} media a media playlist compatible with the current\n     * set of SourceBuffers. Variants in the current master playlist that\n     * do not appear to have compatible codec or stream configurations\n     * will be excluded from the default playlist selection algorithm\n     * indefinitely.\n     * @private\n     */\n\n\n    MasterPlaylistController.prototype.excludeIncompatibleVariants_ = function excludeIncompatibleVariants_(media) {\n      var codecCount = 2;\n      var videoCodec = null;\n      var codecs = void 0;\n\n      if (media.attributes.CODECS) {\n        codecs = parseCodecs(media.attributes.CODECS);\n        videoCodec = codecs.videoCodec;\n        codecCount = codecs.codecCount;\n      }\n\n      this.master().playlists.forEach(function (variant) {\n        var variantCodecs = {\n          codecCount: 2,\n          videoCodec: null\n        };\n\n        if (variant.attributes.CODECS) {\n          variantCodecs = parseCodecs(variant.attributes.CODECS);\n        }\n\n        // if the streams differ in the presence or absence of audio or\n        // video, they are incompatible\n        if (variantCodecs.codecCount !== codecCount) {\n          variant.excludeUntil = Infinity;\n        }\n\n        // if h.264 is specified on the current playlist, some flavor of\n        // it must be specified on all compatible variants\n        if (variantCodecs.videoCodec !== videoCodec) {\n          variant.excludeUntil = Infinity;\n        }\n      });\n    };\n\n    MasterPlaylistController.prototype.updateAdCues_ = function updateAdCues_(media) {\n      var offset = 0;\n      var seekable$$1 = this.seekable();\n\n      if (seekable$$1.length) {\n        offset = seekable$$1.start(0);\n      }\n\n      updateAdCues(media, this.cueTagsTrack_, offset);\n    };\n\n    /**\n     * Calculates the desired forward buffer length based on current time\n     *\n     * @return {Number} Desired forward buffer length in seconds\n     */\n\n\n    MasterPlaylistController.prototype.goalBufferLength = function goalBufferLength() {\n      var currentTime = this.tech_.currentTime();\n      var initial = Config.GOAL_BUFFER_LENGTH;\n      var rate = Config.GOAL_BUFFER_LENGTH_RATE;\n      var max = Math.max(initial, Config.MAX_GOAL_BUFFER_LENGTH);\n\n      return Math.min(initial + currentTime * rate, max);\n    };\n\n    /**\n     * Calculates the desired buffer low water line based on current time\n     *\n     * @return {Number} Desired buffer low water line in seconds\n     */\n\n\n    MasterPlaylistController.prototype.bufferLowWaterLine = function bufferLowWaterLine() {\n      var currentTime = this.tech_.currentTime();\n      var initial = Config.BUFFER_LOW_WATER_LINE;\n      var rate = Config.BUFFER_LOW_WATER_LINE_RATE;\n      var max = Math.max(initial, Config.MAX_BUFFER_LOW_WATER_LINE);\n\n      return Math.min(initial + currentTime * rate, max);\n    };\n\n    return MasterPlaylistController;\n  }(videojs$1.EventTarget);\n\n  /**\n   * Returns a function that acts as the Enable/disable playlist function.\n   *\n   * @param {PlaylistLoader} loader - The master playlist loader\n   * @param {String} playlistUri - uri of the playlist\n   * @param {Function} changePlaylistFn - A function to be called after a\n   * playlist's enabled-state has been changed. Will NOT be called if a\n   * playlist's enabled-state is unchanged\n   * @param {Boolean=} enable - Value to set the playlist enabled-state to\n   * or if undefined returns the current enabled-state for the playlist\n   * @return {Function} Function for setting/getting enabled\n   */\n\n\n  var enableFunction = function enableFunction(loader, playlistUri, changePlaylistFn) {\n    return function (enable) {\n      var playlist = loader.master.playlists[playlistUri];\n      var incompatible = isIncompatible(playlist);\n      var currentlyEnabled = isEnabled(playlist);\n\n      if (typeof enable === 'undefined') {\n        return currentlyEnabled;\n      }\n\n      if (enable) {\n        delete playlist.disabled;\n      } else {\n        playlist.disabled = true;\n      }\n\n      if (enable !== currentlyEnabled && !incompatible) {\n        // Ensure the outside world knows about our changes\n        changePlaylistFn();\n        if (enable) {\n          loader.trigger('renditionenabled');\n        } else {\n          loader.trigger('renditiondisabled');\n        }\n      }\n      return enable;\n    };\n  };\n\n  /**\n   * The representation object encapsulates the publicly visible information\n   * in a media playlist along with a setter/getter-type function (enabled)\n   * for changing the enabled-state of a particular playlist entry\n   *\n   * @class Representation\n   */\n\n  var Representation = function Representation(hlsHandler, playlist, id) {\n    classCallCheck(this, Representation);\n\n    // Get a reference to a bound version of fastQualityChange_\n    var fastChangeFunction = hlsHandler.masterPlaylistController_.fastQualityChange_.bind(hlsHandler.masterPlaylistController_);\n\n    // some playlist attributes are optional\n    if (playlist.attributes.RESOLUTION) {\n      var resolution = playlist.attributes.RESOLUTION;\n\n      this.width = resolution.width;\n      this.height = resolution.height;\n    }\n\n    this.bandwidth = playlist.attributes.BANDWIDTH;\n\n    // The id is simply the ordinality of the media playlist\n    // within the master playlist\n    this.id = id;\n\n    // Partially-apply the enableFunction to create a playlist-\n    // specific variant\n    this.enabled = enableFunction(hlsHandler.playlists, playlist.uri, fastChangeFunction);\n  };\n\n  /**\n   * A mixin function that adds the `representations` api to an instance\n   * of the HlsHandler class\n   * @param {HlsHandler} hlsHandler - An instance of HlsHandler to add the\n   * representation API into\n   */\n\n\n  var renditionSelectionMixin = function renditionSelectionMixin(hlsHandler) {\n    var playlists = hlsHandler.playlists;\n\n    // Add a single API-specific function to the HlsHandler instance\n    hlsHandler.representations = function () {\n      return playlists.master.playlists.filter(function (media) {\n        return !isIncompatible(media);\n      }).map(function (e, i) {\n        return new Representation(hlsHandler, e, e.uri);\n      });\n    };\n  };\n\n  /**\n   * @file playback-watcher.js\n   *\n   * Playback starts, and now my watch begins. It shall not end until my death. I shall\n   * take no wait, hold no uncleared timeouts, father no bad seeks. I shall wear no crowns\n   * and win no glory. I shall live and die at my post. I am the corrector of the underflow.\n   * I am the watcher of gaps. I am the shield that guards the realms of seekable. I pledge\n   * my life and honor to the Playback Watch, for this Player and all the Players to come.\n   */\n\n  // Set of events that reset the playback-watcher time check logic and clear the timeout\n  var timerCancelEvents = ['seeking', 'seeked', 'pause', 'playing', 'error'];\n\n  /**\n   * @class PlaybackWatcher\n   */\n\n  var PlaybackWatcher = function () {\n    /**\n     * Represents an PlaybackWatcher object.\n     * @constructor\n     * @param {object} options an object that includes the tech and settings\n     */\n    function PlaybackWatcher(options) {\n      var _this35 = this;\n\n      classCallCheck(this, PlaybackWatcher);\n\n      this.tech_ = options.tech;\n      this.seekable = options.seekable;\n\n      this.consecutiveUpdates = 0;\n      this.lastRecordedTime = null;\n      this.timer_ = null;\n      this.checkCurrentTimeTimeout_ = null;\n      this.logger_ = logger('PlaybackWatcher');\n\n      this.logger_('initialize');\n\n      var canPlayHandler = function canPlayHandler() {\n        return _this35.monitorCurrentTime_();\n      };\n      var waitingHandler = function waitingHandler() {\n        return _this35.techWaiting_();\n      };\n      var cancelTimerHandler = function cancelTimerHandler() {\n        return _this35.cancelTimer_();\n      };\n      var fixesBadSeeksHandler = function fixesBadSeeksHandler() {\n        return _this35.fixesBadSeeks_();\n      };\n\n      this.tech_.on('seekablechanged', fixesBadSeeksHandler);\n      this.tech_.on('waiting', waitingHandler);\n      this.tech_.on(timerCancelEvents, cancelTimerHandler);\n      this.tech_.on('canplay', canPlayHandler);\n\n      // Define the dispose function to clean up our events\n      this.dispose = function () {\n        _this35.logger_('dispose');\n        _this35.tech_.off('seekablechanged', fixesBadSeeksHandler);\n        _this35.tech_.off('waiting', waitingHandler);\n        _this35.tech_.off(timerCancelEvents, cancelTimerHandler);\n        _this35.tech_.off('canplay', canPlayHandler);\n        if (_this35.checkCurrentTimeTimeout_) {\n          window_1.clearTimeout(_this35.checkCurrentTimeTimeout_);\n        }\n        _this35.cancelTimer_();\n      };\n    }\n\n    /**\n     * Periodically check current time to see if playback stopped\n     *\n     * @private\n     */\n\n\n    PlaybackWatcher.prototype.monitorCurrentTime_ = function monitorCurrentTime_() {\n      this.checkCurrentTime_();\n\n      if (this.checkCurrentTimeTimeout_) {\n        window_1.clearTimeout(this.checkCurrentTimeTimeout_);\n      }\n\n      // 42 = 24 fps // 250 is what Webkit uses // FF uses 15\n      this.checkCurrentTimeTimeout_ = window_1.setTimeout(this.monitorCurrentTime_.bind(this), 250);\n    };\n\n    /**\n     * The purpose of this function is to emulate the \"waiting\" event on\n     * browsers that do not emit it when they are waiting for more\n     * data to continue playback\n     *\n     * @private\n     */\n\n\n    PlaybackWatcher.prototype.checkCurrentTime_ = function checkCurrentTime_() {\n      if (this.tech_.seeking() && this.fixesBadSeeks_()) {\n        this.consecutiveUpdates = 0;\n        this.lastRecordedTime = this.tech_.currentTime();\n        return;\n      }\n\n      if (this.tech_.paused() || this.tech_.seeking()) {\n        return;\n      }\n\n      var currentTime = this.tech_.currentTime();\n      var buffered = this.tech_.buffered();\n\n      if (this.lastRecordedTime === currentTime && (!buffered.length || currentTime + SAFE_TIME_DELTA >= buffered.end(buffered.length - 1))) {\n        // If current time is at the end of the final buffered region, then any playback\n        // stall is most likely caused by buffering in a low bandwidth environment. The tech\n        // should fire a `waiting` event in this scenario, but due to browser and tech\n        // inconsistencies. Calling `techWaiting_` here allows us to simulate\n        // responding to a native `waiting` event when the tech fails to emit one.\n        return this.techWaiting_();\n      }\n\n      if (this.consecutiveUpdates >= 5 && currentTime === this.lastRecordedTime) {\n        this.consecutiveUpdates++;\n        this.waiting_();\n      } else if (currentTime === this.lastRecordedTime) {\n        this.consecutiveUpdates++;\n      } else {\n        this.consecutiveUpdates = 0;\n        this.lastRecordedTime = currentTime;\n      }\n    };\n\n    /**\n     * Cancels any pending timers and resets the 'timeupdate' mechanism\n     * designed to detect that we are stalled\n     *\n     * @private\n     */\n\n\n    PlaybackWatcher.prototype.cancelTimer_ = function cancelTimer_() {\n      this.consecutiveUpdates = 0;\n\n      if (this.timer_) {\n        this.logger_('cancelTimer_');\n        clearTimeout(this.timer_);\n      }\n\n      this.timer_ = null;\n    };\n\n    /**\n     * Fixes situations where there's a bad seek\n     *\n     * @return {Boolean} whether an action was taken to fix the seek\n     * @private\n     */\n\n\n    PlaybackWatcher.prototype.fixesBadSeeks_ = function fixesBadSeeks_() {\n      var seeking = this.tech_.seeking();\n      var seekable = this.seekable();\n      var currentTime = this.tech_.currentTime();\n      var seekTo = void 0;\n\n      if (seeking && this.afterSeekableWindow_(seekable, currentTime)) {\n        var seekableEnd = seekable.end(seekable.length - 1);\n\n        // sync to live point (if VOD, our seekable was updated and we're simply adjusting)\n        seekTo = seekableEnd;\n      }\n\n      if (seeking && this.beforeSeekableWindow_(seekable, currentTime)) {\n        var seekableStart = seekable.start(0);\n\n        // sync to the beginning of the live window\n        // provide a buffer of .1 seconds to handle rounding/imprecise numbers\n        seekTo = seekableStart + SAFE_TIME_DELTA;\n      }\n\n      if (typeof seekTo !== 'undefined') {\n        this.logger_('Trying to seek outside of seekable at time ' + currentTime + ' with ' + ('seekable range ' + printableRange(seekable) + '. Seeking to ') + (seekTo + '.'));\n\n        this.tech_.setCurrentTime(seekTo);\n        return true;\n      }\n\n      return false;\n    };\n\n    /**\n     * Handler for situations when we determine the player is waiting.\n     *\n     * @private\n     */\n\n\n    PlaybackWatcher.prototype.waiting_ = function waiting_() {\n      if (this.techWaiting_()) {\n        return;\n      }\n\n      // All tech waiting checks failed. Use last resort correction\n      var currentTime = this.tech_.currentTime();\n      var buffered = this.tech_.buffered();\n      var currentRange = findRange(buffered, currentTime);\n\n      // Sometimes the player can stall for unknown reasons within a contiguous buffered\n      // region with no indication that anything is amiss (seen in Firefox). Seeking to\n      // currentTime is usually enough to kickstart the player. This checks that the player\n      // is currently within a buffered region before attempting a corrective seek.\n      // Chrome does not appear to continue `timeupdate` events after a `waiting` event\n      // until there is ~ 3 seconds of forward buffer available. PlaybackWatcher should also\n      // make sure there is ~3 seconds of forward buffer before taking any corrective action\n      // to avoid triggering an `unknownwaiting` event when the network is slow.\n      if (currentRange.length && currentTime + 3 <= currentRange.end(0)) {\n        this.cancelTimer_();\n        this.tech_.setCurrentTime(currentTime);\n\n        this.logger_('Stopped at ' + currentTime + ' while inside a buffered region ' + ('[' + currentRange.start(0) + ' -> ' + currentRange.end(0) + ']. Attempting to resume ') + 'playback by seeking to the current time.');\n\n        // unknown waiting corrections may be useful for monitoring QoS\n        this.tech_.trigger({ type: 'usage', name: 'hls-unknown-waiting' });\n        return;\n      }\n    };\n\n    /**\n     * Handler for situations when the tech fires a `waiting` event\n     *\n     * @return {Boolean}\n     *         True if an action (or none) was needed to correct the waiting. False if no\n     *         checks passed\n     * @private\n     */\n\n\n    PlaybackWatcher.prototype.techWaiting_ = function techWaiting_() {\n      var seekable = this.seekable();\n      var currentTime = this.tech_.currentTime();\n\n      if (this.tech_.seeking() && this.fixesBadSeeks_()) {\n        // Tech is seeking or bad seek fixed, no action needed\n        return true;\n      }\n\n      if (this.tech_.seeking() || this.timer_ !== null) {\n        // Tech is seeking or already waiting on another action, no action needed\n        return true;\n      }\n\n      if (this.beforeSeekableWindow_(seekable, currentTime)) {\n        var livePoint = seekable.end(seekable.length - 1);\n\n        this.logger_('Fell out of live window at time ' + currentTime + '. Seeking to ' + ('live point (seekable end) ' + livePoint));\n        this.cancelTimer_();\n        this.tech_.setCurrentTime(livePoint);\n\n        // live window resyncs may be useful for monitoring QoS\n        this.tech_.trigger({ type: 'usage', name: 'hls-live-resync' });\n        return true;\n      }\n\n      var buffered = this.tech_.buffered();\n      var nextRange = findNextRange(buffered, currentTime);\n\n      if (this.videoUnderflow_(nextRange, buffered, currentTime)) {\n        // Even though the video underflowed and was stuck in a gap, the audio overplayed\n        // the gap, leading currentTime into a buffered range. Seeking to currentTime\n        // allows the video to catch up to the audio position without losing any audio\n        // (only suffering ~3 seconds of frozen video and a pause in audio playback).\n        this.cancelTimer_();\n        this.tech_.setCurrentTime(currentTime);\n\n        // video underflow may be useful for monitoring QoS\n        this.tech_.trigger({ type: 'usage', name: 'hls-video-underflow' });\n        return true;\n      }\n\n      // check for gap\n      if (nextRange.length > 0) {\n        var difference = nextRange.start(0) - currentTime;\n\n        this.logger_('Stopped at ' + currentTime + ', setting timer for ' + difference + ', seeking ' + ('to ' + nextRange.start(0)));\n\n        this.timer_ = setTimeout(this.skipTheGap_.bind(this), difference * 1000, currentTime);\n        return true;\n      }\n\n      // All checks failed. Returning false to indicate failure to correct waiting\n      return false;\n    };\n\n    PlaybackWatcher.prototype.afterSeekableWindow_ = function afterSeekableWindow_(seekable, currentTime) {\n      if (!seekable.length) {\n        // we can't make a solid case if there's no seekable, default to false\n        return false;\n      }\n\n      if (currentTime > seekable.end(seekable.length - 1) + SAFE_TIME_DELTA) {\n        return true;\n      }\n\n      return false;\n    };\n\n    PlaybackWatcher.prototype.beforeSeekableWindow_ = function beforeSeekableWindow_(seekable, currentTime) {\n      if (seekable.length &&\n      // can't fall before 0 and 0 seekable start identifies VOD stream\n      seekable.start(0) > 0 && currentTime < seekable.start(0) - SAFE_TIME_DELTA) {\n        return true;\n      }\n\n      return false;\n    };\n\n    PlaybackWatcher.prototype.videoUnderflow_ = function videoUnderflow_(nextRange, buffered, currentTime) {\n      if (nextRange.length === 0) {\n        // Even if there is no available next range, there is still a possibility we are\n        // stuck in a gap due to video underflow.\n        var gap = this.gapFromVideoUnderflow_(buffered, currentTime);\n\n        if (gap) {\n          this.logger_('Encountered a gap in video from ' + gap.start + ' to ' + gap.end + '. ' + ('Seeking to current time ' + currentTime));\n\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    /**\n     * Timer callback. If playback still has not proceeded, then we seek\n     * to the start of the next buffered region.\n     *\n     * @private\n     */\n\n\n    PlaybackWatcher.prototype.skipTheGap_ = function skipTheGap_(scheduledCurrentTime) {\n      var buffered = this.tech_.buffered();\n      var currentTime = this.tech_.currentTime();\n      var nextRange = findNextRange(buffered, currentTime);\n\n      this.cancelTimer_();\n\n      if (nextRange.length === 0 || currentTime !== scheduledCurrentTime) {\n        return;\n      }\n\n      this.logger_('skipTheGap_:', 'currentTime:', currentTime, 'scheduled currentTime:', scheduledCurrentTime, 'nextRange start:', nextRange.start(0));\n\n      // only seek if we still have not played\n      this.tech_.setCurrentTime(nextRange.start(0) + TIME_FUDGE_FACTOR);\n\n      this.tech_.trigger({ type: 'usage', name: 'hls-gap-skip' });\n    };\n\n    PlaybackWatcher.prototype.gapFromVideoUnderflow_ = function gapFromVideoUnderflow_(buffered, currentTime) {\n      // At least in Chrome, if there is a gap in the video buffer, the audio will continue\n      // playing for ~3 seconds after the video gap starts. This is done to account for\n      // video buffer underflow/underrun (note that this is not done when there is audio\n      // buffer underflow/underrun -- in that case the video will stop as soon as it\n      // encounters the gap, as audio stalls are more noticeable/jarring to a user than\n      // video stalls). The player's time will reflect the playthrough of audio, so the\n      // time will appear as if we are in a buffered region, even if we are stuck in a\n      // \"gap.\"\n      //\n      // Example:\n      // video buffer:   0 => 10.1, 10.2 => 20\n      // audio buffer:   0 => 20\n      // overall buffer: 0 => 10.1, 10.2 => 20\n      // current time: 13\n      //\n      // Chrome's video froze at 10 seconds, where the video buffer encountered the gap,\n      // however, the audio continued playing until it reached ~3 seconds past the gap\n      // (13 seconds), at which point it stops as well. Since current time is past the\n      // gap, findNextRange will return no ranges.\n      //\n      // To check for this issue, we see if there is a gap that starts somewhere within\n      // a 3 second range (3 seconds +/- 1 second) back from our current time.\n      var gaps = findGaps(buffered);\n\n      for (var i = 0; i < gaps.length; i++) {\n        var start = gaps.start(i);\n        var end = gaps.end(i);\n\n        // gap is starts no more than 4 seconds back\n        if (currentTime - start < 4 && currentTime - start > 2) {\n          return {\n            start: start,\n            end: end\n          };\n        }\n      }\n\n      return null;\n    };\n\n    return PlaybackWatcher;\n  }();\n\n  var defaultOptions = {\n    errorInterval: 30,\n    getSource: function getSource(next) {\n      var tech = this.tech({ IWillNotUseThisInPlugins: true });\n      var sourceObj = tech.currentSource_;\n\n      return next(sourceObj);\n    }\n  };\n\n  /**\n   * Main entry point for the plugin\n   *\n   * @param {Player} player a reference to a videojs Player instance\n   * @param {Object} [options] an object with plugin options\n   * @private\n   */\n  var initPlugin = function initPlugin(player, options) {\n    var lastCalled = 0;\n    var seekTo = 0;\n    var localOptions = videojs$1.mergeOptions(defaultOptions, options);\n\n    player.ready(function () {\n      player.trigger({ type: 'usage', name: 'hls-error-reload-initialized' });\n    });\n\n    /**\n     * Player modifications to perform that must wait until `loadedmetadata`\n     * has been triggered\n     *\n     * @private\n     */\n    var loadedMetadataHandler = function loadedMetadataHandler() {\n      if (seekTo) {\n        player.currentTime(seekTo);\n      }\n    };\n\n    /**\n     * Set the source on the player element, play, and seek if necessary\n     *\n     * @param {Object} sourceObj An object specifying the source url and mime-type to play\n     * @private\n     */\n    var setSource = function setSource(sourceObj) {\n      if (sourceObj === null || sourceObj === undefined) {\n        return;\n      }\n      seekTo = player.duration() !== Infinity && player.currentTime() || 0;\n\n      player.one('loadedmetadata', loadedMetadataHandler);\n\n      player.src(sourceObj);\n      player.trigger({ type: 'usage', name: 'hls-error-reload' });\n      player.play();\n    };\n\n    /**\n     * Attempt to get a source from either the built-in getSource function\n     * or a custom function provided via the options\n     *\n     * @private\n     */\n    var errorHandler = function errorHandler() {\n      // Do not attempt to reload the source if a source-reload occurred before\n      // 'errorInterval' time has elapsed since the last source-reload\n      if (Date.now() - lastCalled < localOptions.errorInterval * 1000) {\n        player.trigger({ type: 'usage', name: 'hls-error-reload-canceled' });\n        return;\n      }\n\n      if (!localOptions.getSource || typeof localOptions.getSource !== 'function') {\n        videojs$1.log.error('ERROR: reloadSourceOnError - The option getSource must be a function!');\n        return;\n      }\n      lastCalled = Date.now();\n\n      return localOptions.getSource.call(player, setSource);\n    };\n\n    /**\n     * Unbind any event handlers that were bound by the plugin\n     *\n     * @private\n     */\n    var cleanupEvents = function cleanupEvents() {\n      player.off('loadedmetadata', loadedMetadataHandler);\n      player.off('error', errorHandler);\n      player.off('dispose', cleanupEvents);\n    };\n\n    /**\n     * Cleanup before re-initializing the plugin\n     *\n     * @param {Object} [newOptions] an object with plugin options\n     * @private\n     */\n    var reinitPlugin = function reinitPlugin(newOptions) {\n      cleanupEvents();\n      initPlugin(player, newOptions);\n    };\n\n    player.on('error', errorHandler);\n    player.on('dispose', cleanupEvents);\n\n    // Overwrite the plugin function so that we can correctly cleanup before\n    // initializing the plugin\n    player.reloadSourceOnError = reinitPlugin;\n  };\n\n  /**\n   * Reload the source when an error is detected as long as there\n   * wasn't an error previously within the last 30 seconds\n   *\n   * @param {Object} [options] an object with plugin options\n   */\n  var reloadSourceOnError = function reloadSourceOnError(options) {\n    initPlugin(this, options);\n  };\n\n  var version$3 = \"1.0.0\";\n\n  /**\n   * @file videojs-http-streaming.js\n   *\n   * The main file for the HLS project.\n   * License: https://github.com/videojs/videojs-http-streaming/blob/master/LICENSE\n   */\n\n  var Hls$1 = {\n    PlaylistLoader: PlaylistLoader,\n    Playlist: Playlist,\n    Decrypter: Decrypter,\n    AsyncStream: AsyncStream,\n    decrypt: decrypt,\n    utils: utils,\n\n    STANDARD_PLAYLIST_SELECTOR: lastBandwidthSelector,\n    INITIAL_PLAYLIST_SELECTOR: lowestBitrateCompatibleVariantSelector,\n    comparePlaylistBandwidth: comparePlaylistBandwidth,\n    comparePlaylistResolution: comparePlaylistResolution,\n\n    xhr: xhrFactory()\n  };\n\n  // 0.5 MB/s\n  var INITIAL_BANDWIDTH = 4194304;\n\n  // Define getter/setters for config properites\n  ['GOAL_BUFFER_LENGTH', 'MAX_GOAL_BUFFER_LENGTH', 'GOAL_BUFFER_LENGTH_RATE', 'BUFFER_LOW_WATER_LINE', 'MAX_BUFFER_LOW_WATER_LINE', 'BUFFER_LOW_WATER_LINE_RATE', 'BANDWIDTH_VARIANCE'].forEach(function (prop) {\n    Object.defineProperty(Hls$1, prop, {\n      get: function get$$1() {\n        videojs$1.log.warn('using Hls.' + prop + ' is UNSAFE be sure you know what you are doing');\n        return Config[prop];\n      },\n      set: function set$$1(value) {\n        videojs$1.log.warn('using Hls.' + prop + ' is UNSAFE be sure you know what you are doing');\n\n        if (typeof value !== 'number' || value < 0) {\n          videojs$1.log.warn('value of Hls.' + prop + ' must be greater than or equal to 0');\n          return;\n        }\n\n        Config[prop] = value;\n      }\n    });\n  });\n\n  var simpleTypeFromSourceType = function simpleTypeFromSourceType(type) {\n    var mpegurlRE = /^(audio|video|application)\\/(x-|vnd\\.apple\\.)?mpegurl/i;\n\n    if (mpegurlRE.test(type)) {\n      return 'hls';\n    }\n\n    var dashRE = /^application\\/dash\\+xml/i;\n\n    if (dashRE.test(type)) {\n      return 'dash';\n    }\n\n    return null;\n  };\n\n  /**\n   * Updates the selectedIndex of the QualityLevelList when a mediachange happens in hls.\n   *\n   * @param {QualityLevelList} qualityLevels The QualityLevelList to update.\n   * @param {PlaylistLoader} playlistLoader PlaylistLoader containing the new media info.\n   * @function handleHlsMediaChange\n   */\n  var handleHlsMediaChange = function handleHlsMediaChange(qualityLevels, playlistLoader) {\n    var newPlaylist = playlistLoader.media();\n    var selectedIndex = -1;\n\n    for (var i = 0; i < qualityLevels.length; i++) {\n      if (qualityLevels[i].id === newPlaylist.uri) {\n        selectedIndex = i;\n        break;\n      }\n    }\n\n    qualityLevels.selectedIndex_ = selectedIndex;\n    qualityLevels.trigger({\n      selectedIndex: selectedIndex,\n      type: 'change'\n    });\n  };\n\n  /**\n   * Adds quality levels to list once playlist metadata is available\n   *\n   * @param {QualityLevelList} qualityLevels The QualityLevelList to attach events to.\n   * @param {Object} hls Hls object to listen to for media events.\n   * @function handleHlsLoadedMetadata\n   */\n  var handleHlsLoadedMetadata = function handleHlsLoadedMetadata(qualityLevels, hls) {\n    hls.representations().forEach(function (rep) {\n      qualityLevels.addQualityLevel(rep);\n    });\n    handleHlsMediaChange(qualityLevels, hls.playlists);\n  };\n\n  // HLS is a source handler, not a tech. Make sure attempts to use it\n  // as one do not cause exceptions.\n  Hls$1.canPlaySource = function () {\n    return videojs$1.log.warn('HLS is no longer a tech. Please remove it from ' + 'your player\\'s techOrder.');\n  };\n\n  var emeKeySystems = function emeKeySystems(keySystemOptions, videoPlaylist, audioPlaylist) {\n    if (!keySystemOptions) {\n      return keySystemOptions;\n    }\n\n    // upsert the content types based on the selected playlist\n    var keySystemContentTypes = {};\n\n    for (var keySystem in keySystemOptions) {\n      keySystemContentTypes[keySystem] = {\n        audioContentType: 'audio/mp4; codecs=\"' + audioPlaylist.attributes.CODECS + '\"',\n        videoContentType: 'video/mp4; codecs=\"' + videoPlaylist.attributes.CODECS + '\"'\n      };\n\n      if (videoPlaylist.contentProtection && videoPlaylist.contentProtection[keySystem] && videoPlaylist.contentProtection[keySystem].pssh) {\n        keySystemContentTypes[keySystem].pssh = videoPlaylist.contentProtection[keySystem].pssh;\n      }\n\n      // videojs-contrib-eme accepts the option of specifying: 'com.some.cdm': 'url'\n      // so we need to prevent overwriting the URL entirely\n      if (typeof keySystemOptions[keySystem] === 'string') {\n        keySystemContentTypes[keySystem].url = keySystemOptions[keySystem];\n      }\n    }\n\n    return videojs$1.mergeOptions(keySystemOptions, keySystemContentTypes);\n  };\n\n  var setupEmeOptions = function setupEmeOptions(hlsHandler) {\n    if (hlsHandler.options_.sourceType !== 'dash') {\n      return;\n    }\n    var player = videojs$1.players[hlsHandler.tech_.options_.playerId];\n\n    if (player.eme) {\n      var sourceOptions = emeKeySystems(hlsHandler.source_.keySystems, hlsHandler.playlists.media(), hlsHandler.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());\n\n      if (sourceOptions) {\n        player.currentSource().keySystems = sourceOptions;\n      }\n    }\n  };\n\n  /**\n   * Whether the browser has built-in HLS support.\n   */\n  Hls$1.supportsNativeHls = function () {\n    var video = document_1.createElement('video');\n\n    // native HLS is definitely not supported if HTML5 video isn't\n    if (!videojs$1.getTech('Html5').isSupported()) {\n      return false;\n    }\n\n    // HLS manifests can go by many mime-types\n    var canPlay = [\n    // Apple santioned\n    'application/vnd.apple.mpegurl',\n    // Apple sanctioned for backwards compatibility\n    'audio/mpegurl',\n    // Very common\n    'audio/x-mpegurl',\n    // Very common\n    'application/x-mpegurl',\n    // Included for completeness\n    'video/x-mpegurl', 'video/mpegurl', 'application/mpegurl'];\n\n    return canPlay.some(function (canItPlay) {\n      return (/maybe|probably/i.test(video.canPlayType(canItPlay))\n      );\n    });\n  }();\n\n  Hls$1.supportsNativeDash = function () {\n    if (!videojs$1.getTech('Html5').isSupported()) {\n      return false;\n    }\n\n    return (/maybe|probably/i.test(document_1.createElement('video').canPlayType('application/dash+xml'))\n    );\n  }();\n\n  Hls$1.supportsTypeNatively = function (type) {\n    if (type === 'hls') {\n      return Hls$1.supportsNativeHls;\n    }\n\n    if (type === 'dash') {\n      return Hls$1.supportsNativeDash;\n    }\n\n    return false;\n  };\n\n  /**\n   * HLS is a source handler, not a tech. Make sure attempts to use it\n   * as one do not cause exceptions.\n   */\n  Hls$1.isSupported = function () {\n    return videojs$1.log.warn('HLS is no longer a tech. Please remove it from ' + 'your player\\'s techOrder.');\n  };\n\n  var Component$1 = videojs$1.getComponent('Component');\n\n  /**\n   * The Hls Handler object, where we orchestrate all of the parts\n   * of HLS to interact with video.js\n   *\n   * @class HlsHandler\n   * @extends videojs.Component\n   * @param {Object} source the soruce object\n   * @param {Tech} tech the parent tech object\n   * @param {Object} options optional and required options\n   */\n\n  var HlsHandler = function (_Component) {\n    inherits(HlsHandler, _Component);\n\n    function HlsHandler(source, tech, options) {\n      classCallCheck(this, HlsHandler);\n\n      // tech.player() is deprecated but setup a reference to HLS for\n      // backwards-compatibility\n      var _this36 = possibleConstructorReturn(this, _Component.call(this, tech, options.hls));\n\n      if (tech.options_ && tech.options_.playerId) {\n        var _player = videojs$1(tech.options_.playerId);\n\n        if (!_player.hasOwnProperty('hls')) {\n          Object.defineProperty(_player, 'hls', {\n            get: function get$$1() {\n              videojs$1.log.warn('player.hls is deprecated. Use player.tech_.hls instead.');\n              tech.trigger({ type: 'usage', name: 'hls-player-access' });\n              return _this36;\n            }\n          });\n        }\n\n        // Set up a reference to the HlsHandler from player.vhs. This allows users to start\n        // migrating from player.tech_.hls... to player.vhs... for API access. Although this\n        // isn't the most appropriate form of reference for video.js (since all APIs should\n        // be provided through core video.js), it is a common pattern for plugins, and vhs\n        // will act accordingly.\n        _player.vhs = _this36;\n        // deprecated, for backwards compatibility\n        _player.dash = _this36;\n      }\n\n      _this36.tech_ = tech;\n      _this36.source_ = source;\n      _this36.stats = {};\n      _this36.ignoreNextSeekingEvent_ = false;\n      _this36.setOptions_();\n\n      // overriding native HLS only works if audio tracks have been emulated\n      // error early if we're misconfigured:\n      if (_this36.options_.overrideNative && (tech.featuresNativeVideoTracks || tech.featuresNativeAudioTracks)) {\n        throw new Error('Overriding native HLS requires emulated tracks. ' + 'See https://git.io/vMpjB');\n      }\n\n      // listen for fullscreenchange events for this player so that we\n      // can adjust our quality selection quickly\n      _this36.on(document_1, ['fullscreenchange', 'webkitfullscreenchange', 'mozfullscreenchange', 'MSFullscreenChange'], function (event) {\n        var fullscreenElement = document_1.fullscreenElement || document_1.webkitFullscreenElement || document_1.mozFullScreenElement || document_1.msFullscreenElement;\n\n        if (fullscreenElement && fullscreenElement.contains(_this36.tech_.el())) {\n          _this36.masterPlaylistController_.fastQualityChange_();\n        }\n      });\n\n      _this36.on(_this36.tech_, 'seeking', function () {\n        if (this.ignoreNextSeekingEvent_) {\n          this.ignoreNextSeekingEvent_ = false;\n          return;\n        }\n\n        this.setCurrentTime(this.tech_.currentTime());\n      });\n      _this36.on(_this36.tech_, 'error', function () {\n        if (this.masterPlaylistController_) {\n          this.masterPlaylistController_.pauseLoading();\n        }\n      });\n\n      _this36.on(_this36.tech_, 'play', _this36.play);\n      return _this36;\n    }\n\n    HlsHandler.prototype.setOptions_ = function setOptions_() {\n      var _this37 = this;\n\n      // defaults\n      this.options_.withCredentials = this.options_.withCredentials || false;\n\n      if (typeof this.options_.blacklistDuration !== 'number') {\n        this.options_.blacklistDuration = 5 * 60;\n      }\n\n      // start playlist selection at a reasonable bandwidth for\n      // broadband internet (0.5 MB/s) or mobile (0.0625 MB/s)\n      if (typeof this.options_.bandwidth !== 'number') {\n        this.options_.bandwidth = INITIAL_BANDWIDTH;\n      }\n\n      // If the bandwidth number is unchanged from the initial setting\n      // then this takes precedence over the enableLowInitialPlaylist option\n      this.options_.enableLowInitialPlaylist = this.options_.enableLowInitialPlaylist && this.options_.bandwidth === INITIAL_BANDWIDTH;\n\n      // grab options passed to player.src\n      ['withCredentials', 'bandwidth'].forEach(function (option) {\n        if (typeof _this37.source_[option] !== 'undefined') {\n          _this37.options_[option] = _this37.source_[option];\n        }\n      });\n\n      this.bandwidth = this.options_.bandwidth;\n    };\n    /**\n     * called when player.src gets called, handle a new source\n     *\n     * @param {Object} src the source object to handle\n     */\n\n\n    HlsHandler.prototype.src = function src(_src, type) {\n      var _this38 = this;\n\n      // do nothing if the src is falsey\n      if (!_src) {\n        return;\n      }\n      this.setOptions_();\n      // add master playlist controller options\n      this.options_.url = this.source_.src;\n      this.options_.tech = this.tech_;\n      this.options_.externHls = Hls$1;\n      this.options_.sourceType = simpleTypeFromSourceType(type);\n\n      this.masterPlaylistController_ = new MasterPlaylistController(this.options_);\n      this.playbackWatcher_ = new PlaybackWatcher(videojs$1.mergeOptions(this.options_, {\n        seekable: function seekable() {\n          return _this38.seekable();\n        }\n      }));\n\n      this.masterPlaylistController_.on('error', function () {\n        var player = videojs$1.players[_this38.tech_.options_.playerId];\n\n        player.error(_this38.masterPlaylistController_.error);\n      });\n\n      // `this` in selectPlaylist should be the HlsHandler for backwards\n      // compatibility with < v2\n      this.masterPlaylistController_.selectPlaylist = this.selectPlaylist ? this.selectPlaylist.bind(this) : Hls$1.STANDARD_PLAYLIST_SELECTOR.bind(this);\n\n      this.masterPlaylistController_.selectInitialPlaylist = Hls$1.INITIAL_PLAYLIST_SELECTOR.bind(this);\n\n      // re-expose some internal objects for backwards compatibility with < v2\n      this.playlists = this.masterPlaylistController_.masterPlaylistLoader_;\n      this.mediaSource = this.masterPlaylistController_.mediaSource;\n\n      // Proxy assignment of some properties to the master playlist\n      // controller. Using a custom property for backwards compatibility\n      // with < v2\n      Object.defineProperties(this, {\n        selectPlaylist: {\n          get: function get$$1() {\n            return this.masterPlaylistController_.selectPlaylist;\n          },\n          set: function set$$1(selectPlaylist) {\n            this.masterPlaylistController_.selectPlaylist = selectPlaylist.bind(this);\n          }\n        },\n        throughput: {\n          get: function get$$1() {\n            return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate;\n          },\n          set: function set$$1(throughput) {\n            this.masterPlaylistController_.mainSegmentLoader_.throughput.rate = throughput;\n            // By setting `count` to 1 the throughput value becomes the starting value\n            // for the cumulative average\n            this.masterPlaylistController_.mainSegmentLoader_.throughput.count = 1;\n          }\n        },\n        bandwidth: {\n          get: function get$$1() {\n            return this.masterPlaylistController_.mainSegmentLoader_.bandwidth;\n          },\n          set: function set$$1(bandwidth) {\n            this.masterPlaylistController_.mainSegmentLoader_.bandwidth = bandwidth;\n            // setting the bandwidth manually resets the throughput counter\n            // `count` is set to zero that current value of `rate` isn't included\n            // in the cumulative average\n            this.masterPlaylistController_.mainSegmentLoader_.throughput = {\n              rate: 0,\n              count: 0\n            };\n          }\n        },\n        /**\n         * `systemBandwidth` is a combination of two serial processes bit-rates. The first\n         * is the network bitrate provided by `bandwidth` and the second is the bitrate of\n         * the entire process after that - decryption, transmuxing, and appending - provided\n         * by `throughput`.\n         *\n         * Since the two process are serial, the overall system bandwidth is given by:\n         *   sysBandwidth = 1 / (1 / bandwidth + 1 / throughput)\n         */\n        systemBandwidth: {\n          get: function get$$1() {\n            var invBandwidth = 1 / (this.bandwidth || 1);\n            var invThroughput = void 0;\n\n            if (this.throughput > 0) {\n              invThroughput = 1 / this.throughput;\n            } else {\n              invThroughput = 0;\n            }\n\n            var systemBitrate = Math.floor(1 / (invBandwidth + invThroughput));\n\n            return systemBitrate;\n          },\n          set: function set$$1() {\n            videojs$1.log.error('The \"systemBandwidth\" property is read-only');\n          }\n        }\n      });\n\n      Object.defineProperties(this.stats, {\n        bandwidth: {\n          get: function get$$1() {\n            return _this38.bandwidth || 0;\n          },\n          enumerable: true\n        },\n        mediaRequests: {\n          get: function get$$1() {\n            return _this38.masterPlaylistController_.mediaRequests_() || 0;\n          },\n          enumerable: true\n        },\n        mediaRequestsAborted: {\n          get: function get$$1() {\n            return _this38.masterPlaylistController_.mediaRequestsAborted_() || 0;\n          },\n          enumerable: true\n        },\n        mediaRequestsTimedout: {\n          get: function get$$1() {\n            return _this38.masterPlaylistController_.mediaRequestsTimedout_() || 0;\n          },\n          enumerable: true\n        },\n        mediaRequestsErrored: {\n          get: function get$$1() {\n            return _this38.masterPlaylistController_.mediaRequestsErrored_() || 0;\n          },\n          enumerable: true\n        },\n        mediaTransferDuration: {\n          get: function get$$1() {\n            return _this38.masterPlaylistController_.mediaTransferDuration_() || 0;\n          },\n          enumerable: true\n        },\n        mediaBytesTransferred: {\n          get: function get$$1() {\n            return _this38.masterPlaylistController_.mediaBytesTransferred_() || 0;\n          },\n          enumerable: true\n        },\n        mediaSecondsLoaded: {\n          get: function get$$1() {\n            return _this38.masterPlaylistController_.mediaSecondsLoaded_() || 0;\n          },\n          enumerable: true\n        },\n        buffered: {\n          get: function get$$1() {\n            return timeRangesToArray(_this38.tech_.buffered());\n          },\n          enumerable: true\n        },\n        currentTime: {\n          get: function get$$1() {\n            return _this38.tech_.currentTime();\n          },\n          enumerable: true\n        },\n        currentSource: {\n          get: function get$$1() {\n            return _this38.tech_.currentSource_;\n          },\n          enumerable: true\n        },\n        currentTech: {\n          get: function get$$1() {\n            return _this38.tech_.name_;\n          },\n          enumerable: true\n        },\n        duration: {\n          get: function get$$1() {\n            return _this38.tech_.duration();\n          },\n          enumerable: true\n        },\n        master: {\n          get: function get$$1() {\n            return _this38.playlists.master;\n          },\n          enumerable: true\n        },\n        playerDimensions: {\n          get: function get$$1() {\n            return _this38.tech_.currentDimensions();\n          },\n          enumerable: true\n        },\n        seekable: {\n          get: function get$$1() {\n            return timeRangesToArray(_this38.tech_.seekable());\n          },\n          enumerable: true\n        },\n        timestamp: {\n          get: function get$$1() {\n            return Date.now();\n          },\n          enumerable: true\n        },\n        videoPlaybackQuality: {\n          get: function get$$1() {\n            return _this38.tech_.getVideoPlaybackQuality();\n          },\n          enumerable: true\n        }\n      });\n\n      this.tech_.one('canplay', this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_));\n\n      this.masterPlaylistController_.on('selectedinitialmedia', function () {\n        // Add the manual rendition mix-in to HlsHandler\n        renditionSelectionMixin(_this38);\n        setupEmeOptions(_this38);\n      });\n\n      // the bandwidth of the primary segment loader is our best\n      // estimate of overall bandwidth\n      this.on(this.masterPlaylistController_, 'progress', function () {\n        this.tech_.trigger('progress');\n      });\n\n      // In the live case, we need to ignore the very first `seeking` event since\n      // that will be the result of the seek-to-live behavior\n      this.on(this.masterPlaylistController_, 'firstplay', function () {\n        this.ignoreNextSeekingEvent_ = true;\n      });\n\n      this.tech_.ready(function () {\n        return _this38.setupQualityLevels_();\n      });\n\n      // do nothing if the tech has been disposed already\n      // this can occur if someone sets the src in player.ready(), for instance\n      if (!this.tech_.el()) {\n        return;\n      }\n\n      this.tech_.src(videojs$1.URL.createObjectURL(this.masterPlaylistController_.mediaSource));\n    };\n\n    /**\n     * Initializes the quality levels and sets listeners to update them.\n     *\n     * @method setupQualityLevels_\n     * @private\n     */\n\n\n    HlsHandler.prototype.setupQualityLevels_ = function setupQualityLevels_() {\n      var _this39 = this;\n\n      var player = videojs$1.players[this.tech_.options_.playerId];\n\n      if (player && player.qualityLevels) {\n        this.qualityLevels_ = player.qualityLevels();\n\n        this.masterPlaylistController_.on('selectedinitialmedia', function () {\n          handleHlsLoadedMetadata(_this39.qualityLevels_, _this39);\n        });\n\n        this.playlists.on('mediachange', function () {\n          handleHlsMediaChange(_this39.qualityLevels_, _this39.playlists);\n        });\n      }\n    };\n\n    /**\n     * Begin playing the video.\n     */\n\n\n    HlsHandler.prototype.play = function play() {\n      this.masterPlaylistController_.play();\n    };\n\n    /**\n     * a wrapper around the function in MasterPlaylistController\n     */\n\n\n    HlsHandler.prototype.setCurrentTime = function setCurrentTime(currentTime) {\n      this.masterPlaylistController_.setCurrentTime(currentTime);\n    };\n\n    /**\n     * a wrapper around the function in MasterPlaylistController\n     */\n\n\n    HlsHandler.prototype.duration = function duration() {\n      return this.masterPlaylistController_.duration();\n    };\n\n    /**\n     * a wrapper around the function in MasterPlaylistController\n     */\n\n\n    HlsHandler.prototype.seekable = function seekable() {\n      return this.masterPlaylistController_.seekable();\n    };\n\n    /**\n     * Abort all outstanding work and cleanup.\n     */\n\n\n    HlsHandler.prototype.dispose = function dispose() {\n      if (this.playbackWatcher_) {\n        this.playbackWatcher_.dispose();\n      }\n      if (this.masterPlaylistController_) {\n        this.masterPlaylistController_.dispose();\n      }\n      if (this.qualityLevels_) {\n        this.qualityLevels_.dispose();\n      }\n      _Component.prototype.dispose.call(this);\n    };\n\n    return HlsHandler;\n  }(Component$1);\n\n  /**\n   * The Source Handler object, which informs video.js what additional\n   * MIME types are supported and sets up playback. It is registered\n   * automatically to the appropriate tech based on the capabilities of\n   * the browser it is running in. It is not necessary to use or modify\n   * this object in normal usage.\n   */\n\n\n  var HlsSourceHandler = {\n    name: 'videojs-http-streaming',\n    VERSION: version$3,\n    canHandleSource: function canHandleSource(srcObj) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var localOptions = videojs$1.mergeOptions(videojs$1.options, options);\n\n      return HlsSourceHandler.canPlayType(srcObj.type, localOptions);\n    },\n    handleSource: function handleSource(source, tech) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      var localOptions = videojs$1.mergeOptions(videojs$1.options, options);\n\n      tech.hls = new HlsHandler(source, tech, localOptions);\n      tech.hls.xhr = xhrFactory();\n\n      tech.hls.src(source.src, source.type);\n      return tech.hls;\n    },\n    canPlayType: function canPlayType(type) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var _videojs$mergeOptions = videojs$1.mergeOptions(videojs$1.options, options),\n          overrideNative = _videojs$mergeOptions.hls.overrideNative;\n\n      var supportedType = simpleTypeFromSourceType(type);\n      var canUseMsePlayback = supportedType && (!Hls$1.supportsTypeNatively(supportedType) || overrideNative);\n\n      return canUseMsePlayback ? 'maybe' : '';\n    }\n  };\n\n  if (typeof videojs$1.MediaSource === 'undefined' || typeof videojs$1.URL === 'undefined') {\n    videojs$1.MediaSource = MediaSource;\n    videojs$1.URL = URL$1;\n  }\n\n  // register source handlers with the appropriate techs\n  if (MediaSource.supportsNativeMediaSources()) {\n    videojs$1.getTech('Html5').registerSourceHandler(HlsSourceHandler, 0);\n  }\n\n  videojs$1.HlsHandler = HlsHandler;\n  videojs$1.HlsSourceHandler = HlsSourceHandler;\n  videojs$1.Hls = Hls$1;\n  if (!videojs$1.use) {\n    videojs$1.registerComponent('Hls', Hls$1);\n  }\n  videojs$1.options.hls = videojs$1.options.hls || {};\n\n  if (videojs$1.registerPlugin) {\n    videojs$1.registerPlugin('reloadSourceOnError', reloadSourceOnError);\n  } else {\n    videojs$1.plugin('reloadSourceOnError', reloadSourceOnError);\n  }\n\n  return videojs$1;\n\n})));\n","import videojs from './../../plugin/video'\n// import './../../plugin/videojs-contrib-hls'\nvar myPlayer = videojs('my-player');\nmyPlayer.play();"]}